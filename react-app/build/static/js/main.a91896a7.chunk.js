(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{147:function(e,t,n){(function(t,i){var r=n(722),a=n(725),s=n(311),o=n(305),u=n(158),l=n(726),c=n(244),h=n(308),d=n(309),f=n(21),p=n(268),m=n(728),v=n(312),g=n(314),y=n(315),b=n(729),S=n(242),x=n(313),_=["offset"],E=["curve","oversample"],k=["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"],M=["channelCount","channelCountMode","pan"];e.exports=function(){var e={5179:function(e,t,n){"use strict";n.d(t,{B:function(){return a}});var i=n(655),r=n(6308),a=function(){function e(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.root=e,this.initialize.apply(this,(0,i.fl)(n)),this.foundation=void 0===t?this.getDefaultFoundation():t,this.foundation.init(),this.initialSyncWithDOM()}return e.attachTo=function(t){return new e(t,new r.K({}))},e.prototype.initialize=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.getDefaultFoundation=function(){throw new Error("Subclasses must override getDefaultFoundation to return a properly configured foundation class")},e.prototype.initialSyncWithDOM=function(){},e.prototype.destroy=function(){this.foundation.destroy()},e.prototype.listen=function(e,t,n){this.root.addEventListener(e,t,n)},e.prototype.unlisten=function(e,t,n){this.root.removeEventListener(e,t,n)},e.prototype.emit=function(e,t,n){var i;void 0===n&&(n=!1),"function"==typeof CustomEvent?i=new CustomEvent(e,{bubbles:n,detail:t}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,n,!1,t),this.root.dispatchEvent(i)},e}()},6308:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var i=function(){function e(e){void 0===e&&(e={}),this.adapter=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}()},9397:function(e,t,n){"use strict";function i(e){return void 0===e&&(e=window),!!function(e){void 0===e&&(e=window);var t=!1;try{var n={get passive(){return t=!0,!1}},i=function(){};e.document.addEventListener("test",i,n),e.document.removeEventListener("test",i,n)}catch(e){t=!1}return t}(e)&&{passive:!0}}n.d(t,{K:function(){return i}})},2851:function(e,t,n){"use strict";function i(e,t){return(e.matches||e.webkitMatchesSelector||e.msMatchesSelector).call(e,t)}n.d(t,{wB:function(){return i}})},3254:function(e,t,n){"use strict";n.r(t),n.d(t,{MDCIconButtonToggle:function(){return h},MDCIconButtonToggleFoundation:function(){return l},cssClasses:function(){return o},strings:function(){return u}});var i=n(655),r=n(5179),a=n(1661),s=n(6308),o={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},u={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"},l=function(e){function t(n){var r=e.call(this,(0,i.pi)((0,i.pi)({},t.defaultAdapter),n))||this;return r.hasToggledAriaLabel=!1,r}return(0,i.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return o},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return u},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this.adapter.getAttr(u.DATA_ARIA_LABEL_ON),t=this.adapter.getAttr(u.DATA_ARIA_LABEL_OFF);if(e&&t){if(null!==this.adapter.getAttr(u.ARIA_PRESSED))throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(u.ARIA_PRESSED,String(this.isOn()))},t.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},t.prototype.isOn=function(){return this.adapter.hasClass(o.ICON_BUTTON_ON)},t.prototype.toggle=function(e){if(void 0===e&&(e=!this.isOn()),e?this.adapter.addClass(o.ICON_BUTTON_ON):this.adapter.removeClass(o.ICON_BUTTON_ON),this.hasToggledAriaLabel){var t=e?this.adapter.getAttr(u.DATA_ARIA_LABEL_ON):this.adapter.getAttr(u.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(u.ARIA_LABEL,t||"")}else this.adapter.setAttr(u.ARIA_PRESSED,""+e)},t}(s.K),c=l.strings,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rippleComponent=t.createRipple(),t}return(0,i.ZT)(t,e),t.attachTo=function(e){return new t(e)},t.prototype.initialSyncWithDOM=function(){var e=this;this.handleClick=function(){e.foundation.handleClick()},this.listen("click",this.handleClick)},t.prototype.destroy=function(){this.unlisten("click",this.handleClick),this.ripple.destroy(),e.prototype.destroy.call(this)},t.prototype.getDefaultFoundation=function(){var e=this;return new l({addClass:function(t){return e.root.classList.add(t)},hasClass:function(t){return e.root.classList.contains(t)},notifyChange:function(t){e.emit(c.CHANGE_EVENT,t)},removeClass:function(t){return e.root.classList.remove(t)},getAttr:function(t){return e.root.getAttribute(t)},setAttr:function(t,n){return e.root.setAttribute(t,n)}})},Object.defineProperty(t.prototype,"ripple",{get:function(){return this.rippleComponent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"on",{get:function(){return this.foundation.isOn()},set:function(e){this.foundation.toggle(e)},enumerable:!0,configurable:!0}),t.prototype.createRipple=function(){var e=new a.F(this.root);return e.unbounded=!0,e},t}(r.B)},1661:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var i=n(655),r=n(5179),a=n(9397),s=n(2851),o=n(514),u=n(4014),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disabled=!1,t}return(0,i.ZT)(t,e),t.attachTo=function(e,n){void 0===n&&(n={isUnbounded:void 0});var i=new t(e);return void 0!==n.isUnbounded&&(i.unbounded=n.isUnbounded),i},t.createAdapter=function(e){return{addClass:function(t){return e.root.classList.add(t)},browserSupportsCssVars:function(){return u.supportsCssVariables(window)},computeBoundingRect:function(){return e.root.getBoundingClientRect()},containsEventTarget:function(t){return e.root.contains(t)},deregisterDocumentInteractionHandler:function(e,t){return document.documentElement.removeEventListener(e,t,(0,a.K)())},deregisterInteractionHandler:function(t,n){return e.root.removeEventListener(t,n,(0,a.K)())},deregisterResizeHandler:function(e){return window.removeEventListener("resize",e)},getWindowPageOffset:function(){return{x:window.pageXOffset,y:window.pageYOffset}},isSurfaceActive:function(){return(0,s.wB)(e.root,":active")},isSurfaceDisabled:function(){return Boolean(e.disabled)},isUnbounded:function(){return Boolean(e.unbounded)},registerDocumentInteractionHandler:function(e,t){return document.documentElement.addEventListener(e,t,(0,a.K)())},registerInteractionHandler:function(t,n){return e.root.addEventListener(t,n,(0,a.K)())},registerResizeHandler:function(e){return window.addEventListener("resize",e)},removeClass:function(t){return e.root.classList.remove(t)},updateCssVariable:function(t,n){return e.root.style.setProperty(t,n)}}},Object.defineProperty(t.prototype,"unbounded",{get:function(){return Boolean(this.unbounded_)},set:function(e){this.unbounded_=Boolean(e),this.setUnbounded_()},enumerable:!0,configurable:!0}),t.prototype.activate=function(){this.foundation.activate()},t.prototype.deactivate=function(){this.foundation.deactivate()},t.prototype.layout=function(){this.foundation.layout()},t.prototype.getDefaultFoundation=function(){return new o.l(t.createAdapter(this))},t.prototype.initialSyncWithDOM=function(){var e=this.root;this.unbounded="mdcRippleIsUnbounded"in e.dataset},t.prototype.setUnbounded_=function(){this.foundation.setUnbounded(Boolean(this.unbounded_))},t}(r.B)},9552:function(e,t,n){"use strict";n.d(t,{KT:function(){return a},UX:function(){return i},j2:function(){return r}});var i={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},r={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},a={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300}},514:function(e,t,n){"use strict";n.d(t,{l:function(){return c}});var i=n(655),r=n(6308),a=n(9552),s=n(4014),o=["touchstart","pointerdown","mousedown","keydown"],u=["touchend","pointerup","mouseup","contextmenu"],l=[],c=function(e){function t(n){var r=e.call(this,(0,i.pi)((0,i.pi)({},t.defaultAdapter),n))||this;return r.activationAnimationHasEnded_=!1,r.activationTimer_=0,r.fgDeactivationRemovalTimer_=0,r.fgScale_="0",r.frame_={width:0,height:0},r.initialSize_=0,r.layoutFrame_=0,r.maxRadius_=0,r.unboundedCoords_={left:0,top:0},r.activationState_=r.defaultActivationState_(),r.activationTimerCallback_=function(){r.activationAnimationHasEnded_=!0,r.runDeactivationUXLogicIfReady_()},r.activateHandler_=function(e){return r.activate_(e)},r.deactivateHandler_=function(){return r.deactivate_()},r.focusHandler_=function(){return r.handleFocus()},r.blurHandler_=function(){return r.handleBlur()},r.resizeHandler_=function(){return r.layout()},r}return(0,i.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return a.UX},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return a.j2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return a.KT},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this,n=this.supportsPressRipple_();if(this.registerRootHandlers_(n),n){var i=t.cssClasses,r=i.ROOT,a=i.UNBOUNDED;requestAnimationFrame((function(){e.adapter.addClass(r),e.adapter.isUnbounded()&&(e.adapter.addClass(a),e.layoutInternal_())}))}},t.prototype.destroy=function(){var e=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter.removeClass(t.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter.removeClass(t.cssClasses.FG_DEACTIVATION));var n=t.cssClasses,i=n.ROOT,r=n.UNBOUNDED;requestAnimationFrame((function(){e.adapter.removeClass(i),e.adapter.removeClass(r),e.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},t.prototype.activate=function(e){this.activate_(e)},t.prototype.deactivate=function(){this.deactivate_()},t.prototype.layout=function(){var e=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){e.layoutInternal_(),e.layoutFrame_=0}))},t.prototype.setUnbounded=function(e){var n=t.cssClasses.UNBOUNDED;e?this.adapter.addClass(n):this.adapter.removeClass(n)},t.prototype.handleFocus=function(){var e=this;requestAnimationFrame((function(){return e.adapter.addClass(t.cssClasses.BG_FOCUSED)}))},t.prototype.handleBlur=function(){var e=this;requestAnimationFrame((function(){return e.adapter.removeClass(t.cssClasses.BG_FOCUSED)}))},t.prototype.supportsPressRipple_=function(){return this.adapter.browserSupportsCssVars()},t.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},t.prototype.registerRootHandlers_=function(e){var t=this;e&&(o.forEach((function(e){t.adapter.registerInteractionHandler(e,t.activateHandler_)})),this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler_)),this.adapter.registerInteractionHandler("focus",this.focusHandler_),this.adapter.registerInteractionHandler("blur",this.blurHandler_)},t.prototype.registerDeactivationHandlers_=function(e){var t=this;"keydown"===e.type?this.adapter.registerInteractionHandler("keyup",this.deactivateHandler_):u.forEach((function(e){t.adapter.registerDocumentInteractionHandler(e,t.deactivateHandler_)}))},t.prototype.deregisterRootHandlers_=function(){var e=this;o.forEach((function(t){e.adapter.deregisterInteractionHandler(t,e.activateHandler_)})),this.adapter.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler_)},t.prototype.deregisterDeactivationHandlers_=function(){var e=this;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler_),u.forEach((function(t){e.adapter.deregisterDocumentInteractionHandler(t,e.deactivateHandler_)}))},t.prototype.removeCssVars_=function(){var e=this,n=t.strings;Object.keys(n).forEach((function(t){0===t.indexOf("VAR_")&&e.adapter.updateCssVariable(n[t],null)}))},t.prototype.activate_=function(e){var t=this;if(!this.adapter.isSurfaceDisabled()){var n=this.activationState_;if(!n.isActivated){var i=this.previousActivationEvent_;i&&void 0!==e&&i.type!==e.type||(n.isActivated=!0,n.isProgrammatic=void 0===e,n.activationEvent=e,n.wasActivatedByPointer=!n.isProgrammatic&&void 0!==e&&("mousedown"===e.type||"touchstart"===e.type||"pointerdown"===e.type),void 0!==e&&l.length>0&&l.some((function(e){return t.adapter.containsEventTarget(e)}))?this.resetActivationState_():(void 0!==e&&(l.push(e.target),this.registerDeactivationHandlers_(e)),n.wasElementMadeActive=this.checkElementMadeActive_(e),n.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){l=[],n.wasElementMadeActive||void 0===e||" "!==e.key&&32!==e.keyCode||(n.wasElementMadeActive=t.checkElementMadeActive_(e),n.wasElementMadeActive&&t.animateActivation_()),n.wasElementMadeActive||(t.activationState_=t.defaultActivationState_())}))))}}},t.prototype.checkElementMadeActive_=function(e){return void 0===e||"keydown"!==e.type||this.adapter.isSurfaceActive()},t.prototype.animateActivation_=function(){var e=this,n=t.strings,i=n.VAR_FG_TRANSLATE_START,r=n.VAR_FG_TRANSLATE_END,a=t.cssClasses,s=a.FG_DEACTIVATION,o=a.FG_ACTIVATION,u=t.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var l="",c="";if(!this.adapter.isUnbounded()){var h=this.getFgTranslationCoordinates_(),d=h.startPoint,f=h.endPoint;l=d.x+"px, "+d.y+"px",c=f.x+"px, "+f.y+"px"}this.adapter.updateCssVariable(i,l),this.adapter.updateCssVariable(r,c),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter.removeClass(s),this.adapter.computeBoundingRect(),this.adapter.addClass(o),this.activationTimer_=setTimeout((function(){return e.activationTimerCallback_()}),u)},t.prototype.getFgTranslationCoordinates_=function(){var e,t=this.activationState_,n=t.activationEvent;return{startPoint:e={x:(e=t.wasActivatedByPointer?(0,s.getNormalizedEventCoords)(n,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:e.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},t.prototype.runDeactivationUXLogicIfReady_=function(){var e=this,n=t.cssClasses.FG_DEACTIVATION,i=this.activationState_,r=i.hasDeactivationUXRun,s=i.isActivated;(r||!s)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter.addClass(n),this.fgDeactivationRemovalTimer_=setTimeout((function(){e.adapter.removeClass(n)}),a.KT.FG_DEACTIVATION_MS))},t.prototype.rmBoundedActivationClasses_=function(){var e=t.cssClasses.FG_ACTIVATION;this.adapter.removeClass(e),this.activationAnimationHasEnded_=!1,this.adapter.computeBoundingRect()},t.prototype.resetActivationState_=function(){var e=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return e.previousActivationEvent_=void 0}),t.numbers.TAP_DELAY_MS)},t.prototype.deactivate_=function(){var e=this,t=this.activationState_;if(t.isActivated){var n=(0,i.pi)({},t);t.isProgrammatic?(requestAnimationFrame((function(){return e.animateDeactivation_(n)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){e.activationState_.hasDeactivationUXRun=!0,e.animateDeactivation_(n),e.resetActivationState_()})))}},t.prototype.animateDeactivation_=function(e){var t=e.wasActivatedByPointer,n=e.wasElementMadeActive;(t||n)&&this.runDeactivationUXLogicIfReady_()},t.prototype.layoutInternal_=function(){this.frame_=this.adapter.computeBoundingRect();var e=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter.isUnbounded()?e:Math.sqrt(Math.pow(this.frame_.width,2)+Math.pow(this.frame_.height,2))+t.numbers.PADDING;var n=Math.floor(e*t.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&n%2!=0?this.initialSize_=n-1:this.initialSize_=n,this.fgScale_=""+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},t.prototype.updateLayoutCssVars_=function(){var e=t.strings,n=e.VAR_FG_SIZE,i=e.VAR_LEFT,r=e.VAR_TOP,a=e.VAR_FG_SCALE;this.adapter.updateCssVariable(n,this.initialSize_+"px"),this.adapter.updateCssVariable(a,this.fgScale_),this.adapter.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter.updateCssVariable(i,this.unboundedCoords_.left+"px"),this.adapter.updateCssVariable(r,this.unboundedCoords_.top+"px"))},t}(r.K)},7933:function(e,t,n){"use strict";n.r(t),n.d(t,{MDCRipple:function(){return r.F},MDCRippleFoundation:function(){return s.l},cssClasses:function(){return a.UX},numbers:function(){return a.KT},strings:function(){return a.j2},util:function(){return i}});var i=n(4014),r=n(1661),a=n(9552),s=n(514)},4014:function(e,t,n){"use strict";var i;function r(e,t){void 0===t&&(t=!1);var n,r=e.CSS;if("boolean"==typeof i&&!t)return i;if(!r||"function"!=typeof r.supports)return!1;var a=r.supports("--css-vars","yes"),s=r.supports("(--css-vars: yes)")&&r.supports("color","#00000000");return n=a||s,t||(i=n),n}function a(e,t,n){if(!e)return{x:0,y:0};var i,r,a=t.x,s=t.y,o=a+n.left,u=s+n.top;if("touchstart"===e.type){var l=e;i=l.changedTouches[0].pageX-o,r=l.changedTouches[0].pageY-u}else{var c=e;i=c.pageX-o,r=c.pageY-u}return{x:i,y:r}}n.r(t),n.d(t,{getNormalizedEventCoords:function(){return a},supportsCssVariables:function(){return r}})},5088:function(e,t,n){"use strict";n.r(t),n.d(t,{MDCSlider:function(){return P},MDCSliderFoundation:function(){return w},cssClasses:function(){return s},numbers:function(){return u},strings:function(){return o}});var i=n(655),r=n(5179),a=n(9397),s={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete",DISABLE_TOUCH_ACTION:"mdc-slider--disable-touch-action"},o={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},u={PAGE_FACTOR:4},l={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},c={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function h(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}var d=n(6308),f="undefined"!=typeof window,p=f&&!!window.PointerEvent,m=p?["pointerdown"]:["mousedown","touchstart"],v=p?["pointerup"]:["mouseup","touchend"],g={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},y="ArrowDown",b="ArrowLeft",S="ArrowRight",x="ArrowUp",_="End",E="Home",k="PageDown",M="PageUp",w=function(e){function t(n){var r=e.call(this,(0,i.pi)((0,i.pi)({},t.defaultAdapter),n))||this;return r.savedTabIndex_=NaN,r.active_=!1,r.inTransit_=!1,r.isDiscrete_=!1,r.hasTrackMarker_=!1,r.handlingThumbTargetEvt_=!1,r.min_=0,r.max_=100,r.step_=0,r.value_=0,r.disabled_=!1,r.preventFocusState_=!1,r.thumbContainerPointerHandler_=function(){return r.handlingThumbTargetEvt_=!0},r.interactionStartHandler_=function(e){return r.handleDown_(e)},r.keydownHandler_=function(e){return r.handleKeydown_(e)},r.focusHandler_=function(){return r.handleFocus_()},r.blurHandler_=function(){return r.handleBlur_()},r.resizeHandler_=function(){return r.layout()},r}return(0,i.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return s},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return o},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return u},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;this.isDiscrete_=this.adapter.hasClass(s.IS_DISCRETE),this.hasTrackMarker_=this.adapter.hasClass(s.HAS_TRACK_MARKER),m.forEach((function(t){e.adapter.registerInteractionHandler(t,e.interactionStartHandler_),e.adapter.registerThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),p&&this.adapter.addClass(s.DISABLE_TOUCH_ACTION),this.adapter.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter.registerInteractionHandler("focus",this.focusHandler_),this.adapter.registerInteractionHandler("blur",this.blurHandler_),this.adapter.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},t.prototype.destroy=function(){var e=this;m.forEach((function(t){e.adapter.deregisterInteractionHandler(t,e.interactionStartHandler_),e.adapter.deregisterThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter.deregisterResizeHandler(this.resizeHandler_)},t.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},t.prototype.layout=function(){this.rect_=this.adapter.computeBoundingRect(),this.updateUIForCurrentValue_()},t.prototype.getValue=function(){return this.value_},t.prototype.setValue=function(e){this.setValue_(e,!1)},t.prototype.getMax=function(){return this.max_},t.prototype.setMax=function(e){if(e<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=e,this.setValue_(this.value_,!1,!0),this.adapter.setAttribute(o.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},t.prototype.getMin=function(){return this.min_},t.prototype.setMin=function(e){if(e>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=e,this.setValue_(this.value_,!1,!0),this.adapter.setAttribute(o.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},t.prototype.getStep=function(){return this.step_},t.prototype.setStep=function(e){if(e<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof e||e<1)&&(e=1),this.step_=e,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},t.prototype.isDisabled=function(){return this.disabled_},t.prototype.setDisabled=function(e){this.disabled_=e,this.toggleClass_(s.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter.getTabIndex(),this.adapter.setAttribute(o.ARIA_DISABLED,"true"),this.adapter.removeAttribute("tabindex")):(this.adapter.removeAttribute(o.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter.setAttribute("tabindex",String(this.savedTabIndex_)))},t.prototype.handleDown_=function(e){var t=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(e){t.handleMove_(e)},i=g[e.type],r=function e(){t.handleUp_(),t.adapter.deregisterBodyInteractionHandler(i,n),v.forEach((function(n){return t.adapter.deregisterBodyInteractionHandler(n,e)}))};this.adapter.registerBodyInteractionHandler(i,n),v.forEach((function(e){return t.adapter.registerBodyInteractionHandler(e,r)})),this.setValueFromEvt_(e)}},t.prototype.handleMove_=function(e){e.preventDefault(),this.setValueFromEvt_(e)},t.prototype.handleUp_=function(){this.setActive_(!1),this.adapter.notifyChange()},t.prototype.getClientX_=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].clientX:e.clientX},t.prototype.setValueFromEvt_=function(e){var t=this.getClientX_(e),n=this.computeValueFromClientX_(t);this.setValue_(n,!0)},t.prototype.computeValueFromClientX_=function(e){var t=this.max_,n=this.min_,i=(e-this.rect_.left)/this.rect_.width;return this.adapter.isRTL()&&(i=1-i),n+i*(t-n)},t.prototype.handleKeydown_=function(e){var t=this.getKeyId_(e),n=this.getValueForKeyId_(t);isNaN(n)||(e.preventDefault(),this.adapter.addClass(s.FOCUS),this.setValue_(n,!0),this.adapter.notifyChange())},t.prototype.getKeyId_=function(e){return e.key===b||37===e.keyCode?b:e.key===S||39===e.keyCode?S:e.key===x||38===e.keyCode?x:e.key===y||40===e.keyCode?y:e.key===E||36===e.keyCode?E:e.key===_||35===e.keyCode?_:e.key===M||33===e.keyCode?M:e.key===k||34===e.keyCode?k:""},t.prototype.getValueForKeyId_=function(e){var t=this,n=t.max_,i=t.min_,r=t.step_||(n-i)/100;switch(this.adapter.isRTL()&&(e===b||e===S)&&(r=-r),e){case b:case y:return this.value_-r;case S:case x:return this.value_+r;case E:return this.min_;case _:return this.max_;case M:return this.value_+r*u.PAGE_FACTOR;case k:return this.value_-r*u.PAGE_FACTOR;default:return NaN}},t.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter.addClass(s.FOCUS)},t.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter.removeClass(s.FOCUS)},t.prototype.setValue_=function(e,t,n){if(void 0===n&&(n=!1),e!==this.value_||n){var i=this.min_,r=this.max_,a=e===i||e===r;this.step_&&!a&&(e=this.quantize_(e)),e<i?e=i:e>r&&(e=r),e=e||0,this.value_=e,this.adapter.setAttribute(o.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),t&&(this.adapter.notifyInput(),this.isDiscrete_&&this.adapter.setMarkerValue(e))}},t.prototype.quantize_=function(e){return Math.round(e/this.step_)*this.step_},t.prototype.updateUIForCurrentValue_=function(){var e=this,t=this,n=t.max_,i=t.min_,r=(t.value_-i)/(n-i),a=r*this.rect_.width;this.adapter.isRTL()&&(a=this.rect_.width-a);var s=f?function(e,t){if(h(e)&&t in l){var n=e.document.createElement("div"),i=l.transform,r=i.standard,a=i.prefixed;return r in n.style?r:a}return t}(window,"transform"):"transform",o=f?function(e,t){if(h(e)&&t in c){var n=e.document.createElement("div"),i=c[t],r=i.standard,a=i.prefixed;return i.cssProperty in n.style?r:a}return t}(window,"transitionend"):"transitionend";if(this.inTransit_){var u=function t(){e.setInTransit_(!1),e.adapter.deregisterThumbContainerInteractionHandler(o,t)};this.adapter.registerThumbContainerInteractionHandler(o,u)}requestAnimationFrame((function(){e.adapter.setThumbContainerStyleProperty(s,"translateX("+a+"px) translateX(-50%)"),e.adapter.setTrackStyleProperty(s,"scaleX("+r+")")}))},t.prototype.setActive_=function(e){this.active_=e,this.toggleClass_(s.ACTIVE,this.active_)},t.prototype.setInTransit_=function(e){this.inTransit_=e,this.toggleClass_(s.IN_TRANSIT,this.inTransit_)},t.prototype.toggleClass_=function(e,t){t?this.adapter.addClass(e):this.adapter.removeClass(e)},t}(d.K),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.attachTo=function(e){return new t(e)},Object.defineProperty(t.prototype,"value",{get:function(){return this.foundation.getValue()},set:function(e){this.foundation.setValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.foundation.getMin()},set:function(e){this.foundation.setMin(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.foundation.getMax()},set:function(e){this.foundation.setMax(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"step",{get:function(){return this.foundation.getStep()},set:function(e){this.foundation.setStep(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this.foundation.isDisabled()},set:function(e){this.foundation.setDisabled(e)},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.thumbContainer_=this.root.querySelector(o.THUMB_CONTAINER_SELECTOR),this.track_=this.root.querySelector(o.TRACK_SELECTOR),this.pinValueMarker_=this.root.querySelector(o.PIN_VALUE_MARKER_SELECTOR),this.trackMarkerContainer_=this.root.querySelector(o.TRACK_MARKER_CONTAINER_SELECTOR)},t.prototype.getDefaultFoundation=function(){var e=this;return new w({hasClass:function(t){return e.root.classList.contains(t)},addClass:function(t){return e.root.classList.add(t)},removeClass:function(t){return e.root.classList.remove(t)},getAttribute:function(t){return e.root.getAttribute(t)},setAttribute:function(t,n){return e.root.setAttribute(t,n)},removeAttribute:function(t){return e.root.removeAttribute(t)},computeBoundingRect:function(){return e.root.getBoundingClientRect()},getTabIndex:function(){return e.root.tabIndex},registerInteractionHandler:function(t,n){return e.listen(t,n,(0,a.K)())},deregisterInteractionHandler:function(t,n){return e.unlisten(t,n,(0,a.K)())},registerThumbContainerInteractionHandler:function(t,n){e.thumbContainer_.addEventListener(t,n,(0,a.K)())},deregisterThumbContainerInteractionHandler:function(t,n){e.thumbContainer_.removeEventListener(t,n,(0,a.K)())},registerBodyInteractionHandler:function(e,t){return document.body.addEventListener(e,t)},deregisterBodyInteractionHandler:function(e,t){return document.body.removeEventListener(e,t)},registerResizeHandler:function(e){return window.addEventListener("resize",e)},deregisterResizeHandler:function(e){return window.removeEventListener("resize",e)},notifyInput:function(){return e.emit(o.INPUT_EVENT,e)},notifyChange:function(){return e.emit(o.CHANGE_EVENT,e)},setThumbContainerStyleProperty:function(t,n){e.thumbContainer_.style.setProperty(t,n)},setTrackStyleProperty:function(t,n){return e.track_.style.setProperty(t,n)},setMarkerValue:function(t){return e.pinValueMarker_.innerText=t.toLocaleString()},setTrackMarkers:function(t,n,i){var r=t.toLocaleString(),a="linear-gradient(to right, currentColor 2px, transparent 0) 0 center / calc((100% - 2px) / (("+n.toLocaleString()+" - "+i.toLocaleString()+") / "+r+")) 100% repeat-x";e.trackMarkerContainer_.style.setProperty("background",a)},isRTL:function(){return"rtl"===getComputedStyle(e.root).direction}})},t.prototype.initialSyncWithDOM=function(){var e=this.parseFloat_(this.root.getAttribute(o.ARIA_VALUENOW),this.value),t=this.parseFloat_(this.root.getAttribute(o.ARIA_VALUEMIN),this.min),n=this.parseFloat_(this.root.getAttribute(o.ARIA_VALUEMAX),this.max);t>=this.max?(this.max=n,this.min=t):(this.min=t,this.max=n),this.step=this.parseFloat_(this.root.getAttribute(o.STEP_DATA_ATTR),this.step),this.value=e,this.disabled=this.root.hasAttribute(o.ARIA_DISABLED)&&"false"!==this.root.getAttribute(o.ARIA_DISABLED),this.foundation.setupTrackMarker()},t.prototype.layout=function(){this.foundation.layout()},t.prototype.stepUp=function(e){void 0===e&&(e=this.step||1),this.value+=e},t.prototype.stepDown=function(e){void 0===e&&(e=this.step||1),this.value-=e},t.prototype.parseFloat_=function(e,t){var n=parseFloat(e);return"number"==typeof n&&isFinite(n)?n:t},t}(r.B)},9333:function(e,t,n){"use strict";n.r(t),n.d(t,{MDCTabBar:function(){return B},MDCTabBarFoundation:function(){return O},numbers:function(){return I},strings:function(){return C}});var i,r=n(655),a=n(5179),s=n(9397),o=n(2851),u=n(6308),l={ANIMATING:"mdc-tab-scroller--animating",SCROLL_AREA_SCROLL:"mdc-tab-scroller__scroll-area--scroll",SCROLL_TEST:"mdc-tab-scroller__test"},c={AREA_SELECTOR:".mdc-tab-scroller__scroll-area",CONTENT_SELECTOR:".mdc-tab-scroller__scroll-content"},h=function(e){this.adapter=e},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.getScrollPositionRTL=function(){var e=this.adapter.getScrollAreaScrollLeft(),t=this.calculateScrollEdges_().right;return Math.round(t-e)},t.prototype.scrollToRTL=function(e){var t=this.calculateScrollEdges_(),n=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue_(t.right-e);return{finalScrollPosition:i,scrollDelta:i-n}},t.prototype.incrementScrollRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(t-e);return{finalScrollPosition:n,scrollDelta:n-t}},t.prototype.getAnimatingScrollPosition=function(e){return e},t.prototype.calculateScrollEdges_=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},t.prototype.clampScrollValue_=function(e){var t=this.calculateScrollEdges_();return Math.min(Math.max(t.left,e),t.right)},t}(h),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.getScrollPositionRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft();return Math.round(e-t)},t.prototype.scrollToRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(-e);return{finalScrollPosition:n,scrollDelta:n-t}},t.prototype.incrementScrollRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(t-e);return{finalScrollPosition:n,scrollDelta:n-t}},t.prototype.getAnimatingScrollPosition=function(e,t){return e-t},t.prototype.calculateScrollEdges_=function(){var e=this.adapter.getScrollContentOffsetWidth();return{left:this.adapter.getScrollAreaOffsetWidth()-e,right:0}},t.prototype.clampScrollValue_=function(e){var t=this.calculateScrollEdges_();return Math.max(Math.min(t.right,e),t.left)},t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.getScrollPositionRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft();return Math.round(t-e)},t.prototype.scrollToRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(e);return{finalScrollPosition:n,scrollDelta:t-n}},t.prototype.incrementScrollRTL=function(e){var t=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(t+e);return{finalScrollPosition:n,scrollDelta:t-n}},t.prototype.getAnimatingScrollPosition=function(e,t){return e+t},t.prototype.calculateScrollEdges_=function(){return{left:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth(),right:0}},t.prototype.clampScrollValue_=function(e){var t=this.calculateScrollEdges_();return Math.min(Math.max(t.right,e),t.left)},t}(h),m=function(e){function t(n){var i=e.call(this,(0,r.pi)((0,r.pi)({},t.defaultAdapter),n))||this;return i.isAnimating_=!1,i}return(0,r.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return l},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return c},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{eventTargetMatchesSelector:function(){return!1},addClass:function(){},removeClass:function(){},addScrollAreaClass:function(){},setScrollAreaStyleProperty:function(){},setScrollContentStyleProperty:function(){},getScrollContentStyleValue:function(){return""},setScrollAreaScrollLeft:function(){},getScrollAreaScrollLeft:function(){return 0},getScrollContentOffsetWidth:function(){return 0},getScrollAreaOffsetWidth:function(){return 0},computeScrollAreaClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeScrollContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeHorizontalScrollbarHeight:function(){return 0}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this.adapter.computeHorizontalScrollbarHeight();this.adapter.setScrollAreaStyleProperty("margin-bottom",-e+"px"),this.adapter.addScrollAreaClass(t.cssClasses.SCROLL_AREA_SCROLL)},t.prototype.getScrollPosition=function(){if(this.isRTL_())return this.computeCurrentScrollPositionRTL_();var e=this.calculateCurrentTranslateX_();return this.adapter.getScrollAreaScrollLeft()-e},t.prototype.handleInteraction=function(){this.isAnimating_&&this.stopScrollAnimation_()},t.prototype.handleTransitionEnd=function(e){var n=e.target;this.isAnimating_&&this.adapter.eventTargetMatchesSelector(n,t.strings.CONTENT_SELECTOR)&&(this.isAnimating_=!1,this.adapter.removeClass(t.cssClasses.ANIMATING))},t.prototype.incrementScroll=function(e){0!==e&&this.animate_(this.getIncrementScrollOperation_(e))},t.prototype.incrementScrollImmediate=function(e){if(0!==e){var t=this.getIncrementScrollOperation_(e);0!==t.scrollDelta&&(this.stopScrollAnimation_(),this.adapter.setScrollAreaScrollLeft(t.finalScrollPosition))}},t.prototype.scrollTo=function(e){if(this.isRTL_())return this.scrollToRTL_(e);this.scrollTo_(e)},t.prototype.getRTLScroller=function(){return this.rtlScrollerInstance_||(this.rtlScrollerInstance_=this.rtlScrollerFactory_()),this.rtlScrollerInstance_},t.prototype.calculateCurrentTranslateX_=function(){var e=this.adapter.getScrollContentStyleValue("transform");if("none"===e)return 0;var t=/\((.+?)\)/.exec(e);if(!t)return 0;var n=t[1],i=(0,r.CR)(n.split(","),6),a=(i[0],i[1],i[2],i[3],i[4]);return i[5],parseFloat(a)},t.prototype.clampScrollValue_=function(e){var t=this.calculateScrollEdges_();return Math.min(Math.max(t.left,e),t.right)},t.prototype.computeCurrentScrollPositionRTL_=function(){var e=this.calculateCurrentTranslateX_();return this.getRTLScroller().getScrollPositionRTL(e)},t.prototype.calculateScrollEdges_=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},t.prototype.scrollTo_=function(e){var t=this.getScrollPosition(),n=this.clampScrollValue_(e),i=n-t;this.animate_({finalScrollPosition:n,scrollDelta:i})},t.prototype.scrollToRTL_=function(e){var t=this.getRTLScroller().scrollToRTL(e);this.animate_(t)},t.prototype.getIncrementScrollOperation_=function(e){if(this.isRTL_())return this.getRTLScroller().incrementScrollRTL(e);var t=this.getScrollPosition(),n=e+t,i=this.clampScrollValue_(n);return{finalScrollPosition:i,scrollDelta:i-t}},t.prototype.animate_=function(e){var n=this;0!==e.scrollDelta&&(this.stopScrollAnimation_(),this.adapter.setScrollAreaScrollLeft(e.finalScrollPosition),this.adapter.setScrollContentStyleProperty("transform","translateX("+e.scrollDelta+"px)"),this.adapter.computeScrollAreaClientRect(),requestAnimationFrame((function(){n.adapter.addClass(t.cssClasses.ANIMATING),n.adapter.setScrollContentStyleProperty("transform","none")})),this.isAnimating_=!0)},t.prototype.stopScrollAnimation_=function(){this.isAnimating_=!1;var e=this.getAnimatingScrollPosition_();this.adapter.removeClass(t.cssClasses.ANIMATING),this.adapter.setScrollContentStyleProperty("transform","translateX(0px)"),this.adapter.setScrollAreaScrollLeft(e)},t.prototype.getAnimatingScrollPosition_=function(){var e=this.calculateCurrentTranslateX_(),t=this.adapter.getScrollAreaScrollLeft();return this.isRTL_()?this.getRTLScroller().getAnimatingScrollPosition(t,e):t-e},t.prototype.rtlScrollerFactory_=function(){var e=this.adapter.getScrollAreaScrollLeft();this.adapter.setScrollAreaScrollLeft(e-1);var t=this.adapter.getScrollAreaScrollLeft();if(t<0)return this.adapter.setScrollAreaScrollLeft(e),new f(this.adapter);var n=this.adapter.computeScrollAreaClientRect(),i=this.adapter.computeScrollContentClientRect(),r=Math.round(i.right-n.right);return this.adapter.setScrollAreaScrollLeft(e),r===t?new p(this.adapter):new d(this.adapter)},t.prototype.isRTL_=function(){return"rtl"===this.adapter.getScrollContentStyleValue("direction")},t}(u.K),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.attachTo=function(e){return new t(e)},t.prototype.initialize=function(){this.area_=this.root.querySelector(m.strings.AREA_SELECTOR),this.content_=this.root.querySelector(m.strings.CONTENT_SELECTOR)},t.prototype.initialSyncWithDOM=function(){var e=this;this.handleInteraction_=function(){return e.foundation.handleInteraction()},this.handleTransitionEnd_=function(t){return e.foundation.handleTransitionEnd(t)},this.area_.addEventListener("wheel",this.handleInteraction_,(0,s.K)()),this.area_.addEventListener("touchstart",this.handleInteraction_,(0,s.K)()),this.area_.addEventListener("pointerdown",this.handleInteraction_,(0,s.K)()),this.area_.addEventListener("mousedown",this.handleInteraction_,(0,s.K)()),this.area_.addEventListener("keydown",this.handleInteraction_,(0,s.K)()),this.content_.addEventListener("transitionend",this.handleTransitionEnd_)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.area_.removeEventListener("wheel",this.handleInteraction_,(0,s.K)()),this.area_.removeEventListener("touchstart",this.handleInteraction_,(0,s.K)()),this.area_.removeEventListener("pointerdown",this.handleInteraction_,(0,s.K)()),this.area_.removeEventListener("mousedown",this.handleInteraction_,(0,s.K)()),this.area_.removeEventListener("keydown",this.handleInteraction_,(0,s.K)()),this.content_.removeEventListener("transitionend",this.handleTransitionEnd_)},t.prototype.getDefaultFoundation=function(){var e=this;return new m({eventTargetMatchesSelector:function(e,t){return(0,o.wB)(e,t)},addClass:function(t){return e.root.classList.add(t)},removeClass:function(t){return e.root.classList.remove(t)},addScrollAreaClass:function(t){return e.area_.classList.add(t)},setScrollAreaStyleProperty:function(t,n){return e.area_.style.setProperty(t,n)},setScrollContentStyleProperty:function(t,n){return e.content_.style.setProperty(t,n)},getScrollContentStyleValue:function(t){return window.getComputedStyle(e.content_).getPropertyValue(t)},setScrollAreaScrollLeft:function(t){return e.area_.scrollLeft=t},getScrollAreaScrollLeft:function(){return e.area_.scrollLeft},getScrollContentOffsetWidth:function(){return e.content_.offsetWidth},getScrollAreaOffsetWidth:function(){return e.area_.offsetWidth},computeScrollAreaClientRect:function(){return e.area_.getBoundingClientRect()},computeScrollContentClientRect:function(){return e.content_.getBoundingClientRect()},computeHorizontalScrollbarHeight:function(){return function(e,t){if(void 0===t&&(t=!0),t&&void 0!==i)return i;var n=e.createElement("div");n.classList.add(l.SCROLL_TEST),e.body.appendChild(n);var r=n.offsetHeight-n.clientHeight;return e.body.removeChild(n),t&&(i=r),r}(document)}})},t.prototype.getScrollPosition=function(){return this.foundation.getScrollPosition()},t.prototype.getScrollContentWidth=function(){return this.content_.offsetWidth},t.prototype.incrementScroll=function(e){this.foundation.incrementScroll(e)},t.prototype.scrollTo=function(e){this.foundation.scrollTo(e)},t}(a.B),g=n(1661),y=n(514),b={ACTIVE:"mdc-tab-indicator--active",FADE:"mdc-tab-indicator--fade",NO_TRANSITION:"mdc-tab-indicator--no-transition"},S={CONTENT_SELECTOR:".mdc-tab-indicator__content"},x=function(e){function t(n){return e.call(this,(0,r.pi)((0,r.pi)({},t.defaultAdapter),n))||this}return(0,r.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return b},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return S},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},computeContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setContentStyleProperty:function(){}}},enumerable:!0,configurable:!0}),t.prototype.computeContentClientRect=function(){return this.adapter.computeContentClientRect()},t}(u.K),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.activate=function(){this.adapter.addClass(x.cssClasses.ACTIVE)},t.prototype.deactivate=function(){this.adapter.removeClass(x.cssClasses.ACTIVE)},t}(x),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.activate=function(e){if(e){var t=this.computeContentClientRect(),n=e.width/t.width,i=e.left-t.left;this.adapter.addClass(x.cssClasses.NO_TRANSITION),this.adapter.setContentStyleProperty("transform","translateX("+i+"px) scaleX("+n+")"),this.computeContentClientRect(),this.adapter.removeClass(x.cssClasses.NO_TRANSITION),this.adapter.addClass(x.cssClasses.ACTIVE),this.adapter.setContentStyleProperty("transform","")}else this.adapter.addClass(x.cssClasses.ACTIVE)},t.prototype.deactivate=function(){this.adapter.removeClass(x.cssClasses.ACTIVE)},t}(x),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.attachTo=function(e){return new t(e)},t.prototype.initialize=function(){this.content_=this.root.querySelector(x.strings.CONTENT_SELECTOR)},t.prototype.computeContentClientRect=function(){return this.foundation.computeContentClientRect()},t.prototype.getDefaultFoundation=function(){var e=this,t={addClass:function(t){return e.root.classList.add(t)},removeClass:function(t){return e.root.classList.remove(t)},computeContentClientRect:function(){return e.content_.getBoundingClientRect()},setContentStyleProperty:function(t,n){return e.content_.style.setProperty(t,n)}};return this.root.classList.contains(x.cssClasses.FADE)?new _(t):new E(t)},t.prototype.activate=function(e){this.foundation.activate(e)},t.prototype.deactivate=function(){this.foundation.deactivate()},t}(a.B),M={ACTIVE:"mdc-tab--active"},w={ARIA_SELECTED:"aria-selected",CONTENT_SELECTOR:".mdc-tab__content",INTERACTED_EVENT:"MDCTab:interacted",RIPPLE_SELECTOR:".mdc-tab__ripple",TABINDEX:"tabIndex",TAB_INDICATOR_SELECTOR:".mdc-tab-indicator"},P=function(e){function t(n){var i=e.call(this,(0,r.pi)((0,r.pi)({},t.defaultAdapter),n))||this;return i.focusOnActivate_=!0,i}return(0,r.ZT)(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return M},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return w},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},activateIndicator:function(){},deactivateIndicator:function(){},notifyInteracted:function(){},getOffsetLeft:function(){return 0},getOffsetWidth:function(){return 0},getContentOffsetLeft:function(){return 0},getContentOffsetWidth:function(){return 0},focus:function(){}}},enumerable:!0,configurable:!0}),t.prototype.handleClick=function(){this.adapter.notifyInteracted()},t.prototype.isActive=function(){return this.adapter.hasClass(M.ACTIVE)},t.prototype.setFocusOnActivate=function(e){this.focusOnActivate_=e},t.prototype.activate=function(e){this.adapter.addClass(M.ACTIVE),this.adapter.setAttr(w.ARIA_SELECTED,"true"),this.adapter.setAttr(w.TABINDEX,"0"),this.adapter.activateIndicator(e),this.focusOnActivate_&&this.adapter.focus()},t.prototype.deactivate=function(){this.isActive()&&(this.adapter.removeClass(M.ACTIVE),this.adapter.setAttr(w.ARIA_SELECTED,"false"),this.adapter.setAttr(w.TABINDEX,"-1"),this.adapter.deactivateIndicator())},t.prototype.computeDimensions=function(){var e=this.adapter.getOffsetWidth(),t=this.adapter.getOffsetLeft(),n=this.adapter.getContentOffsetWidth(),i=this.adapter.getContentOffsetLeft();return{contentLeft:t+i,contentRight:t+i+n,rootLeft:t,rootRight:t+e}},t}(u.K),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.attachTo=function(e){return new t(e)},t.prototype.initialize=function(e,t){void 0===e&&(e=function(e,t){return new g.F(e,t)}),void 0===t&&(t=function(e){return new k(e)}),this.id=this.root.id;var n=this.root.querySelector(P.strings.RIPPLE_SELECTOR),i=(0,r.pi)((0,r.pi)({},g.F.createAdapter(this)),{addClass:function(e){return n.classList.add(e)},removeClass:function(e){return n.classList.remove(e)},updateCssVariable:function(e,t){return n.style.setProperty(e,t)}}),a=new y.l(i);this.ripple_=e(this.root,a);var s=this.root.querySelector(P.strings.TAB_INDICATOR_SELECTOR);this.tabIndicator_=t(s),this.content_=this.root.querySelector(P.strings.CONTENT_SELECTOR)},t.prototype.initialSyncWithDOM=function(){var e=this;this.handleClick_=function(){return e.foundation.handleClick()},this.listen("click",this.handleClick_)},t.prototype.destroy=function(){this.unlisten("click",this.handleClick_),this.ripple_.destroy(),e.prototype.destroy.call(this)},t.prototype.getDefaultFoundation=function(){var e=this;return new P({setAttr:function(t,n){return e.root.setAttribute(t,n)},addClass:function(t){return e.root.classList.add(t)},removeClass:function(t){return e.root.classList.remove(t)},hasClass:function(t){return e.root.classList.contains(t)},activateIndicator:function(t){return e.tabIndicator_.activate(t)},deactivateIndicator:function(){return e.tabIndicator_.deactivate()},notifyInteracted:function(){return e.emit(P.strings.INTERACTED_EVENT,{tabId:e.id},!0)},getOffsetLeft:function(){return e.root.offsetLeft},getOffsetWidth:function(){return e.root.offsetWidth},getContentOffsetLeft:function(){return e.content_.offsetLeft},getContentOffsetWidth:function(){return e.content_.offsetWidth},focus:function(){return e.root.focus()}})},Object.defineProperty(t.prototype,"active",{get:function(){return this.foundation.isActive()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusOnActivate",{set:function(e){this.foundation.setFocusOnActivate(e)},enumerable:!0,configurable:!0}),t.prototype.activate=function(e){this.foundation.activate(e)},t.prototype.deactivate=function(){this.foundation.deactivate()},t.prototype.computeIndicatorClientRect=function(){return this.tabIndicator_.computeContentClientRect()},t.prototype.computeDimensions=function(){return this.foundation.computeDimensions()},t.prototype.focus=function(){this.root.focus()},t}(a.B),C={ARROW_LEFT_KEY:"ArrowLeft",ARROW_RIGHT_KEY:"ArrowRight",END_KEY:"End",ENTER_KEY:"Enter",HOME_KEY:"Home",SPACE_KEY:"Space",TAB_ACTIVATED_EVENT:"MDCTabBar:activated",TAB_SCROLLER_SELECTOR:".mdc-tab-scroller",TAB_SELECTOR:".mdc-tab"},I={ARROW_LEFT_KEYCODE:37,ARROW_RIGHT_KEYCODE:39,END_KEYCODE:35,ENTER_KEYCODE:13,EXTRA_SCROLL_AMOUNT:20,HOME_KEYCODE:36,SPACE_KEYCODE:32},A=new Set;A.add(C.ARROW_LEFT_KEY),A.add(C.ARROW_RIGHT_KEY),A.add(C.END_KEY),A.add(C.HOME_KEY),A.add(C.ENTER_KEY),A.add(C.SPACE_KEY);var L=new Map;L.set(I.ARROW_LEFT_KEYCODE,C.ARROW_LEFT_KEY),L.set(I.ARROW_RIGHT_KEYCODE,C.ARROW_RIGHT_KEY),L.set(I.END_KEYCODE,C.END_KEY),L.set(I.HOME_KEYCODE,C.HOME_KEY),L.set(I.ENTER_KEYCODE,C.ENTER_KEY),L.set(I.SPACE_KEYCODE,C.SPACE_KEY);var O=function(e){function t(n){var i=e.call(this,(0,r.pi)((0,r.pi)({},t.defaultAdapter),n))||this;return i.useAutomaticActivation_=!1,i}return(0,r.ZT)(t,e),Object.defineProperty(t,"strings",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return I},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{scrollTo:function(){},incrementScroll:function(){},getScrollPosition:function(){return 0},getScrollContentWidth:function(){return 0},getOffsetWidth:function(){return 0},isRTL:function(){return!1},setActiveTab:function(){},activateTabAtIndex:function(){},deactivateTabAtIndex:function(){},focusTabAtIndex:function(){},getTabIndicatorClientRectAtIndex:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabDimensionsAtIndex:function(){return{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:function(){return-1},getFocusedTabIndex:function(){return-1},getIndexOfTabById:function(){return-1},getTabListLength:function(){return 0},notifyTabActivated:function(){}}},enumerable:!0,configurable:!0}),t.prototype.setUseAutomaticActivation=function(e){this.useAutomaticActivation_=e},t.prototype.activateTab=function(e){var t,n=this.adapter.getPreviousActiveTabIndex();this.indexIsInRange_(e)&&e!==n&&(-1!==n&&(this.adapter.deactivateTabAtIndex(n),t=this.adapter.getTabIndicatorClientRectAtIndex(n)),this.adapter.activateTabAtIndex(e,t),this.scrollIntoView(e),this.adapter.notifyTabActivated(e))},t.prototype.handleKeyDown=function(e){var t=this.getKeyFromEvent_(e);if(void 0!==t)if(this.isActivationKey_(t)||e.preventDefault(),this.useAutomaticActivation_){if(this.isActivationKey_(t))return;var n=this.determineTargetFromKey_(this.adapter.getPreviousActiveTabIndex(),t);this.adapter.setActiveTab(n),this.scrollIntoView(n)}else{var i=this.adapter.getFocusedTabIndex();this.isActivationKey_(t)?this.adapter.setActiveTab(i):(n=this.determineTargetFromKey_(i,t),this.adapter.focusTabAtIndex(n),this.scrollIntoView(n))}},t.prototype.handleTabInteraction=function(e){this.adapter.setActiveTab(this.adapter.getIndexOfTabById(e.detail.tabId))},t.prototype.scrollIntoView=function(e){if(this.indexIsInRange_(e))return 0===e?this.adapter.scrollTo(0):e===this.adapter.getTabListLength()-1?this.adapter.scrollTo(this.adapter.getScrollContentWidth()):this.isRTL_()?this.scrollIntoViewRTL_(e):void this.scrollIntoView_(e)},t.prototype.determineTargetFromKey_=function(e,t){var n=this.isRTL_(),i=this.adapter.getTabListLength()-1,r=t===C.END_KEY,a=t===C.ARROW_LEFT_KEY&&!n||t===C.ARROW_RIGHT_KEY&&n,s=t===C.ARROW_RIGHT_KEY&&!n||t===C.ARROW_LEFT_KEY&&n,o=e;return r?o=i:a?o-=1:s?o+=1:o=0,o<0?o=i:o>i&&(o=0),o},t.prototype.calculateScrollIncrement_=function(e,t,n,i){var r=this.adapter.getTabDimensionsAtIndex(t),a=r.contentLeft-n-i,s=r.contentRight-n-I.EXTRA_SCROLL_AMOUNT,o=a+I.EXTRA_SCROLL_AMOUNT;return t<e?Math.min(s,0):Math.max(o,0)},t.prototype.calculateScrollIncrementRTL_=function(e,t,n,i,r){var a=this.adapter.getTabDimensionsAtIndex(t),s=r-a.contentLeft-n,o=r-a.contentRight-n-i+I.EXTRA_SCROLL_AMOUNT,u=s-I.EXTRA_SCROLL_AMOUNT;return t>e?Math.max(o,0):Math.min(u,0)},t.prototype.findAdjacentTabIndexClosestToEdge_=function(e,t,n,i){var r=t.rootLeft-n,a=t.rootRight-n-i,s=r+a;return r<0||s<0?e-1:a>0||s>0?e+1:-1},t.prototype.findAdjacentTabIndexClosestToEdgeRTL_=function(e,t,n,i,r){var a=r-t.rootLeft-i-n,s=r-t.rootRight-n,o=a+s;return a>0||o>0?e+1:s<0||o<0?e-1:-1},t.prototype.getKeyFromEvent_=function(e){return A.has(e.key)?e.key:L.get(e.keyCode)},t.prototype.isActivationKey_=function(e){return e===C.SPACE_KEY||e===C.ENTER_KEY},t.prototype.indexIsInRange_=function(e){return e>=0&&e<this.adapter.getTabListLength()},t.prototype.isRTL_=function(){return this.adapter.isRTL()},t.prototype.scrollIntoView_=function(e){var t=this.adapter.getScrollPosition(),n=this.adapter.getOffsetWidth(),i=this.adapter.getTabDimensionsAtIndex(e),r=this.findAdjacentTabIndexClosestToEdge_(e,i,t,n);if(this.indexIsInRange_(r)){var a=this.calculateScrollIncrement_(e,r,t,n);this.adapter.incrementScroll(a)}},t.prototype.scrollIntoViewRTL_=function(e){var t=this.adapter.getScrollPosition(),n=this.adapter.getOffsetWidth(),i=this.adapter.getTabDimensionsAtIndex(e),r=this.adapter.getScrollContentWidth(),a=this.findAdjacentTabIndexClosestToEdgeRTL_(e,i,t,n,r);if(this.indexIsInRange_(a)){var s=this.calculateScrollIncrementRTL_(e,a,t,n,r);this.adapter.incrementScroll(s)}},t}(u.K),R=O.strings,N=0,B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.attachTo=function(e){return new t(e)},Object.defineProperty(t.prototype,"focusOnActivate",{set:function(e){this.tabList_.forEach((function(t){return t.focusOnActivate=e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useAutomaticActivation",{set:function(e){this.foundation.setUseAutomaticActivation(e)},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e,t){void 0===e&&(e=function(e){return new T(e)}),void 0===t&&(t=function(e){return new v(e)}),this.tabList_=this.instantiateTabs_(e),this.tabScroller_=this.instantiateTabScroller_(t)},t.prototype.initialSyncWithDOM=function(){var e=this;this.handleTabInteraction_=function(t){return e.foundation.handleTabInteraction(t)},this.handleKeyDown_=function(t){return e.foundation.handleKeyDown(t)},this.listen(P.strings.INTERACTED_EVENT,this.handleTabInteraction_),this.listen("keydown",this.handleKeyDown_);for(var t=0;t<this.tabList_.length;t++)if(this.tabList_[t].active){this.scrollIntoView(t);break}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.unlisten(P.strings.INTERACTED_EVENT,this.handleTabInteraction_),this.unlisten("keydown",this.handleKeyDown_),this.tabList_.forEach((function(e){return e.destroy()})),this.tabScroller_&&this.tabScroller_.destroy()},t.prototype.getDefaultFoundation=function(){var e=this;return new O({scrollTo:function(t){return e.tabScroller_.scrollTo(t)},incrementScroll:function(t){return e.tabScroller_.incrementScroll(t)},getScrollPosition:function(){return e.tabScroller_.getScrollPosition()},getScrollContentWidth:function(){return e.tabScroller_.getScrollContentWidth()},getOffsetWidth:function(){return e.root.offsetWidth},isRTL:function(){return"rtl"===window.getComputedStyle(e.root).getPropertyValue("direction")},setActiveTab:function(t){return e.foundation.activateTab(t)},activateTabAtIndex:function(t,n){return e.tabList_[t].activate(n)},deactivateTabAtIndex:function(t){return e.tabList_[t].deactivate()},focusTabAtIndex:function(t){return e.tabList_[t].focus()},getTabIndicatorClientRectAtIndex:function(t){return e.tabList_[t].computeIndicatorClientRect()},getTabDimensionsAtIndex:function(t){return e.tabList_[t].computeDimensions()},getPreviousActiveTabIndex:function(){for(var t=0;t<e.tabList_.length;t++)if(e.tabList_[t].active)return t;return-1},getFocusedTabIndex:function(){var t=e.getTabElements_(),n=document.activeElement;return t.indexOf(n)},getIndexOfTabById:function(t){for(var n=0;n<e.tabList_.length;n++)if(e.tabList_[n].id===t)return n;return-1},getTabListLength:function(){return e.tabList_.length},notifyTabActivated:function(t){return e.emit(R.TAB_ACTIVATED_EVENT,{index:t},!0)}})},t.prototype.activateTab=function(e){this.foundation.activateTab(e)},t.prototype.scrollIntoView=function(e){this.foundation.scrollIntoView(e)},t.prototype.getTabElements_=function(){return[].slice.call(this.root.querySelectorAll(R.TAB_SELECTOR))},t.prototype.instantiateTabs_=function(e){return this.getTabElements_().map((function(t){return t.id=t.id||"mdc-tab-"+ ++N,e(t)}))},t.prototype.instantiateTabScroller_=function(e){var t=this.root.querySelector(R.TAB_SCROLLER_SELECTOR);return t?e(t):null},t}(a.B)},7729:function(e){e.exports=function(e){var r=e.createGain(),a=r._voltage=function(e){var t=e.createBufferSource(),i=e.createBuffer(1,2,e.sampleRate);return i.getChannelData(0).set(n),t.buffer=i,t.loop=!0,t}(e),s=i(a),o=i(a),u=i(a);return r._startAmount=i(o),r._endAmount=i(u),r._multiplier=i(s),r._multiplier.connect(r),r._startAmount.connect(r),r._endAmount.connect(r),r.value=s.gain,r.startValue=o.gain,r.endValue=u.gain,r.startValue.value=0,r.endValue.value=0,Object.defineProperties(r,t),r};var t={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,i=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var a=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),i.cancelScheduledValues(e),i.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(a,this._decayFrom,r(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var i=this._multiplier.gain,a=this._startAmount.gain,s=this._endAmount.gain;i.cancelScheduledValues(e),a.cancelScheduledValues(e),s.cancelScheduledValues(e);var o=r(this.release);if(this.attack&&e<this._decayFrom){var u=function(e,t,n,i,r){var a=0+(r-n)/(i-n)*1;return a<=0&&(a=0),a>=1&&(a=1),a}(0,0,this._startedAt,this._decayFrom,e);i.linearRampToValueAtTime(u,e),a.linearRampToValueAtTime(1-u,e),a.setTargetAtTime(0,e,o)}s.setTargetAtTime(1,e,o),i.setTargetAtTime(0,e,o)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},n=new Float32Array([1,1]);function i(e){var t=e.context.createGain();return e.connect(t),t}function r(e){return Math.log(e+1)/Math.log(100)}},4158:function(e){"use strict";e.exports={decode:function(e,t){for(var n,i,r,a=e.replace(/[^A-Za-z0-9\+\/]/g,""),s=a.length,o=t?Math.ceil((3*s+1>>2)/t)*t:3*s+1>>2,u=new Uint8Array(o),l=0,c=0,h=0;h<s;h++)if(i=3&h,l|=((r=a.charCodeAt(h))>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:43===r?62:47===r?63:0)<<18-6*i,3===i||s-h==1){for(n=0;n<3&&c<o;n++,c++)u[c]=l>>>(16>>>n&24)&255;l=0}return u}}},9799:function(e){"use strict";e.exports=function(e,t){return new Promise((function(n,i){var r=new XMLHttpRequest;t&&(r.responseType=t),r.open("GET",e),r.onload=function(){200===r.status?n(r.response):i(Error(r.statusText))},r.onerror=function(){i(Error("Network Error"))},r.send()}))}},7665:function(e,t,n){"use strict";var i=n(4158),r=n(9799);function a(e){return function(t){return"string"==typeof t&&e.test(t)}}function s(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function o(e,t,n,i){var r,a=t instanceof ArrayBuffer?u:l(t)?c:(r=t)&&"function"==typeof r.then?h:d(t)?f:function(e){return e&&"object"==typeof e}(t)?p:m(t)?v:g(t)?y:b(t)?S:null;return a?a(e,t,n||{}):i?Promise.resolve(i):Promise.reject("Source not valid ("+t+")")}function u(e,t,n){return new Promise((function(n,i){e.decodeAudioData(t,(function(e){n(e)}),(function(){i("Can't decode audio data ("+t.slice(0,30)+"...)")}))}))}o.fetch=r;var l=a(/\.(mp3|wav|ogg)(\?.*)?$/i);function c(e,t,n){var i=s(n.from,t);return o(e,o.fetch(i,"arraybuffer"),n)}function h(e,t,n){return t.then((function(t){return o(e,t,n)}))}var d=Array.isArray;function f(e,t,n){return Promise.all(t.map((function(t){return o(e,t,n,t)})))}function p(e,t,n){var i={},r=Object.keys(t).map((function(r){if(n.only&&-1===n.only.indexOf(r))return null;var a=t[r];return o(e,a,n,a).then((function(e){i[r]=e}))}));return Promise.all(r).then((function(){return i}))}var m=a(/\.json(\?.*)?$/i);function v(e,t,n){var i=s(n.from,t);return o(e,o.fetch(i,"text").then(JSON.parse),n)}var g=a(/^data:audio/);function y(e,t,n){var r=t.indexOf(",");return o(e,i.decode(t.slice(r+1)).buffer,n)}var b=a(/\.js(\?.*)?$/i);function S(e,t,n){var i=s(n.from,t);return o(e,o.fetch(i,"text").then(x),n)}function x(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=o),"undefined"!=typeof window&&(window.loadAudio=o)},5382:function(e,t,n){!function(e,t,n,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=r(t),s=r(n),o=r(i),u=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},l=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},c=function(e,t){return{startTime:t,type:"setValue",value:e}},h=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},d=function(e,t,n){var i=n.startTime,r=n.target,a=n.timeConstant;return r+(t-r)*Math.exp((i-e)/a)},f=function(e){return"exponentialRampToValue"===e.type},p=function(e){return"linearRampToValue"===e.type},m=function(e){return f(e)||p(e)},v=function(e){return"setValue"===e.type},g=function(e){return"setValueCurve"===e.type},y=function e(t,n,i,r){var a=t[n];return void 0===a?r:m(a)||v(a)?a.value:g(a)?a.values[a.values.length-1]:d(i,e(t,n-1,a.startTime,r),a)},b=function(e,t,n,i,r){return void 0===n?[i.insertTime,r]:m(n)?[n.endTime,n.value]:v(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(e,t-1,n.startTime,r)]},S=function(e){return"cancelAndHold"===e.type},x=function(e){return"cancelScheduledValues"===e.type},_=function(e){return S(e)||x(e)?e.cancelTime:f(e)||p(e)?e.endTime:e.startTime},E=function(e,t,n,i){var r=i.endTime,a=i.value;return n===a?a:0<n&&0<a||n<0&&a<0?n*Math.pow(a/n,(e-t)/(r-t)):0},k=function(e,t,n,i){return n+(e-t)/(i.endTime-t)*(i.value-n)},M=function(e,t){var n=t.duration,i=t.startTime,r=t.values;return function(e,t){var n=Math.floor(t),i=Math.ceil(t);return n===i?e[n]:(1-(t-n))*e[n]+(1-(i-t))*e[i]}(r,(e-i)/n*(r.length-1))},w=function(e){return"setTarget"===e.type},P=function(e){function t(e){s.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return o.default(t,[{key:e,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=_(e);if(S(e)||x(e)){var n=this._automationEvents.findIndex((function(n){return x(e)&&g(n)?n.startTime+n.duration>=t:_(n)>=t})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),S(e)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&m(i)){if(w(r))throw new Error("The internal list is malformed.");var a=g(r)?r.startTime+r.duration:_(r),s=g(r)?r.values[r.values.length-1]:r.value,o=f(i)?E(t,a,s,i):k(t,a,s,i),d=f(i)?u(o,t,this._currenTime):l(o,t,this._currenTime);this._automationEvents.push(d)}void 0!==r&&w(r)&&this._automationEvents.push(c(this.getValue(t),t)),void 0!==r&&g(r)&&r.startTime+r.duration>t&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),r.startTime,t-r.startTime))}}else{var v=this._automationEvents.findIndex((function(e){return _(e)>t})),y=-1===v?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[v-1];if(void 0!==y&&g(y)&&_(y)+y.duration>t)return!1;var b=f(e)?u(e.value,e.endTime,this._currenTime):p(e)?l(e.value,t,this._currenTime):e;if(-1===v)this._automationEvents.push(b);else{if(g(e)&&t+e.duration>_(this._automationEvents[v]))return!1;this._automationEvents.splice(v,0,b)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return _(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),i=n[0];w(i)&&n.unshift(c(y(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents.findIndex((function(t){return _(t)>e})),n=this._automationEvents[t],i=(-1===t?this._automationEvents.length:t)-1,r=this._automationEvents[i];if(void 0!==r&&w(r)&&(void 0===n||!m(n)||n.insertTime>e))return d(e,y(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&v(r)&&(void 0===n||!m(n)))return r.value;if(void 0!==r&&g(r)&&(void 0===n||!m(n)||r.startTime+r.duration>e))return e<r.startTime+r.duration?M(e,r):r.values[r.values.length-1];if(void 0!==r&&m(r)&&(void 0===n||!m(n)))return r.value;if(void 0!==n&&f(n)){var s=b(this._automationEvents,i,r,n,this._defaultValue),o=a.default(s,2),u=o[0],l=o[1];return E(e,u,l,n)}if(void 0!==n&&p(n)){var c=b(this._automationEvents,i,r,n,this._defaultValue),h=a.default(c,2),S=h[0],x=h[1];return k(e,S,x,n)}return this._defaultValue}}]),t}(Symbol.iterator);e.AutomationEventList=P,e.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},e.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},e.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},e.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},e.createSetTargetAutomationEvent=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}},e.createSetValueAutomationEvent=c,e.createSetValueCurveAutomationEvent=h,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(7424),n(6690),n(9728))},8011:function(e,t){var n,i;void 0===(i="function"==typeof(n=function(){"use strict";return function(e){for(var t={command:/\s*([achlmqstvz])/gi,number:/\s*([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/gi,comma:/\s*(?:(,)|\s)/g,flag:/\s*([01])/g},n={number:function(e){return+c("number",e)},"coordinate pair":function(e){var t=c("number",e);return null!==t||e?(c("comma"),{x:+t,y:+c("number",!0)}):null},"arc definition":function(e){var t=n["coordinate pair"](e);if(!t&&!e)return null;c("comma");var i=+c("number",!0);c("comma",!0);var r=!!+c("flag",!0);c("comma");var a=!!+c("flag",!0);return c("comma"),{radii:t,rotation:i,large:r,clockwise:a,end:n["coordinate pair"](!0)}}},i=0,r=[];i<e.length;){var a,s=c("command"),o=s.toUpperCase(),u=s!==o;switch(o){case"M":a=h("coordinate pair").map((function(e,t){return 1===t&&(s=u?"l":"L"),l({end:e})}));break;case"L":case"T":a=h("coordinate pair").map((function(e){return l({end:e})}));break;case"C":if((a=h("coordinate pair")).length%3)throw Error("Expected coordinate pair triplet at position "+i);a=a.reduce((function(e,t,n){var i=n%3;return i?e[e.length-1][1===i?"cp2":"end"]=t:e.push(l({cp1:t})),e}),[]);break;case"Q":case"S":if(1&(a=h("coordinate pair")).length)throw Error("Expected coordinate pair couple at position "+i);a=a.reduce((function(e,t,n){return 1&n?e[e.length-1].end=t:e.push(l({cp:t})),e}),[]);break;case"H":case"V":a=h("number").map((function(e){return l({value:e})}));break;case"A":a=h("arc definition").map(l);break;case"Z":a=[{code:"Z"}]}r.push.apply(r,a)}return r;function l(e){return e.code=s,e.relative=u,e}function c(n,r){t[n].lastIndex=i;var a=t[n].exec(e);if(!a||a.index!==i){if(!r)return null;throw Error("Expected "+n+" at position "+i)}return i=t[n].lastIndex,a[1]}function h(e){for(var t,i=[],r=!0;t=n[e](r);)i.push(t),r=!!c("comma");return i}}})?n.apply(t,[]):n)||(e.exports=i)},177:function(e){e.exports=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(){var e=d();return e.compile=function(t,n){return u.compile(t,n,e)},e.precompile=function(t,n){return u.precompile(t,n,e)},e.AST=s.default,e.Compiler=u.Compiler,e.JavaScriptCompiler=l.default,e.Parser=o.parser,e.parse=o.parse,e.parseWithoutProcessing=o.parseWithoutProcessing,e}var r=n(1).default;t.__esModule=!0;var a=r(n(2)),s=r(n(45)),o=n(46),u=n(51),l=r(n(52)),c=r(n(49)),h=r(n(44)),d=a.default.create,f=i();f.create=i,h.default(f),f.Visitor=c.default,f.default=f,t.default=f,e.exports=t.default},function(e,t){"use strict";t.default=function(e){return e&&e.__esModule?e:{default:e}},t.__esModule=!0},function(e,t,n){"use strict";function i(){var e=new s.HandlebarsEnvironment;return l.extend(e,s),e.SafeString=o.default,e.Exception=u.default,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=c,e.template=function(t){return c.template(t,e)},e}var r=n(3).default,a=n(1).default;t.__esModule=!0;var s=r(n(4)),o=a(n(37)),u=a(n(6)),l=r(n(5)),c=r(n(38)),h=a(n(44)),d=i();d.create=i,h.default(d),d.default=d,t.default=d,e.exports=t.default},function(e,t){"use strict";t.default=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},t.__esModule=!0},function(e,t,n){"use strict";function i(e,t,n){this.helpers=e||{},this.partials=t||{},this.decorators=n||{},o.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}var r=n(1).default;t.__esModule=!0,t.HandlebarsEnvironment=i;var a=n(5),s=r(n(6)),o=n(10),u=n(30),l=r(n(32)),c=n(33);t.VERSION="4.7.7",t.COMPILER_REVISION=8,t.LAST_COMPATIBLE_COMPILER_REVISION=7,t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var h="[object Object]";i.prototype={constructor:i,logger:l.default,log:l.default.log,registerHelper:function(e,t){if(a.toString.call(e)===h){if(t)throw new s.default("Arg not supported with multiple helpers");a.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(a.toString.call(e)===h)a.extend(this.partials,e);else{if(void 0===t)throw new s.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(a.toString.call(e)===h){if(t)throw new s.default("Arg not supported with multiple decorators");a.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){c.resetLoggedProperties()}};var d=l.default.log;t.log=d,t.createFrame=a.createFrame,t.logger=l.default},function(e,t){"use strict";function n(e){return r[e]}function i(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}t.__esModule=!0,t.extend=i,t.indexOf=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return s.test(e)?e.replace(a,n):e},t.isEmpty=function(e){return!e&&0!==e||!(!l(e)||0!==e.length)},t.createFrame=function(e){var t=i({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},a=/[&<>"'`=]/g,s=/[&<>"'`=]/,o=Object.prototype.toString;t.toString=o;var u=function(e){return"function"==typeof e};u(/x/)&&(t.isFunction=u=function(e){return"function"==typeof e&&"[object Function]"===o.call(e)}),t.isFunction=u;var l=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===o.call(e)};t.isArray=l},function(e,t,n){"use strict";function i(e,t){var n=t&&t.loc,s=void 0,o=void 0,u=void 0,l=void 0;n&&(s=n.start.line,o=n.end.line,u=n.start.column,l=n.end.column,e+=" - "+s+":"+u);for(var c=Error.prototype.constructor.call(this,e),h=0;h<a.length;h++)this[a[h]]=c[a[h]];Error.captureStackTrace&&Error.captureStackTrace(this,i);try{n&&(this.lineNumber=s,this.endLineNumber=o,r?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:l,enumerable:!0})):(this.column=u,this.endColumn=l))}catch(e){}}var r=n(7).default;t.__esModule=!0;var a=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];i.prototype=new Error,t.default=i,e.exports=t.default},function(e,t,n){e.exports={default:n(8),__esModule:!0}},function(e,t,n){var i=n(9);e.exports=function(e,t,n){return i.setDesc(e,t,n)}},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){"use strict";var i=n(1).default;t.__esModule=!0,t.registerDefaultHelpers=function(e){r.default(e),a.default(e),s.default(e),o.default(e),u.default(e),l.default(e),c.default(e)},t.moveHelperToHooks=function(e,t,n){e.helpers[t]&&(e.hooks[t]=e.helpers[t],n||delete e.helpers[t])};var r=i(n(11)),a=i(n(12)),s=i(n(25)),o=i(n(26)),u=i(n(27)),l=i(n(28)),c=i(n(29))},function(e,t,n){"use strict";t.__esModule=!0;var i=n(5);t.default=function(e){e.registerHelper("blockHelperMissing",(function(t,n){var r=n.inverse,a=n.fn;if(!0===t)return a(this);if(!1===t||null==t)return r(this);if(i.isArray(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):r(this);if(n.data&&n.ids){var s=i.createFrame(n.data);s.contextPath=i.appendContextPath(n.data.contextPath,n.name),n={data:s}}return a(t,n)}))},e.exports=t.default},function(e,t,n){(function(i){"use strict";var r=n(13).default,a=n(1).default;t.__esModule=!0;var s=n(5),o=a(n(6));t.default=function(e){e.registerHelper("each",(function(e,t){function n(t,n,i){h&&(h.key=t,h.index=n,h.first=0===n,h.last=!!i,d&&(h.contextPath=d+t)),c+=a(e[t],{data:h,blockParams:s.blockParams([e[t],t],[d+t,null])})}if(!t)throw new o.default("Must pass iterator to #each");var a=t.fn,u=t.inverse,l=0,c="",h=void 0,d=void 0;if(t.data&&t.ids&&(d=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),s.isFunction(e)&&(e=e.call(this)),t.data&&(h=s.createFrame(t.data)),e&&"object"==typeof e)if(s.isArray(e))for(var f=e.length;l<f;l++)l in e&&n(l,l,l===e.length-1);else if(i.Symbol&&e[i.Symbol.iterator]){for(var p=[],m=e[i.Symbol.iterator](),v=m.next();!v.done;v=m.next())p.push(v.value);for(f=(e=p).length;l<f;l++)n(l,l,l===e.length-1)}else!function(){var t=void 0;r(e).forEach((function(e){void 0!==t&&n(t,l-1),t=e,l++})),void 0!==t&&n(t,l-1,!0)}();return 0===l&&(c=u(this)),c}))},e.exports=t.default}).call(t,function(){return this}())},function(e,t,n){e.exports={default:n(14),__esModule:!0}},function(e,t,n){n(15),e.exports=n(21).Object.keys},function(e,t,n){var i=n(16);n(18)("keys",(function(e){return function(t){return e(i(t))}}))},function(e,t,n){var i=n(17);e.exports=function(e){return Object(i(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(19),r=n(21),a=n(24);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],s={};s[e]=t(n),i(i.S+i.F*a((function(){n(1)})),"Object",s)}},function(e,t,n){var i=n(20),r=n(21),a=n(22),s="prototype",o=function e(t,n,o){var u,l,c,h=t&e.F,d=t&e.G,f=t&e.S,p=t&e.P,m=t&e.B,v=t&e.W,g=d?r:r[n]||(r[n]={}),y=d?i:f?i[n]:(i[n]||{})[s];for(u in d&&(o=n),o)(l=!h&&y&&u in y)&&u in g||(c=l?y[u]:o[u],g[u]=d&&"function"!=typeof y[u]?o[u]:m&&l?a(c,i):v&&y[u]==c?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[s]=e[s],t}(c):p&&"function"==typeof c?a(Function.call,c):c,p&&((g[s]||(g[s]={}))[u]=c))};o.F=1,o.G=2,o.S=4,o.P=8,o.B=16,o.W=32,e.exports=o},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(23);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var i=n(1).default;t.__esModule=!0;var r=i(n(6));t.default=function(e){e.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new r.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},e.exports=t.default},function(e,t,n){"use strict";var i=n(1).default;t.__esModule=!0;var r=n(5),a=i(n(6));t.default=function(e){e.registerHelper("if",(function(e,t){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return r.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)})),e.registerHelper("unless",(function(t,n){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return e.helpers.if.call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}))},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("log",(function(){for(var t=[void 0],n=arguments[arguments.length-1],i=0;i<arguments.length-1;i++)t.push(arguments[i]);var r=1;null!=n.hash.level?r=n.hash.level:n.data&&null!=n.data.level&&(r=n.data.level),t[0]=r,e.log.apply(e,t)}))},e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",(function(e,t,n){return e?n.lookupProperty(e,t):e}))},e.exports=t.default},function(e,t,n){"use strict";var i=n(1).default;t.__esModule=!0;var r=n(5),a=i(n(6));t.default=function(e){e.registerHelper("with",(function(e,t){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");r.isFunction(e)&&(e=e.call(this));var n=t.fn;if(r.isEmpty(e))return t.inverse(this);var i=t.data;return t.data&&t.ids&&((i=r.createFrame(t.data)).contextPath=r.appendContextPath(t.data.contextPath,t.ids[0])),n(e,{data:i,blockParams:r.blockParams([e],[i&&i.contextPath])})}))},e.exports=t.default},function(e,t,n){"use strict";var i=n(1).default;t.__esModule=!0,t.registerDefaultDecorators=function(e){r.default(e)};var r=i(n(31))},function(e,t,n){"use strict";t.__esModule=!0;var i=n(5);t.default=function(e){e.registerDecorator("inline",(function(e,t,n,r){var a=e;return t.partials||(t.partials={},a=function(r,a){var s=n.partials;n.partials=i.extend({},s,t.partials);var o=e(r,a);return n.partials=s,o}),t.partials[r.args[0]]=r.fn,a}))},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i=n(5),r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=i.indexOf(r.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=r.lookupLevel(e),"undefined"!=typeof console&&r.lookupLevel(r.level)<=e){var t=r.methodMap[e];console[t]||(t="log");for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];console[t].apply(console,i)}}};t.default=r,e.exports=t.default},function(e,t,n){"use strict";var i=n(34).default,r=n(13).default,a=n(3).default;t.__esModule=!0,t.createProtoAccessControl=function(e){var t=i(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var n=i(null);return n.__proto__=!1,{properties:{whitelist:s.createNewLookupObject(n,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:s.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},t.resultIsAllowed=function(e,t,n){return function(e,t){return void 0!==e.whitelist[t]?!0===e.whitelist[t]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==u[e]&&(u[e]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(t),!1)}("function"==typeof e?t.methods:t.properties,n)},t.resetLoggedProperties=function(){r(u).forEach((function(e){delete u[e]}))};var s=n(36),o=a(n(32)),u=i(null)},function(e,t,n){e.exports={default:n(35),__esModule:!0}},function(e,t,n){var i=n(9);e.exports=function(e,t){return i.create(e,t)}},function(e,t,n){"use strict";var i=n(34).default;t.__esModule=!0,t.createNewLookupObject=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.extend.apply(void 0,[i(null)].concat(t))};var r=n(5)},function(e,t){"use strict";function n(e){this.string=e}t.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t.default=n,e.exports=t.default},function(e,t,n){"use strict";function i(e,t,n,i,r,a,o){function u(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o;return!o||t==o[0]||t===e.nullContext&&null===o[0]||(s=[t].concat(o)),n(e,t,e.helpers,e.partials,r.data||i,a&&[r.blockParams].concat(a),s)}return(u=s(n,u,e,o,i,a)).program=t,u.depth=o?o.length:0,u.blockParams=r||0,u}function r(){return""}function a(e,t){return t&&"root"in t||((t=t?f.createFrame(t):{}).root=e),t}function s(e,t,n,i,r,a){if(e.decorator){var s={};t=e.decorator(t,s,n,i&&i[0],r,a,i),h.extend(t,s)}return t}var o=n(39).default,u=n(13).default,l=n(3).default,c=n(1).default;t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,n=f.COMPILER_REVISION;if(!(t>=f.LAST_COMPATIBLE_COMPILER_REVISION&&t<=f.COMPILER_REVISION)){if(t<f.LAST_COMPATIBLE_COMPILER_REVISION){var i=f.REVISION_CHANGES[n],r=f.REVISION_CHANGES[t];throw new d.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+r+").")}throw new d.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},t.template=function(e,t){function n(t){function i(t){return""+e.main(l,t,l.helpers,l.partials,o,c,u)}var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.data;n._setup(r),!r.partial&&e.useData&&(o=a(t,o));var u=void 0,c=e.useBlockParams?[]:void 0;return e.useDepths&&(u=r.depths?t!=r.depths[0]?[t].concat(r.depths):r.depths:[t]),(i=s(e.main,i,l,r.depths||[],o,c))(t,r)}if(!t)throw new d.default("No environment passed to template");if(!e||!e.main)throw new d.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var r=e.compiler&&7===e.compiler[0],l={strict:function(e,t,n){if(!e||!(t in e))throw new d.default('"'+t+'" not defined in '+e,{loc:n});return l.lookupProperty(e,t)},lookupProperty:function(e,t){var n=e[t];return null==n||Object.prototype.hasOwnProperty.call(e,t)||v.resultIsAllowed(n,l.protoAccessControl,t)?n:void 0},lookup:function(e,t){for(var n=e.length,i=0;i<n;i++)if(null!=(e[i]&&l.lookupProperty(e[i],t)))return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:function(n,i,r){r.hash&&(i=h.extend({},i,r.hash),r.ids&&(r.ids[0]=!0)),n=t.VM.resolvePartial.call(this,n,i,r);var a=h.extend({},r,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=t.VM.invokePartial.call(this,n,i,a);if(null==s&&t.compile&&(r.partials[r.name]=t.compile(n,e.compilerOptions,t),s=r.partials[r.name](i,a)),null!=s){if(r.indent){for(var o=s.split("\n"),u=0,l=o.length;u<l&&(o[u]||u+1!==l);u++)o[u]=r.indent+o[u];s=o.join("\n")}return s}throw new d.default("The partial "+r.name+" could not be compiled when running in runtime-only mode")},fn:function(t){var n=e[t];return n.decorator=e[t+"_d"],n},programs:[],program:function(e,t,n,r,a){var s=this.programs[e],o=this.fn(e);return t||a||r||n?s=i(this,e,o,t,n,r,a):s||(s=this.programs[e]=i(this,e,o)),s},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=h.extend({},t,e)),n},nullContext:o({}),noop:t.VM.noop,compilerInfo:e.compiler};return n.isTop=!0,n._setup=function(n){if(n.partial)l.protoAccessControl=n.protoAccessControl,l.helpers=n.helpers,l.partials=n.partials,l.decorators=n.decorators,l.hooks=n.hooks;else{var i=h.extend({},t.helpers,n.helpers);(function(e,t){u(e).forEach((function(n){var i=e[n];e[n]=function(e,t){var n=t.lookupProperty;return m.wrapHelper(e,(function(e){return h.extend({lookupProperty:n},e)}))}(i,t)}))})(i,l),l.helpers=i,e.usePartial&&(l.partials=l.mergeIfNeeded(n.partials,t.partials)),(e.usePartial||e.useDecorators)&&(l.decorators=h.extend({},t.decorators,n.decorators)),l.hooks={},l.protoAccessControl=v.createProtoAccessControl(n);var a=n.allowCallsToHelperMissing||r;p.moveHelperToHooks(l,"helperMissing",a),p.moveHelperToHooks(l,"blockHelperMissing",a)}},n._child=function(t,n,r,a){if(e.useBlockParams&&!r)throw new d.default("must pass block params");if(e.useDepths&&!a)throw new d.default("must pass parent depths");return i(l,t,e[t],n,0,r,a)},n},t.wrapProgram=i,t.resolvePartial=function(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name],e},t.invokePartial=function(e,t,n){var i=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var a=void 0;if(n.fn&&n.fn!==r&&function(){n.data=f.createFrame(n.data);var e=n.fn;a=n.data["partial-block"]=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return n.data=f.createFrame(n.data),n.data["partial-block"]=i,e(t,n)},e.partials&&(n.partials=h.extend({},n.partials,e.partials))}(),void 0===e&&a&&(e=a),void 0===e)throw new d.default("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)},t.noop=r;var h=l(n(5)),d=c(n(6)),f=n(4),p=n(10),m=n(43),v=n(33)},function(e,t,n){e.exports={default:n(40),__esModule:!0}},function(e,t,n){n(41),e.exports=n(21).Object.seal},function(e,t,n){var i=n(42);n(18)("seal",(function(e){return function(t){return e&&i(t)?e(t):t}}))},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){"use strict";t.__esModule=!0,t.wrapHelper=function(e,t){return"function"!=typeof e?e:function(){return arguments[arguments.length-1]=t(arguments[arguments.length-1]),e.apply(this,arguments)}}},function(e,t){(function(n){"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==n?n:window,i=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=i),e}},e.exports=t.default}).call(t,function(){return this}())},function(e,t){"use strict";t.__esModule=!0;var n={helpers:{helperExpression:function(e){return"SubExpression"===e.type||("MustacheStatement"===e.type||"BlockStatement"===e.type)&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!n.helpers.scopedId(e)&&!e.depth}}};t.default=n,e.exports=t.default},function(e,t,n){"use strict";function i(e,t){return"Program"===e.type?e:(s.default.yy=c,c.locInfo=function(e){return new c.SourceLocation(t&&t.srcName,e)},s.default.parse(e))}var r=n(1).default,a=n(3).default;t.__esModule=!0,t.parseWithoutProcessing=i,t.parse=function(e,t){var n=i(e,t);return new o.default(t).accept(n)};var s=r(n(47)),o=r(n(48)),u=a(n(50)),l=n(5);t.parser=s.default;var c={};l.extend(c,u)},function(e,t){"use strict";t.__esModule=!0;var n=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(e,t,n,i,r,a,s){var o=a.length-1;switch(r){case 1:return a[o-1];case 2:this.$=i.prepareProgram(a[o]);break;case 3:case 4:case 5:case 6:case 7:case 8:case 20:case 27:case 28:case 33:case 34:case 40:case 41:this.$=a[o];break;case 9:this.$={type:"CommentStatement",value:i.stripComment(a[o]),strip:i.stripFlags(a[o],a[o]),loc:i.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:a[o],value:a[o],loc:i.locInfo(this._$)};break;case 11:this.$=i.prepareRawBlock(a[o-2],a[o-1],a[o],this._$);break;case 12:this.$={path:a[o-3],params:a[o-2],hash:a[o-1]};break;case 13:this.$=i.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!1,this._$);break;case 14:this.$=i.prepareBlock(a[o-3],a[o-2],a[o-1],a[o],!0,this._$);break;case 15:this.$={open:a[o-5],path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:i.stripFlags(a[o-5],a[o])};break;case 16:case 17:this.$={path:a[o-4],params:a[o-3],hash:a[o-2],blockParams:a[o-1],strip:i.stripFlags(a[o-5],a[o])};break;case 18:this.$={strip:i.stripFlags(a[o-1],a[o-1]),program:a[o]};break;case 19:var u=i.prepareBlock(a[o-2],a[o-1],a[o],a[o],!1,this._$),l=i.prepareProgram([u],a[o-1].loc);l.chained=!0,this.$={strip:a[o-2].strip,program:l,chain:!0};break;case 21:this.$={path:a[o-1],strip:i.stripFlags(a[o-2],a[o])};break;case 22:case 23:this.$=i.prepareMustache(a[o-3],a[o-2],a[o-1],a[o-4],i.stripFlags(a[o-4],a[o]),this._$);break;case 24:this.$={type:"PartialStatement",name:a[o-3],params:a[o-2],hash:a[o-1],indent:"",strip:i.stripFlags(a[o-4],a[o]),loc:i.locInfo(this._$)};break;case 25:this.$=i.preparePartialBlock(a[o-2],a[o-1],a[o],this._$);break;case 26:this.$={path:a[o-3],params:a[o-2],hash:a[o-1],strip:i.stripFlags(a[o-4],a[o])};break;case 29:this.$={type:"SubExpression",path:a[o-3],params:a[o-2],hash:a[o-1],loc:i.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:a[o],loc:i.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:i.id(a[o-2]),value:a[o],loc:i.locInfo(this._$)};break;case 32:this.$=i.id(a[o-1]);break;case 35:this.$={type:"StringLiteral",value:a[o],original:a[o],loc:i.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(a[o]),original:Number(a[o]),loc:i.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===a[o],original:"true"===a[o],loc:i.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:i.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:i.locInfo(this._$)};break;case 42:this.$=i.preparePath(!0,a[o],this._$);break;case 43:this.$=i.preparePath(!1,a[o],this._$);break;case 44:a[o-2].push({part:i.id(a[o]),original:a[o],separator:a[o-1]}),this.$=a[o-2];break;case 45:this.$=[{part:i.id(a[o]),original:a[o]}];break;case 46:case 48:case 50:case 58:case 64:case 70:case 78:case 82:case 86:case 90:case 94:this.$=[];break;case 47:case 49:case 51:case 59:case 65:case 71:case 79:case 83:case 87:case 91:case 95:case 99:case 101:a[o-1].push(a[o]);break;case 98:case 100:this.$=[a[o]]}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(e,t){throw new Error(e)},parse:function(e){function t(){var e;return"number"!=typeof(e=n.lexer.lex()||1)&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],a=[],s=this.table,o="",u=0,l=0,c=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;a.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,p,m,v,g,y,b,S,x,_={};;){if(m=i[i.length-1],this.defaultActions[m]?v=this.defaultActions[m]:(null!=f||(f=t()),v=s[m]&&s[m][f]),void 0===v||!v.length||!v[0]){var E="";if(!c){for(y in x=[],s[m])this.terminals_[y]&&y>2&&x.push("'"+this.terminals_[y]+"'");E=this.lexer.showPosition?"Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(E,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:h,expected:x})}}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+f);switch(v[0]){case 1:i.push(f),r.push(this.lexer.yytext),a.push(this.lexer.yylloc),i.push(v[1]),f=null,p?(f=p,p=null):(l=this.lexer.yyleng,o=this.lexer.yytext,u=this.lexer.yylineno,h=this.lexer.yylloc,c>0&&c--);break;case 2:if(b=this.productions_[v[1]][1],_.$=r[r.length-b],_._$={first_line:a[a.length-(b||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(b||1)].first_column,last_column:a[a.length-1].last_column},d&&(_._$.range=[a[a.length-(b||1)].range[0],a[a.length-1].range[1]]),void 0!==(g=this.performAction.call(_,o,l,u,this.yy,v[1],r,a)))return g;b&&(i=i.slice(0,-1*b*2),r=r.slice(0,-1*b),a=a.slice(0,-1*b)),i.push(this.productions_[v[1]][0]),r.push(_.$),a.push(_._$),S=s[i[i.length-2]][i[i.length-1]],i.push(S);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t,n,i,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var a=this._currentRules(),s=0;s<a.length&&(!(n=this._input.match(this.rules[a[s]]))||t&&!(n[0].length>t[0].length)||(t=n,i=s,this.options.flex));s++);return t?((r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,a[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},options:{},performAction:function(e,t,n,i){function r(e,n){return t.yytext=t.yytext.substring(e,t.yyleng-n+e)}switch(n){case 0:if("\\\\"===t.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 15;break;case 1:case 5:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(r(5,9),"END_RAW_BLOCK");case 6:case 22:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:case 23:return 48;case 21:this.unput(t.yytext),this.popState(),this.begin("com");break;case 24:return 73;case 25:case 26:case 41:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return t.yytext=r(1,2).replace(/\\"/g,'"'),80;case 32:return t.yytext=r(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 42:return t.yytext=t.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}}};return e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();t.default=n,e.exports=t.default},function(e,t,n){"use strict";function i(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=e}function r(e,t,n){void 0===t&&(t=e.length);var i=e[t-1],r=e[t-2];return i?"ContentStatement"===i.type?(r||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original):void 0:n}function a(e,t,n){void 0===t&&(t=-1);var i=e[t+1],r=e[t+2];return i?"ContentStatement"===i.type?(r||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original):void 0:n}function s(e,t,n){var i=e[null==t?0:t+1];if(i&&"ContentStatement"===i.type&&(n||!i.rightStripped)){var r=i.value;i.value=i.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.value!==r}}function o(e,t,n){var i=e[null==t?e.length-1:t-1];if(i&&"ContentStatement"===i.type&&(n||!i.leftStripped)){var r=i.value;return i.value=i.value.replace(n?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.value!==r,i.leftStripped}}var u=n(1).default;t.__esModule=!0;var l=u(n(49));i.prototype=new l.default,i.prototype.Program=function(e){var t=!this.options.ignoreStandalone,n=!this.isRootSeen;this.isRootSeen=!0;for(var i=e.body,u=0,l=i.length;u<l;u++){var c=i[u],h=this.accept(c);if(h){var d=r(i,u,n),f=a(i,u,n),p=h.openStandalone&&d,m=h.closeStandalone&&f,v=h.inlineStandalone&&d&&f;h.close&&s(i,u,!0),h.open&&o(i,u,!0),t&&v&&(s(i,u),o(i,u)&&"PartialStatement"===c.type&&(c.indent=/([ \t]+$)/.exec(i[u-1].original)[1])),t&&p&&(s((c.program||c.inverse).body),o(i,u)),t&&m&&(s(i,u),o((c.inverse||c.program).body))}}return e},i.prototype.BlockStatement=i.prototype.DecoratorBlock=i.prototype.PartialBlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,n=e.program&&e.inverse,i=n,u=n;if(n&&n.chained)for(i=n.body[0].program;u.chained;)u=u.body[u.body.length-1].program;var l={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:a(t.body),closeStandalone:r((i||t).body)};if(e.openStrip.close&&s(t.body,null,!0),n){var c=e.inverseStrip;c.open&&o(t.body,null,!0),c.close&&s(i.body,null,!0),e.closeStrip.open&&o(u.body,null,!0),!this.options.ignoreStandalone&&r(t.body)&&a(i.body)&&(o(t.body),s(i.body))}else e.closeStrip.open&&o(t.body,null,!0);return l},i.prototype.Decorator=i.prototype.MustacheStatement=function(e){return e.strip},i.prototype.PartialStatement=i.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},t.default=i,e.exports=t.default},function(e,t,n){"use strict";function i(){this.parents=[]}function r(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")}function a(e){r.call(this,e),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")}function s(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")}var o=n(1).default;t.__esModule=!0;var u=o(n(6));i.prototype={constructor:i,mutating:!1,acceptKey:function(e,t){var n=this.accept(e[t]);if(this.mutating){if(n&&!i.prototype[n.type])throw new u.default('Unexpected node type "'+n.type+'" found when accepting '+t+" on "+e.type);e[t]=n}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new u.default(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,n=e.length;t<n;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,n--)},accept:function(e){if(e){if(!this[e.type])throw new u.default("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:!1!==t?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:r,Decorator:r,BlockStatement:a,DecoratorBlock:a,PartialStatement:s,PartialBlockStatement:function(e){s.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:r,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},t.default=i,e.exports=t.default},function(e,t,n){"use strict";function i(e,t){if(t=t.path?t.path.original:t,e.path.original!==t){var n={loc:e.path.loc};throw new a.default(e.path.original+" doesn't match "+t,n)}}var r=n(1).default;t.__esModule=!0,t.SourceLocation=function(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}},t.id=function(e){return/^\[.*\]$/.test(e)?e.substring(1,e.length-1):e},t.stripFlags=function(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}},t.stripComment=function(e){return e.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")},t.preparePath=function(e,t,n){n=this.locInfo(n);for(var i=e?"@":"",r=[],s=0,o=0,u=t.length;o<u;o++){var l=t[o].part,c=t[o].original!==l;if(i+=(t[o].separator||"")+l,c||".."!==l&&"."!==l&&"this"!==l)r.push(l);else{if(r.length>0)throw new a.default("Invalid path: "+i,{loc:n});".."===l&&s++}}return{type:"PathExpression",data:e,depth:s,parts:r,original:i,loc:n}},t.prepareMustache=function(e,t,n,i,r,a){var s=i.charAt(3)||i.charAt(2),o="{"!==s&&"&"!==s;return{type:/\*/.test(i)?"Decorator":"MustacheStatement",path:e,params:t,hash:n,escaped:o,strip:r,loc:this.locInfo(a)}},t.prepareRawBlock=function(e,t,n,r){i(e,n);var a={type:"Program",body:t,strip:{},loc:r=this.locInfo(r)};return{type:"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:a,openStrip:{},inverseStrip:{},closeStrip:{},loc:r}},t.prepareBlock=function(e,t,n,r,s,o){r&&r.path&&i(e,r);var u=/\*/.test(e.open);t.blockParams=e.blockParams;var l=void 0,c=void 0;if(n){if(u)throw new a.default("Unexpected inverse block on decorator",n);n.chain&&(n.program.body[0].closeStrip=r.strip),c=n.strip,l=n.program}return s&&(s=l,l=t,t=s),{type:u?"DecoratorBlock":"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:t,inverse:l,openStrip:e.strip,inverseStrip:c,closeStrip:r&&r.strip,loc:this.locInfo(o)}},t.prepareProgram=function(e,t){if(!t&&e.length){var n=e[0].loc,i=e[e.length-1].loc;n&&i&&(t={source:n.source,start:{line:n.start.line,column:n.start.column},end:{line:i.end.line,column:i.end.column}})}return{type:"Program",body:e,strip:{},loc:t}},t.preparePartialBlock=function(e,t,n,r){return i(e,n),{type:"PartialBlockStatement",name:e.path,params:e.params,hash:e.hash,program:t,openStrip:e.strip,closeStrip:n&&n.strip,loc:this.locInfo(r)}};var a=r(n(6))},function(e,t,n){"use strict";function i(){}function r(e,t){if(e===t)return!0;if(l.isArray(e)&&l.isArray(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}}function a(e){if(!e.path.parts){var t=e.path;e.path={type:"PathExpression",data:!1,depth:0,parts:[t.original+""],original:t.original+"",loc:t.loc}}}var s=n(34).default,o=n(1).default;t.__esModule=!0,t.Compiler=i,t.precompile=function(e,t,n){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);"data"in(t=t||{})||(t.data=!0),t.compat&&(t.useDepths=!0);var i=n.parse(e,t),r=(new n.Compiler).compile(i,t);return(new n.JavaScriptCompiler).compile(r,t)},t.compile=function(e,t,n){function i(){var i=n.parse(e,t),r=(new n.Compiler).compile(i,t),a=(new n.JavaScriptCompiler).compile(r,t,void 0,!0);return n.template(a)}function r(e,t){return a||(a=i()),a.call(this,e,t)}if(void 0===t&&(t={}),null==e||"string"!=typeof e&&"Program"!==e.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);"data"in(t=l.extend({},t))||(t.data=!0),t.compat&&(t.useDepths=!0);var a=void 0;return r._setup=function(e){return a||(a=i()),a._setup(e)},r._child=function(e,t,n,r){return a||(a=i()),a._child(e,t,n,r)},r};var u=o(n(6)),l=n(5),c=o(n(45)),h=[].slice;i.prototype={compiler:i,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var i=this.opcodes[n],a=e.opcodes[n];if(i.opcode!==a.opcode||!r(i.args,a.args))return!1}for(t=this.children.length,n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[],t.knownHelpers=l.extend(s(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},t.knownHelpers),this.accept(e)},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++;return this.usePartial=this.usePartial||t.usePartial,this.children[n]=t,this.useDepths=this.useDepths||t.useDepths,n},accept:function(e){if(!this[e.type])throw new u.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,n=t.length,i=0;i<n;i++)this.accept(t[i]);return this.options.blockParams.shift(),this.isSimple=1===n,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){a(e);var t=e.program,n=e.inverse;t=t&&this.compileProgram(t),n=n&&this.compileProgram(n);var i=this.classifySexpr(e);"helper"===i?this.helperSexpr(e,t,n):"simple"===i?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,n),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var t=e.program&&this.compileProgram(e.program),n=this.setupFullMustacheParams(e,t,void 0),i=e.path;this.useDecorators=!0,this.opcode("registerDecorator",n.length,i.original)},PartialStatement:function(e){this.usePartial=!0;var t=e.program;t&&(t=this.compileProgram(e.program));var n=e.params;if(n.length>1)throw new u.default("Unsupported number of partial arguments: "+n.length,e);n.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):n.push({type:"PathExpression",parts:[],depth:0}));var i=e.name.original,r="SubExpression"===e.name.type;r&&this.accept(e.name),this.setupFullMustacheParams(e,t,void 0,!0);var a=e.indent||"";this.options.preventIndent&&a&&(this.opcode("appendContent",a),a=""),this.opcode("invokePartial",r,i,a),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){a(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,n){var i=e.path,r=i.parts[0],a=null!=t||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),i.strict=!0,this.accept(i),this.opcode("invokeAmbiguous",r,a)},simpleSexpr:function(e){var t=e.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),r=e.path,a=r.parts[0];if(this.options.knownHelpers[a])this.opcode("invokeKnownHelper",i.length,a);else{if(this.options.knownHelpersOnly)throw new u.default("You specified knownHelpersOnly, but used the unknown helper "+a,e);r.strict=!0,r.falsy=!0,this.accept(r),this.opcode("invokeHelper",i.length,r.original,c.default.helpers.simpleId(r))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],n=c.default.helpers.scopedId(e),i=!e.depth&&!n&&this.blockParamIndex(t);i?this.opcode("lookupBlockParam",i,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,n):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,n=0,i=t.length;for(this.opcode("pushHash");n<i;n++)this.pushParam(t[n].value);for(;n--;)this.opcode("assignToHash",t[n].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:h.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=c.default.helpers.simpleId(e.path),n=t&&!!this.blockParamIndex(e.path.parts[0]),i=!n&&c.default.helpers.helperExpression(e),r=!n&&(i||t);if(r&&!i){var a=e.path.parts[0],s=this.options;s.knownHelpers[a]?i=!0:s.knownHelpersOnly&&(r=!1)}return i?"helper":r?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;t<n;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var n=void 0;if(!e.parts||c.default.helpers.scopedId(e)||e.depth||(n=this.blockParamIndex(e.parts[0])),n){var i=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,i)}else(t=e.original||t).replace&&(t=t.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,n,i){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.accept(e.hash):this.opcode("emptyHash",i),r},blockParamIndex:function(e){for(var t=0,n=this.options.blockParams.length;t<n;t++){var i=this.options.blockParams[t],r=i&&l.indexOf(i,e);if(i&&r>=0)return[t,r]}}}},function(e,t,n){"use strict";function i(e){this.value=e}function r(){}var a=n(13).default,s=n(1).default;t.__esModule=!0;var o=n(4),u=s(n(6)),l=n(5),c=s(n(53));r.prototype={nameLookup:function(e,t){return this.internalNameLookup(e,t)},depthedLookup:function(e){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(e),")"]},compilerInfo:function(){var e=o.COMPILER_REVISION;return[e,o.REVISION_CHANGES[e]]},appendToBuffer:function(e,t,n){return l.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:n?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(e,t){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",e,",",JSON.stringify(t),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(e,t,n,i){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var r=e.opcodes,a=void 0,s=void 0,o=void 0,l=void 0;for(o=0,l=r.length;o<l;o++)a=r[o],this.source.currentLocation=a.loc,s=s||a.loc,this[a.opcode].apply(this,a.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new u.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),";\n"]),this.decorators.push("return fn;"),i?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var c=this.createFunctionContext(i);if(this.isChild)return c;var h={compiler:this.compilerInfo(),main:c};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var d=this.context,f=d.programs,p=d.decorators;for(o=0,l=f.length;o<l;o++)f[o]&&(h[o]=f[o],p[o]&&(h[o+"_d"]=p[o],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),i?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),t.srcName?(h=h.toStringWithSourceMap({file:t.destName})).map=h.map&&h.map.toString():h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new c.default(this.options.srcName),this.decorators=new c.default(this.options.srcName)},createFunctionContext:function(e){var t=this,n="",i=this.stackVars.concat(this.registers.list);i.length>0&&(n+=", "+i.join(", "));var r=0;a(this.aliases).forEach((function(e){var i=t.aliases[e];i.children&&i.referenceCount>1&&(n+=", alias"+ ++r+"="+e,i.children[0]="alias"+r)})),this.lookupPropertyFunctionIsUsed&&(n+=", "+this.lookupPropertyFunctionVarDeclaration());var s=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var o=this.mergeSource(n);return e?(s.push(o),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",o,"}"])},mergeSource:function(e){var t=this.environment.isSimple,n=!this.forceBuffer,i=void 0,r=void 0,a=void 0,s=void 0;return this.source.each((function(e){e.appendToBuffer?(a?e.prepend("  + "):a=e,s=e):(a&&(r?a.prepend("buffer += "):i=!0,s.add(";"),a=s=void 0),r=!0,t||(n=!1))})),n?a?(a.prepend("return "),s.add(";")):r||this.source.push('return "";'):(e+=", buffer = "+(i?"":this.initializeBuffer()),a?(a.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(i?"":";\n")),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return"\n      lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    }\n    ".trim()},blockValue:function(e){var t=this.aliasable("container.hooks.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(e,0,n);var i=this.popStack();n.splice(1,0,i),this.push(this.source.functionCall(t,"call",n))},ambiguousBlockValue:function(){var e=this.aliasable("container.hooks.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var n=this.topStack();t.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack((function(e){return[" != null ? ",e,' : ""']})),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n,i){var r=0;i||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[r++])),this.resolvePath("context",e,r,t,n)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t,n){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0,n)},resolvePath:function(e,t,n,i,r){var a=this;if(this.options.strict||this.options.assumeObjects)this.push(function(e,t,n,i){var r=t.popStack(),a=0,s=n.length;for(e&&s--;a<s;a++)r=t.nameLookup(r,n[a],i);return e?[t.aliasable("container.strict"),"(",r,", ",t.quotedString(n[a]),", ",JSON.stringify(t.source.currentLocation)," )"]:r}(this.options.strict&&r,this,t,e));else for(var s=t.length;n<s;n++)this.replaceStack((function(r){var s=a.nameLookup(r,t[n],e);return i?[" && ",s]:[" != null ? ",s," : ",r]}))},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,t){var n=this.nameLookup("decorators",t,"decorator"),i=this.setupHelperArgs(t,e);this.decorators.push(["fn = ",this.decorators.functionCall(n,"",["fn","props","container",i])," || fn;"])},invokeHelper:function(e,t,n){var i=this.popStack(),r=this.setupHelper(e,t),a=[];n&&a.push(r.name),a.push(i),this.options.strict||a.push(this.aliasable("container.hooks.helperMissing"));var s=["(",this.itemsSeparatedBy(a,"||"),")"],o=this.source.functionCall(s,"call",r.callParams);this.push(o)},itemsSeparatedBy:function(e,t){var n=[];n.push(e[0]);for(var i=1;i<e.length;i++)n.push(t,e[i]);return n},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,e,t),r=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",e,"helper")," || ",n,")"];this.options.strict||(r[0]="(helper = ",r.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",r,i.paramsInit?["),(",i.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",i.callParams)," : helper))"])},invokePartial:function(e,t,n){var i=[],r=this.setupParams(t,1,i);e&&(t=this.popStack(),delete r.name),n&&(r.indent=JSON.stringify(n)),r.helpers="helpers",r.partials="partials",r.decorators="container.decorators",e?i.unshift(t):i.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(r.depths="depths"),r=this.objectLiteral(r),i.push(r),this.push(this.source.functionCall("container.invokePartial","",i))},assignToHash:function(e){var t=this.popStack(),n=void 0,i=void 0,r=void 0;this.trackIds&&(r=this.popStack()),this.stringParams&&(i=this.popStack(),n=this.popStack());var a=this.hash;n&&(a.contexts[e]=n),i&&(a.types[e]=i),r&&(a.ids[e]=r),a.values[e]=t},pushId:function(e,t,n){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):"PathExpression"===e?this.pushString(t):"SubExpression"===e?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:r,compileChildren:function(e,t){for(var n=e.children,i=void 0,r=void 0,a=0,s=n.length;a<s;a++){i=n[a],r=new this.compiler;var o=this.matchExistingProgram(i);if(null==o){this.context.programs.push("");var u=this.context.programs.length;i.index=u,i.name="program"+u,this.context.programs[u]=r.compile(i,t,this.context,!this.precompile),this.context.decorators[u]=r.decorators,this.context.environments[u]=i,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams,i.useDepths=this.useDepths,i.useBlockParams=this.useBlockParams}else i.index=o.index,i.name="program"+o.index,this.useDepths=this.useDepths||o.useDepths,this.useBlockParams=this.useBlockParams||o.useBlockParams}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var i=this.context.environments[t];if(i&&i.equals(e))return i}},programExpression:function(e){var t=this.environment.children[e],n=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"container.program("+n.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof i||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new i(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],n=void 0,r=void 0,a=void 0;if(!this.isInline())throw new u.default("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof i)t=["(",n=[s.value]],a=!0;else{r=!0;var o=this.incrStack();t=["((",this.push(o)," = ",s,")"],n=this.topStack()}var l=e.call(this,n);a||this.popStack(),r&&this.stackSlot--,this.push(t.concat(l,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];if(r instanceof i)this.compileStack.push(r);else{var a=this.incrStack();this.pushSource([a," = ",r,";"]),this.compileStack.push(a)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof i)return n.value;if(!t){if(!this.stackSlot)throw new u.default("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof i?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):((t=this.aliases[e]=this.source.wrap(e)).aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,n){var i=[];return{params:i,paramsInit:this.setupHelperArgs(t,e,i,n),name:this.nameLookup("helpers",t,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})")].concat(i)}},setupParams:function(e,t,n){var i={},r=[],a=[],s=[],o=!n,u=void 0;o&&(n=[]),i.name=this.quotedString(e),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var l=this.popStack(),c=this.popStack();(c||l)&&(i.fn=c||"container.noop",i.inverse=l||"container.noop");for(var h=t;h--;)u=this.popStack(),n[h]=u,this.trackIds&&(s[h]=this.popStack()),this.stringParams&&(a[h]=this.popStack(),r[h]=this.popStack());return o&&(i.args=this.source.generateArray(n)),this.trackIds&&(i.ids=this.source.generateArray(s)),this.stringParams&&(i.types=this.source.generateArray(a),i.contexts=this.source.generateArray(r)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(e,t,n,i){var r=this.setupParams(e,t,n);return r.loc=JSON.stringify(this.source.currentLocation),r=this.objectLiteral(r),i?(this.useRegister("options"),n.push("options"),["options=",r]):n?(n.push(r),""):r}},function(){for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),t=r.RESERVED_WORDS={},n=0,i=e.length;n<i;n++)t[e[n]]=!0}(),r.isValidJavaScriptVariableName=function(e){return!r.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},t.default=r,e.exports=t.default},function(e,t,n){"use strict";function i(e,t,n){if(s.isArray(e)){for(var i=[],r=0,a=e.length;r<a;r++)i.push(t.wrap(e[r],n));return i}return"boolean"==typeof e||"number"==typeof e?e+"":e}function r(e){this.srcFile=e,this.source=[]}var a=n(13).default;t.__esModule=!0;var s=n(5),o=void 0;o||(o=function(e,t,n,i){this.src="",i&&this.add(i)},o.prototype={add:function(e){s.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){s.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),r.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each((function(t){e.add(["  ",t,"\n"])})),e},each:function(e){for(var t=0,n=this.source.length;t<n;t++)e(this.source[t])},empty:function(){var e=this.currentLocation||{start:{}};return new o(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return e instanceof o?e:(e=i(e,this,t),new o(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,n){return n=this.generateList(n),this.wrap([e,t?"."+t+"(":"(",n,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=this,n=[];a(e).forEach((function(r){var a=i(e[r],t);"undefined"!==a&&n.push([t.quotedString(r),":",a])}));var r=this.generateList(n);return r.prepend("{"),r.add("}"),r},generateList:function(e){for(var t=this.empty(),n=0,r=e.length;n<r;n++)n&&t.add(","),t.add(i(e[n],this));return t},generateArray:function(e){var t=this.generateList(e);return t.prepend("["),t.add("]"),t}},t.default=r,e.exports=t.default}])},9402:function(e){e.exports='<div class="control-panel annotation-ui-container hide"> <div class="control-panel__container"> <div class="mdc-card controls-container"> <div class="title-bar toolbar playback-title-bar"> <span class="col-10 d-inline-block v-align-middle"> <h4 class="playback-title">Tempo (BPM)</h4> </span> <span class="col-2 d-inline-block v-align-middle"> <div class="mdc-touch-target-wrapper"> <button aria-label="Close Audio Controls" class="mdc-icon-button material-icons close-playback">close</button> </div> </span> </div> <div class="col-10 metronome-toolbar"> <div class="mdc-slider mdc-slider--discrete metronome-slider" tabindex="0" role="slider" data-step="1" aria-valuemin="1" aria-valuemax="300" aria-valuenow="90" aria-label="BPM"> <div class="mdc-slider__track-container"> <div class="mdc-slider__track"></div> </div> <div class="mdc-slider__thumb-container"> <div class="mdc-slider__pin"> <span class="mdc-slider__pin-value-marker">60</span> </div> <svg class="mdc-slider__thumb" width="21" height="21"> <circle cx="10.5" cy="10.5" r="7.875"></circle> </svg> <div class="mdc-slider__focus-ring"></div> </div> </div> </div> <div class="col-10 hide volume-toolbar"> </div> <div class="mdc-tab-bar playback-tabs" role="tablist"> <div class="mdc-tab-scroller"> <div class="mdc-tab-scroller__scroll-area"> <div class="mdc-tab-scroller__scroll-content"> <button class="mdc-tab" role="tab" aria-selected="true" aria-label="Metronome" tabindex="0"> <span class="mdc-tab__content"> <span style="margin-top:5px" class="material-icons"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 1.75l-3.43.92l-4.5 16.83c-.01 0-.07.34-.07.5c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2c0-.16-.06-.5-.07-.5l-4.5-16.83L12 1.75M10.29 4h3.42l3.49 13H13v-5h-2v5H6.8l3.49-13M11 5v4h-1v2h4V9h-1V5h-2z" fill="#626262"/><rect x="0" y="0" width="24" height="24" fill="rgba(0, 0, 0, 0)"/></svg></span> </span> <span class="mdc-tab-indicator"> <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span> </span> <span class="mdc-tab__ripple"></span> </button> <button class="mdc-tab add-symbol-mode" role="tab" aria-selected="false" aria-label="Add Symbol" tabindex="1"> <span class="mdc-tab__content"> <span class="mdc-tab__icon material-icons" aria-hidden="true">volume_up</span> </span> <span class="mdc-tab-indicator"> <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span> </span> <span class="mdc-tab__ripple"></span> </button> </div> </div> </div> </div> </div> </div> </div>'},1268:function(e){e.exports='<div class="playback-buttons"> <div class="control-panel__play-controls"> <button class="mdc-fab mdc-fab--mini reset-button" aria-label="Reset"> <div class="mdc-fab__ripple"></div> <span class="mdc-fab__icon material-icons">skip_previous</span> </button> <button class="mdc-fab playpause-button" aria-label="Play" style="margin-left:20px"> <div class="mdc-fab__ripple"></div> <span class="mdc-fab__icon material-icons play-icon">play_arrow</span> <span class="mdc-fab__icon material-icons pause-icon">pause</span> </button> </div> </div>'},8068:function(e){e.exports='<div> <label for="{{id}}-slider">{{name}}</label> <button class="mdc-button mdc-button--outlined mute-button d-inline-block v-align-middle" aria-label="Mute" aria-pressed="false"> <div class="mdc-button__ripple"></div> <span class="mdc-button__label">Mute</span> </button> <div class="mdc-slider mdc-slider--discrete volume-slider" id="{{id}}-slider" tabindex="0" role="slider" data-step="1" aria-valuemin="1" aria-valuemax="100" aria-valuenow="80" aria-label="Volume {{name}}"> <div class="mdc-slider__track-container"> <div class="mdc-slider__track"></div> </div> <div class="mdc-slider__thumb-container"> <div class="mdc-slider__pin"> <span class="mdc-slider__pin-value-marker">60</span> </div> <svg class="mdc-slider__thumb" width="21" height="21"> <circle cx="10.5" cy="10.5" r="7.875"></circle> </svg> <div class="mdc-slider__focus-ring"></div> </div> </div> </div>'},5733:function(e,n,r){e.exports=function e(t,n,i){function r(s,o){if(!n[s]){if(!t[s]){if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){return r(t[s][1][e]||e)}),l,l.exports,e,t,n,i)}return n[s].exports}for(var a=void 0,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,s,o,u,l,c=[],h=0,d=e.length,f=d,p="string"!==i.getTypeOf(e);h<e.length;)f=d-h,r=p?(t=e[h++],n=h<d?e[h++]:0,h<d?e[h++]:0):(t=e.charCodeAt(h++),n=h<d?e.charCodeAt(h++):0,h<d?e.charCodeAt(h++):0),s=t>>2,o=(3&t)<<4|n>>4,u=1<f?(15&n)<<2|r>>6:64,l=2<f?63&r:64,c.push(a.charAt(s)+a.charAt(o)+a.charAt(u)+a.charAt(l));return c.join("")},n.decode=function(e){var t,n,i,s,o,u,l=0,c=0,h="data:";if(e.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|f):new Array(0|f);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(s=a.indexOf(e.charAt(l++)))>>4,n=(15&s)<<4|(o=a.indexOf(e.charAt(l++)))>>2,i=(3&o)<<6|(u=a.indexOf(e.charAt(l++))),d[c++]=t,64!==o&&(d[c++]=n),64!==u&&(d[c++]=i);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var i=e("./external"),r=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),s=e("./stream/DataLengthProbe");function o(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}o.prototype={getContentWorker:function(){var e=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new s("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var i=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var a=r,s=0+n;e^=-1;for(var o=0;o<s;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,n,i){var a=r,s=0+n;e^=-1;for(var o=0;o<s;o++)e=e>>>8^a[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:37}],7:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),a=e("./utils"),s=e("./stream/GenericWorker"),o=i?"uint8array":"array";function u(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(u,s),u.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(o,e.data),!1)},u.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new u("Deflate",e)},n.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function i(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i}function r(e,t,n,r,s,c){var h,d,f=e.file,p=e.compression,m=c!==o.utf8encode,v=a.transformTo("string",c(f.name)),g=a.transformTo("string",o.utf8encode(f.name)),y=f.comment,b=a.transformTo("string",c(y)),S=a.transformTo("string",o.utf8encode(y)),x=g.length!==f.name.length,_=S.length!==y.length,E="",k="",M="",w=f.dir,P=f.date,T={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(T.crc32=e.crc32,T.compressedSize=e.compressedSize,T.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),m||!x&&!_||(C|=2048);var I=0,A=0;w&&(I|=16),"UNIX"===s?(A=798,I|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,w)):(A=20,I|=function(e){return 63&(e||0)}(f.dosPermissions)),h=P.getUTCHours(),h<<=6,h|=P.getUTCMinutes(),h<<=5,h|=P.getUTCSeconds()/2,d=P.getUTCFullYear()-1980,d<<=4,d|=P.getUTCMonth()+1,d<<=5,d|=P.getUTCDate(),x&&(k=i(1,1)+i(u(v),4)+g,E+="up"+i(k.length,2)+k),_&&(M=i(1,1)+i(u(b),4)+S,E+="uc"+i(M.length,2)+M);var L="";return L+="\n\0",L+=i(C,2),L+=p.magic,L+=i(h,2),L+=i(d,2),L+=i(T.crc32,4),L+=i(T.compressedSize,4),L+=i(T.uncompressedSize,4),L+=i(v.length,2),L+=i(E.length,2),{fileRecord:l.LOCAL_FILE_HEADER+L+v+E,dirRecord:l.CENTRAL_FILE_HEADER+i(A,2)+L+i(b.length,2)+"\0\0\0\0"+i(I,4)+i(r,4)+v+E+b}}var a=e("../utils"),s=e("../stream/GenericWorker"),o=e("../utf8"),u=e("../crc32"),l=e("../signature");function c(e,t,n,i){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(c,s),c.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=r(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=r(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return l.DATA_DESCRIPTOR+i(e.crc32,4)+i(e.compressedSize,4)+i(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,r=function(e,t,n,r,s){var o=a.transformTo("string",s(r));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(e,2)+i(e,2)+i(t,4)+i(n,4)+i(o.length,2)+o}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},c.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},c.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var i=e("../compressions"),r=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new r(t.streamFiles,n,t.platform,t.encodeFileName),s=0;try{e.forEach((function(e,n){s++;var r=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),o=n.options.compressionOptions||t.compressionOptions||{},u=n.dir,l=n.date;n._compressWorker(r,o).withStreamInfo("file",{name:e,dir:u,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)})),a.entriesCount=s}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.7.1",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./external"),a=e("./utf8"),s=e("./zipEntries"),o=e("./stream/Crc32Probe"),u=e("./nodejsUtils");function l(e){return new r.Promise((function(t,n){var i=e.decompressed.getContentWorker().pipe(new o);i.on("error",(function(e){n(e)})).on("end",(function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var n=this;return t=i.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new s(t);return n.load(e),n})).then((function(e){var n=[r.Promise.resolve(e)],i=e.files;if(t.checkCRC32)for(var a=0;a<i.length;a++)n.push(l(i[a]));return r.Promise.all(n)})).then((function(e){for(var i=e.shift(),r=i.files,a=0;a<r.length;a++){var s=r[a];n.file(s.fileNameStr,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../stream/GenericWorker");function a(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}i.inherits(a,r),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},a.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var i=e("readable-stream").Readable;function r(e,t,n){i.call(this,t),this._helper=e;var r=this;e.on("data",(function(e,t){r.push(e)||r._helper.pause(),n&&n(t)})).on("error",(function(e){r.emit("error",e)})).on("end",(function(){r.push(null)}))}e("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,n,i){"use strict";n.exports={isNode:"undefined"!=typeof t,newBufferFrom:function(e,n){if(t.from&&t.from!==Uint8Array.from)return t.from(e,n);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new t(e,n)},allocBuffer:function(e){if(t.alloc)return t.alloc(e);var n=new t(e);return n.fill(0),n},isBuffer:function(e){return t.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function i(e,t,n){var i,r=a.getTypeOf(t),o=a.extend(n||{},u);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=m(e)),o.createFolders&&(i=p(e))&&v.call(this,i,!0);var h,g="string"===r&&!1===o.binary&&!1===o.base64;n&&void 0!==n.binary||(o.binary=!g),(t instanceof l&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",r="string"),h=t instanceof l||t instanceof s?t:d.isNode&&d.isStream(t)?new f(e,t):a.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var y=new c(e,h,o);this.files[e]=y}var r=e("./utf8"),a=e("./utils"),s=e("./stream/GenericWorker"),o=e("./stream/StreamHelper"),u=e("./defaults"),l=e("./compressedObject"),c=e("./zipObject"),h=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},v=function(e,t){return t=void 0!==t?t:u.createFolders,e=m(e),this.files[e]||i.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i)},filter:function(e){var t=[];return this.forEach((function(n,i){e(n,i)&&t.push(i)})),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,i.call(this,e,t,n),this;if(g(e)){var r=e;return this.filter((function(e,t){return!t.dir&&r.test(e)}))}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(g(e))return this.filter((function(t,n){return n.dir&&e.test(t)}));var t=this.root+e,n=v.call(this,t),i=this.clone();return i.root=n.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var i=n.comment||this.comment||"";t=h.generateWorker(this,n,i)}catch(e){(t=new s("error")).error(e)}return new o(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var i=e("./DataReader");function r(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===i&&this.data[a+3]===r)return a-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&i===a[2]&&r===a[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var i=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,n){"use strict";var i=e("./Uint8ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var i=e("./DataReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var i=e("./ArrayReader");function r(e){i.call(this,e)}e("../utils").inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../support"),a=e("./ArrayReader"),s=e("./StringReader"),o=e("./NodeBufferReader"),u=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new o(e):r.uint8array?new u(i.transformTo("uint8array",e)):new a(i.transformTo("array",e)):new s(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var i=e("./GenericWorker"),r=e("../utils");function a(e){i.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(a,i),a.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var i=e("./GenericWorker"),r=e("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,i),a.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(a,r),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var i=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}i.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,n,i){"use strict";var r=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),o=e("../base64"),u=e("../support"),l=e("../external"),c=null;if(u.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function h(e,t,n){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=n,r.checkSupport(i),this._worker=e.pipe(new a(i)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}h.prototype={accumulate:function(e){return function(e,n){return new l.Promise((function(i,a){var s=[],u=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,t){s.push(e),n&&n(t)})).on("error",(function(e){s=[],a(e)})).on("end",(function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(l,function(e,n){var i,r=0,a=null,s=0;for(i=0;i<n.length;i++)s+=n[i].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(a=new Uint8Array(s),i=0;i<n.length;i++)a.set(n[i],r),r+=n[i].length;return a;case"nodebuffer":return t.concat(n);default:throw new Error("concat : unsupported type '"+e+"'")}}(u,s),c);i(e)}catch(e){a(e)}s=[]})).resume()}))}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,i){"use strict";if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof t,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(r),i.blob=0===a.getBlob("application/zip").size}catch(e){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(e){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var i=e("./utils"),r=e("./support"),a=e("./nodejsUtils"),s=e("./stream/GenericWorker"),o=new Array(256),u=0;u<256;u++)o[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function l(){s.call(this,"utf-8 decode"),this.leftOver=null}function c(){s.call(this,"utf-8 encode")}o[254]=o[254]=1,n.utf8encode=function(e){return r.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,i,a,s,o=e.length,u=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),u+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(u):new Array(u),a=s=0;s<u;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){return r.nodebuffer?i.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,a,s=e.length,u=new Array(2*s);for(t=n=0;t<s;)if((r=e[t++])<128)u[n++]=r;else if(4<(a=o[r]))u[n++]=65533,t+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&t<s;)r=r<<6|63&e[t++],a--;1<a?u[n++]=65533:r<65536?u[n++]=r:(r-=65536,u[n++]=55296|r>>10&1023,u[n++]=56320|1023&r)}return u.length!==n&&(u.subarray?u=u.subarray(0,n):u.length=n),i.applyFromCharCode(u)}(e=i.transformTo(r.uint8array?"uint8array":"array",e))},i.inherits(l,s),l.prototype.processChunk=function(e){var t=i.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var s=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}(t),u=t;s!==t.length&&(r.uint8array?(u=t.subarray(0,s),this.leftOver=t.subarray(s,t.length)):(u=t.slice(0,s),this.leftOver=t.slice(s,t.length))),this.push({data:n.utf8decode(u),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=l,i.inherits(c,s),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var i=e("./support"),r=e("./base64"),a=e("./nodejsUtils"),s=e("set-immediate-shim"),o=e("./external");function u(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(e),i.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,n){var i=[],r=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;r<a;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,a)))):i.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,a)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=c.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=c.applyCanBeUsed.nodebuffer),r)for(;1<t;)try{return c.stringifyByChunk(e,i,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=h;var f={};f.string={string:u,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},f.array={string:h,array:u,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},f.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:u,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:u,nodebuffer:function(e){return a.newBufferFrom(e)}},f.nodebuffer={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:u},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return f[i][e](t)},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&a.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){s((function(){e.apply(n||null,t||[])}))},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,s,u){return o.Promise.resolve(t).then((function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise((function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)})):e})).then((function(t){var c=n.getTypeOf(t);return c?("arraybuffer"===c?t=n.transformTo("uint8array",t):"string"===c&&(u?t=r.decode(t):a&&!0!==s&&(t=function(e){return l(e,i.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,n){"use strict";var i=e("./reader/readerFor"),r=e("./utils"),a=e("./signature"),s=e("./zipEntry"),o=(e("./utf8"),e("./support"));function u(e){this.files=[],this.loadOptions=e}u.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(0<i)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var i=e("./reader/readerFor"),r=e("./utils"),a=e("./compressedObject"),s=e("./crc32"),o=e("./utf8"),u=e("./compressions"),l=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].magic===e)return u[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i};e.setIndex(r)},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var a=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function i(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var r=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),s=e("./utf8"),o=e("./compressedObject"),u=e("./stream/GenericWorker");i.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var i="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!i&&(t=t.pipe(new s.Utf8EncodeWorker)),!a&&i&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(e){(t=new u("error")).error(e)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<l.length;h++)i.prototype[l[h]]=c;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){"use strict";var n,i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var a=0,s=new r(c),o=e.document.createTextNode("");s.observe(o,{characterData:!0}),n=function(){o.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var u=new e.MessageChannel;u.port1.onmessage=c,n=function(){u.port2.postMessage(0)}}var l=[];function c(){var e,t;i=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}i=!1}t.exports=function(e){1!==l.push(e)||i||n()}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var i=e("immediate");function r(){}var a={},s=["REJECTED"],o=["FULFILLED"],u=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){i((function(){var i;try{i=t(n)}catch(i){return a.reject(e,i)}i===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,i)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function i(t){n||(n=!0,a.reject(e,t))}function r(t){n||(n=!0,a.resolve(e,t))}var s=p((function(){t(r,i)}));"error"===s.status&&i(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=l).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(r);return this.state!==u?h(n,this.state===o?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){a.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return a.reject(e,n.value);var i=n.value;if(i)f(e,i);else{e.state=o,e.outcome=t;for(var r=-1,s=e.queue.length;++r<s;)e.queue[r].callFulfilled(t)}return e},a.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(r),e)},l.reject=function(e){var t=new this(r);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),o=0,u=-1,l=new this(r);++u<n;)c(e[u],u);return l;function c(e,r){t.resolve(e).then((function(e){s[r]=e,++o!==n||i||(i=!0,a.resolve(l,s))}),(function(e){i||(i=!0,a.reject(l,e))}))}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var i,s=-1,o=new this(r);++s<t;)i=e[s],this.resolve(i).then((function(e){n||(n=!0,a.resolve(o,e))}),(function(e){n||(n=!0,a.reject(o,e))}));return o}},{immediate:36}],38:[function(e,t,n){"use strict";var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var i=e("./zlib/deflate"),r=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/messages"),o=e("./zlib/zstream"),u=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(s[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=i.deflateSetDictionary(this.strm,c)))throw new Error(s[n]);this._dict_set=!0}}function c(e,t){var n=new l(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}l.prototype.push=function(e,t){var n,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=a.string2buf(e):"[object ArrayBuffer]"===u.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(l),o.next_out=0,o.avail_out=l),1!==(n=i.deflate(o,s))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==n);return 4===s?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),!(o.avail_out=0))},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=l,n.deflate=c,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var i=e("./zlib/inflate"),r=e("./utils/common"),a=e("./utils/strings"),s=e("./zlib/constants"),o=e("./zlib/messages"),u=e("./zlib/zstream"),l=e("./zlib/gzheader"),c=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);this.header=new l,i.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}h.prototype.push=function(e,t){var n,o,u,l,h,d,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,v=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(p),f.next_out=0,f.avail_out=p),(n=i.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&m&&(d="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,n=i.inflateSetDictionary(this.strm,d)),n===s.Z_BUF_ERROR&&!0===v&&(n=s.Z_OK,v=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(u=a.utf8border(f.output,f.next_out),l=f.next_out-u,h=a.buf2string(f.output,u),f.next_out=l,f.avail_out=p-l,l&&r.arraySet(f.output,f.output,u,l,0),this.onData(h)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(v=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(f.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,s;for(t=i=0,n=e.length;t<n;t++)i+=e[t].length;for(s=new Uint8Array(i),t=r=0,n=e.length;t<n;t++)a=e[t],s.set(a,r),r+=a.length;return s}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},{}],42:[function(e,t,n){"use strict";var i=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var s=new i.Buf8(256),o=0;o<256;o++)s[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function u(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,n.string2buf=function(e){var t,n,r,a,s,o=e.length,u=0;for(a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),u+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(u),a=s=0;s<u;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[s++]=n:(n<2048?t[s++]=192|n>>>6:(n<65536?t[s++]=224|n>>>12:(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63),t[s++]=128|n>>>6&63),t[s++]=128|63&n);return t},n.buf2binstring=function(e){return u(e,e.length)},n.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,i,r,a,o=t||e.length,l=new Array(2*o);for(n=i=0;n<o;)if((r=e[n++])<128)l[i++]=r;else if(4<(a=s[r]))l[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&n<o;)r=r<<6|63&e[n++],a--;1<a?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return u(l,i)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;a=a+(r=r+t[i++]|0)|0,--s;);r%=65521,a%=65521}return r|a<<16|0}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var a=i,s=r+n;e^=-1;for(var o=r;o<s;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,n){"use strict";var i,r=e("../utils/common"),a=e("./trees"),s=e("./adler32"),o=e("./crc32"),u=e("./messages"),l=-2,c=258,h=262,d=113;function f(e,t){return e.msg=u[t],t}function p(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function v(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function g(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,v(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function S(e,t){var n,i,r=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,l=e.window,d=e.w_mask,f=e.prev,p=e.strstart+c,m=l[a+s-1],v=l[a+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(n=t)+s]===v&&l[n+s-1]===m&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<p);if(i=c-(p-a),a=p-c,s<i){if(e.match_start=t,o<=(s=i))break;m=l[a+s-1],v=l[a+s]}}}while((t=f[t&d])>u&&0!=--r);return s<=e.lookahead?s:e.lookahead}function x(e){var t,n,i,a,u,l,c,d,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){for(r.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;i=e.head[--t],e.head[t]=m<=i?i-m:0,--n;);for(t=n=m;i=e.prev[--t],e.prev[t]=m<=i?i-m:0,--n;);a+=m}if(0===e.strm.avail_in)break;if(l=e.strm,c=e.window,d=e.strstart+e.lookahead,p=void 0,(f=a)<(p=l.avail_in)&&(p=f),n=0===p?0:(l.avail_in-=p,r.arraySet(c,l.input,l.next_in,p,d),1===l.state.wrap?l.adler=s(l.adler,c,p,d):2===l.state.wrap&&(l.adler=o(l.adler,c,p,d)),l.next_in+=p,l.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(u=e.strstart-e.insert,e.ins_h=e.window[u],e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[u+3-1])&e.hash_mask,e.prev[u&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=u,u++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function _(e,t){for(var n,i;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-h&&(e.match_length=S(e,n)),e.match_length>=3)if(i=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var n,i,r;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-h&&(e.match_length=S(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-3,i=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=a._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function k(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function M(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):f(e,l)}function P(e){var t=w(e);return 0===t&&function(e){e.window_size=2*e.w_size,m(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function T(e,t,n,i,a,s){if(!e)return l;var o=1;if(-1===t&&(t=6),i<0?(o=0,i=-i):15<i&&(o=2,i-=16),a<1||9<a||8!==n||i<8||15<i||t<0||9<t||s<0||4<s)return f(e,l);8===i&&(i=9);var u=new M;return(e.state=u).strm=e,u.wrap=o,u.gzhead=null,u.w_bits=i,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=a+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new r.Buf8(2*u.w_size),u.head=new r.Buf16(u.hash_size),u.prev=new r.Buf16(u.w_size),u.lit_bufsize=1<<a+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new r.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=s,u.method=n,P(e)}i=[new k(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,g(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)})),new k(4,4,8,4,_),new k(4,5,16,8,_),new k(4,6,32,32,_),new k(4,4,16,16,E),new k(8,16,32,32,E),new k(8,16,128,128,E),new k(8,32,128,256,E),new k(32,128,258,1024,E),new k(32,258,258,4096,E)],n.deflateInit=function(e,t){return T(e,t,8,15,8,0)},n.deflateInit2=T,n.deflateReset=P,n.deflateResetKeep=w,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?l:(e.state.gzhead=t,0):l},n.deflate=function(e,t){var n,r,s,u;if(!e||!e.state||5<t||t<0)return e?f(e,l):l;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&4!==t)return f(e,0===e.avail_out?-5:l);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,y(r,31),y(r,139),y(r,8),r.gzhead?(y(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),y(r,255&r.gzhead.time),y(r,r.gzhead.time>>8&255),y(r,r.gzhead.time>>16&255),y(r,r.gzhead.time>>24&255),y(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),y(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(y(r,255&r.gzhead.extra.length),y(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=o(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(y(r,0),y(r,0),y(r,0),y(r,0),y(r,0),y(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),y(r,3),r.status=d);else{var h=8+(r.w_bits-8<<4)<<8;h|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(h|=32),h+=31-h%31,r.status=d,b(r,h),0!==r.strstart&&(b(r,e.adler>>>16),b(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),v(e),s=r.pending,r.pending!==r.pending_buf_size));)y(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),v(e),s=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,y(r,u)}while(0!==u);r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),0===u&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),v(e),s=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,y(r,u)}while(0!==u);r.gzhead.hcrc&&r.pending>s&&(e.adler=o(e.adler,r.pending_buf,r.pending-s,s)),0===u&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&v(e),r.pending+2<=r.pending_buf_size&&(y(r,255&e.adler),y(r,e.adler>>8&255),e.adler=0,r.status=d)):r.status=d),0!==r.pending){if(v(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(n)&&4!==t)return f(e,-5);if(666===r.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&666!==r.status){var S=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,i,r,s,o=e.window;;){if(e.lookahead<=c){if(x(e),e.lookahead<=c&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){s=e.strstart+c;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);e.match_length=c-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(r,t):i[r.level].func(r,t);if(3!==S&&4!==S||(r.status=666),1===S||3===S)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===S&&(1===t?a._tr_align(r):5!==t&&(a._tr_stored_block(r,0,0,!1),3===t&&(m(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),v(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(y(r,255&e.adler),y(r,e.adler>>8&255),y(r,e.adler>>16&255),y(r,e.adler>>24&255),y(r,255&e.total_in),y(r,e.total_in>>8&255),y(r,e.total_in>>16&255),y(r,e.total_in>>24&255)):(b(r,e.adler>>>16),b(r,65535&e.adler)),v(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==d&&666!==t?f(e,l):(e.state=null,t===d?f(e,-3):0):l},n.deflateSetDictionary=function(e,t){var n,i,a,o,u,c,h,d,f=t.length;if(!e||!e.state)return l;if(2===(o=(n=e.state).wrap)||1===o&&42!==n.status||n.lookahead)return l;for(1===o&&(e.adler=s(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new r.Buf8(n.w_size),r.arraySet(d,t,f-n.w_size,n.w_size,0),t=d,f=n.w_size),u=e.avail_in,c=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,x(n);n.lookahead>=3;){for(i=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--a;);n.strstart=i,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=c,e.input=h,e.avail_in=u,n.wrap=o,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,i,r,a,s,o,u,l,c,h,d,f,p,m,v,g,y,b,S,x,_,E,k,M,w;n=e.state,i=e.next_in,M=e.input,r=i+(e.avail_in-5),a=e.next_out,w=e.output,s=a-(t-e.avail_out),o=a+(e.avail_out-257),u=n.dmax,l=n.wsize,c=n.whave,h=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,v=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=M[i++]<<p,p+=8,f+=M[i++]<<p,p+=8),b=m[f&g];t:for(;;){if(f>>>=S=b>>>24,p-=S,0==(S=b>>>16&255))w[a++]=65535&b;else{if(!(16&S)){if(0==(64&S)){b=m[(65535&b)+(f&(1<<S)-1)];continue t}if(32&S){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&b,(S&=15)&&(p<S&&(f+=M[i++]<<p,p+=8),x+=f&(1<<S)-1,f>>>=S,p-=S),p<15&&(f+=M[i++]<<p,p+=8,f+=M[i++]<<p,p+=8),b=v[f&y];n:for(;;){if(f>>>=S=b>>>24,p-=S,!(16&(S=b>>>16&255))){if(0==(64&S)){b=v[(65535&b)+(f&(1<<S)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(_=65535&b,p<(S&=15)&&(f+=M[i++]<<p,(p+=8)<S&&(f+=M[i++]<<p,p+=8)),u<(_+=f&(1<<S)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=S,p-=S,(S=a-s)<_){if(c<(S=_-S)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(k=d,(E=0)===h){if(E+=l-S,S<x){for(x-=S;w[a++]=d[E++],--S;);E=a-_,k=w}}else if(h<S){if(E+=l+h-S,(S-=h)<x){for(x-=S;w[a++]=d[E++],--S;);if(E=0,h<x){for(x-=S=h;w[a++]=d[E++],--S;);E=a-_,k=w}}}else if(E+=h-S,S<x){for(x-=S;w[a++]=d[E++],--S;);E=a-_,k=w}for(;2<x;)w[a++]=k[E++],w[a++]=k[E++],w[a++]=k[E++],x-=3;x&&(w[a++]=k[E++],1<x&&(w[a++]=k[E++]))}else{for(E=a-_;w[a++]=w[E++],w[a++]=w[E++],w[a++]=w[E++],2<(x-=3););x&&(w[a++]=w[E++],1<x&&(w[a++]=w[E++]))}break}}break}}while(i<r&&a<o);i-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var i=e("../utils/common"),r=e("./adler32"),a=e("./crc32"),s=e("./inffast"),o=e("./inftrees"),u=-2;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):u}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):u}function f(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,d(e))):u}function p(e,t){var n,i;return e?(i=new c,(e.state=i).window=null,0!==(n=f(e,t))&&(e.state=null),n):u}var m,v,g=!0;function y(e){if(g){var t;for(m=new i.Buf32(512),v=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,v,0,e.work,{bits:5}),g=!1}e.lencode=m,e.lenbits=9,e.distcode=v,e.distbits=5}function b(e,t,n,r){var a,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),r>=s.wsize?(i.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(r<(a=s.wsize-s.wnext)&&(a=r),i.arraySet(s.window,t,n-r,a,s.wnext),(r-=a)?(i.arraySet(s.window,t,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}n.inflateReset=d,n.inflateReset2=f,n.inflateResetKeep=h,n.inflateInit=function(e){return p(e,15)},n.inflateInit2=p,n.inflate=function(e,t){var n,c,h,d,f,p,m,v,g,S,x,_,E,k,M,w,P,T,C,I,A,L,O,R,N=0,B=new i.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,h=e.output,m=e.avail_out,d=e.next_in,c=e.input,p=e.avail_in,v=n.hold,g=n.bits,S=p,x=m,L=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;g<16;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(2&n.wrap&&35615===v){B[n.check=0]=255&v,B[1]=v>>>8&255,n.check=a(n.check,B,2,0),g=v=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&v)<<8)+(v>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&v)){e.msg="unknown compression method",n.mode=30;break}if(g-=4,A=8+(15&(v>>>=4)),0===n.wbits)n.wbits=A;else if(A>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<A,e.adler=n.check=1,n.mode=512&v?10:12,g=v=0;break;case 2:for(;g<16;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(n.flags=v,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=v>>8&1),512&n.flags&&(B[0]=255&v,B[1]=v>>>8&255,n.check=a(n.check,B,2,0)),g=v=0,n.mode=3;case 3:for(;g<32;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.head&&(n.head.time=v),512&n.flags&&(B[0]=255&v,B[1]=v>>>8&255,B[2]=v>>>16&255,B[3]=v>>>24&255,n.check=a(n.check,B,4,0)),g=v=0,n.mode=4;case 4:for(;g<16;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.head&&(n.head.xflags=255&v,n.head.os=v>>8),512&n.flags&&(B[0]=255&v,B[1]=v>>>8&255,n.check=a(n.check,B,2,0)),g=v=0,n.mode=5;case 5:if(1024&n.flags){for(;g<16;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.length=v,n.head&&(n.head.extra_len=v),512&n.flags&&(B[0]=255&v,B[1]=v>>>8&255,n.check=a(n.check,B,2,0)),g=v=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p<(_=n.length)&&(_=p),_&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,c,d,_,A)),512&n.flags&&(n.check=a(n.check,c,_,d)),p-=_,d+=_,n.length-=_),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;for(_=0;A=c[d+_++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A)),A&&_<p;);if(512&n.flags&&(n.check=a(n.check,c,_,d)),p-=_,d+=_,A)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;for(_=0;A=c[d+_++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A)),A&&_<p;);if(512&n.flags&&(n.check=a(n.check,c,_,d)),p-=_,d+=_,A)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;g<16;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(v!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}g=v=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;g<32;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}e.adler=n.check=l(v),g=v=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,n.hold=v,n.bits=g,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){v>>>=7&g,g-=7&g,n.mode=27;break}for(;g<3;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}switch(n.last=1&v,g-=1,3&(v>>>=1)){case 0:n.mode=14;break;case 1:if(y(n),n.mode=20,6!==t)break;v>>>=2,g-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}v>>>=2,g-=2;break;case 14:for(v>>>=7&g,g-=7&g;g<32;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if((65535&v)!=(v>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&v,g=v=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(_=n.length){if(p<_&&(_=p),m<_&&(_=m),0===_)break e;i.arraySet(h,c,d,_,f),p-=_,d+=_,m-=_,f+=_,n.length-=_;break}n.mode=12;break;case 17:for(;g<14;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(n.nlen=257+(31&v),v>>>=5,g-=5,n.ndist=1+(31&v),v>>>=5,g-=5,n.ncode=4+(15&v),v>>>=4,g-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;g<3;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.lens[D[n.have++]]=7&v,v>>>=3,g-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,O={bits:n.lenbits},L=o(0,n.lens,0,19,n.lencode,0,n.work,O),n.lenbits=O.bits,L){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;w=(N=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,P=65535&N,!((M=N>>>24)<=g);){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(P<16)v>>>=M,g-=M,n.lens[n.have++]=P;else{if(16===P){for(R=M+2;g<R;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(v>>>=M,g-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}A=n.lens[n.have-1],_=3+(3&v),v>>>=2,g-=2}else if(17===P){for(R=M+3;g<R;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}g-=M,A=0,_=3+(7&(v>>>=M)),v>>>=3,g-=3}else{for(R=M+7;g<R;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}g-=M,A=0,_=11+(127&(v>>>=M)),v>>>=7,g-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;_--;)n.lens[n.have++]=A}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,O={bits:n.lenbits},L=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,O),n.lenbits=O.bits,L){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,O={bits:n.distbits},L=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,O),n.distbits=O.bits,L){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=p&&258<=m){e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,n.hold=v,n.bits=g,s(e,x),f=e.next_out,h=e.output,m=e.avail_out,d=e.next_in,c=e.input,p=e.avail_in,v=n.hold,g=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;w=(N=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,P=65535&N,!((M=N>>>24)<=g);){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(w&&0==(240&w)){for(T=M,C=w,I=P;w=(N=n.lencode[I+((v&(1<<T+C)-1)>>T)])>>>16&255,P=65535&N,!(T+(M=N>>>24)<=g);){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}v>>>=T,g-=T,n.back+=T}if(v>>>=M,g-=M,n.back+=M,n.length=P,0===w){n.mode=26;break}if(32&w){n.back=-1,n.mode=12;break}if(64&w){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&w,n.mode=22;case 22:if(n.extra){for(R=n.extra;g<R;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.length+=v&(1<<n.extra)-1,v>>>=n.extra,g-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;w=(N=n.distcode[v&(1<<n.distbits)-1])>>>16&255,P=65535&N,!((M=N>>>24)<=g);){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(0==(240&w)){for(T=M,C=w,I=P;w=(N=n.distcode[I+((v&(1<<T+C)-1)>>T)])>>>16&255,P=65535&N,!(T+(M=N>>>24)<=g);){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}v>>>=T,g-=T,n.back+=T}if(v>>>=M,g-=M,n.back+=M,64&w){e.msg="invalid distance code",n.mode=30;break}n.offset=P,n.extra=15&w,n.mode=24;case 24:if(n.extra){for(R=n.extra;g<R;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}n.offset+=v&(1<<n.extra)-1,v>>>=n.extra,g-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===m)break e;if(_=x-m,n.offset>_){if((_=n.offset-_)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}E=_>n.wnext?(_-=n.wnext,n.wsize-_):n.wnext-_,_>n.length&&(_=n.length),k=n.window}else k=h,E=f-n.offset,_=n.length;for(m<_&&(_=m),m-=_,n.length-=_;h[f++]=k[E++],--_;);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;h[f++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;g<32;){if(0===p)break e;p--,v|=c[d++]<<g,g+=8}if(x-=m,e.total_out+=x,n.total+=x,x&&(e.adler=n.check=n.flags?a(n.check,h,x,f-x):r(n.check,h,x,f-x)),x=m,(n.flags?v:l(v))!==n.check){e.msg="incorrect data check",n.mode=30;break}g=v=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;g<32;){if(0===p)break e;p--,v+=c[d++]<<g,g+=8}if(v!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}g=v=0}n.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return u}return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=p,n.hold=v,n.bits=g,(n.wsize||x!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&b(e,e.output,e.next_out,x-e.avail_out)?(n.mode=31,-4):(S-=e.avail_in,x-=e.avail_out,e.total_in+=S,e.total_out+=x,n.total+=x,n.wrap&&x&&(e.adler=n.check=n.flags?a(n.check,h,x,e.next_out-x):r(n.check,h,x,e.next_out-x)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==S&&0===x||4===t)&&0===L&&(L=-5),L)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?u:((n.head=t).done=!1,0):u},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&r(1,t,i,0)!==n.check?-3:b(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var i=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,u,l,c,h,d){var f,p,m,v,g,y,b,S,x,_=d.bits,E=0,k=0,M=0,w=0,P=0,T=0,C=0,I=0,A=0,L=0,O=null,R=0,N=new i.Buf16(16),B=new i.Buf16(16),D=null,F=0;for(E=0;E<=15;E++)N[E]=0;for(k=0;k<u;k++)N[t[n+k]]++;for(P=_,w=15;1<=w&&0===N[w];w--);if(w<P&&(P=w),0===w)return l[c++]=20971520,l[c++]=20971520,d.bits=1,0;for(M=1;M<w&&0===N[M];M++);for(P<M&&(P=M),E=I=1;E<=15;E++)if(I<<=1,(I-=N[E])<0)return-1;if(0<I&&(0===e||1!==w))return-1;for(B[1]=0,E=1;E<15;E++)B[E+1]=B[E]+N[E];for(k=0;k<u;k++)0!==t[n+k]&&(h[B[t[n+k]]++]=k);if(y=0===e?(O=D=h,19):1===e?(O=r,R-=257,D=a,F-=257,256):(O=s,D=o,-1),E=M,g=c,C=k=L=0,m=-1,v=(A=1<<(T=P))-1,1===e&&852<A||2===e&&592<A)return 1;for(;;){for(b=E-C,x=h[k]<y?(S=0,h[k]):h[k]>y?(S=D[F+h[k]],O[R+h[k]]):(S=96,0),f=1<<E-C,M=p=1<<T;l[g+(L>>C)+(p-=f)]=b<<24|S<<16|x|0,0!==p;);for(f=1<<E-1;L&f;)f>>=1;if(0!==f?(L&=f-1,L+=f):L=0,k++,0==--N[E]){if(E===w)break;E=t[n+h[k]]}if(P<E&&(L&v)!==m){for(0===C&&(C=P),g+=M,I=1<<(T=E-C);T+C<w&&!((I-=N[T+C])<=0);)T++,I<<=1;if(A+=1<<T,1===e&&852<A||2===e&&592<A)return 1;l[m=L&v]=P<<24|T<<16|g-c|0}}return 0!==L&&(l[g+L]=E-C<<24|64<<16|0),d.bits=P,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var i=e("../utils/common");function r(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,s=286,o=30,u=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);r(f);var p=new Array(60);r(p);var m=new Array(512);r(m);var v=new Array(256);r(v);var g=new Array(29);r(g);var y,b,S,x=new Array(o);function _(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function E(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function k(e){return e<256?m[e]:m[256+(e>>>7)]}function M(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function w(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,M(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function P(e,t,n){w(e,n[2*t],n[2*t+1])}function T(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function C(e,t,n){var i,r,a=new Array(16),s=0;for(i=1;i<=u;i++)a[i]=s=s+n[i-1]<<1;for(r=0;r<=t;r++){var o=e[2*r+1];0!==o&&(e[2*r]=T(a[o]++,o))}}function I(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){8<e.bi_valid?M(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function L(e,t,n,i){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]}function O(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&L(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!L(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function R(e,t,n){var i,r,s,o,u=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],r=e.pending_buf[e.l_buf+u],u++,0===i?P(e,r,t):(P(e,(s=v[r])+a+1,t),0!==(o=l[s])&&w(e,r-=g[s],o),P(e,s=k(--i),n),0!==(o=c[s])&&w(e,i-=x[s],o)),u<e.last_lit;);P(e,256,t)}function N(e,t){var n,i,r,a=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,o&&(e.static_len-=s[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)O(e,a,n);for(r=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],O(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*r]=a[2*n]+a[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=r,e.heap[1]=r++,O(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,a,s,o,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,v=0;for(a=0;a<=u;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)m<(a=l[2*l[2*(i=e.heap[n])+1]+1]+1)&&(a=m,v++),l[2*i+1]=a,c<i||(e.bl_count[a]++,s=0,p<=i&&(s=f[i-p]),o=l[2*i],e.opt_len+=o*(a+s),d&&(e.static_len+=o*(h[2*i+1]+s)));if(0!==v){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,v-=2}while(0<v);for(a=m;0!==a;a--)for(i=e.bl_count[a];0!==i;)c<(r=e.heap[--n])||(l[2*r+1]!==a&&(e.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),i--)}}(e,t),C(a,c,e.bl_count)}function B(e,t,n){var i,r,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=t[2*(i+1)+1],++o<u&&r===s||(o<l?e.bl_tree[2*r]+=o:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=r,l=(o=0)===s?(u=138,3):r===s?(u=6,3):(u=7,4))}function D(e,t,n){var i,r,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),i=0;i<=n;i++)if(r=s,s=t[2*(i+1)+1],!(++o<u&&r===s)){if(o<l)for(;P(e,r,e.bl_tree),0!=--o;);else 0!==r?(r!==a&&(P(e,r,e.bl_tree),o--),P(e,16,e.bl_tree),w(e,o-3,2)):o<=10?(P(e,17,e.bl_tree),w(e,o-3,3)):(P(e,18,e.bl_tree),w(e,o-11,7));a=r,l=(o=0)===s?(u=138,3):r===s?(u=6,3):(u=7,4)}}r(x);var F=!1;function j(e,t,n,r){w(e,0+(r?1:0),3),function(e,t,n,r){A(e),M(e,n),M(e,~n),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){F||(function(){var e,t,n,i,r,a=new Array(16);for(i=n=0;i<28;i++)for(g[i]=n,e=0;e<1<<l[i];e++)v[n++]=i;for(v[n-1]=i,i=r=0;i<16;i++)for(x[i]=r,e=0;e<1<<c[i];e++)m[r++]=i;for(r>>=7;i<o;i++)for(x[i]=r<<7,e=0;e<1<<c[i]-7;e++)m[256+r++]=i;for(t=0;t<=u;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(C(f,287,a),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=T(e,5);y=new _(f,l,257,s,u),b=new _(p,c,0,o,u),S=new _(new Array(0),h,0,19,7)}(),F=!0),e.l_desc=new E(e.dyn_ltree,y),e.d_desc=new E(e.dyn_dtree,b),e.bl_desc=new E(e.bl_tree,S),e.bi_buf=0,e.bi_valid=0,I(e)},n._tr_stored_block=j,n._tr_flush_block=function(e,t,n,i){var r,s,o=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),N(e,e.l_desc),N(e,e.d_desc),o=function(e){var t;for(B(e,e.dyn_ltree,e.l_desc.max_code),B(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==t?j(e,t,n,i):4===e.strategy||s===r?(w(e,2+(i?1:0),3),R(e,f,p)):(w(e,4+(i?1:0),3),function(e,t,n,i){var r;for(w(e,t-257,5),w(e,n-1,5),w(e,i-4,4),r=0;r<i;r++)w(e,e.bl_tree[2*d[r]+1],3);D(e,e.dyn_ltree,t-1),D(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),R(e,e.dyn_ltree,e.dyn_dtree)),I(e),i&&A(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(v[n]+a+1)]++,e.dyn_dtree[2*k(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){w(e,2,3),P(e,256,f),function(e){16===e.bi_valid?(M(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){"use strict";t.exports="function"==typeof i?i:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)},2043:function(e,t,n){var i,r;!function(a,s){"use strict";i=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?a:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):e)}function o(t,n){for(var r=0;r<i.length;r++){var a=i[r];this[a]=r<t?e:this.methodFactory(a,t,n)}this.log=this.debug}function u(e,n,i){return function(){typeof console!==t&&(o.call(this,n,i),this[e].apply(this,arguments))}}function l(e,t,n){return s(e)||u.apply(this,arguments)}function c(e,n,r){var a,s=this;n=null==n?"WARN":n;var u="loglevel";function c(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(u)+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||l,s.getLevel=function(){return a},s.setLevel=function(n,r){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==r&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}(n),o.call(s,n,e),typeof console===t&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){n=e,c()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(n,!1),function(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var h=c();null==h&&(h=n),s.setLevel(h,!1)}var h=new c,d={};h.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new c(e,h.getLevel(),h.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return h.noConflict=function(){return typeof window!==t&&window.log===h&&(window.log=f),h},h.getLoggers=function(){return d},h.default=h,h},void 0===(r=i.call(t,n,t,e))||(e.exports=r)}()},2846:function(e){e.exports=function e(t,n,i){function r(s,o){if(!n[s]){if(!t[s]){if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,(function(e){return r(t[s][1][e]||e)}),l,l.exports,e,t,n,i)}return n[s].exports}for(var a=void 0,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)},8681:function(e,t,n){"use strict";function i(e,t){return Array(t+1).join(e)}function r(e){return"number"==typeof e}function a(e,t){return Math.pow(2,(e-69)/12)*(t||440)}n.r(t),n.d(t,{acc:function(){return p},alt:function(){return g},build:function(){return c},chroma:function(){return y},freq:function(){return d},letter:function(){return f},midi:function(){return h},oct:function(){return b},parse:function(){return l},pc:function(){return m},regex:function(){return o},step:function(){return v}});var s=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function o(){return s}var u=[0,2,4,5,7,9,11];function l(e,t,n){if("string"!=typeof e)return null;var i=s.exec(e);if(!i||!t&&i[4])return null;var r={letter:i[1].toUpperCase(),acc:i[2].replace(/x/g,"##")};r.pc=r.letter+r.acc,r.step=(r.letter.charCodeAt(0)+3)%7,r.alt="b"===r.acc[0]?-r.acc.length:r.acc.length;var o=u[r.step]+r.alt;return r.chroma=o<0?12+o:o%12,i[3]&&(r.oct=+i[3],r.midi=o+12*(r.oct+1),r.freq=a(r.midi,n)),t&&(r.tonicOf=i[4]),r}function c(e,t,n){return null==e?null:e.step?c(e.step,e.alt,e.oct):e<0||e>6?null:"CDEFGAB".charAt(e)+(r(a=t)?a<0?i("b",-a):i("#",a):"")+function(e){return r(e)?""+e:""}(n);var a}function h(e){if((r(e)||"string"==typeof e)&&e>=0&&e<128)return+e;var t=l(e);return t&&void 0!==t.midi?t.midi:null}function d(e,t){var n=h(e);return null===n?null:a(n,t)}function f(e){return(l(e)||{}).letter}function p(e){return(l(e)||{}).acc}function m(e){return(l(e)||{}).pc}function v(e){return(l(e)||{}).step}function g(e){return(l(e)||{}).alt}function y(e){return(l(e)||{}).chroma}function b(e){return(l(e)||{}).oct}},9316:function(e){e.exports=function(e){return e.on=function(t,n){if(1===arguments.length&&"function"==typeof t)return e.on("event",t);var i="on"+t;return e[i]?e[i].push(n):e[i]=[n],e},e}},224:function(e,t,n){"use strict";var i=n(9451),r=n(9316),a=n(3861),s=n(6041),o=n(1549);function u(e,t,n){return o(s(a(r(i(e,t,n)))))}e.exports&&(e.exports=u),"undefined"!=typeof window&&(window.SamplePlayer=u)},1549:function(e,t,n){var i=n(2846);e.exports=function(e){return e.listenToMidi=function(t,n){var r={},a=n||{},s=a.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:i(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!a.channel||n.channel===a.channel)switch(n.messageType){case"noteon":r[n.key]=e.play(n.key,0,{gain:s(n.velocity)});break;case"noteoff":r[n.key]&&(r[n.key].stop(),delete r[n.key])}},e},e}},3861:function(e,t,n){"use strict";var i=n(9046),r=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:i.midi(e)};e.exports=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:r,i=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce((function(n,i){return n[t(i)]=e[i],n}),{})}(e.buffers,i);var a=e.start;e.start=function(e,t,n){var r=i(e),s=r%1;return s&&(r=Math.floor(r),n=Object.assign(n||{},{cents:Math.floor(100*s)})),a(r,t,n)}}return e}},9451:function(e,t,n){"use strict";var i=n(7729),r={},a={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function s(e){return"number"==typeof e}var o=["attack","decay","sustain","release"];function u(e,t,n){var r=i(e),a=t.adsr||n.adsr;return o.forEach((function(e,i){r[e]=a?a[i]:t[e]||n[e]})),r.value.value=s(t.gain)?t.gain:s(n.gain)?n.gain:1,r}function l(e){return e?Math.pow(2,e/1200):1}e.exports=function(e,t,n){var i=!1,s=0,o={},c=e.createGain();c.gain.value=1;var h=Object.assign({},a,n),d={context:e,out:c,opts:h};return t instanceof AudioBuffer?d.buffer=t:d.buffers=t,d.start=function(t,n,a){if(d.buffer&&null!==t)return d.start(null,t,n);var u=t?d.buffers[t]:d.buffer;if(u){if(i){var l,c=a||r;for(var h in n=Math.max(e.currentTime,n||0),d.emit("start",n,t,c),o)u===o[h].source.buffer&&o[h].startTime+u.duration<n&&(l=p(o[h],u,c));return l||((l=f(t,u,c)).id=function(t,n){return n.id=s++,o[n.id]=n,n.startTime=e.currentTime,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),d.emit("ended",t,n.id,n)},n.id}(0,l)),l.env.start(n),l.source.start(n),d.emit("started",n,l.id,l),c.duration&&l.stop(n+c.duration),l}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},d.play=function(e,t,n){return d.start(e,t,n)},d.stop=function(e,t){var n;return(t=t||Object.keys(o)).map((function(t){return(n=o[t])?(n.stop(e),n.id):null}))},d.connect=function(e){return i=!0,c.connect(e),d},d.emit=function(e,t,n,i){d.onevent&&d.onevent(e,t,n,i);var r=d["on"+e];r&&r.forEach((function(e){e(t,n,i)}))},d;function f(t,n,i){var r=e.createGain();return r.gain.value=0,r.connect(c),r.env=u(e,i,h),r.env.connect(r.gain),r.source=e.createBufferSource(),r.source.buffer=n,r.source.connect(r),r.source.loop=i.loop||h.loop,r.source.playbackRate.value=l(i.cents||h.cents),r.source.loopStart=i.loopStart||h.loopStart,r.source.loopEnd=i.loopEnd||h.loopEnd,r.stop=function(n){var i=n||e.currentTime;d.emit("stop",i,t);var a=r.env.stop(i);r.source.stop(a)},r}function p(t,n,i){var r=t;return r.gain.value=0,r.connect(c),r.env=u(e,i,h),r.env.connect(r.gain),r.source=e.createBufferSource(),r.source.buffer=n,r.source.connect(r),r.source.loop=i.loop||h.loop,r.source.playbackRate.value=l(i.cents||h.cents),r.source.loopStart=i.loopStart||h.loopStart,r.source.loopEnd=i.loopEnd||h.loopEnd,r}}},6041:function(e){"use strict";var t=Array.isArray,n={};e.exports=function(e){return e.schedule=function(i,r){var a,s,o,u,l=e.context.currentTime,c=i<l?l:i;return e.emit("schedule",c,r),r.map((function(i){return i?(t(i)?(a=i[0],s=i[1]):(a=i.time,s=i),function(e){return e&&"object"==typeof e}(s)?(o=s.name||s.key||s.note||s.midi||null,u=s):(o=s,u=n),e.start(o,c+(a||0),u)):null}))},e}},9046:function(e){"use strict";var t=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function i(e,i,a){if("string"!=typeof e)return null;var s=t.exec(e);if(!s||!i&&s[4])return null;var o={letter:s[1].toUpperCase(),acc:s[2].replace(/x/g,"##")};return o.pc=o.letter+o.acc,o.step=(o.letter.charCodeAt(0)+3)%7,o.alt="b"===o.acc[0]?-o.acc.length:o.acc.length,o.chroma=n[o.step]+o.alt,s[3]&&(o.oct=+s[3],o.midi=o.chroma+12*(o.oct+1),o.freq=r(o.midi,a)),i&&(o.tonicOf=s[4]),o}function r(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var a={parse:i,regex:function(){return t},midiToFreq:r};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(e){a[e]=function(t){var n=i(t);return n&&void 0!==n[e]?n[e]:null}})),e.exports=a},8346:function(e,t,n){"use strict";var i=n(7665),r=n(224);function a(e){return/\.js(\?.*)?$/i.test(e)}function s(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}var o=n(975);o.instrument=function e(t,n,o){if(1===arguments.length)return function(n,i){return e(t,n,i)};var u=o||{},l=u.isSoundfontURL||a,c=u.nameToUrl||s,h=l(n)?n:c(n,u.soundfont,u.format);return i(t,h,{only:u.only||u.notes}).then((function(e){var i=r(t,e,u).connect(u.destination?u.destination:t.destination);return i.url=h,i.name=n,i}))},o.nameToUrl=s,e.exports&&(e.exports=o),"undefined"!=typeof window&&(window.Soundfont=o)},975:function(e,t,n){"use strict";var i=n(8681);function r(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof r))return new r(e);this.nameToUrl=t||r.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function a(e,t){return t=t||{},function(n,r,a,s){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var o=n>0&&n<129?+n:i.midi(n),u=o?i.midiToFreq(o,440):null;if(u){a=a||.2;var l=(s=s||{}).destination||t.destination||e.destination,c=s.vcoType||t.vcoType||"sine",h=s.gain||t.gain||.4,d=e.createOscillator();d.type=c,d.frequency.value=u;var f=e.createGain();return f.gain.value=h,d.connect(f),f.connect(l),d.start(r),a>0&&d.stop(r+a),d}}}r.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},r.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var i={name:e,play:a(n,t)};if(this.instruments[e]=i,"default"!==e){var s=r.instrument(n,e,t).then((function(e){return i.play=e.play,i}));this.promises.push(s),i.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),s.then(e)}}else i.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return i},r.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),r.instrument(e,t,n).then((function(e){return e.buffers}))},r.noteToMidi=i.midi,e.exports=r},807:function(e,t,n){"use strict";n.r(t),n.d(t,{AnalyserNode:function(){return rn},AudioBuffer:function(){return cn},AudioBufferSourceNode:function(){return yn},AudioContext:function(){return Ci},AudioWorkletNode:function(){return Wi},BiquadFilterNode:function(){return _n},ChannelMergerNode:function(){return Pn},ChannelSplitterNode:function(){return Cn},ConstantSourceNode:function(){return On},ConvolverNode:function(){return Bn},DelayNode:function(){return Fn},DynamicsCompressorNode:function(){return Gn},GainNode:function(){return Un},IIRFilterNode:function(){return Kn},MediaElementAudioSourceNode:function(){return ki},MediaStreamAudioDestinationNode:function(){return Mi},MediaStreamAudioSourceNode:function(){return wi},MediaStreamTrackAudioSourceNode:function(){return Ti},MinimalAudioContext:function(){return Ui},MinimalOfflineAudioContext:function(){return Xi},OfflineAudioContext:function(){return Yi},OscillatorNode:function(){return ei},PannerNode:function(){return oi},PeriodicWave:function(){return li},StereoPannerNode:function(){return fi},WaveShaperNode:function(){return mi},addAudioWorkletModule:function(){return Si},decodeAudioData:function(){return _i},isAnyAudioContext:function(){return Ki},isAnyAudioNode:function(){return qi},isAnyAudioParam:function(){return Zi},isAnyOfflineAudioContext:function(){return Ji},isSupported:function(){return Qi}});var i=n(5382),r=new WeakSet,a=new WeakMap,s=new WeakMap,o=new WeakMap,u=new WeakMap,w=new WeakMap,P=new WeakMap,T=new WeakMap,C=new WeakMap,I=new WeakMap,A={construct:function(){return A}},L=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,O=function(e,t){for(var n=[],i=e.replace(/^[\s]+/,""),r=i.match(L);null!==r;){var a=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(a,new URL(a,t).toString());n.push(s),r=(i=i.slice(r[0].length).replace(/^[\s]+/,"")).match(L)}return[n.join(";"),i]},R=function(e){if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},N=function(e){if(!function(e){try{new new Proxy(e,A)}catch(t){return!1}return!0}(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},B=function(e,t){var n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},D=function(e,t){var n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var i=x(n,1)[0];return e.delete(i),i},F=function(e,t,n,i){var r=B(e,t),a=D(r,(function(e){return e[0]===n&&e[1]===i}));return 0===r.size&&e.delete(t),a},j=function(e){return B(P,e)},V=function(e){if(r.has(e))throw new Error("The AudioNode is already stored.");r.add(e),j(e).forEach((function(e){return e(!0)}))},G=function(e){return"port"in e},W=function(e){if(!r.has(e))throw new Error("The AudioNode is not stored.");r.delete(e),j(e).forEach((function(e){return e(!1)}))},U=function(e,t){!G(e)&&t.every((function(e){return 0===e.size}))&&W(e)},z={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},H=function(e,t){return e.context===t},X=function(e){try{e.copyToChannel(new Float32Array(1),0,-1)}catch(t){return!1}return!0},Y=function(){return new DOMException("","IndexSizeError")},K=function(e){var t;e.getChannelData=(t=e.getChannelData,function(n){try{return t.call(e,n)}catch(e){if(12===e.code)throw Y();throw e}})},q={numberOfChannels:1},Z=-34028234663852886e22,J=-Z,Q=function(e){return r.has(e)},$={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},ee=function(e){return B(a,e)},te=function(e){return B(o,e)},ne=function e(t,n){ee(t).activeInputs.forEach((function(i){return i.forEach((function(i){var r=x(i,1)[0];n.includes(t)||e(r,[].concat(S(n),[t]))}))}));var i,r=function(e){return"playbackRate"in e}(t)?[t.playbackRate]:G(t)?Array.from(t.parameters.values()):function(e){return"frequency"in e&&"gain"in e}(t)?[t.Q,t.detune,t.frequency,t.gain]:function(e){return"offset"in e}(t)?[t.offset]:function(e){return!("frequency"in e)&&"gain"in e}(t)?[t.gain]:function(e){return"detune"in e&&"frequency"in e}(t)?[t.detune,t.frequency]:function(e){return"pan"in e}(t)?[t.pan]:[],a=b(r);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=te(s);void 0!==o&&o.activeInputs.forEach((function(t){var i=x(t,1)[0];return e(i,n)}))}}catch(u){a.e(u)}finally{a.f()}Q(t)&&W(t)},ie=function(e){ne(e.destination,[])},re=function(e){return void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e)},ae=function(e){return"context"in e},se=function(e){return ae(e[0])},oe=function(e,t,n,i){var r,a=b(e);try{for(a.s();!(r=a.n()).done;)if(n(r.value)){if(i)return!1;throw Error("The set contains at least one similar element.")}}catch(s){a.e(s)}finally{a.f()}return e.add(t),!0},ue=function(e,t,n,i){var r=x(n,2),a=r[0],s=r[1];oe(e,[t,a,s],(function(e){return e[0]===t&&e[1]===a}),i)},le=function(e,t,n){var i=x(t,3),r=i[0],a=i[1],s=i[2],o=e.get(r);void 0===o?e.set(r,new Set([[a,s]])):oe(o,[a,s],(function(e){return e[0]===a}),n)},ce=function(e){return"inputs"in e},he=function(e,t,n,i){if(ce(t)){var r=t.inputs[i];return e.connect(r,n,0),[r,n,0]}return e.connect(t,n,i),[t,n,i]},de=function(e,t,n){var i,r=b(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a[0]===t&&a[1]===n)return e.delete(a),a}}catch(s){r.e(s)}finally{r.f()}return null},fe=function(e,t){if(!j(e).delete(t))throw new Error("Missing the expected event listener.")},pe=function(e,t,n){var i=B(e,t),r=D(i,(function(e){return e[0]===n}));return 0===i.size&&e.delete(t),r},me=function(e,t,n,i){ce(t)?e.disconnect(t.inputs[i],n,0):e.disconnect(t,n,i)},ve=function(e){return B(s,e)},ge=function(e){return B(u,e)},ye=function(e){return T.has(e)},be=function(e){return!r.has(e)},Se=function(e,t){return new Promise((function(n){if(null!==t)n(!0);else{var i=e.createScriptProcessor(256,1,1),r=e.createGain(),a=e.createBuffer(1,2,44100),s=a.getChannelData(0);s[0]=1,s[1]=1;var o=e.createBufferSource();o.buffer=a,o.loop=!0,o.connect(i).connect(e.destination),o.connect(r),o.disconnect(r),i.onaudioprocess=function(t){var r=t.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(function(e){return 1===e}))?n(!0):n(!1),o.stop(),i.onaudioprocess=null,o.disconnect(i),i.disconnect(e.destination)},o.start()}}))},xe=function(e,t){var n,i=new Map,r=b(e);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=b(s);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=i.get(u);i.set(u,void 0===l?1:l+1)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}i.forEach((function(e,n){return t(n,e)}))},_e=function(e){return"context"in e},Ee=function(e){var t,n,i=new Map;e.connect=(t=e.connect.bind(e),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=_e(e)?t(e,n,r):t(e,n),s=i.get(e);return void 0===s?i.set(e,[{input:r,output:n}]):s.every((function(e){return e.input!==r||e.output!==n}))&&s.push({input:r,output:n}),a}),e.disconnect=(n=e.disconnect,function(t,r,a){if(n.apply(e),void 0===t)i.clear();else if("number"==typeof t){var s,o=b(i);try{for(o.s();!(s=o.n()).done;){var u=x(s.value,2),l=u[0],c=u[1].filter((function(e){return e.output!==t}));0===c.length?i.delete(l):i.set(l,c)}}catch(v){o.e(v)}finally{o.f()}}else if(i.has(t))if(void 0===r)i.delete(t);else{var h=i.get(t);if(void 0!==h){var d=h.filter((function(e){return e.output!==r&&(e.input!==a||void 0===a)}));0===d.length?i.delete(t):i.set(t,d)}}var f,p=b(i);try{var m=function(){var t=x(f.value,2),n=t[0];t[1].forEach((function(t){_e(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)}))};for(p.s();!(f=p.n()).done;)m()}catch(v){p.e(v)}finally{p.f()}})},ke=function(e,t,n,i,r){var a=function(e,t,n,i){var r=ee(t),a=r.activeInputs,s=r.passiveInputs,o=de(a[i],e,n);return null===o?[F(s,e,n,i)[2],!1]:[o[2],!0]}(e,n,i,r),s=x(a,2),o=s[0],u=s[1];if(null!==o&&(fe(e,o),!u||t||ye(e)||me(ve(e),ve(n),i,r)),Q(n)){var l=ee(n).activeInputs;U(n,l)}},Me=function(e,t,n,i){var r=function(e,t,n){var i=te(t),r=i.activeInputs,a=i.passiveInputs,s=de(r,e,n);return null===s?[pe(a,e,n)[1],!1]:[s[2],!0]}(e,n,i),a=x(r,2),s=a[0],o=a[1];null!==s&&(fe(e,s),!o||t||ye(e)||ve(e).disconnect(ge(n),i))},we=function(){function e(t){g(this,e),this._map=new Map(t)}return y(e,[{key:"size",get:function(){return this._map.size}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((function(i,r){return e.call(n,i,r,t)}))}},{key:"get",value:function(e){return this._map.get(e)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}}]),e}(),Pe={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Te(e,t,n,i,r){if("function"==typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],i,r);else{var a=e.getChannelData(i);if(0===t[n].byteLength)t[n]=a.slice(r,r+128);else{var s=new Float32Array(a.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(s)}}}var Ce=function(e,t,n,i,r){"function"==typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],i,r):0!==t[n].byteLength&&e.getChannelData(i).set(t[n],r)},Ie=function(e,t){for(var n=[],i=0;i<e;i+=1){for(var r=[],a="number"==typeof t?t:t[i],s=0;s<a;s+=1)r.push(new Float32Array(128));n.push(r)}return n},Ae=function(){var e=v(f.mark((function e(t,n,i,r,a,s,o){var u,l,c,h,d,v,g,y,b,S,x;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null===n?128*Math.ceil(t.context.length/128):n.length,l=r.channelCount*r.numberOfInputs,c=a.reduce((function(e,t){return e+t}),0),h=0===c?null:i.createBuffer(c,u,i.sampleRate),void 0!==s){e.next=3;break}throw new Error("Missing the processor constructor.");case 3:return d=ee(t),e.next=6,function(e,t){var n=B(I,e),i=ve(t);return B(n,i)}(i,t);case 6:v=e.sent,g=Ie(r.numberOfInputs,r.channelCount),y=Ie(r.numberOfOutputs,a),b=Array.from(t.parameters.keys()).reduce((function(e,t){return m(m({},e),{},p({},t,new Float32Array(128)))}),{}),S=function(e){if(r.numberOfInputs>0&&null!==n)for(var u=0;u<r.numberOfInputs;u+=1)for(var c=0;c<r.channelCount;c+=1)Te(n,g[u],c,c,e);void 0!==s.parameterDescriptors&&null!==n&&s.parameterDescriptors.forEach((function(t,i){var r=t.name;Te(n,b,r,l+i,e)}));for(var f=0;f<r.numberOfInputs;f+=1)for(var p=0;p<a[f];p+=1)0===y[f][p].byteLength&&(y[f][p]=new Float32Array(128));try{var m=g.map((function(e,t){return 0===d.activeInputs[t].size?[]:e})),S=o(e/i.sampleRate,i.sampleRate,(function(){return v.process(m,y,b)}));if(null!==h)for(var x=0,_=0;x<r.numberOfOutputs;x+=1){for(var E=0;E<a[x];E+=1)Ce(h,y[x],E,_+E,e);_+=a[x]}if(!S)return"break"}catch(n){return t.dispatchEvent(new ErrorEvent("processorerror",{colno:n.colno,filename:n.filename,lineno:n.lineno,message:n.message})),"break"}},x=0;case 12:if(!(x<u)){e.next=19;break}if("break"!==S(x)){e.next=16;break}return e.abrupt("break",19);case 16:x+=128,e.next=12;break;case 19:return e.abrupt("return",h);case 20:case"end":return e.stop()}}),e)})));return function(t,n,i,r,a,s,o){return e.apply(this,arguments)}}(),Le={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Oe={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Re={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ne={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Be={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},De=function(e){var t=new MessageChannel,n=t.port1,i=t.port2;return new Promise((function(t){var r=function(){i.onmessage=null,n.close(),i.close(),t()};i.onmessage=function(){return r()};try{n.postMessage(e,[e])}finally{r()}}))},Fe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},je=function(e,t,n){var i=t[n];if(void 0===i)throw e();return i},Ve={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ge={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},We=function(){return new DOMException("","InvalidStateError")},Ue=function(){return new DOMException("","InvalidAccessError")},ze={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},He=function(e,t,n,i,r,a,s,o,u,l,c){for(var h=l.length,d=o,f=0;f<h;f+=1){for(var p=n[0]*l[f],m=1;m<r;m+=1){var v=d-m&u-1;p+=n[m]*a[v],p-=e[m]*s[v]}for(var g=r;g<i;g+=1)p+=n[g]*a[d-g&u-1];for(var y=r;y<t;y+=1)p-=e[y]*s[d-y&u-1];a[d]=l[f],s[d]=p,d=d+1&u-1,c[f]=p}return d},Xe={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Ye=function(e){var t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=e.decodeAudioData(t.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(i){}return!1},Ke={numberOfChannels:1},qe=function(e,t,n){var i=t[n];void 0!==i&&i!==e[n]&&(e[n]=i)},Ze=function(e,t){qe(e,t,"channelCount"),qe(e,t,"channelCountMode"),qe(e,t,"channelInterpretation")},Je=function(e){return"function"==typeof e.getFloatTimeDomainData},Qe=function(e,t,n){var i=t[n];void 0!==i&&i!==e[n].value&&(e[n].value=i)},$e=function(e){var t;e.start=(t=e.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,i,r)})},et=function(e){var t;e.stop=(t=e.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},tt=function(e,t){return null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t)))))},nt=function(e,t){var n=e.createBiquadFilter();return Ze(n,t),Qe(n,t,"Q"),Qe(n,t,"detune"),Qe(n,t,"frequency"),Qe(n,t,"gain"),qe(n,t,"type"),n},it=function(e,t){var n=e.createChannelSplitter(t.numberOfOutputs);return Ze(n,t),function(e){var t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:function(){return t},set:function(e){if(e!==t)throw We()}}),Object.defineProperty(e,"channelCountMode",{get:function(){return"explicit"},set:function(e){if("explicit"!==e)throw We()}}),Object.defineProperty(e,"channelInterpretation",{get:function(){return"discrete"},set:function(e){if("discrete"!==e)throw We()}})}(n),n},rt=function(e,t){return e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e},at=function(e,t){var n=e.createDelay(t.maxDelayTime);return Ze(n,t),Qe(n,t,"delayTime"),n},st=function(e,t){var n=e.createGain();return Ze(n,t),Qe(n,t,"gain"),n};function ot(e,t){var n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function ut(e,t){for(var n,i,r=[0,0],a=e.length-1;a>=0;a-=1)i=t,(r=[(n=r)[0]*i[0]-n[1]*i[1],n[0]*i[1]+n[1]*i[0]])[0]+=e[a];return r}var lt,ct,ht,dt,ft,pt,mt=function(e,t,n,i){return e.createScriptProcessor(t,n,i)},vt=function(){return new DOMException("","NotSupportedError")},gt={numberOfChannels:1},yt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},bt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},St={disableNormalization:!1},xt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},_t=function(){return new DOMException("","UnknownError")},Et={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},kt=function(e,t,n){return void 0===e.copyFromChannel?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0])},Mt=function(e){if(null===e)return!1;var t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},wt=function(e,t,n,i){for(var r=e;!r.hasOwnProperty(t);)r=Object.getPrototypeOf(r);var a=Object.getOwnPropertyDescriptor(r,t),s=a.get,o=a.set;Object.defineProperty(e,t,{get:n(s),set:i(o)})},Pt=function e(t,n,r){try{t.setValueAtTime(n,r)}catch(i){if(9!==i.code)throw i;e(t,n,r+1e-7)}},Tt=function(e){var t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},Ct=function(e){var t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch(i){return!1}},It=function(e){var t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},At=function(){try{new DOMException}catch(e){return!1}return!0},Lt=function(){return new Promise((function(e){var t=new ArrayBuffer(0),n=new MessageChannel,i=n.port1,r=n.port2;i.onmessage=function(t){var n=t.data;return e(null!==n)},r.postMessage(t,[t])}))},Ot=function(e,t){var n=t.createGain();e.connect(n);var i,r=(i=e.disconnect,function(){i.call(e,n),e.removeEventListener("ended",r)});e.addEventListener("ended",r),rt(e,n),e.stop=function(t){var i=!1;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(i)try{t.call(e,r)}catch(a){n.gain.setValueAtTime(0,r)}else t.call(e,r),i=!0}}(e.stop)},Rt=function(e,t){return function(n){var i={value:e};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof t?t.call(e,n):t.handleEvent.call(e,n)}},Nt=function(e){return function(t,n,i,r){var a=x(i,3),s=a[0],o=a[1],u=a[2];e(t[o],[n,s,u],(function(e){return e[0]===n&&e[1]===s}),r)}}(oe),Bt=function(e){return function(t,n,i,r){var a=x(i,3),s=a[0],o=a[1],u=a[2],l=t.get(s);void 0===l?t.set(s,new Set([[o,n,u]])):e(l,[o,n,u],(function(e){return e[0]===o&&e[1]===n}),r)}}(oe),Dt=function(e){return function(t,n,i,r){return e(t[r],(function(e){return e[0]===n&&e[1]===i}))}}(D),Ft=new WeakMap,jt=function(e){return function(t){var n;return null!==(n=e.get(t))&&void 0!==n?n:0}}(Ft),Vt=(lt=new Map,ct=new WeakMap,function(e,t){var n=ct.get(e);if(void 0!==n)return n;var i=lt.get(e);if(void 0!==i)return i;try{var r=t();return r instanceof Promise?(lt.set(e,r),r.catch((function(){return!1})).then((function(t){return lt.delete(e),ct.set(e,t),t}))):(ct.set(e,r),r)}catch(a){return ct.set(e,!1),!1}}),Gt="undefined"==typeof window?null:window,Wt=function(e,t){return function(n,i){var r=n.createAnalyser();if(Ze(r,i),!(i.maxDecibels>i.minDecibels))throw t();return qe(r,i,"fftSize"),qe(r,i,"maxDecibels"),qe(r,i,"minDecibels"),qe(r,i,"smoothingTimeConstant"),e(Je,(function(){return Je(r)}))||function(e){e.getFloatTimeDomainData=function(t){var n=new Uint8Array(t.length);e.getByteTimeDomainData(n);for(var i=Math.max(n.length,e.fftSize),r=0;r<i;r+=1)t[r]=.0078125*(n[r]-128);return t}}(r),r}}(Vt,Y),Ut=function(e){return function(t){var n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer}}(ee),zt=function(e,t,n){return function(){var i=v(f.mark((function i(r,a,s){var o;return f.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=e(r),i.next=3,Promise.all(o.activeInputs.map((function(e,i){return Array.from(e).map(function(){var e=v(f.mark((function e(o){var u,l,c,h,d,p;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=x(o,2),l=u[0],c=u[1],h=t(l),e.next=4,h.render(l,a);case 4:d=e.sent,p=r.context.destination,n(l)||r===p&&n(r)||d.connect(s,c,i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).reduce((function(e,t){return[].concat(S(e),S(t))}),[]));case 3:case"end":return i.stop()}}),i)})));return function(e,t,n){return i.apply(this,arguments)}}()}(ee,Ut,ye),Ht=function(e,t,n){return function(){var i=new WeakMap;return{render:function(r,a){var s=i.get(a);return void 0!==s?Promise.resolve(s):function(){var r=v(f.mark((function r(a,s){var o,u;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t(a),H(o,s)||(u={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant},o=e(s,u)),i.set(s,o),r.next=5,n(a,s,o);case 5:return r.abrupt("return",o);case 6:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()(r,a)}}}}(Wt,ve,zt),Xt=(ht=w,function(e){var t=ht.get(e);if(void 0===t)throw We();return t}),Yt=function(e){return null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null}(Gt),Kt=function(e){return function(t){return null!==e&&t instanceof e}}(Yt),qt=new WeakMap,Zt=function(e){return function(){function t(e){g(this,t),this._nativeEventTarget=e,this._listeners=new WeakMap}return y(t,[{key:"addEventListener",value:function(t,n,i){if(null!==n){var r=this._listeners.get(n);void 0===r&&(r=e(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(t,r,i)}}},{key:"dispatchEvent",value:function(e){return this._nativeEventTarget.dispatchEvent(e)}},{key:"removeEventListener",value:function(e,t,n){var i=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===i?null:i,n)}}]),t}()}(Rt),Jt=function(e){return null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null}(Gt),Qt=function(e){return function(t){return null!==e&&t instanceof e}}(Jt),$t=function(e){return function(t){return null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode}}(Gt),en=function(e){return function(t){return null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam}}(Gt),tn=function(e){return null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null}(Gt),nn=function(e,t,n,i,r,a,o,u,l,f,p,m,v,x,_,E){return function(f){h(M,f);var k=d(M);function M(t,i,r,a){var o;g(this,M),(o=k.call(this,r))._context=t,o._nativeAudioNode=r;var u=p(t);return m(u)&&!0!==n(Se,(function(){return Se(u,E)}))&&Ee(r),s.set(c(o),r),P.set(c(o),new Set),"closed"!==t.state&&i&&V(c(o)),e(c(o),a,r),o}return y(M,[{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(e){this._nativeAudioNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(e){this._nativeAudioNode.channelCountMode=e}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(e){this._nativeAudioNode.channelInterpretation=e}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}},{key:"connect",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();var u=p(this._context),c=_(u);if(v(e)||x(e))throw a();if(ae(e)){var h=ve(e);try{var d,f=he(this._nativeAudioNode,h,n,s),m=be(this);(c||m)&&(d=this._nativeAudioNode).disconnect.apply(d,S(f)),"closed"!==this.context.state&&!m&&be(e)&&V(e)}catch(e){if(12===e.code)throw a();throw e}if(t(this,e,n,s,c)){var g=l([this],e);xe(g,i(c))}return e}var y=ge(e);if("playbackRate"===y.name&&1024===y.maxValue)throw o();try{this._nativeAudioNode.connect(y,n),(c||be(this))&&this._nativeAudioNode.disconnect(y,n)}catch(e){if(12===e.code)throw a();throw e}if(function(e,t,n,i){var r=te(t),a=r.activeInputs,s=r.passiveInputs,o=ee(e).outputs,u=j(e),l=function(r){var o=ve(e),u=ge(t);if(r){var l=pe(s,e,n);ue(a,e,l,!1),i||ye(e)||o.connect(u,n)}else{var c=function(e,t,n){return D(e,(function(e){return e[0]===t&&e[1]===n}))}(a,e,n);le(s,c,!1),i||ye(e)||o.disconnect(u,n)}};return!!oe(o,[t,n],(function(e){return e[0]===t&&e[1]===n}),!0)&&(u.add(l),Q(e)?ue(a,e,[n,l],!0):le(s,[e,n,l],!0),!0)}(this,e,n,c)){var b=l([this],e);xe(b,i(c))}}},{key:"disconnect",value:function(e,t,n){var i,s=p(this._context),o=_(s);if(void 0===e)i=function(e,t){var n,i=ee(e),r=[],a=b(i.outputs);try{for(a.s();!(n=a.n()).done;){var s=n.value;se(s)?ke.apply(void 0,[e,t].concat(S(s))):Me.apply(void 0,[e,t].concat(S(s))),r.push(s[0])}}catch(o){a.e(o)}finally{a.f()}return i.outputs.clear(),r}(this,o);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw r();i=function(e,t,n){var i,r=ee(e),a=[],s=b(r.outputs);try{for(s.s();!(i=s.n()).done;){var o=i.value;o[1]===n&&(se(o)?ke.apply(void 0,[e,t].concat(S(o))):Me.apply(void 0,[e,t].concat(S(o))),a.push(o[0]),r.outputs.delete(o))}}catch(u){s.e(u)}finally{s.f()}return a}(this,o,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw r();if(ae(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw r();if(i=function(e,t,n,i,r){var a=ee(e);return Array.from(a.outputs).filter((function(e){return!(e[0]!==n||void 0!==i&&e[1]!==i||void 0!==r&&e[2]!==r)})).map((function(n){return se(n)?ke.apply(void 0,[e,t].concat(S(n))):Me.apply(void 0,[e,t].concat(S(n))),a.outputs.delete(n),n[0]}))}(this,o,e,t,n),0===i.length)throw a()}var c,h=b(i);try{for(h.s();!(c=h.n()).done;){var d=c.value,f=l([this],d);xe(f,u)}}catch(m){h.e(m)}finally{h.f()}}}]),M}(f)}((dt=a,function(e,t,n){for(var i=[],r=0;r<n.numberOfInputs;r+=1)i.push(new Set);dt.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),function(e,t,n,i,r,a,s,o,u,l,c,h,d){var f=new WeakMap;return function(p,m,v,g,y){var b=a(m),S=b.activeInputs,x=b.passiveInputs,_=a(p).outputs,E=o(p),k=function(a){var o=u(m),l=u(p);if(a){var b=F(x,p,v,g);e(S,p,b,!1),y||h(p)||n(l,o,v,g),d(m)&&V(m)}else{var _=i(S,p,v,g);t(x,g,_,!1),y||h(p)||r(l,o,v,g);var E=s(m);if(0===E)c(m)&&U(m,S);else{var k=f.get(m);void 0!==k&&clearTimeout(k),f.set(m,setTimeout((function(){c(m)&&U(m,S)}),1e3*E))}}};return!!l(_,[m,v,g],(function(e){return e[0]===m&&e[1]===v&&e[2]===g}),!0)&&(E.add(k),c(p)?e(S,p,[v,g,k],!0):t(x,g,[p,v,k],!0),!0)}}(Nt,Bt,he,Dt,me,ee,jt,j,ve,oe,Q,ye,be),Vt,function(e,t,n,i,r,a){return function(s){return function(o,u){var l=e.get(o);if(void 0===l){if(!s&&a(o)){var c,h=i(o),d=n(o).outputs,f=b(d);try{for(f.s();!(c=f.n()).done;){var p=c.value;if(se(p)){var m=i(p[0]);t(h,m,p[1],p[2])}else{var v=r(p[0]);h.disconnect(v,p[1])}}}catch(g){f.e(g)}finally{f.f()}}e.set(o,u)}else e.set(o,l+u)}}}(T,me,ee,ve,ge,Q),Y,Ue,vt,function(e,t,n,i,r,a,s,o){return function(u,l){var c=t.get(u);if(void 0===c)throw new Error("Missing the expected cycle count.");var h=a(u.context),d=o(h);if(c===l){if(t.delete(u),!d&&s(u)){var f,p=i(u),m=n(u).outputs,v=b(m);try{for(v.s();!(f=v.n()).done;){var g=f.value;if(se(g)){var y=i(g[0]);e(p,y,g[1],g[2])}else{var S=r(g[0]);p.connect(S,g[1])}}}catch(x){v.e(x)}finally{v.f()}}}else t.set(u,c-l)}}(he,T,ee,ve,ge,Xt,Q,Kt),function(e,t,n){return function i(r,a){var s=ae(a)?a:n(e,a);if(function(e){return"delayTime"in e}(s))return[];if(r[0]===s)return[r];if(r.includes(s))return[];var o=t(s).outputs;return Array.from(o).map((function(e){return i([].concat(S(r),[s]),e[0])})).reduce((function(e,t){return e.concat(t)}),[])}}(qt,ee,B),Zt,Xt,Qt,$t,en,Kt,tn),rn=function(e,t,n,i,r,a){return function(e){h(o,e);var s=d(o);function o(e,n){var u;g(this,o);var l=r(e),c=m(m({},z),n),h=i(l,c);return(u=s.call(this,e,!1,h,a(l)?t():null))._nativeAnalyserNode=h,u}return y(o,[{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(e){this._nativeAnalyserNode.fftSize=e}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(e){var t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(e){var t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(e){this._nativeAnalyserNode.smoothingTimeConstant=e}},{key:"getByteFrequencyData",value:function(e){this._nativeAnalyserNode.getByteFrequencyData(e)}},{key:"getByteTimeDomainData",value:function(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}},{key:"getFloatFrequencyData",value:function(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}},{key:"getFloatTimeDomainData",value:function(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}]),o}(e)}(nn,Ht,Y,Wt,Xt,Kt),an=new WeakSet,sn=function(e){return null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null}(Gt),on=(ft=new Uint32Array(1),function(e){return ft[0]=e,ft[0]}),un=function(e,t){return function(n){n.copyFromChannel=function(i,r){var a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),s=e(r);if(s>=n.numberOfChannels)throw t();for(var o=n.length,u=n.getChannelData(s),l=i.length,c=a<0?-a:0;c+a<o&&c<l;c+=1)i[c]=u[c+a]},n.copyToChannel=function(i,r){var a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),s=e(r);if(s>=n.numberOfChannels)throw t();for(var o=n.length,u=n.getChannelData(s),l=i.length,c=a<0?-a:0;c+a<o&&c<l;c+=1)u[c+a]=i[c]}}}(on,Y),ln=function(e){return function(t){t.copyFromChannel=function(n){return function(i,r){var a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),s=e(r);if(a<t.length)return n.call(t,i,s,a)}}(t.copyFromChannel),t.copyToChannel=function(n){return function(i,r){var a=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),s=e(r);if(a<t.length)return n.call(t,i,s,a)}}(t.copyToChannel)}}(on),cn=function(e,t,n,i,r,a,s,o){var u=null;return function(l){function c(l){if(g(this,c),null===r)throw new Error("Missing the native OfflineAudioContext constructor.");var h=m(m({},q),l),d=h.length,f=h.numberOfChannels,p=h.sampleRate;null===u&&(u=new r(1,1,44100));var v=null!==i&&t(a,a)?new i({length:d,numberOfChannels:f,sampleRate:p}):u.createBuffer(f,d,p);if(0===v.numberOfChannels)throw n();return"function"!=typeof v.copyFromChannel?(s(v),K(v)):t(X,(function(){return X(v)}))||o(v),e.add(v),v}return y(c,null,[{key:l,value:function(t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===c.prototype||e.has(t)}}]),c}(Symbol.hasInstance)}(an,Vt,vt,sn,Yt,function(e){return function(){if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch(t){return!1}return!0}}(sn),un,ln),hn=function(e){return function(t,n){var i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(t.destination);var r=function e(){n.removeEventListener("ended",e),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)}}(st),dn=function(e,t,n){return function(){var i=v(f.mark((function i(r,a,s){var o;return f.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=t(r),i.next=3,Promise.all(Array.from(o.activeInputs).map(function(){var t=v(f.mark((function t(i){var r,o,u,l,c;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=x(i,2),o=r[0],u=r[1],l=e(o),t.next=4,l.render(o,a);case 4:c=t.sent,n(o)||c.connect(s,u);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return i.stop()}}),i)})));return function(e,t,n){return i.apply(this,arguments)}}()}(Ut,te,ye),fn=function(e){return function(t,n,i){return e(n,t,i)}}(dn),pn=function(e,t,n,i,r,a,s,o,u,l,c){return function(u,h){var d=u.createBufferSource();return Ze(d,h),Qe(d,h,"playbackRate"),qe(d,h,"buffer"),qe(d,h,"loop"),qe(d,h,"loopEnd"),qe(d,h,"loopStart"),t(n,(function(){return n(u)}))||function(e){e.start=function(t){var n=!1;return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if(n)throw We();t.call(e,i,r,a),n=!0}}(e.start)}(d),t(i,(function(){return i(u)}))||function(e){var t;e.start=(t=e.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=e.buffer,s=null===a?i:Math.min(a.duration,i);null!==a&&s>a.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,s,r)})}(d),t(r,(function(){return r(u)}))||l(d,u),t(a,(function(){return a(u)}))||$e(d),t(s,(function(){return s(u)}))||c(d,u),t(o,(function(){return o(u)}))||et(d),e(u,d),d}}(hn,Vt,(function(e){var t=e.createBufferSource();t.start();try{t.start()}catch(n){return!0}return!1}),(function(e){var t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch(i){return!1}return!0}),(function(e){var t=e.createBufferSource();t.start();try{t.stop()}catch(n){return!1}return!0}),Tt,Ct,It,0,function(e){return function(t,n){var i=n.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=i),e(t,"buffer",(function(e){return function(){var n=e.call(t);return n===i?null:n}}),(function(e){return function(n){return e.call(t,null===n?i:n)}}))}}(wt),Ot),mn=function(e,t){return function(n,i,r){return e(i).replay(r),t(i,n,r)}}(function(e){return function(t){var n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(te),dn),vn=function(e,t,n,i,r){return function(){var a=new WeakMap,s=null,o=null;return{set start(e){s=e},set stop(e){o=e},render:function(u,l){var c=a.get(l);return void 0!==c?Promise.resolve(c):function(){var u=v(f.mark((function u(l,c){var h,d,p,m;return f.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(h=n(l),(d=H(h,c))||(m={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value},h=t(c,m),null!==s&&(p=h).start.apply(p,S(s)),null!==o&&h.stop(o)),a.set(c,h),!d){u.next=9;break}return u.next=7,e(c,l.playbackRate,h.playbackRate);case 7:u.next=11;break;case 9:return u.next=11,i(c,l.playbackRate,h.playbackRate);case 11:return u.next=13,r(l,c,h);case 13:return u.abrupt("return",h);case 14:case"end":return u.stop()}}),u)})));return function(e,t){return u.apply(this,arguments)}}()(u,l)}}}}(fn,pn,ve,mn,zt),gn=function(e,t,n,r,a,s,o,u,l,c,h,d,f){return function(r,p,m){var v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,y=new i.AutomationEventList(m.defaultValue),S=p?function(e){return{replay:function(t){var n,i=b(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if("exponentialRampToValue"===r.type){var a=r.endTime,s=r.value;t.exponentialRampToValueAtTime(s,a)}else if("linearRampToValue"===r.type){var o=r.endTime,u=r.value;t.linearRampToValueAtTime(u,o)}else if("setTarget"===r.type){var l=r.startTime,c=r.target,h=r.timeConstant;t.setTargetAtTime(c,l,h)}else if("setValue"===r.type){var d=r.startTime,f=r.value;t.setValueAtTime(f,d)}else{if("setValueCurve"!==r.type)throw new Error("Can't apply an unknown automation.");var p=r.duration,m=r.startTime,v=r.values;t.setValueCurveAtTime(v,m,p)}}}catch(g){i.e(g)}finally{i.f()}}}}(y):null,x={get defaultValue(){return m.defaultValue},get maxValue(){return null===v?m.maxValue:v},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(e){m.value=e,x.setValueAtTime(e,r.context.currentTime)},cancelAndHoldAtTime:function(e){if("function"==typeof m.cancelAndHoldAtTime)null===S&&y.flush(r.context.currentTime),y.add(a(e)),m.cancelAndHoldAtTime(e);else{var t=Array.from(y).pop();null===S&&y.flush(r.context.currentTime),y.add(a(e));var n=Array.from(y).pop();m.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return x},cancelScheduledValues:function(e){return null===S&&y.flush(r.context.currentTime),y.add(s(e)),m.cancelScheduledValues(e),x},exponentialRampToValueAtTime:function(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;return null===S&&y.flush(r.context.currentTime),y.add(o(e,t)),m.exponentialRampToValueAtTime(e,t),x},linearRampToValueAtTime:function(e,t){return null===S&&y.flush(r.context.currentTime),y.add(u(e,t)),m.linearRampToValueAtTime(e,t),x},setTargetAtTime:function(e,t,n){return null===S&&y.flush(r.context.currentTime),y.add(l(e,t,n)),m.setTargetAtTime(e,t,n),x},setValueAtTime:function(e,t){return null===S&&y.flush(r.context.currentTime),y.add(c(e,t)),m.setValueAtTime(e,t),x},setValueCurveAtTime:function(e,t,n){var i=e instanceof Float32Array?e:new Float32Array(e);if(null!==d&&"webkitAudioContext"===d.name){for(var a=t+n,s=r.context.sampleRate,o=Math.ceil(t*s),u=Math.floor(a*s),l=u-o,c=new Float32Array(l),p=0;p<l;p+=1){var v=(i.length-1)/n*((o+p)/s-t),g=Math.floor(v),b=Math.ceil(v);c[p]=g===b?i[g]:(1-(v-g))*i[g]+(1-(b-v))*i[b]}null===S&&y.flush(r.context.currentTime),y.add(h(c,t,n)),m.setValueCurveAtTime(c,t,n);var _=u/s;_<a&&f(x,c[c.length-1],_),f(x,i[i.length-1],a)}else null===S&&y.flush(r.context.currentTime),y.add(h(i,t,n)),m.setValueCurveAtTime(i,t,n);return x}};return n.set(x,m),t.set(x,r),e(x,S),x}}((pt=o,function(e,t){pt.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),qt,u,0,i.createCancelAndHoldAutomationEvent,i.createCancelScheduledValuesAutomationEvent,i.createExponentialRampToValueAutomationEvent,i.createLinearRampToValueAutomationEvent,i.createSetTargetAutomationEvent,i.createSetValueAutomationEvent,i.createSetValueCurveAutomationEvent,Jt,Pt),yn=function(e,t,n,i,r,a,s,o){return function(e){h(l,e);var u=d(l);function l(e,i){var o;g(this,l);var h=a(e),d=m(m({},$),i),f=r(h,d),p=s(h),v=p?t():null;return(o=u.call(this,e,!1,f,v))._audioBufferSourceNodeRenderer=v,o._isBufferNullified=!1,o._isBufferSet=null!==d.buffer,o._nativeAudioBufferSourceNode=f,o._onended=null,o._playbackRate=n(c(o),p,f.playbackRate,J,Z),o}return y(l,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer},set:function(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw i();this._isBufferSet=!0}}},{key:"loop",get:function(){return this._nativeAudioBufferSourceNode.loop},set:function(e){this._nativeAudioBufferSourceNode.loop=e}},{key:"loopEnd",get:function(){return this._nativeAudioBufferSourceNode.loopEnd},set:function(e){this._nativeAudioBufferSourceNode.loopEnd=e}},{key:"loopStart",get:function(){return this._nativeAudioBufferSourceNode.loopStart},set:function(e){this._nativeAudioBufferSourceNode.loopStart=e}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?o(this,e):null;this._nativeAudioBufferSourceNode.onended=t;var n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(t,n,i),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===i?[t,n]:[t,n,i]),"closed"!==this.context.state){V(this);var r=function t(){e._nativeAudioBufferSourceNode.removeEventListener("ended",t),Q(e)&&W(e)};this._nativeAudioBufferSourceNode.addEventListener("ended",r)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}]),l}(e)}(nn,vn,gn,We,pn,Xt,Kt,Rt),bn=function(e,t,n,i,r,a,s,o){return function(e){h(u,e);var t=d(u);function u(e,n){var i;g(this,u);var l=a(e),c=s(l),h=r(l,n,c);return i=t.call(this,e,!1,h,c?function(e){var t=new WeakMap;return{render:function(n,i){var r=t.get(i);return void 0!==r?Promise.resolve(r):function(){var n=v(f.mark((function n(i,r){var a;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.destination,t.set(r,a),n.next=4,e(i,r,a);case 4:return n.abrupt("return",a);case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()(n,i)}}}(o):null),i._isNodeOfNativeOfflineAudioContext=c,i._nativeAudioDestinationNode=h,i}return y(u,[{key:"channelCount",get:function(){return this._nativeAudioDestinationNode.channelCount},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioDestinationNode.channelCountMode},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=e}},{key:"maxChannelCount",get:function(){return this._nativeAudioDestinationNode.maxChannelCount}}]),u}(e)}(nn,0,Y,We,function(e,t){return function(n,i,r){var a=n.destination;if(a.channelCount!==i)try{a.channelCount=i}catch(o){}r&&"explicit"!==a.channelCountMode&&(a.channelCountMode="explicit"),0===a.maxChannelCount&&Object.defineProperty(a,"maxChannelCount",{value:i});var s=e(n,{channelCount:i,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return t(s,"channelCount",(function(e){return function(){return e.call(s)}}),(function(e){return function(t){e.call(s,t);try{a.channelCount=t}catch(e){if(t>a.maxChannelCount)throw e}}})),t(s,"channelCountMode",(function(e){return function(){return e.call(s)}}),(function(e){return function(t){e.call(s,t),a.channelCountMode=t}})),t(s,"channelInterpretation",(function(e){return function(){return e.call(s)}}),(function(e){return function(t){e.call(s,t),a.channelInterpretation=t}})),Object.defineProperty(s,"maxChannelCount",{get:function(){return a.maxChannelCount}}),s.connect(a),s}}(st,wt),Xt,Kt,zt),Sn=function(e,t,n,i,r){return function(){var a=new WeakMap;return{render:function(s,o){var u=a.get(o);return void 0!==u?Promise.resolve(u):function(){var s=v(f.mark((function s(o,u){var l,c,h;return f.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=n(o),(c=H(l,u))||(h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type},l=t(u,h)),a.set(u,l),!c){s.next=15;break}return s.next=7,e(u,o.Q,l.Q);case 7:return s.next=9,e(u,o.detune,l.detune);case 9:return s.next=11,e(u,o.frequency,l.frequency);case 11:return s.next=13,e(u,o.gain,l.gain);case 13:s.next=23;break;case 15:return s.next=17,i(u,o.Q,l.Q);case 17:return s.next=19,i(u,o.detune,l.detune);case 19:return s.next=21,i(u,o.frequency,l.frequency);case 21:return s.next=23,i(u,o.gain,l.gain);case 23:return s.next=25,r(o,u,l);case 25:return s.abrupt("return",l);case 26:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()(s,o)}}}}(fn,nt,ve,mn,zt),xn=function(e){return function(t,n){return e.set(t,n)}}(Ft),_n=function(e,t,n,i,r,a,s,o){return function(e){h(l,e);var u=d(l);function l(e,i){var h;g(this,l);var d=a(e),f=m(m({},Le),i),p=r(d,f),v=s(d);return(h=u.call(this,e,!1,p,v?n():null))._Q=t(c(h),v,p.Q,J,Z),h._detune=t(c(h),v,p.detune,1200*Math.log2(J),-1200*Math.log2(J)),h._frequency=t(c(h),v,p.frequency,e.sampleRate/2,0),h._gain=t(c(h),v,p.gain,40*Math.log10(J),Z),h._nativeBiquadFilterNode=p,o(c(h),1),h}return y(l,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"gain",get:function(){return this._gain}},{key:"Q",get:function(){return this._Q}},{key:"type",get:function(){return this._nativeBiquadFilterNode.type},set:function(e){this._nativeBiquadFilterNode.type=e}},{key:"getFrequencyResponse",value:function(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(e){if(11===e.code)throw i();throw e}if(e.length!==t.length||t.length!==n.length)throw i()}}]),l}(e)}(nn,gn,Sn,Ue,nt,Xt,Kt,xn),En=function(e,t){return function(n,i,r){var a,s,o=new Set;return n.connect=(a=n.connect,function(r){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=0===o.size;if(t(r))return a.call(n,r,s,u),e(o,[r,s,u],(function(e){return e[0]===r&&e[1]===s&&e[2]===u}),!0),l&&i(),r;a.call(n,r,s),e(o,[r,s],(function(e){return e[0]===r&&e[1]===s}),!0),l&&i()}),n.disconnect=(s=n.disconnect,function(e,i,a){var u=o.size>0;if(void 0===e)s.apply(n),o.clear();else if("number"==typeof e){s.call(n,e);var l,c=b(o);try{for(c.s();!(l=c.n()).done;){var h=l.value;h[1]===e&&o.delete(h)}}catch(v){c.e(v)}finally{c.f()}}else{t(e)?s.call(n,e,i,a):s.call(n,e,i);var d,f=b(o);try{for(f.s();!(d=f.n()).done;){var p=d.value;p[0]!==e||void 0!==i&&p[1]!==i||void 0!==a&&p[2]!==a||o.delete(p)}}catch(v){f.e(v)}finally{f.f()}}var m=0===o.size;u&&m&&r()}),n}}(oe,$t),kn=function(e,t){return function(n,i){i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:function(){return 1},set:function(){throw e()}}),Object.defineProperty(i,"channelCountMode",{get:function(){return"explicit"},set:function(){throw e()}});var r=n.createBufferSource();t(i,(function(){for(var e=i.numberOfInputs,t=0;t<e;t+=1)r.connect(i,0,t)}),(function(){return r.disconnect(i)}))}}(We,En),Mn=function(e,t){return function(n,i){var r=n.createChannelMerger(i.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,r),Ze(r,i),r}}(Jt,kn),wn=function(e,t,n){return function(){var i=new WeakMap;return{render:function(r,a){var s=i.get(a);return void 0!==s?Promise.resolve(s):function(){var r=v(f.mark((function r(a,s){var o,u;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t(a),H(o,s)||(u={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs},o=e(s,u)),i.set(s,o),r.next=5,n(a,s,o);case 5:return r.abrupt("return",o);case 6:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()(r,a)}}}}(Mn,ve,zt),Pn=function(e,t,n,i,r){return function(e){h(s,e);var a=d(s);function s(e,o){g(this,s);var u=i(e),l=m(m({},Oe),o);return a.call(this,e,!1,n(u,l),r(u)?t():null)}return s}(e)}(nn,wn,Mn,Xt,Kt),Tn=function(e,t,n){return function(){var i=new WeakMap;return{render:function(r,a){var s=i.get(a);return void 0!==s?Promise.resolve(s):function(){var r=v(f.mark((function r(a,s){var o,u;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t(a),H(o,s)||(u={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs},o=e(s,u)),i.set(s,o),r.next=5,n(a,s,o);case 5:return r.abrupt("return",o);case 6:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()(r,a)}}}}(it,ve,zt),Cn=function(e,t,n,i,r,a){return function(e){h(s,e);var a=d(s);function s(e,o){g(this,s);var u=i(e),l=function(e){return m(m({},e),{},{channelCount:e.numberOfOutputs})}(m(m({},Re),o));return a.call(this,e,!1,n(u,l),r(u)?t():null)}return s}(e)}(nn,Tn,it,Xt,Kt),In=function(e,t,n,i){return function(r,a){var s=a.offset,o=l(a,_),u=r.createBuffer(1,2,44100),c=t(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=n(r,m(m({},o),{},{gain:s})),d=u.getChannelData(0);d[0]=1,d[1]=1,c.buffer=u,c.loop=!0;var f={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(e){h.channelCount=e},get channelCountMode(){return h.channelCountMode},set channelCountMode(e){h.channelCountMode=e},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(e){h.channelInterpretation=e},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener:function(){return c.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return c.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return c.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.start.call(c,e)},stop:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.stop.call(c,e)}};return e(r,c),i(rt(f,h),(function(){return c.connect(h)}),(function(){return c.disconnect(h)}))}}(hn,pn,st,En),An=function(e,t,n,i,r){return function(a,s){if(void 0===a.createConstantSource)return n(a,s);var o=a.createConstantSource();return Ze(o,s),Qe(o,s,"offset"),t(i,(function(){return i(a)}))||$e(o),t(r,(function(){return r(a)}))||et(o),e(a,o),o}}(hn,Vt,In,Tt,It),Ln=function(e,t,n,i,r){return function(){var a=new WeakMap,s=null,o=null;return{set start(e){s=e},set stop(e){o=e},render:function(u,l){var c=a.get(l);return void 0!==c?Promise.resolve(c):function(){var u=v(f.mark((function u(l,c){var h,d,p;return f.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(h=n(l),(d=H(h,c))||(p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value},h=t(c,p),null!==s&&h.start(s),null!==o&&h.stop(o)),a.set(c,h),!d){u.next=9;break}return u.next=7,e(c,l.offset,h.offset);case 7:u.next=11;break;case 9:return u.next=11,i(c,l.offset,h.offset);case 11:return u.next=13,r(l,c,h);case 13:return u.abrupt("return",h);case 14:case"end":return u.stop()}}),u)})));return function(e,t){return u.apply(this,arguments)}}()(u,l)}}}}(fn,An,ve,mn,zt),On=function(e,t,n,i,r,a,s){return function(e){h(u,e);var o=d(u);function u(e,s){var l;g(this,u);var h=r(e),d=m(m({},Ne),s),f=i(h,d),p=a(h),v=p?n():null;return(l=o.call(this,e,!1,f,v))._constantSourceNodeRenderer=v,l._nativeConstantSourceNode=f,l._offset=t(c(l),p,f.offset,J,Z),l._onended=null,l}return y(u,[{key:"offset",get:function(){return this._offset}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?s(this,e):null;this._nativeConstantSourceNode.onended=t;var n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){V(this);var n=function t(){e._nativeConstantSourceNode.removeEventListener("ended",t),Q(e)&&W(e)};this._nativeConstantSourceNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}]),u}(e)}(nn,gn,Ln,An,Xt,Kt,Rt),Rn=function(e,t){return function(n,i){var r=n.createConvolver();if(Ze(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),qe(r,i,"buffer"),i.channelCount>2)throw e();if(t(r,"channelCount",(function(e){return function(){return e.call(r)}}),(function(t){return function(n){if(n>2)throw e();return t.call(r,n)}})),"max"===i.channelCountMode)throw e();return t(r,"channelCountMode",(function(e){return function(){return e.call(r)}}),(function(t){return function(n){if("max"===n)throw e();return t.call(r,n)}})),r}}(vt,wt),Nn=function(e,t,n){return function(){var i=new WeakMap;return{render:function(r,a){var s=i.get(a);return void 0!==s?Promise.resolve(s):function(){var r=v(f.mark((function r(a,s){var o,u;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=t(a),H(o,s)||(u={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize},o=e(s,u)),i.set(s,o),!ce(o)){r.next=8;break}return r.next=6,n(a,s,o.inputs[0]);case 6:r.next=10;break;case 8:return r.next=10,n(a,s,o);case 10:return r.abrupt("return",o);case 11:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()(r,a)}}}}(Rn,ve,zt),Bn=function(e,t,n,i,r,a){return function(e){h(o,e);var s=d(o);function o(e,u){var l;g(this,o);var h=i(e),d=m(m({},Be),u),f=n(h,d);return(l=s.call(this,e,!1,f,r(h)?t():null))._isBufferNullified=!1,l._nativeConvolverNode=f,null!==d.buffer&&a(c(l),d.buffer.duration),l}return y(o,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer},set:function(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){var t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}},{key:"normalize",get:function(){return this._nativeConvolverNode.normalize},set:function(e){this._nativeConvolverNode.normalize=e}}]),o}(e)}(nn,Nn,Rn,Xt,Kt,xn),Dn=function(e,t,n,i,r){return function(a){var s=new WeakMap;return{render:function(o,u){var l=s.get(u);return void 0!==l?Promise.resolve(l):function(){var o=v(f.mark((function o(u,l){var c,h,d;return f.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n(u),(h=H(c,l))||(d={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:a},c=t(l,d)),s.set(l,c),!h){o.next=9;break}return o.next=7,e(l,u.delayTime,c.delayTime);case 7:o.next=11;break;case 9:return o.next=11,i(l,u.delayTime,c.delayTime);case 11:return o.next=13,r(u,l,c);case 13:return o.abrupt("return",c);case 14:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}()(o,u)}}}}(fn,at,ve,mn,zt),Fn=function(e,t,n,i,r,a,s){return function(e){h(u,e);var o=d(u);function u(e,l){var h;g(this,u);var d=r(e),f=m(m({},Fe),l),p=i(d,f),v=a(d);return(h=o.call(this,e,!1,p,v?n(f.maxDelayTime):null))._delayTime=t(c(h),v,p.delayTime),s(c(h),f.maxDelayTime),h}return y(u,[{key:"delayTime",get:function(){return this._delayTime}}]),u}(e)}(nn,gn,Dn,at,Xt,Kt,xn),jn=function(e){return function(t,n){var i=t.createDynamicsCompressor();if(Ze(i,n),n.channelCount>2)throw e();if("max"===n.channelCountMode)throw e();return Qe(i,n,"attack"),Qe(i,n,"knee"),Qe(i,n,"ratio"),Qe(i,n,"release"),Qe(i,n,"threshold"),i}}(vt),Vn=function(e,t,n,i,r){return function(){var a=new WeakMap;return{render:function(s,o){var u=a.get(o);return void 0!==u?Promise.resolve(u):function(){var s=v(f.mark((function s(o,u){var l,c,h;return f.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=n(o),(c=H(l,u))||(h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value},l=t(u,h)),a.set(u,l),!c){s.next=17;break}return s.next=7,e(u,o.attack,l.attack);case 7:return s.next=9,e(u,o.knee,l.knee);case 9:return s.next=11,e(u,o.ratio,l.ratio);case 11:return s.next=13,e(u,o.release,l.release);case 13:return s.next=15,e(u,o.threshold,l.threshold);case 15:s.next=27;break;case 17:return s.next=19,i(u,o.attack,l.attack);case 19:return s.next=21,i(u,o.knee,l.knee);case 21:return s.next=23,i(u,o.ratio,l.ratio);case 23:return s.next=25,i(u,o.release,l.release);case 25:return s.next=27,i(u,o.threshold,l.threshold);case 27:return s.next=29,r(o,u,l);case 29:return s.abrupt("return",l);case 30:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()(s,o)}}}}(fn,jn,ve,mn,zt),Gn=function(e,t,n,i,r,a,s,o){return function(e){h(l,e);var u=d(l);function l(e,r){var h;g(this,l);var d=a(e),f=m(m({},Ve),r),p=i(d,f),v=s(d);return(h=u.call(this,e,!1,p,v?n():null))._attack=t(c(h),v,p.attack),h._knee=t(c(h),v,p.knee),h._nativeDynamicsCompressorNode=p,h._ratio=t(c(h),v,p.ratio),h._release=t(c(h),v,p.release),h._threshold=t(c(h),v,p.threshold),o(c(h),.006),h}return y(l,[{key:"attack",get:function(){return this._attack}},{key:"channelCount",get:function(){return this._nativeDynamicsCompressorNode.channelCount},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,r()}},{key:"channelCountMode",get:function(){return this._nativeDynamicsCompressorNode.channelCountMode},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,r()}},{key:"knee",get:function(){return this._knee}},{key:"ratio",get:function(){return this._ratio}},{key:"reduction",get:function(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}},{key:"release",get:function(){return this._release}},{key:"threshold",get:function(){return this._threshold}}]),l}(e)}(nn,gn,Vn,jn,vt,Xt,Kt,xn),Wn=function(e,t,n,i,r){return function(){var a=new WeakMap;return{render:function(s,o){var u=a.get(o);return void 0!==u?Promise.resolve(u):function(){var s=v(f.mark((function s(o,u){var l,c,h;return f.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=n(o),(c=H(l,u))||(h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value},l=t(u,h)),a.set(u,l),!c){s.next=9;break}return s.next=7,e(u,o.gain,l.gain);case 7:s.next=11;break;case 9:return s.next=11,i(u,o.gain,l.gain);case 11:return s.next=13,r(o,u,l);case 13:return s.abrupt("return",l);case 14:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()(s,o)}}}}(fn,st,ve,mn,zt),Un=function(e,t,n,i,r,a){return function(e){h(o,e);var s=d(o);function o(e,u){var l;g(this,o);var h=r(e),d=m(m({},Ge),u),f=i(h,d),p=a(h);return(l=s.call(this,e,!1,f,p?n():null))._gain=t(c(l),p,f.gain,J,Z),l}return y(o,[{key:"gain",get:function(){return this._gain}}]),o}(e)}(nn,gn,Wn,st,Xt,Kt),zn=function(e,t,n,i){return function(r,a,s){var o=s.channelCount,u=s.channelCountMode,l=s.channelInterpretation,c=s.feedback,h=s.feedforward,d=tt(a,r.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),p=h instanceof Float64Array?h:new Float64Array(h),m=f.length,v=p.length,g=Math.min(m,v);if(0===m||m>20)throw i();if(0===f[0])throw t();if(0===v||v>20)throw i();if(0===p[0])throw t();if(1!==f[0]){for(var y=0;y<v;y+=1)p[y]/=f[0];for(var b=1;b<m;b+=1)f[b]/=f[0]}var S=n(r,d,o,o);S.channelCount=o,S.channelCountMode=u,S.channelInterpretation=l;for(var x=[],_=[],E=[],k=0;k<o;k+=1){x.push(0);var M=new Float32Array(32),w=new Float32Array(32);M.fill(0),w.fill(0),_.push(M),E.push(w)}S.onaudioprocess=function(e){for(var t=e.inputBuffer,n=e.outputBuffer,i=t.numberOfChannels,r=0;r<i;r+=1){var a=t.getChannelData(r),s=n.getChannelData(r);x[r]=He(f,m,p,v,g,_[r],E[r],x[r],32,a,s)}};var P=r.sampleRate/2;return rt({get bufferSize(){return d},get channelCount(){return S.channelCount},set channelCount(e){S.channelCount=e},get channelCountMode(){return S.channelCountMode},set channelCountMode(e){S.channelCountMode=e},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(e){S.channelInterpretation=e},get context(){return S.context},get inputs(){return[S]},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},addEventListener:function(){return S.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return S.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse:function(t,n,i){if(t.length!==n.length||n.length!==i.length)throw e();for(var r=t.length,a=0;a<r;a+=1){var s=-Math.PI*(t[a]/P),o=[Math.cos(s),Math.sin(s)],u=ot(ut(p,o),ut(f,o));n[a]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),i[a]=Math.atan2(u[1],u[0])}},removeEventListener:function(){return S.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},S)}}(Ue,We,mt,vt),Hn=function(e,t,n,i){return function(r){return e(Ye,(function(){return Ye(r)}))?Promise.resolve(e(i,i)).then((function(e){if(!e){var t=n(r,512,0,1);r.oncomplete=function(){t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=function(){return r.currentTime},t.connect(r.destination)}return r.startRendering()})):new Promise((function(e){var n=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=function(t){n.disconnect(),e(t.renderedBuffer)},n.connect(r.destination),r.startRendering()}))}}(Vt,st,mt,function(e,t){return function(){if(null===t)return Promise.resolve(!1);var n=new t(1,1,44100),i=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((function(e){n.oncomplete=function(){i.disconnect(),e(0!==n.currentTime)},n.startRendering()}))}}(st,Yt)),Xn=function(e,t,n,i,r){return function(a,s){var o=new WeakMap,u=null;return{render:function(l,c){var h=o.get(c);return void 0!==h?Promise.resolve(h):function(){var l=v(f.mark((function l(c,h){var d,p,m,g,y;return f.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(d=null,p=t(c),m=H(p,h),void 0===h.createIIRFilter?d=e(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(p=h.createIIRFilter(s,a)),o.set(h,null===d?p:d),null===d){l.next=12;break}if(null!==u){l.next=8;break}if(null!==n){l.next=6;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 6:g=new n(c.context.destination.channelCount,c.context.length,h.sampleRate),u=v(f.mark((function e(){return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(c,g,g.destination);case 2:return e.t0=function(e,t,n,i){var r=n instanceof Float64Array?n:new Float64Array(n),a=i instanceof Float64Array?i:new Float64Array(i),s=r.length,o=a.length,u=Math.min(s,o);if(1!==r[0]){for(var l=0;l<s;l+=1)a[l]/=r[0];for(var c=1;c<o;c+=1)r[c]/=r[0]}for(var h=new Float32Array(32),d=new Float32Array(32),f=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),p=e.numberOfChannels,m=0;m<p;m+=1){var v=e.getChannelData(m),g=f.getChannelData(m);h.fill(0),d.fill(0),He(r,s,a,o,u,h,d,0,32,v,g)}return f},e.next=5,r(g);case 5:return e.t1=e.sent,e.t2=h,e.t3=a,e.t4=s,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))();case 8:return l.next=10,u;case 10:return y=l.sent,l.abrupt("return",(d.buffer=y,d.start(0),d));case 12:return l.next=14,i(c,h,p);case 14:return l.abrupt("return",p);case 15:case"end":return l.stop()}}),l)})));return function(e,t){return l.apply(this,arguments)}}()(l,c)}}}}(pn,ve,Yt,zt,Hn),Yn=function(e){return function(t,n,i){if(void 0===t.createIIRFilter)return e(t,n,i);var r=t.createIIRFilter(i.feedforward,i.feedback);return Ze(r,i),r}}(zn),Kn=function(e,t,n,i,r,a){return function(e){h(o,e);var s=d(o);function o(e,u){var l;g(this,o);var h=i(e),d=r(h),f=m(m({},ze),u),p=t(h,d?null:e.baseLatency,f);return l=s.call(this,e,!1,p,d?n(f.feedback,f.feedforward):null),function(e){var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,function(n,i,r){if(n.length!==i.length||i.length!==r.length)throw Ue();return t.call(e,n,i,r)})}(p),l._nativeIIRFilterNode=p,a(c(l),1),l}return y(o,[{key:"getFrequencyResponse",value:function(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}}]),o}(e)}(nn,Yn,Xn,Xt,Kt,xn),qn=function(e,t,n,i,r,a,s,o){return function(u,l){var c=l.listener,h=void 0===c.forwardX?function(){var h=new Float32Array(1),d=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),f=s(l),p=!1,m=[0,0,-1,0,1,0],v=[0,0,0],g=function(){if(!p){p=!0;var e=i(l,256,9,0);e.onaudioprocess=function(e){var t=e.inputBuffer,n=[a(t,h,0),a(t,h,1),a(t,h,2),a(t,h,3),a(t,h,4),a(t,h,5)];n.some((function(e,t){return e!==m[t]}))&&(c.setOrientation.apply(c,n),m=n);var i=[a(t,h,6),a(t,h,7),a(t,h,8)];i.some((function(e,t){return e!==v[t]}))&&(c.setPosition.apply(c,i),v=i)},d.connect(e)}},y=function(e){return function(t){t!==m[e]&&(m[e]=t,c.setOrientation.apply(c,S(m)))}},b=function(e){return function(t){t!==v[e]&&(v[e]=t,c.setPosition.apply(c,S(v)))}},x=function(t,i,a){var s=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});s.connect(d,0,t),s.start(),Object.defineProperty(s.offset,"defaultValue",{get:function(){return i}});var c,h,p,m,v,y,b,S=e({context:u},f,s.offset,J,Z);return o(S,"value",(function(e){return function(){return e.call(S)}}),(function(e){return function(t){try{e.call(S,t)}catch(e){if(9!==e.code)throw e}g(),f&&a(t)}})),S.cancelAndHoldAtTime=(c=S.cancelAndHoldAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=c.apply(S,t);return g(),i}),S.cancelScheduledValues=(h=S.cancelScheduledValues,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=h.apply(S,t);return g(),i}),S.exponentialRampToValueAtTime=(p=S.exponentialRampToValueAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=p.apply(S,t);return g(),i}),S.linearRampToValueAtTime=(m=S.linearRampToValueAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=m.apply(S,t);return g(),i}),S.setTargetAtTime=(v=S.setTargetAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=v.apply(S,t);return g(),i}),S.setValueAtTime=(y=S.setValueAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=y.apply(S,t);return g(),i}),S.setValueCurveAtTime=(b=S.setValueCurveAtTime,f?function(){throw r()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=b.apply(S,t);return g(),i}),S};return{forwardX:x(0,0,y(0)),forwardY:x(1,0,y(1)),forwardZ:x(2,-1,y(2)),positionX:x(6,0,b(0)),positionY:x(7,0,b(1)),positionZ:x(8,0,b(2)),upX:x(3,0,y(3)),upY:x(4,1,y(4)),upZ:x(5,0,y(5))}}():c,d=h.forwardX,f=h.forwardY,p=h.forwardZ,m=h.positionX,v=h.positionY,g=h.positionZ,y=h.upX,b=h.upY,x=h.upZ;return{get forwardX(){return d},get forwardY(){return f},get forwardZ(){return p},get positionX(){return m},get positionY(){return v},get positionZ(){return g},get upX(){return y},get upY(){return b},get upZ(){return x}}}}(gn,Mn,An,mt,vt,kt,Kt,wt),Zn=new WeakMap,Jn=function(e,t,n,i,r,a){return function(n){h(o,n);var s=d(o);function o(n,a){var u;return g(this,o),(u=s.call(this,n))._nativeContext=n,w.set(c(u),n),i(n)&&r.set(n,new Set),u._destination=new e(c(u),a),u._listener=t(c(u),n),u._onstatechange=null,u}return y(o,[{key:"currentTime",get:function(){return this._nativeContext.currentTime}},{key:"destination",get:function(){return this._destination}},{key:"listener",get:function(){return this._listener}},{key:"onstatechange",get:function(){return this._onstatechange},set:function(e){var t="function"==typeof e?a(this,e):null;this._nativeContext.onstatechange=t;var n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}},{key:"sampleRate",get:function(){return this._nativeContext.sampleRate}},{key:"state",get:function(){return this._nativeContext.state}}]),o}(n)}(bn,qn,Zt,Kt,Zn,Rt),Qn=function(e,t,n,i,r,a){return function(s,o){var u=s.createOscillator();return Ze(u,o),Qe(u,o,"detune"),Qe(u,o,"frequency"),void 0!==o.periodicWave?u.setPeriodicWave(o.periodicWave):qe(u,o,"type"),t(n,(function(){return n(s)}))||$e(u),t(i,(function(){return i(s)}))||a(u,s),t(r,(function(){return r(s)}))||et(u),e(s,u),u}}(hn,Vt,Tt,Ct,It,Ot),$n=function(e,t,n,i,r){return function(){var a=new WeakMap,s=null,o=null,u=null;return{set periodicWave(e){s=e},set start(e){o=e},set stop(e){u=e},render:function(l,c){var h=a.get(c);return void 0!==h?Promise.resolve(h):function(){var l=v(f.mark((function l(c,h){var d,p,m;return f.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(d=n(c),(p=H(d,h))||(m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===s?void 0:s,type:d.type},d=t(h,m),null!==o&&d.start(o),null!==u&&d.stop(u)),a.set(h,d),!p){l.next=11;break}return l.next=7,e(h,c.detune,d.detune);case 7:return l.next=9,e(h,c.frequency,d.frequency);case 9:l.next=15;break;case 11:return l.next=13,i(h,c.detune,d.detune);case 13:return l.next=15,i(h,c.frequency,d.frequency);case 15:return l.next=17,r(c,h,d);case 17:return l.abrupt("return",d);case 18:case"end":return l.stop()}}),l)})));return function(e,t){return l.apply(this,arguments)}}()(l,c)}}}}(fn,Qn,ve,mn,zt),ei=function(e,t,n,i,r,a,s){return function(e){h(u,e);var o=d(u);function u(e,s){var l;g(this,u);var h=r(e),d=m(m({},yt),s),f=n(h,d),p=a(h),v=p?i():null,y=e.sampleRate/2;return(l=o.call(this,e,!1,f,v))._detune=t(c(l),p,f.detune,153600,-153600),l._frequency=t(c(l),p,f.frequency,y,-y),l._nativeOscillatorNode=f,l._onended=null,l._oscillatorNodeRenderer=v,null!==l._oscillatorNodeRenderer&&void 0!==d.periodicWave&&(l._oscillatorNodeRenderer.periodicWave=d.periodicWave),l}return y(u,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?s(this,e):null;this._nativeOscillatorNode.onended=t;var n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"type",get:function(){return this._nativeOscillatorNode.type},set:function(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}},{key:"setPeriodicWave",value:function(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){V(this);var n=function t(){e._nativeOscillatorNode.removeEventListener("ended",t),Q(e)&&W(e)};this._nativeOscillatorNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}]),u}(e)}(nn,gn,Qn,$n,Xt,Kt,Rt),ti=function(e){return function(t,n){var i=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=t.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),function(){i.stop(),i.disconnect(n)}}}(pn),ni=function(e,t,n,i,r){return function(a,s){var o=s.curve,u=s.oversample,c=l(s,E),h=a.createWaveShaper(),d=a.createWaveShaper();Ze(h,c),Ze(d,c);var f=n(a,m(m({},c),{},{gain:1})),p=n(a,m(m({},c),{},{gain:-1})),v=n(a,m(m({},c),{},{gain:1})),g=n(a,m(m({},c),{},{gain:-1})),y=null,b=!1,S=null,x={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(e){f.channelCount=e,p.channelCount=e,h.channelCount=e,v.channelCount=e,d.channelCount=e,g.channelCount=e},get channelCountMode(){return h.channelCountMode},set channelCountMode(e){f.channelCountMode=e,p.channelCountMode=e,h.channelCountMode=e,v.channelCountMode=e,d.channelCountMode=e,g.channelCountMode=e},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e,p.channelInterpretation=e,h.channelInterpretation=e,v.channelInterpretation=e,d.channelInterpretation=e,g.channelInterpretation=e},get context(){return h.context},get curve(){return S},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)h.curve=n,d.curve=n;else{var r=n.length,s=new Float32Array(r+2-r%2),o=new Float32Array(r+2-r%2);s[0]=n[0],o[0]=-n[r-1];for(var u=Math.ceil((r+1)/2),l=(r+1)/2-1,c=1;c<u;c+=1){var p=c/u*l,m=Math.floor(p),v=Math.ceil(p);s[c]=m===v?n[m]:(1-(p-m))*n[m]+(1-(v-p))*n[v],o[c]=m===v?-n[r-1-m]:-(1-(p-m))*n[r-1-m]-(1-(v-p))*n[r-1-v]}s[u]=r%2==1?n[u-1]:(n[u-2]+n[u-1])/2,h.curve=s,d.curve=o}S=n,b&&(i(S)&&null===y?y=e(a,f):null!==y&&(y(),y=null))},get inputs(){return[f]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(e){h.oversample=e,d.oversample=e},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return null!==o&&(x.curve=o instanceof Float32Array?o:new Float32Array(o)),u!==x.oversample&&(x.oversample=u),r(rt(x,v),(function(){f.connect(h).connect(v),f.connect(p).connect(d).connect(g).connect(v),b=!0,i(S)&&(y=e(a,f))}),(function(){f.disconnect(h),h.disconnect(v),f.disconnect(p),p.disconnect(d),d.disconnect(g),g.disconnect(v),b=!1,null!==y&&(y(),y=null)}))}}(ti,We,st,Mt,En),ii=function(e,t,n,i,r,a,s){return function(o,u){var l=o.createWaveShaper();if(null!==a&&"webkitAudioContext"===a.name&&void 0===o.createGain().gain.automationRate)return n(o,u);Ze(l,u);var c=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==c&&c.length<2)throw t();qe(l,{curve:c},"curve"),qe(l,u,"oversample");var h=null,d=!1;return s(l,"curve",(function(e){return function(){return e.call(l)}}),(function(t){return function(n){return t.call(l,n),d&&(i(n)&&null===h?h=e(o,l):i(n)||null===h||(h(),h=null)),n}})),r(l,(function(){d=!0,i(l.curve)&&(h=e(o,l))}),(function(){d=!1,null!==h&&(h(),h=null)}))}}(ti,We,ni,Mt,En,Jt,wt),ri=function(e,t,n,i,r,a,s,o,u,c){return function(h,d){var f=d.coneInnerAngle,p=d.coneOuterAngle,v=d.coneOuterGain,g=d.distanceModel,y=d.maxDistance,b=d.orientationX,x=d.orientationY,_=d.orientationZ,E=d.panningModel,M=d.positionX,w=d.positionY,P=d.positionZ,T=d.refDistance,C=d.rolloffFactor,I=l(d,k),A=h.createPanner();if(I.channelCount>2)throw s();if("max"===I.channelCountMode)throw s();Ze(A,I);var L={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},O=n(h,m(m({},L),{},{channelInterpretation:"speakers",numberOfInputs:6})),R=i(h,m(m({},I),{},{gain:1})),N=i(h,m(m({},L),{},{gain:1})),B=i(h,m(m({},L),{},{gain:0})),D=i(h,m(m({},L),{},{gain:0})),F=i(h,m(m({},L),{},{gain:0})),j=i(h,m(m({},L),{},{gain:0})),V=i(h,m(m({},L),{},{gain:0})),G=r(h,256,6,1),W=a(h,m(m({},L),{},{curve:new Float32Array([1,1]),oversample:"none"})),U=[b,x,_],z=[M,w,P],H=new Float32Array(1);G.onaudioprocess=function(e){var t=e.inputBuffer,n=[u(t,H,0),u(t,H,1),u(t,H,2)];n.some((function(e,t){return e!==U[t]}))&&(A.setOrientation.apply(A,n),U=n);var i=[u(t,H,3),u(t,H,4),u(t,H,5)];i.some((function(e,t){return e!==z[t]}))&&(A.setPosition.apply(A,i),z=i)},Object.defineProperty(B.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(D.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(F.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(j.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(V.gain,"defaultValue",{get:function(){return 0}});var X={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(e){if(e>2)throw s();R.channelCount=e,A.channelCount=e},get channelCountMode(){return A.channelCountMode},set channelCountMode(e){if("max"===e)throw s();R.channelCountMode=e,A.channelCountMode=e},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(e){R.channelInterpretation=e,A.channelInterpretation=e},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(e){A.coneInnerAngle=e},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(e){A.coneOuterAngle=e},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();A.coneOuterGain=e},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(e){A.distanceModel=e},get inputs(){return[R]},get maxDistance(){return A.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;A.maxDistance=e},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return N.gain},get orientationY(){return B.gain},get orientationZ(){return D.gain},get panningModel(){return A.panningModel},set panningModel(e){A.panningModel=e},get positionX(){return F.gain},get positionY(){return j.gain},get positionZ(){return V.gain},get refDistance(){return A.refDistance},set refDistance(e){if(e<0)throw new RangeError;A.refDistance=e},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;A.rolloffFactor=e},addEventListener:function(){return R.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return R.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return R.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return f!==X.coneInnerAngle&&(X.coneInnerAngle=f),p!==X.coneOuterAngle&&(X.coneOuterAngle=p),v!==X.coneOuterGain&&(X.coneOuterGain=v),g!==X.distanceModel&&(X.distanceModel=g),y!==X.maxDistance&&(X.maxDistance=y),b!==X.orientationX.value&&(X.orientationX.value=b),x!==X.orientationY.value&&(X.orientationY.value=x),_!==X.orientationZ.value&&(X.orientationZ.value=_),E!==X.panningModel&&(X.panningModel=E),M!==X.positionX.value&&(X.positionX.value=M),w!==X.positionY.value&&(X.positionY.value=w),P!==X.positionZ.value&&(X.positionZ.value=P),T!==X.refDistance&&(X.refDistance=T),C!==X.rolloffFactor&&(X.rolloffFactor=C),1===U[0]&&0===U[1]&&0===U[2]||A.setOrientation.apply(A,S(U)),0===z[0]&&0===z[1]&&0===z[2]||A.setPosition.apply(A,S(z)),c(rt(X,A),(function(){R.connect(A),e(R,W,0,0),W.connect(N).connect(O,0,0),W.connect(B).connect(O,0,1),W.connect(D).connect(O,0,2),W.connect(F).connect(O,0,3),W.connect(j).connect(O,0,4),W.connect(V).connect(O,0,5),O.connect(G).connect(h.destination)}),(function(){R.disconnect(A),o(R,W,0,0),W.disconnect(N),N.disconnect(O),W.disconnect(B),B.disconnect(O),W.disconnect(D),D.disconnect(O),W.disconnect(F),F.disconnect(O),W.disconnect(j),j.disconnect(O),W.disconnect(V),V.disconnect(O),O.disconnect(G),G.disconnect(h.destination)}))}}(he,We,Mn,st,mt,ii,vt,me,kt,En),ai=function(e){return function(t,n){var i=t.createPanner();return void 0===i.orientationX?e(t,n):(Ze(i,n),Qe(i,n,"orientationX"),Qe(i,n,"orientationY"),Qe(i,n,"orientationZ"),Qe(i,n,"positionX"),Qe(i,n,"positionY"),Qe(i,n,"positionZ"),qe(i,n,"coneInnerAngle"),qe(i,n,"coneOuterAngle"),qe(i,n,"coneOuterGain"),qe(i,n,"distanceModel"),qe(i,n,"maxDistance"),qe(i,n,"panningModel"),qe(i,n,"refDistance"),qe(i,n,"rolloffFactor"),i)}}(ri),si=function(e,t,n,i,r,a,s,o,u,l){return function(){var c=new WeakMap,h=null;return{render:function(d,p){var g=c.get(p);return void 0!==g?Promise.resolve(g):function(){var d=v(f.mark((function d(p,g){var y,b,S,x,_,E,k;return f.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(y=null,b=a(p),S={channelCount:b.channelCount,channelCountMode:b.channelCountMode,channelInterpretation:b.channelInterpretation},x=m(m({},S),{},{coneInnerAngle:b.coneInnerAngle,coneOuterAngle:b.coneOuterAngle,coneOuterGain:b.coneOuterGain,distanceModel:b.distanceModel,maxDistance:b.maxDistance,panningModel:b.panningModel,refDistance:b.refDistance,rolloffFactor:b.rolloffFactor}),_=H(b,g),"bufferSize"in b?y=i(g,m(m({},S),{},{gain:1})):_||(E=m(m({},x),{},{orientationX:b.orientationX.value,orientationY:b.orientationY.value,orientationZ:b.orientationZ.value,positionX:b.positionX.value,positionY:b.positionY.value,positionZ:b.positionZ.value}),b=r(g,E)),c.set(g,null===y?b:y),null===y){d.next=8;break}return d.delegateYield(f.mark((function e(){var a,c,d,b,_,E,k,M,w,P,T,C,I,A;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==h){e.next=5;break}if(null!==s){e.next=3;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 3:a=new s(6,p.context.length,g.sampleRate),(c=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(a.destination),h=v(f.mark((function e(){var t,i;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(function(){var e=v(f.mark((function e(t,i){var r;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0}),e.next=3,o(a,t,r.offset);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:for(t=e.sent,i=0;i<6;i+=1)t[i].connect(c,0,i),t[i].start(0);return e.abrupt("return",l(a));case 5:case"end":return e.stop()}}),e)})))();case 5:return e.next=7,h;case 7:return d=e.sent,b=i(g,m(m({},S),{},{gain:1})),e.next=11,u(p,g,b);case 11:for(_=[],E=0;E<d.numberOfChannels;E+=1)_.push(d.getChannelData(E));for(k=[_[0][0],_[1][0],_[2][0]],M=[_[3][0],_[4][0],_[5][0]],w=i(g,m(m({},S),{},{gain:1})),P=r(g,m(m({},x),{},{orientationX:k[0],orientationY:k[1],orientationZ:k[2],positionX:M[0],positionY:M[1],positionZ:M[2]})),b.connect(w).connect(P.inputs[0]),P.connect(y),T=128;T<d.length;T+=128)C=[_[0][T],_[1][T],_[2][T]],I=[_[3][T],_[4][T],_[5][T]],(C.some((function(e,t){return e!==k[t]}))||I.some((function(e,t){return e!==M[t]})))&&(k=C,M=I,A=T/g.sampleRate,w.gain.setValueAtTime(0,A),w=i(g,m(m({},S),{},{gain:0})),P=r(g,m(m({},x),{},{orientationX:k[0],orientationY:k[1],orientationZ:k[2],positionX:M[0],positionY:M[1],positionZ:M[2]})),w.gain.setValueAtTime(1,A),b.connect(w).connect(P.inputs[0]),P.connect(y));return e.abrupt("return",{v:y});case 17:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:if("object"!==typeof(k=d.t0)){d.next=8;break}return d.abrupt("return",k.v);case 8:if(!_){d.next=23;break}return d.next=11,e(g,p.orientationX,b.orientationX);case 11:return d.next=13,e(g,p.orientationY,b.orientationY);case 13:return d.next=15,e(g,p.orientationZ,b.orientationZ);case 15:return d.next=17,e(g,p.positionX,b.positionX);case 17:return d.next=19,e(g,p.positionY,b.positionY);case 19:return d.next=21,e(g,p.positionZ,b.positionZ);case 21:d.next=35;break;case 23:return d.next=25,o(g,p.orientationX,b.orientationX);case 25:return d.next=27,o(g,p.orientationY,b.orientationY);case 27:return d.next=29,o(g,p.orientationZ,b.orientationZ);case 29:return d.next=31,o(g,p.positionX,b.positionX);case 31:return d.next=33,o(g,p.positionY,b.positionY);case 33:return d.next=35,o(g,p.positionZ,b.positionZ);case 35:if(!ce(b)){d.next=40;break}return d.next=38,u(p,g,b.inputs[0]);case 38:d.next=42;break;case 40:return d.next=42,u(p,g,b);case 42:return d.abrupt("return",b);case 43:case"end":return d.stop()}}),d)})));return function(e,t){return d.apply(this,arguments)}}()(d,p)}}}}(fn,Mn,An,st,ai,ve,Yt,mn,zt,Hn),oi=function(e,t,n,i,r,a,s){return function(e){h(u,e);var o=d(u);function u(e,l){var h;g(this,u);var d=r(e),f=m(m({},bt),l),p=n(d,f),v=a(d);return(h=o.call(this,e,!1,p,v?i():null))._nativePannerNode=p,h._orientationX=t(c(h),v,p.orientationX,J,Z),h._orientationY=t(c(h),v,p.orientationY,J,Z),h._orientationZ=t(c(h),v,p.orientationZ,J,Z),h._positionX=t(c(h),v,p.positionX,J,Z),h._positionY=t(c(h),v,p.positionY,J,Z),h._positionZ=t(c(h),v,p.positionZ,J,Z),s(c(h),1),h}return y(u,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(e){this._nativePannerNode.coneInnerAngle=e}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(e){this._nativePannerNode.coneOuterAngle=e}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(e){this._nativePannerNode.coneOuterGain=e}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(e){this._nativePannerNode.distanceModel=e}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(e){this._nativePannerNode.maxDistance=e}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(e){this._nativePannerNode.panningModel=e}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(e){this._nativePannerNode.refDistance=e}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(e){this._nativePannerNode.rolloffFactor=e}}]),u}(e)}(nn,gn,ai,si,Xt,Kt,xn),ui=function(e){return function(t,n){var i=n.disableNormalization,r=n.imag,a=n.real,s=r instanceof Float32Array?r:new Float32Array(r),o=a instanceof Float32Array?a:new Float32Array(a),u=t.createPeriodicWave(o,s,{disableNormalization:i});if(Array.from(r).length<2)throw e();return u}}(Y),li=function(e,t,n,i){return function(i){function r(i,a){g(this,r);var s=t(i),o=function(e){var t=e.imag,n=e.real;return m(m({},e),{},void 0===t?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:t,real:Array.from(t,(function(){return 0}))}:{imag:t,real:n})}(m(m({},St),a)),u=e(s,o);return n.add(u),u}return y(r,null,[{key:i,value:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===r.prototype||n.has(e)}}]),r}(Symbol.hasInstance)}(ui,Xt,new WeakSet),ci=function(e,t,n,i,r,a){var s=16385,o=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h=m(m({},c),{},{oversample:"none"}),d=function(e,a,l,d,f){if(1===a)return function(e,t,r,a){for(var l=new Float32Array(s),d=new Float32Array(s),f=0;f<s;f+=1){var p=f/16384*u;l[f]=Math.cos(p),d[f]=Math.sin(p)}var v=n(e,m(m({},c),{},{gain:0})),g=i(e,m(m({},h),{},{curve:l})),y=i(e,m(m({},h),{},{curve:o})),b=n(e,m(m({},c),{},{gain:0})),S=i(e,m(m({},h),{},{curve:d}));return{connectGraph:function(){t.connect(v),t.connect(void 0===y.inputs?y:y.inputs[0]),t.connect(b),y.connect(r),r.connect(void 0===g.inputs?g:g.inputs[0]),r.connect(void 0===S.inputs?S:S.inputs[0]),g.connect(v.gain),S.connect(b.gain),v.connect(a,0,0),b.connect(a,0,1)},disconnectGraph:function(){t.disconnect(v),t.disconnect(void 0===y.inputs?y:y.inputs[0]),t.disconnect(b),y.disconnect(r),r.disconnect(void 0===g.inputs?g:g.inputs[0]),r.disconnect(void 0===S.inputs?S:S.inputs[0]),g.disconnect(v.gain),S.disconnect(b.gain),v.disconnect(a,0,0),b.disconnect(a,0,1)}}}(e,l,d,f);if(2===a)return function(e,r,a,l){for(var d=new Float32Array(s),f=new Float32Array(s),p=new Float32Array(s),v=new Float32Array(s),g=Math.floor(8192.5),y=0;y<s;y+=1)if(y>g){var b=(y-g)/(16384-g)*u;d[y]=Math.cos(b),f[y]=Math.sin(b),p[y]=0,v[y]=1}else{var S=y/(16384-g)*u;d[y]=1,f[y]=0,p[y]=Math.cos(S),v[y]=Math.sin(S)}var x=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),_=n(e,m(m({},c),{},{gain:0})),E=i(e,m(m({},h),{},{curve:d})),k=n(e,m(m({},c),{},{gain:0})),M=i(e,m(m({},h),{},{curve:f})),w=i(e,m(m({},h),{},{curve:o})),P=n(e,m(m({},c),{},{gain:0})),T=i(e,m(m({},h),{},{curve:p})),C=n(e,m(m({},c),{},{gain:0})),I=i(e,m(m({},h),{},{curve:v}));return{connectGraph:function(){r.connect(x),r.connect(void 0===w.inputs?w:w.inputs[0]),x.connect(_,0),x.connect(k,0),x.connect(P,1),x.connect(C,1),w.connect(a),a.connect(void 0===E.inputs?E:E.inputs[0]),a.connect(void 0===M.inputs?M:M.inputs[0]),a.connect(void 0===T.inputs?T:T.inputs[0]),a.connect(void 0===I.inputs?I:I.inputs[0]),E.connect(_.gain),M.connect(k.gain),T.connect(P.gain),I.connect(C.gain),_.connect(l,0,0),P.connect(l,0,0),k.connect(l,0,1),C.connect(l,0,1)},disconnectGraph:function(){r.disconnect(x),r.disconnect(void 0===w.inputs?w:w.inputs[0]),x.disconnect(_,0),x.disconnect(k,0),x.disconnect(P,1),x.disconnect(C,1),w.disconnect(a),a.disconnect(void 0===E.inputs?E:E.inputs[0]),a.disconnect(void 0===M.inputs?M:M.inputs[0]),a.disconnect(void 0===T.inputs?T:T.inputs[0]),a.disconnect(void 0===I.inputs?I:I.inputs[0]),E.disconnect(_.gain),M.disconnect(k.gain),T.disconnect(P.gain),I.disconnect(C.gain),_.disconnect(l,0,0),P.disconnect(l,0,0),k.disconnect(l,0,1),C.disconnect(l,0,1)}}}(e,l,d,f);throw r()};return function(t,i){var s=i.channelCount,o=i.channelCountMode,u=i.pan,c=l(i,M);if("max"===o)throw r();var h=e(t,m(m({},c),{},{channelCount:1,channelCountMode:o,numberOfInputs:2})),f=n(t,m(m({},c),{},{channelCount:s,channelCountMode:o,gain:1})),p=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),v=d(t,s,f,p,h),g=v.connectGraph,y=v.disconnectGraph;Object.defineProperty(p.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(p.gain,"maxValue",{get:function(){return 1}}),Object.defineProperty(p.gain,"minValue",{get:function(){return-1}});var b={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(e){var n;f.channelCount!==e&&(S&&y(),n=d(t,e,f,p,h),g=n.connectGraph,y=n.disconnectGraph,S&&g()),f.channelCount=e},get channelCountMode(){return f.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw r();f.channelCountMode=e},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},S=!1;return a(rt(b,h),(function(){g(),S=!0}),(function(){y(),S=!1}))}}(Mn,it,st,ii,vt,En),hi=function(e,t){return function(n,i){var r=i.channelCountMode;if("clamped-max"===r)throw t();if(void 0===n.createStereoPanner)return e(n,i);var a=n.createStereoPanner();return Ze(a,i),Qe(a,i,"pan"),Object.defineProperty(a,"channelCountMode",{get:function(){return r},set:function(e){if(e!==r)throw t()}}),a}}(ci,vt),di=function(e,t,n,i,r){return function(){var a=new WeakMap;return{render:function(s,o){var u=a.get(o);return void 0!==u?Promise.resolve(u):function(){var s=v(f.mark((function s(o,u){var l,c,h;return f.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=n(o),(c=H(l,u))||(h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value},l=t(u,h)),a.set(u,l),!c){s.next=9;break}return s.next=7,e(u,o.pan,l.pan);case 7:s.next=11;break;case 9:return s.next=11,i(u,o.pan,l.pan);case 11:if(!ce(l)){s.next=16;break}return s.next=14,r(o,u,l.inputs[0]);case 14:s.next=18;break;case 16:return s.next=18,r(o,u,l);case 18:return s.abrupt("return",l);case 19:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}()(s,o)}}}}(fn,hi,ve,mn,zt),fi=function(e,t,n,i,r,a){return function(e){h(o,e);var s=d(o);function o(e,u){var l;g(this,o);var h=r(e),d=m(m({},xt),u),f=n(h,d),p=a(h);return(l=s.call(this,e,!1,f,p?i():null))._pan=t(c(l),p,f.pan),l}return y(o,[{key:"pan",get:function(){return this._pan}}]),o}(e)}(nn,gn,hi,di,Xt,Kt),pi=function(e,t,n){return function(){var i=new WeakMap;return{render:function(r,a){var s=i.get(a);return void 0!==s?Promise.resolve(s):function(){var r=v(f.mark((function r(a,s){var o,u;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=t(a),H(o,s)||(u={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample},o=e(s,u)),i.set(s,o),!ce(o)){r.next=8;break}return r.next=6,n(a,s,o.inputs[0]);case 6:r.next=10;break;case 8:return r.next=10,n(a,s,o);case 10:return r.abrupt("return",o);case 11:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()(r,a)}}}}(ii,ve,zt),mi=function(e,t,n,i,r,a,s){return function(e){h(u,e);var o=d(u);function u(e,t){var l;g(this,u);var h=r(e),d=m(m({},Et),t),f=n(h,d);return(l=o.call(this,e,!0,f,a(h)?i():null))._isCurveNullified=!1,l._nativeWaveShaperNode=f,s(c(l),1),l}return y(u,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(e){this._nativeWaveShaperNode.oversample=e}}]),u}(e)}(nn,We,ii,pi,Xt,Kt,xn),vi=function(e){return null!==e&&e.isSecureContext}(Gt),gi=function(e){return function(t,n,i){Object.defineProperties(e,{currentFrame:{configurable:!0,get:function(){return Math.round(t*n)}},currentTime:{configurable:!0,get:function(){return t}}});try{return i()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}}}(Gt),yi=new WeakMap,bi=function(e,t){return function(n){var i=e.get(n);if(void 0!==i)return i;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new t(1,1,44100),e.set(n,i),i}}(yi,Yt),Si=vi?function(e,t,n,i,r,a,s,o,u,l,c,h,d){var f=0;return function(p,m){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},y=c.get(p);if(void 0!==y&&y.has(m))return Promise.resolve();var b=l.get(p);if(void 0!==b){var S=b.get(m);if(void 0!==S)return S}var _=a(p),E=void 0===_.audioWorklet?r(m).then((function(e){var t=x(e,2),i=t[0],r=t[1],a=O(i,r),s=x(a,2),o=s[0],u=s[1];return n("".concat(o,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(u,"\n})})(window,'_AWGS')"))})).then((function(){var e=d._AWGS.pop();if(void 0===e)throw new SyntaxError;i(_.currentTime,_.sampleRate,(function(){return e(function(){function e(){g(this,e)}return e}(),void 0,(function(e,n){if(""===e.trim())throw t();var i=C.get(_);if(void 0!==i){if(i.has(e))throw t();N(n),R(n.parameterDescriptors),i.set(e,n)}else N(n),R(n.parameterDescriptors),C.set(_,new Map([[e,n]]))}),_.sampleRate,void 0,void 0)}))})):Promise.all([r(m),Promise.resolve(e(h,h))]).then((function(e){var t=x(e,2),n=x(t[0],2),i=n[0],r=n[1],a=t[1],l=f+1;f=l;var c=O(i,r),h=x(c,2),d=h[0],p=h[1],m=new Blob(["".concat(d,";((AudioWorkletProcessor,registerProcessor)=>{").concat(p,"\n})(").concat(a?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",",(n,p)=>registerProcessor(n,class extends p{").concat(a?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));","process(i,o,p){").concat(a?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));","return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(l,"',class extends AudioWorkletProcessor{process(){return !1}})")],{type:"application/javascript; charset=utf-8"}),g=URL.createObjectURL(m);return _.audioWorklet.addModule(g,v).then((function(){if(o(_))return _;var e=s(_);return e.audioWorklet.addModule(g,v).then((function(){return e}))})).then((function(e){if(null===u)throw new SyntaxError;try{new u(e,"__sac".concat(l))}catch(t){throw new SyntaxError}})).finally((function(){return URL.revokeObjectURL(g)}))}));return void 0===b?l.set(p,new Map([[m,E]])):b.set(m,E),E.then((function(){var e=c.get(p);void 0===e?c.set(p,new Set([m])):e.add(m)})).finally((function(){var e=l.get(p);void 0!==e&&e.delete(m)})),E}}(Vt,vt,function(e){return function(t){return new Promise((function(n,i){if(null!==e){var r=e.document.head;if(null===r)i(new SyntaxError);else{var a=e.document.createElement("script"),s=new Blob([t],{type:"application/javascript"}),o=URL.createObjectURL(s),u=e.onerror,l=function(){e.onerror=u,URL.revokeObjectURL(o)};e.onerror=function(t,n,r,a,s){return n===o||n===e.location.href&&1===r&&1===a?(l(),i(s),!1):null!==u?u(t,n,r,a,s):void 0},a.onerror=function(){l(),i(new SyntaxError)},a.onload=function(){l(),n()},a.src=o,a.type="module",r.appendChild(a)}}else i(new SyntaxError)}))}}(Gt),gi,function(){var e=v(f.mark((function e(t){var n;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.text();case 7:return e.t0=e.sent,e.t1=n.url,e.abrupt("return",[e.t0,e.t1]);case 10:e.next=14;break;case 12:e.prev=12,e.t2=e.catch(0);case 14:throw new DOMException("","AbortError");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),Xt,bi,Kt,tn,new WeakMap,new WeakMap,function(e,t){return v(f.mark((function n(){var i,r,a,s,o,u,l;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return i=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,44100),a=URL.createObjectURL(i),s=!1,o=!1,n.prev=6,n.next=9,r.audioWorklet.addModule(a);case 9:return u=new e(r,"a",{numberOfOutputs:0}),l=r.createOscillator(),u.port.onmessage=function(){return s=!0},u.onprocessorerror=function(){return o=!0},l.connect(u),l.start(0),n.next=16,r.startRendering();case 16:n.next=20;break;case 18:n.prev=18,n.t0=n.catch(6);case 20:return n.prev=20,URL.revokeObjectURL(a),n.finish(20);case 23:return n.abrupt("return",s&&!o);case 24:case"end":return n.stop()}}),n,null,[[6,18,20,23]])})))}(tn,Yt),Gt):void 0,xi=function(e,t){return function(n){return e(n)||t(n)}}(Qt,Kt),_i=function(e,t,n,i,r,a,s,o,u,l,c){return function(n,i){var h=s(n)?n:a(n);if(r.has(i)){var d=new DOMException("","DataCloneError");return Promise.reject(d)}try{r.add(i)}catch(p){}return t(u,(function(){return u(h)}))?h.decodeAudioData(i).then((function(n){return De(i).catch((function(){})),t(o,(function(){return o(n)}))||c(n),e.add(n),n})):new Promise((function(t,n){var r=function(){var e=v(f.mark((function e(){return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,De(i);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),a=function(e){n(e),r()};try{h.decodeAudioData(i,(function(n){"function"!=typeof n.copyFromChannel&&(l(n),K(n)),e.add(n),r().then((function(){return t(n)}))}),(function(e){a(null===e?new DOMException("","EncodingError"):e)}))}catch(e){a(e)}}))}}(an,Vt,0,0,new WeakSet,Xt,xi,X,Ye,un,ln),Ei=function(e,t,n,i,r,a,s,o,u,l,f,p,v,b,S,x,_,E,k,M){return function(S){h(P,S);var w=d(P);function P(t,n){var i;return g(this,P),(i=w.call(this,t,n))._nativeContext=t,i._audioWorklet=void 0===e?void 0:{addModule:function(t,n){return e(c(i),t,n)}},i}return y(P,[{key:"audioWorklet",get:function(){return this._audioWorklet}},{key:"createAnalyser",value:function(){return new t(this)}},{key:"createBiquadFilter",value:function(){return new r(this)}},{key:"createBuffer",value:function(e,t,i){return new n({length:t,numberOfChannels:e,sampleRate:i})}},{key:"createBufferSource",value:function(){return new i(this)}},{key:"createChannelMerger",value:function(){return new a(this,{numberOfInputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}},{key:"createChannelSplitter",value:function(){return new s(this,{numberOfOutputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}},{key:"createConstantSource",value:function(){return new o(this)}},{key:"createConvolver",value:function(){return new u(this)}},{key:"createDelay",value:function(){return new f(this,{maxDelayTime:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})}},{key:"createDynamicsCompressor",value:function(){return new p(this)}},{key:"createGain",value:function(){return new v(this)}},{key:"createIIRFilter",value:function(e,t){return new b(this,{feedback:t,feedforward:e})}},{key:"createOscillator",value:function(){return new x(this)}},{key:"createPanner",value:function(){return new _(this)}},{key:"createPeriodicWave",value:function(e,t){return new E(this,m(m({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1}),{},{imag:t,real:e}))}},{key:"createStereoPanner",value:function(){return new k(this)}},{key:"createWaveShaper",value:function(){return new M(this)}},{key:"decodeAudioData",value:function(e,t,n){return l(this._nativeContext,e).then((function(e){return"function"==typeof t&&t(e),e}),(function(e){throw"function"==typeof n&&n(e),e}))}}]),P}(S)}(Si,rn,cn,yn,_n,Pn,Cn,On,Bn,_i,Fn,Gn,Un,Kn,Jn,ei,oi,li,fi,mi),ki=function(e,t,n,i){return function(e){h(r,e);var t=d(r);function r(e,a){var s;g(this,r);var o=n(e),u=function(e,t){return e.createMediaElementSource(t.mediaElement)}(o,a);if(i(o))throw TypeError();return(s=t.call(this,e,!0,u,null))._nativeMediaElementAudioSourceNode=u,s}return y(r,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}]),r}(e)}(nn,0,Xt,Kt),Mi=function(e,t,n,i){return function(e){h(r,e);var t=d(r);function r(e,a){var s;g(this,r);var o=n(e);if(i(o))throw new TypeError;var u=function(e,t){var n=e.createMediaStreamDestination();return Ze(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}(o,m(m({},Xe),a));return(s=t.call(this,e,!1,u,null))._nativeMediaStreamAudioDestinationNode=u,s}return y(r,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}]),r}(e)}(nn,0,Xt,Kt),wi=function(e,t,n,i){return function(e){h(r,e);var t=d(r);function r(e,a){var s;g(this,r);var o=n(e),u=function(e,t){var n=t.mediaStream,i=n.getAudioTracks();i.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}));var r=i.slice(0,1),a=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(a,"mediaStream",{value:n}),a}(o,a);if(i(o))throw new TypeError;return(s=t.call(this,e,!0,u,null))._nativeMediaStreamAudioSourceNode=u,s}return y(r,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}]),r}(e)}(nn,0,Xt,Kt),Pi=function(e,t){return function(n,i){var r=i.mediaStreamTrack;if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);var a=new MediaStream([r]),s=n.createMediaStreamSource(a);if("audio"!==r.kind)throw e();if(t(n))throw new TypeError;return s}}(We,Kt),Ti=function(e,t,n){return function(e){h(r,e);var i=d(r);function r(e,a){g(this,r);var s=n(e);return i.call(this,e,!0,t(s,a),null)}return r}(e)}(nn,Pi,Xt),Ci=function(e,t,n,i,r,a,s,o,u){return function(e){h(c,e);var l=d(c);function c(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(g(this,c),null===u)throw new Error("Missing the native AudioContext constructor.");try{t=new u(r)}catch(r){if(12===r.code&&"sampleRate is not in range"===r.message)throw n();throw r}if(null===t)throw i();if(!re(r.latencyHint))throw new TypeError("The provided value '".concat(r.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==r.sampleRate&&t.sampleRate!==r.sampleRate)throw n();e=l.call(this,t,2);var a=r.latencyHint,s=t.sampleRate;if(e._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===a?512/s:"interactive"===a||void 0===a?256/s:"playback"===a?1024/s:128*Math.max(2,Math.min(128,Math.round(a*s/128)))/s,e._nativeAudioContext=t,"webkitAudioContext"===u.name?(e._nativeGainNode=t.createGain(),e._nativeOscillatorNode=t.createOscillator(),e._nativeGainNode.gain.value=1e-37,e._nativeOscillatorNode.connect(e._nativeGainNode).connect(t.destination),e._nativeOscillatorNode.start()):(e._nativeGainNode=null,e._nativeOscillatorNode=null),e._state=null,"running"===t.state){e._state="suspended";var o=function n(){"suspended"===e._state&&(e._state=null),t.removeEventListener("statechange",n)};t.addEventListener("statechange",o)}return e}return y(c,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var e=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==e._nativeGainNode&&null!==e._nativeOscillatorNode&&(e._nativeOscillatorNode.stop(),e._nativeGainNode.disconnect(),e._nativeOscillatorNode.disconnect()),ie(e)})))}},{key:"createMediaElementSource",value:function(e){return new r(this,{mediaElement:e})}},{key:"createMediaStreamDestination",value:function(){return new a(this)}},{key:"createMediaStreamSource",value:function(e){return new s(this,{mediaStream:e})}},{key:"createMediaStreamTrackSource",value:function(e){return new o(this,{mediaStreamTrack:e})}},{key:"resume",value:function(){var e=this;return"suspended"===this._state?new Promise((function(t,n){var i=function i(){e._nativeAudioContext.removeEventListener("statechange",i),"running"===e._nativeAudioContext.state?t():e.resume().then(t,n)};e._nativeAudioContext.addEventListener("statechange",i)})):this._nativeAudioContext.resume().catch((function(e){if(void 0===e||15===e.code)throw t();throw e}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(e){if(void 0===e)throw t();throw e}))}}]),c}(e)}(Ei,We,vt,_t,ki,Mi,wi,Ti,Jt),Ii=function(e){return function(t){var n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n}}(Zn),Ai=function(e){return function(t,n){e(t).add(n)}}(Ii),Li=function(e){return function(t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t[arguments.length>2&&void 0!==arguments[2]?arguments[2]:0];if(void 0===r)throw e();return _e(n)?r.connect(n,0,i):r.connect(n,0)}}(Y),Oi=function(e){return function(t,n){e(t).delete(n)}}(Ii),Ri=function(e){return function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?t.forEach((function(e){return e.disconnect()})):"number"==typeof n?je(e,t,n).disconnect():_e(n)?void 0===i?t.forEach((function(e){return e.disconnect(n)})):void 0===r?je(e,t,i).disconnect(n,0):je(e,t,i).disconnect(n,0,r):void 0===i?t.forEach((function(e){return e.disconnect(n)})):je(e,t,i).disconnect(n,0)}}(Y),Ni=new WeakMap,Bi=function(e,t){return function(n){return t(e,n)}}(Ni,B),Di=function(e,t,n,i,r,a,s,o,u,l,c,h,d){return function(g,y,S,x){if(0===x.numberOfInputs&&0===x.numberOfOutputs)throw u();var _=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(_.some((function(e){return e<1})))throw u();if(_.length!==x.numberOfOutputs)throw t();if("explicit"!==x.channelCountMode)throw u();var E=x.channelCount*x.numberOfInputs,k=_.reduce((function(e,t){return e+t}),0),M=void 0===S.parameterDescriptors?0:S.parameterDescriptors.length;if(E+M>6||k>6)throw u();for(var w=new MessageChannel,P=[],T=[],C=0;C<x.numberOfInputs;C+=1)P.push(s(g,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),T.push(r(g,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));var A=[];if(void 0!==S.parameterDescriptors){var L,O=b(S.parameterDescriptors);try{var R=function(){var e=L.value,t=e.defaultValue,n=e.maxValue,i=e.minValue,r=e.name,s=a(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==x.parameterData[r]?x.parameterData[r]:void 0===t?0:t});Object.defineProperties(s.offset,{defaultValue:{get:function(){return void 0===t?0:t}},maxValue:{get:function(){return void 0===n?J:n}},minValue:{get:function(){return void 0===i?Z:i}}}),A.push(s)};for(O.s();!(L=O.n()).done;)R()}catch(de){O.e(de)}finally{O.f()}}for(var N=i(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,E+M)}),B=tt(y,g.sampleRate),D=o(g,B,E+M,Math.max(1,k)),F=r(g,{channelCount:Math.max(1,k),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,k)}),j=[],V=0;V<x.numberOfOutputs;V+=1)j.push(i(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[V]}));for(var G=0;G<x.numberOfInputs;G+=1){P[G].connect(T[G]);for(var W=0;W<x.channelCount;W+=1)T[G].connect(N,W,G*x.channelCount+W)}var U=new we(void 0===S.parameterDescriptors?[]:S.parameterDescriptors.map((function(e,t){var n=e.name,i=A[t];return i.connect(N,0,E+t),i.start(0),[n,i.offset]})));N.connect(D);var z,H,X=x.channelInterpretation,Y=null,K=0===x.numberOfOutputs?[D]:j,q={get bufferSize(){return B},get channelCount(){return x.channelCount},set channelCount(e){throw n()},get channelCountMode(){return x.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return X},set channelInterpretation(e){var t,n=b(P);try{for(n.s();!(t=n.n()).done;)t.value.channelInterpretation=e}catch(de){n.e(de)}finally{n.f()}X=e},get context(){return D.context},get inputs(){return P},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get onprocessorerror(){return Y},set onprocessorerror(e){"function"==typeof Y&&q.removeEventListener("processorerror",Y),"function"==typeof(Y="function"==typeof e?e:null)&&q.addEventListener("processorerror",Y)},get parameters(){return U},get port(){return w.port2},addEventListener:function(){return D.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:e.bind(null,K),disconnect:l.bind(null,K),dispatchEvent:function(){return D.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return D.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},Q=new Map;w.port1.addEventListener=(z=w.port1.addEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var i="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==i){var r=Q.get(t[1]);void 0!==r?t[1]=r:(t[1]=function(e){c(g.currentTime,g.sampleRate,(function(){return i(e)}))},Q.set(i,t[1]))}}return z.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(H=w.port1.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var i=Q.get(t[1]);void 0!==i&&(Q.delete(t[1]),t[1]=i)}return H.call(w.port1,t[0],t[1],t[2])});var $=null;Object.defineProperty(w.port1,"onmessage",{get:function(){return $},set:function(e){"function"==typeof $&&w.port1.removeEventListener("message",$),"function"==typeof($="function"==typeof e?e:null)&&(w.port1.addEventListener("message",$),w.port1.start())}}),S.prototype.port=w.port1;var ee=null,te=function(e,t,n,i){var r=I.get(e);void 0===r&&(r=new WeakMap,I.set(e,r));var a=function(){var e=v(f.mark((function e(t,n){var i;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(e){return new Promise((function(t,n){var i=new MessageChannel,r=i.port1,a=i.port2;r.onmessage=function(e){var n=e.data;r.close(),a.close(),t(n)},r.onmessageerror=function(e){var t=e.data;r.close(),a.close(),n(t)},a.postMessage(e)}))}(n);case 2:return i=e.sent,e.abrupt("return",new t(i));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(n,i);return r.set(t,a),a}(g,q,S,x);te.then((function(e){return ee=e}));var ne=Ie(x.numberOfInputs,x.channelCount),ie=Ie(x.numberOfOutputs,_),re=void 0===S.parameterDescriptors?[]:S.parameterDescriptors.reduce((function(e,t){var n=t.name;return m(m({},e),{},p({},n,new Float32Array(128)))}),{}),ae=!0,se=function(){x.numberOfOutputs>0&&D.disconnect(F);for(var e=0,t=0;e<x.numberOfOutputs;e+=1){for(var n=j[e],i=0;i<_[e];i+=1)F.disconnect(n,t+i,i);t+=_[e]}},oe=new Map;D.onaudioprocess=function(e){var t=e.inputBuffer,n=e.outputBuffer;null!==ee&&function(){for(var e=h(q),i=function(i){for(var r=0;r<x.numberOfInputs;r+=1)for(var a=0;a<x.channelCount;a+=1)Te(t,ne[r],a,a,i);void 0!==S.parameterDescriptors&&S.parameterDescriptors.forEach((function(e,n){var r=e.name;Te(t,re,r,E+n,i)}));for(var s=0;s<x.numberOfInputs;s+=1)for(var o=0;o<_[s];o+=1)0===ie[s][o].byteLength&&(ie[s][o]=new Float32Array(128));try{var u=ne.map((function(t,n){if(e[n].size>0)return oe.set(n,B/128),t;var i=oe.get(n);return void 0===i?[]:(t.every((function(e){return e.every((function(e){return 0===e}))}))&&(1===i?oe.delete(n):oe.set(n,i-1)),t)})),l=c(g.currentTime+i/g.sampleRate,g.sampleRate,(function(){return ee.process(u,ie,re)}));ae=l;for(var h=0,d=0;h<x.numberOfOutputs;h+=1){for(var f=0;f<_[h];f+=1)Ce(n,ie[h],f,d+f,i);d+=_[h]}}catch(t){ae=!1,q.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!ae){for(var p=0;p<x.numberOfInputs;p+=1){P[p].disconnect(T[p]);for(var m=0;m<x.channelCount;m+=1)T[i].disconnect(N,m,p*x.channelCount+m)}if(void 0!==S.parameterDescriptors)for(var v=S.parameterDescriptors.length,y=0;y<v;y+=1){var b=A[y];b.disconnect(N,0,E+y),b.stop()}return N.disconnect(D),D.onaudioprocess=null,ue?se():he(),"break"}},r=0;r<B&&"break"!==i(r);r+=128);}()};var ue=!1,le=s(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ce=function(){return D.connect(le).connect(g.destination)},he=function(){D.disconnect(le),le.disconnect()};return ce(),d(q,(function(){if(ae){he(),x.numberOfOutputs>0&&D.connect(F);for(var e=0,t=0;e<x.numberOfOutputs;e+=1){for(var n=j[e],i=0;i<_[e];i+=1)F.connect(n,t+i,i);t+=_[e]}}ue=!0}),(function(){ae&&(ce(),se()),ue=!1}))}}(Li,Y,We,Mn,it,An,st,mt,vt,Ri,gi,Bi,En),Fi=function(e,t,n,i,r){return function(a,s,o,u,l,c){if(null!==o)try{var h=new o(a,u,c),d=new Map,f=null;if(Object.defineProperties(h,{channelCount:{get:function(){return c.channelCount},set:function(){throw e()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw e()}},onprocessorerror:{get:function(){return f},set:function(e){"function"==typeof f&&h.removeEventListener("processorerror",f),"function"==typeof(f="function"==typeof e?e:null)&&h.addEventListener("processorerror",f)}}}),h.addEventListener=(g=h.addEventListener,function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if("processorerror"===n[0]){var r="function"==typeof n[1]?n[1]:"object"==typeof n[1]&&null!==n[1]&&"function"==typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==r){var a=d.get(n[1]);void 0!==a?n[1]=a:(n[1]=function(e){"error"===e.type?(Object.defineProperties(e,{type:{value:"processorerror"}}),r(e)):r(new ErrorEvent(n[0],m({},e)))},d.set(r,n[1]))}}return g.call(h,"error",n[1],n[2]),(e=g).call.apply(e,[h].concat(n))}),h.removeEventListener=(v=h.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("processorerror"===t[0]){var i=d.get(t[1]);void 0!==i&&(d.delete(t[1]),t[1]=i)}return v.call(h,"error",t[1],t[2]),v.call(h,t[0],t[1],t[2])}),0!==c.numberOfOutputs){var p=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(a.destination),r(h,(function(){return p.disconnect()}),(function(){return p.connect(a.destination)}))}return h}catch(e){if(11===e.code)throw i();throw e}var v,g;if(void 0===l)throw i();return function(e){var t=(new MessageChannel).port1;try{t.postMessage(e)}finally{t.close()}}(c),t(a,s,l,c)}}(We,Di,st,vt,En),ji=function(e,t,n,i,r,a,s,o,u,l,c,h,d,p,m,g){return function(y,S,_){var E=new WeakMap,k=null;return{render:function(M,w){o(w,M);var P=E.get(w);return void 0!==P?Promise.resolve(P):function(){var o=v(f.mark((function o(M,w){var P,T,C,I,A,L,O,R,N,B,D,F,j,V,G,W,U,z,X,Y,K,q,Z,J,Q,$,ee,te,ne,ie,re,ae,se;return f.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(P=c(M),T=null,C=H(P,w),I=Array.isArray(S.outputChannelCount)?S.outputChannelCount:Array.from(S.outputChannelCount),null===h){for(A=I.reduce((function(e,t){return e+t}),0),L=r(w,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),O=[],R=0;R<M.numberOfOutputs;R+=1)O.push(i(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:I[R]}));(N=s(w,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})).connect=t.bind(null,O),N.disconnect=u.bind(null,O),T=[L,O,N]}else C||(P=new h(w,y));if(E.set(w,null===T?P:T[2]),null===T){o.next=38;break}if(null!==k){o.next=26;break}if(void 0!==_){o.next=7;break}throw new Error("Missing the processor constructor.");case 7:if(null!==d){o.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:if(B=M.channelCount*M.numberOfInputs,D=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length,F=B+D,j=function(){var e=v(f.mark((function e(){var t,n,o,u,l,c,h,y,_,E,k,P,T;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new d(F,128*Math.ceil(M.context.length/128),w.sampleRate),n=[],o=[],u=0;u<S.numberOfInputs;u+=1)n.push(s(t,{channelCount:S.channelCount,channelCountMode:S.channelCountMode,channelInterpretation:S.channelInterpretation,gain:1})),o.push(r(t,{channelCount:S.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:S.channelCount}));return e.next=4,Promise.all(Array.from(M.parameters.values()).map(function(){var e=v(f.mark((function e(n){var i;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n.value}),e.next=3,p(t,n,i.offset);case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:for(l=e.sent,c=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,B+D)}),h=0;h<S.numberOfInputs;h+=1)for(n[h].connect(o[h]),y=0;y<S.channelCount;y+=1)o[h].connect(c,y,h*S.channelCount+y);_=b(l.entries());try{for(_.s();!(E=_.n()).done;)k=x(E.value,2),P=k[0],(T=k[1]).connect(c,0,B+P),T.start(0)}catch(C){_.e(C)}finally{_.f()}return c.connect(t.destination),e.next=12,Promise.all(n.map((function(e){return m(M,t,e)})));case 12:return e.abrupt("return",g(t));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o.t0=Ae,o.t1=M,0!==F){o.next=16;break}o.t2=null,o.next=19;break;case 16:return o.next=18,j();case 18:o.t2=o.sent;case 19:o.t3=o.t2,o.t4=w,o.t5=S,o.t6=I,o.t7=_,o.t8=l,k=(0,o.t0)(o.t1,o.t3,o.t4,o.t5,o.t6,o.t7,o.t8);case 26:return o.next=28,k;case 28:for(V=o.sent,G=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),W=x(T,3),U=W[0],z=W[1],X=W[2],null!==V&&(G.buffer=V,G.start(0)),G.connect(U),Y=0,K=0;Y<M.numberOfOutputs;Y+=1){for(q=z[Y],Z=0;Z<I[Y];Z+=1)U.connect(q,K+Z,Z);K+=I[Y]}return o.abrupt("return",X);case 38:if(!C){o.next=58;break}J=b(M.parameters.entries()),o.prev=40,J.s();case 42:if((Q=J.n()).done){o.next=48;break}return $=x(Q.value,2),ee=$[0],te=$[1],o.next=46,e(w,te,P.parameters.get(ee));case 46:o.next=42;break;case 48:o.next=53;break;case 50:o.prev=50,o.t9=o.catch(40),J.e(o.t9);case 53:return o.prev=53,J.f(),o.finish(53);case 56:o.next=75;break;case 58:ne=b(M.parameters.entries()),o.prev=59,ne.s();case 61:if((ie=ne.n()).done){o.next=67;break}return re=x(ie.value,2),ae=re[0],se=re[1],o.next=65,p(w,se,P.parameters.get(ae));case 65:o.next=61;break;case 67:o.next=72;break;case 69:o.prev=69,o.t10=o.catch(59),ne.e(o.t10);case 72:return o.prev=72,ne.f(),o.finish(72);case 75:return o.next=77,m(M,w,P);case 77:return o.abrupt("return",P);case 78:case"end":return o.stop()}}),o,null,[[40,50,53,56],[59,69,72,75]])})));return function(e,t){return o.apply(this,arguments)}}()(M,w)}}}}(fn,Li,pn,Mn,it,An,st,Oi,Ri,gi,ve,tn,Yt,mn,zt,Hn),Vi=function(e){return function(t){return e.get(t)}}(yi),Gi=function(e){return function(t,n){e.set(t,n)}}(Ni),Wi=vi?function(e,t,n,i,r,a,s,o,u,l,f,p,v,b){return function(t){h(v,t);var f=d(v);function v(t,h,d){var y,b;g(this,v);var S=o(t),x=u(S),_=function(e){return m(m({},e),{},{outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(function(){return 1}))})}(m(m({},Pe),d));!function(e){var t=new MessageChannel,n=t.port1,i=t.port2;try{n.postMessage(e)}finally{n.close(),i.close()}}(_);var E=C.get(S),k=null==E?void 0:E.get(h),M=x||"closed"!==S.state?S:null!==(b=s(S))&&void 0!==b?b:S,w=r(M,x?null:t.baseLatency,l,h,k,_);y=f.call(this,t,!0,w,x?i(h,_,k):null);var P=[];w.parameters.forEach((function(e,t){var i=n(c(y),x,e);P.push([t,i])})),y._nativeAudioWorkletNode=w,y._onprocessorerror=null,y._parameters=new we(P),x&&e(S,c(y));var T=a(c(y)).activeInputs;return p(w,T),y}return y(v,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(e){var t="function"==typeof e?b(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}]),v}(t)}(Ai,nn,gn,ji,Fi,ee,Vi,Xt,Kt,tn,0,Gi,0,Rt):void 0,Ui=function(e,t,n,i,r){return function(i){h(s,i);var a=d(s);function s(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(g(this,s),null===r)throw new Error("Missing the native AudioContext constructor.");try{i=new r(o)}catch(o){if(12===o.code&&"sampleRate is not in range"===o.message)throw t();throw o}if(null===i)throw n();if(!re(o.latencyHint))throw new TypeError("The provided value '".concat(o.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==o.sampleRate&&i.sampleRate!==o.sampleRate)throw t();e=a.call(this,i,2);var u=o.latencyHint,l=i.sampleRate;if(e._baseLatency="number"==typeof i.baseLatency?i.baseLatency:"balanced"===u?512/l:"interactive"===u||void 0===u?256/l:"playback"===u?1024/l:128*Math.max(2,Math.min(128,Math.round(u*l/128)))/l,e._nativeAudioContext=i,"webkitAudioContext"===r.name?(e._nativeGainNode=i.createGain(),e._nativeOscillatorNode=i.createOscillator(),e._nativeGainNode.gain.value=1e-37,e._nativeOscillatorNode.connect(e._nativeGainNode).connect(i.destination),e._nativeOscillatorNode.start()):(e._nativeGainNode=null,e._nativeOscillatorNode=null),e._state=null,"running"===i.state){e._state="suspended";var c=function t(){"suspended"===e._state&&(e._state=null),i.removeEventListener("statechange",t)};i.addEventListener("statechange",c)}return e}return y(s,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var t=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==t._nativeGainNode&&null!==t._nativeOscillatorNode&&(t._nativeOscillatorNode.stop(),t._nativeGainNode.disconnect(),t._nativeOscillatorNode.disconnect()),ie(t)})))}},{key:"resume",value:function(){var t=this;return"suspended"===this._state?new Promise((function(e,n){var i=function i(){t._nativeAudioContext.removeEventListener("statechange",i),"running"===t._nativeAudioContext.state?e():t.resume().then(e,n)};t._nativeAudioContext.addEventListener("statechange",i)})):this._nativeAudioContext.resume().catch((function(t){if(void 0===t||15===t.code)throw e();throw t}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(t){if(void 0===t)throw e();throw t}))}}]),s}(i)}(We,vt,_t,Jn,Jt),zi=function(e,t){return function(n,i,r){if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,i,r)}catch(t){if("SyntaxError"===t.name)throw e();throw t}}}(vt,Yt),Hi=function(e,t,n,i,r,a,s,o){return function(u,l){return n(u).render(u,l).then((function(){return Promise.all(Array.from(i(l)).map((function(e){return n(e).render(e,l)})))})).then((function(){return r(l)})).then((function(n){return"function"!=typeof n.copyFromChannel?(s(n),K(n)):t(a,(function(){return a(n)}))||o(n),e.add(n),n}))}}(an,Vt,Ut,Ii,Hn,X,un,ln),Xi=function(e,t,n,i,r){return function(i){h(s,i);var a=d(s);function s(t){var i;g(this,s);var r=m(m({},Ke),t),o=r.length,u=r.numberOfChannels,l=r.sampleRate,c=n(u,o,l);return e(Ye,(function(){return Ye(c)}))||c.addEventListener("statechange",function(){var e=0,t=function t(n){"running"===i._state&&(e>0?(c.removeEventListener("statechange",t),n.stopImmediatePropagation(),i._waitForThePromiseToSettle(n)):e+=1)};return t}()),(i=a.call(this,c,u))._length=o,i._nativeOfflineAudioContext=c,i._state=null,i}return y(s,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var e=this;return"running"===this._state?Promise.reject(t()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){e._state=null,ie(e)})))}},{key:"_waitForThePromiseToSettle",value:function(e){var t=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((function(){return t._waitForThePromiseToSettle(e)}))}}]),s}(i)}(Vt,We,zi,Jn,Hi),Yi=function(e,t,n,i,r){return function(e){h(s,e);var a=d(s);function s(e,n,r){var o,u;if(g(this,s),"number"==typeof e&&void 0!==n&&void 0!==r)u={length:n,numberOfChannels:e,sampleRate:r};else{if("object"!=typeof e)throw new Error("The given parameters are not valid.");u=e}var l=m(m({},gt),u),c=l.length,h=l.numberOfChannels,d=l.sampleRate,f=i(h,c,d);return t(Ye,(function(){return Ye(f)}))||f.addEventListener("statechange",function(){var e=0,t=function t(n){"running"===o._state&&(e>0?(f.removeEventListener("statechange",t),n.stopImmediatePropagation(),o._waitForThePromiseToSettle(n)):e+=1)};return t}()),(o=a.call(this,f,h))._length=c,o._nativeOfflineAudioContext=f,o._state=null,o}return y(s,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var e=this;return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){e._state=null,ie(e)})))}},{key:"_waitForThePromiseToSettle",value:function(e){var t=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((function(){return t._waitForThePromiseToSettle(e)}))}}]),s}(e)}(Ei,Vt,We,zi,Hi),Ki=function(e,t){return function(n){var i=e.get(n);return t(i)||t(n)}}(w,Qt),qi=function(e,t){return function(n){return e.has(n)||t(n)}}(s,$t),Zi=function(e,t){return function(n){return e.has(n)||t(n)}}(u,en),Ji=function(e,t){return function(n){var i=e.get(n);return t(i)||t(n)}}(w,Kt),Qi=function(){return function(){var e=v(f.mark((function e(t,n,i,r,a,s,o,u,l,c,h,d,p,m,v,g){return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!!(t(n,n)&&t(i,i)&&t(a,a)&&t(s,s)&&t(u,u)&&t(l,l)&&t(c,c)&&t(h,h)&&t(d,d)&&t(p,p)&&t(m,m)),!e.t0){e.next=5;break}return e.next=4,Promise.all([t(r,r),t(o,o),t(v,v),t(g,g)]);case 4:e.t0=e.sent.every((function(e){return e}));case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t,n,i,r,a,s,o,u,l,c,h,d,f,p,m,v){return e.apply(this,arguments)}}()(Vt,function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;var n=new Float32Array(2);try{t.copyFromChannel(n,0,0)}catch(i){return!1}return!0}}(Yt),function(e){return function(){if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;var t=new e,n=void 0!==t.close;try{t.close()}catch(i){}return n}}(Jt),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);return new Promise((function(e){var n,i=!0,r=function(n){i&&(i=!1,t.startRendering(),e(n instanceof TypeError))};try{n=t.decodeAudioData(null,(function(){}),r)}catch(e){r(e)}void 0!==n&&n.catch(r)}))}}(Yt),function(e){return function(){if(null===e)return!1;var t;try{t=new e({latencyHint:"balanced"})}catch(n){return!1}return t.close(),!0}}(Jt),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createGain(),n=t.connect(t)===t;return t.disconnect(t),n}}(Yt),function(e,t){return v(f.mark((function n(){var i,r,a,s,o,u,l;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return i=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new MessageChannel,a=new t(1,128,44100),s=URL.createObjectURL(i),o=!1,n.prev=6,n.next=9,a.audioWorklet.addModule(s);case 9:return u=new e(a,"a",{numberOfOutputs:0}),l=a.createOscillator(),n.next=12,new Promise((function(e){u.port.onmessage=function(){return e()},u.port.postMessage(r.port2,[r.port2])}));case 12:return u.port.onmessage=function(){return o=!0},l.connect(u),l.start(0),n.next=17,a.startRendering();case 17:return n.next=19,new Promise((function(e){r.port1.onmessage=function(t){var n=t.data;return e(1===n)},r.port1.postMessage(0)}));case 19:o=n.sent,n.next=24;break;case 22:n.prev=22,n.t0=n.catch(6);case 24:return n.prev=24,r.port1.close(),URL.revokeObjectURL(s),n.finish(24);case 27:return n.abrupt("return",o);case 28:case"end":return n.stop()}}),n,null,[[6,22,24,27]])})))}(tn,Yt),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createChannelMerger();if("max"===t.channelCountMode)return!0;try{t.channelCount=2}catch(n){return!0}return!1}}(Yt),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100);return void 0===t.createConstantSource||t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}}(Yt),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100),n=t.createConvolver();n.buffer=t.createBuffer(1,1,t.sampleRate);try{n.buffer=t.createBuffer(1,1,t.sampleRate)}catch(i){return!1}return!0}}(Yt),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createConvolver();try{t.channelCount=1}catch(n){return!1}return!0}}(Yt),At,function(e){return function(){return null!==e&&e.hasOwnProperty("isSecureContext")}}(Gt),function(e){return function(){if(null===e)return!1;var t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}finally{t.close()}}}(Jt),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);var n=t.createConstantSource(),i=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(t.destination),t.startRendering().then((function(e){return 1!==e.getChannelData(0)[0]}))}}(Yt),Lt)}},8151:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CursorPosChangedData=void 0,t.CursorPosChangedData=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;g(this,e),this.ResetOccurred=!1,this.CurrentMeasureIndex=t,this.CurrentRepetition=n,this.CurrentRepetitionIteration=i,this.PredictedPosition=r,this.CurrentBpm=a}return e}()},1797:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fraction=void 0;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];g(this,e),this.numerator=0,this.denominator=1,this.wholeValue=0,this.numerator=t,this.denominator=n,this.wholeValue=i,r&&this.simplify(),this.setRealValue()}return y(e,[{key:"toString",value:function(){var e=this.numerator+"/"+this.denominator;return 0!==this.wholeValue&&(e=this.wholeValue+" "+e),e}},{key:"clone",value:function(){return new e(this.numerator,this.denominator,this.wholeValue,!1)}},{key:"Numerator",get:function(){return this.numerator},set:function(e){this.numerator!==e&&(this.numerator=e,this.simplify(),this.setRealValue())}},{key:"Denominator",get:function(){return this.denominator},set:function(e){this.denominator!==e&&(this.denominator=e,0!==this.numerator&&this.simplify(),this.setRealValue())}},{key:"WholeValue",get:function(){return this.wholeValue},set:function(e){this.wholeValue!==e&&(this.wholeValue=e,this.setRealValue())}},{key:"GetExpandedNumerator",value:function(){return this.wholeValue*this.denominator+this.numerator}},{key:"calculateNumberOfNeededDots",value:function(){for(var e=1,t=2,n=this.GetExpandedNumerator();t<n;)e++,t=Math.pow(2,e);return Math.min(3,e-1)}},{key:"IsNegative",value:function(){return this.realValue<0}},{key:"RealValue",get:function(){return this.realValue}},{key:"expand",value:function(e){this.numerator*=e,this.denominator*=e,0!==this.wholeValue&&(this.numerator+=this.wholeValue*this.denominator,this.wholeValue=0)}},{key:"Add",value:function(e){return this.numerator=(this.wholeValue*this.denominator+this.numerator)*e.denominator+(e.wholeValue*e.denominator+e.numerator)*this.denominator,this.denominator=this.denominator*e.denominator,this.wholeValue=0,this.simplify(),this.setRealValue(),this}},{key:"Sub",value:function(e){return this.numerator=(this.wholeValue*this.denominator+this.numerator)*e.denominator-(e.wholeValue*e.denominator+e.numerator)*this.denominator,this.denominator=this.denominator*e.denominator,this.wholeValue=0,this.simplify(),this.setRealValue(),this}},{key:"getHalfLength",value:function(){return new e(this.WholeValue,2).Add(new e(this.Numerator,2*this.Denominator))}},{key:"Quantize",value:function(t){if(this.denominator<=t)return this;for(var n=new e(this.numerator+1,this.denominator,this.wholeValue);n.Denominator>t;)n.Numerator++;if(this.numerator>this.denominator){for(var i=new e(this.numerator-1,this.denominator,this.wholeValue);i.Denominator>t;)i.Numerator--;if(i.Denominator<n.Denominator)return i}return n}},{key:"Equals",value:function(e){return this.realValue===(null==e?void 0:e.realValue)}},{key:"CompareTo",value:function(e){var t=this.realValue-e.realValue;return t?t<0?-1:1:0}},{key:"lt",value:function(e){return this.realValue<e.realValue}},{key:"lte",value:function(e){return this.realValue<=e.realValue}},{key:"gt",value:function(e){return!this.lte(e)}},{key:"gte",value:function(e){return!this.lt(e)}},{key:"setRealValue",value:function(){this.realValue=this.wholeValue+this.numerator/this.denominator}},{key:"simplify",value:function(){if(0!==this.numerator){var t=e.greatestCommonDenominator(Math.abs(this.numerator),Math.abs(this.denominator));this.numerator/=t,this.denominator/=t;var n=Math.floor(this.numerator/this.denominator);if(0!==n&&(this.wholeValue+=n,this.numerator-=n*this.denominator,0===this.numerator&&(this.denominator=1)),this.denominator>e.maximumAllowedNumber){var i=this.denominator/e.maximumAllowedNumber;this.numerator=Math.round(this.numerator/i),this.denominator=Math.round(this.denominator/i)}if(this.numerator>e.maximumAllowedNumber){var r=this.numerator/e.maximumAllowedNumber;this.numerator=Math.round(this.numerator/r),this.denominator=Math.round(this.denominator/r)}}else this.denominator=1}},{key:"isOnBeat",value:function(t){var n=this.distanceFromBeat(t);return Math.abs(n)<e.FloatInaccuracyTolerance}},{key:"distanceFromBeat",value:function(t){var n=new e(1,t.Denominator);return this.RealValue%n.RealValue}}],[{key:"max",value:function(e,t){return e.RealValue>t.RealValue?e:t}},{key:"Equal",value:function(e,t){return e.wholeValue===t.wholeValue&&e.Denominator===t.Denominator&&e.Numerator===t.Numerator}},{key:"createFromFraction",value:function(t){return new e(t.numerator,t.denominator,t.wholeValue,!1)}},{key:"plus",value:function(e,t){var n=e.clone();return n.Add(t),n}},{key:"minus",value:function(e,t){var n=e.clone();return n.Sub(t),n}},{key:"multiply",value:function(t,n){return new e((t.wholeValue*t.denominator+t.numerator)*(n.wholeValue*n.denominator+n.numerator),t.denominator*n.denominator)}},{key:"greatestCommonDenominator",value:function(e,t){if(0===e)return t;if(1===t)return 1;for(;Math.abs(t)>1e-8;)e>t?e-=t:t-=e;return Math.round(e)}}]),e}();t.Fraction=n,n.maximumAllowedNumber=46340,n.FloatInaccuracyTolerance=1e-4},8363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix2D=void 0;var i=n(9086),r=function(){function e(){g(this,e),this.matrix=[];for(var t=0;t<2;t++){this.matrix[t]=[];for(var n=0;n<2;n++)this.matrix[t][n]=0}}return y(e,[{key:"scalarMultiplication",value:function(e){for(var t=0;t<2;t++)for(var n=0;n<2;n++)this.matrix[t][n]*=e}},{key:"getTransposeMatrix",value:function(){for(var t=new e,n=0;n<2;n++)for(var i=0;i<2;i++)t.matrix[n][i]=this.matrix[i][n];return t}},{key:"vectorMultiplication",value:function(e){var t=new i.PointF2D;return t.x=e.x*this.matrix[0][0]+e.y*this.matrix[0][1],t.y=e.x*this.matrix[1][0]+e.y*this.matrix[1][1],t}}],[{key:"getRotationMatrix",value:function(t){var n=new e,i=Math.cos(t),r=Math.sin(t);return n.matrix[0][0]=i,n.matrix[0][1]=-r,n.matrix[1][0]=r,n.matrix[1][1]=i,n}}]),e}();t.Matrix2D=r},9651:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSheetErrors=void 0,t.MusicSheetErrors=function(){function e(){g(this,e),this.measureErrors={},this.errors=[],this.tempErrors=[]}return y(e,[{key:"finalizeMeasure",value:function(e){var t=this.measureErrors[e];t||(t=[]),this.measureErrors[e]=t.concat(this.tempErrors),this.tempErrors=[]}},{key:"pushMeasureError",value:function(e){this.tempErrors.push(e)}},{key:"push",value:function(e){this.errors.push(e)}}]),e}()},9855:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OSMDColor=void 0;var n=function(){function e(t,n,i){g(this,e),this.alpha=255,this.red=t,this.green=n,this.blue=i}return y(e,[{key:"toHexString",value:function(){var e=(256|this.red).toString(16).slice(1)+(256|this.green).toString(16).slice(1)+(256|this.blue).toString(16).slice(1);return"#"+(e+=(256|this.alpha).toString(16).slice(1))}},{key:"toString",value:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"}}],[{key:"Black",get:function(){return new e(0,0,0)}},{key:"DeepSkyBlue",get:function(){return new e(0,191,255)}},{key:"Green",get:function(){return new e(20,160,20)}},{key:"Magenta",get:function(){return new e(255,0,255)}},{key:"Orange",get:function(){return new e(255,128,0)}},{key:"Red",get:function(){return new e(240,20,20)}},{key:"Disabled",get:function(){return new e(225,225,225)}},{key:"DarkBlue",get:function(){return new e(0,0,140)}},{key:"Debug1",get:function(){return new e(200,0,140)}},{key:"Debug2",get:function(){return new e(100,100,200)}},{key:"Debug3",get:function(){return new e(0,50,140)}}]),e}();t.OSMDColor=n},8640:function(e,t){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Pitch=t.AccidentalEnum=t.NoteEnum=void 0,function(e){e[e.C=0]="C",e[e.D=2]="D",e[e.E=4]="E",e[e.F=5]="F",e[e.G=7]="G",e[e.A=9]="A",e[e.B=11]="B"}(n=t.NoteEnum||(t.NoteEnum={})),function(e){e[e.SHARP=0]="SHARP",e[e.FLAT=1]="FLAT",e[e.NONE=2]="NONE",e[e.NATURAL=3]="NATURAL",e[e.DOUBLESHARP=4]="DOUBLESHARP",e[e.DOUBLEFLAT=5]="DOUBLEFLAT",e[e.TRIPLESHARP=6]="TRIPLESHARP",e[e.TRIPLEFLAT=7]="TRIPLEFLAT",e[e.QUARTERTONESHARP=8]="QUARTERTONESHARP",e[e.QUARTERTONEFLAT=9]="QUARTERTONEFLAT",e[e.SLASHFLAT=10]="SLASHFLAT",e[e.THREEQUARTERSSHARP=11]="THREEQUARTERSSHARP",e[e.THREEQUARTERSFLAT=12]="THREEQUARTERSFLAT",e[e.SLASHQUARTERSHARP=13]="SLASHQUARTERSHARP",e[e.SLASHSHARP=14]="SLASHSHARP",e[e.DOUBLESLASHFLAT=15]="DOUBLESLASHFLAT",e[e.SORI=16]="SORI",e[e.KORON=17]="KORON"}(i=t.AccidentalEnum||(t.AccidentalEnum={}));var r=function(){function e(t,n,r,a){g(this,e),this.accidental=i.NONE,this.fundamentalNote=t,this.octave=n,this.accidental=r,this.accidentalXml=a,this.halfTone=t+12*(n+e.octXmlDiff)+e.HalfTonesFromAccidental(r),this.frequency=e.calcFrequency(this)}return y(e,[{key:"AccidentalHalfTones",get:function(){return e.HalfTonesFromAccidental(this.accidental)}},{key:"Octave",get:function(){return this.octave}},{key:"FundamentalNote",get:function(){return this.fundamentalNote}},{key:"Accidental",get:function(){return this.accidental}},{key:"AccidentalXml",get:function(){return this.accidentalXml}},{key:"Frequency",get:function(){return this.frequency}},{key:"getHalfTone",value:function(){return this.halfTone}},{key:"getTransposedPitch",value:function(e){if(e>12)throw new Error("rewrite this method to handle bigger octave changes or don't use is with bigger octave changes!");return e>0?this.getHigherPitchByTransposeFactor(e):e<0?this.getLowerPitchByTransposeFactor(-e):this}},{key:"DoEnharmonicChange",value:function(){switch(this.accidental){case i.FLAT:case i.DOUBLEFLAT:this.fundamentalNote=this.getPreviousFundamentalNote(this.fundamentalNote),this.accidental=e.AccidentalFromHalfTones(this.halfTone-(this.fundamentalNote+12*(this.octave+e.octXmlDiff)));break;case i.SHARP:case i.DOUBLESHARP:this.fundamentalNote=this.getNextFundamentalNote(this.fundamentalNote),this.accidental=e.AccidentalFromHalfTones(this.halfTone-(this.fundamentalNote+12*(this.octave+e.octXmlDiff)));break;default:return}}},{key:"ToString",value:function(){var t=e.accidentalVexflow(this.accidental);return t||(t=""),"Key: "+e.getNoteEnumString(this.fundamentalNote)+t+", Note: "+this.fundamentalNote+", octave: "+this.octave.toString()}},{key:"OperatorEquals",value:function(e){var t=this;return!(!t||!e)&&t.FundamentalNote===e.FundamentalNote&&t.Octave===e.Octave&&t.Accidental===e.Accidental}},{key:"OperatorNotEqual",value:function(e){return!(this===e)}},{key:"OperatorFundamentalGreaterThan",value:function(e){var t=this;return t.Octave===e.Octave?t.FundamentalNote>e.FundamentalNote:t.Octave>e.Octave}},{key:"OperatorFundamentalLessThan",value:function(e){var t=this;return t.Octave===e.Octave?t.FundamentalNote<e.FundamentalNote:t.Octave<e.Octave}},{key:"getHigherPitchByTransposeFactor",value:function(t){var n,r=e.pitchEnumValues.indexOf(this.fundamentalNote),a=this.octave;return r+t>e.pitchEnumValues.length-1?(n=e.pitchEnumValues[r+t-e.pitchEnumValues.length],a++):n=e.pitchEnumValues[r+t],new e(n,a,i.NONE)}},{key:"getLowerPitchByTransposeFactor",value:function(t){var n,r=e.pitchEnumValues.indexOf(this.fundamentalNote),a=this.octave;return r-t<0?(n=e.pitchEnumValues[e.pitchEnumValues.length+r-t],a--):n=e.pitchEnumValues[r-t],new e(n,a,i.NONE)}},{key:"getNextFundamentalNote",value:function(t){var n=e.pitchEnumValues.indexOf(t);return n=(n+1)%e.pitchEnumValues.length,e.pitchEnumValues[n]}},{key:"getPreviousFundamentalNote",value:function(t){var n=e.pitchEnumValues.indexOf(t);return n>0?e.pitchEnumValues[n-1]:e.pitchEnumValues[e.pitchEnumValues.length-1]}}],[{key:"getNoteEnumString",value:function(e){switch(e){case n.C:return"C";case n.D:return"D";case n.E:return"E";case n.F:return"F";case n.G:return"G";case n.A:return"A";case n.B:return"B";default:return""}}},{key:"lineShiftFromNoteEnum",value:function(t,n){if(0===n)return[t,0];var i=e.pitchEnumValues,r=i.indexOf(t),a=0,s=(r+n)%i.length;return r+n>i.length-1&&(a=1),s<0&&(s=i.length+s,a=-1),[i[s],a]}},{key:"CalculateTransposedHalfTone",value:function(t,n){var i=t.fundamentalNote+t.AccidentalHalfTones+n;return e.WrapAroundCheck(i,12)}},{key:"WrapAroundCheck",value:function(e,t){for(var n=0;e<0;)e+=t,n--;for(;e>=t;)e-=t,n++;return{overflow:n,halftone:e}}},{key:"calcFrequency",value:function(t){var i,r=0;if(t instanceof e){var a=t;r=a.octave-1,i=a.fundamentalNote-n.A+a.AccidentalHalfTones}else"number"==typeof t&&(i=t-57);return 440*Math.pow(2,r)*Math.pow(2,i/12)}},{key:"calcFractionalKey",value:function(t){return Math.log(t/440)/Math.LN10*e.halftoneFactor+57}},{key:"fromFrequency",value:function(t){var n=e.calcFractionalKey(t)+.5,r=Math.floor(n/12)-e.octXmlDiff,a=Math.floor(n)%12,s=a,o=i.NONE;return-1===this.pitchEnumValues.indexOf(s)&&(s=a-1,o=i.SHARP),new e(s,r,o)}},{key:"fromHalftone",value:function(t){var n=Math.floor(t/12)-e.octXmlDiff,r=t%12,a=r,s=i.NONE;return-1===this.pitchEnumValues.indexOf(a)&&(a=r-1,s=i.SHARP),new e(a,n,s)}},{key:"ceiling",value:function(e){var t=e%=12;return-1===this.pitchEnumValues.indexOf(t)&&(t=e+1),t}},{key:"floor",value:function(e){var t=e%=12;return-1===this.pitchEnumValues.indexOf(t)&&(t=e-1),t}},{key:"HalfTonesFromAccidental",value:function(e){switch(e){case i.NONE:return 0;case i.SHARP:return 1;case i.FLAT:return-1;case i.NATURAL:return 0;case i.DOUBLESHARP:return 2;case i.DOUBLEFLAT:return-2;case i.TRIPLESHARP:return 3;case i.TRIPLEFLAT:return-3;case i.QUARTERTONESHARP:return.5;case i.QUARTERTONEFLAT:return-.5;case i.SLASHFLAT:return-.51;case i.THREEQUARTERSSHARP:return 1.5;case i.THREEQUARTERSFLAT:return-1.5;case i.SLASHQUARTERSHARP:return.0013;case i.SLASHSHARP:return.0014;case i.DOUBLESLASHFLAT:return-.0015;case i.SORI:return.0016;case i.KORON:return.0017;default:throw new Error("Unhandled AccidentalEnum value")}}},{key:"AccidentalFromHalfTones",value:function(e){switch(e){case 0:return i.NONE;case 1:return i.SHARP;case-1:return i.FLAT;case 2:return i.DOUBLESHARP;case-2:return i.DOUBLEFLAT;case 3:return i.TRIPLESHARP;case-3:return i.TRIPLEFLAT;case.5:return i.QUARTERTONESHARP;case-.5:return i.QUARTERTONEFLAT;case 1.5:return i.THREEQUARTERSSHARP;case-1.5:return i.THREEQUARTERSFLAT;default:return e>0&&e<1?i.QUARTERTONESHARP:e<0&&e>-1?i.QUARTERTONEFLAT:i.QUARTERTONESHARP}}},{key:"accidentalVexflow",value:function(e){var t;switch(e){case i.NATURAL:t="n";break;case i.FLAT:t="b";break;case i.SHARP:t="#";break;case i.DOUBLESHARP:t="##";break;case i.TRIPLESHARP:t="###";break;case i.DOUBLEFLAT:t="bb";break;case i.TRIPLEFLAT:t="bbs";break;case i.QUARTERTONESHARP:t="+";break;case i.QUARTERTONEFLAT:t="d";break;case i.SLASHFLAT:t="bs";break;case i.THREEQUARTERSSHARP:t="++";break;case i.THREEQUARTERSFLAT:t="db";break;case i.SLASHQUARTERSHARP:t="+-";break;case i.SLASHSHARP:t="++-";break;case i.DOUBLESLASHFLAT:t="bss";break;case i.SORI:t="o";break;case i.KORON:t="k"}return t}},{key:"OctaveXmlDifference",get:function(){return e.octXmlDiff}}]),e}();t.Pitch=r,r.pitchEnumValues=[n.C,n.D,n.E,n.F,n.G,n.A,n.B],r.halftoneFactor=12/(Math.LN2/Math.LN10),r.octXmlDiff=3},7359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackSettings=void 0;var i=n(1797),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.Fraction,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;g(this,e),this.rhythm=t,this.beatsPerMinute=n,this.beatLengthInMilliseconds=6e4/n,this.beatRealValue=1/4}return y(e,[{key:"BeatsPerMinute",get:function(){return this.beatsPerMinute},set:function(e){this.beatsPerMinute=e,this.beatLengthInMilliseconds=6e4/this.beatsPerMinute}},{key:"Rhythm",get:function(){return this.rhythm},set:function(e){this.rhythm=e}},{key:"BeatRealValue",get:function(){return this.beatRealValue}},{key:"BeatLengthInMilliseconds",get:function(){return this.beatLengthInMilliseconds}},{key:"getDurationInMilliseconds",value:function(e){return("number"==typeof e?e:e.RealValue)*this.BeatLengthInMilliseconds/this.beatRealValue}},{key:"getDurationAsNoteDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=e/this.BeatLengthInMilliseconds,r=Math.floor(n),a=new i.Fraction(r,4),s=n-r;return r=Math.round(s/(1/t)/4),0!==s&&0===r&&e>0&&(r=1),a.Add(new i.Fraction(r,t)),a}}],[{key:"createFrom",value:function(t){return new e(t.Rhythm,t.BeatsPerMinute)}}]),e}();t.PlaybackSettings=r},9086:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointF2D=void 0;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;g(this,e),this.x=0,this.y=0,this.x=t,this.y=n}return y(e,[{key:"ToString",value:function(){return"["+this.x+", "+this.y+"]"}}],[{key:"Empty",get:function(){return new e}},{key:"pointsAreEqual",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),e}();t.PointF2D=n},3278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleF2D=void 0;var i=n(739),r=n(9086),a=function(){function e(t,n,i,r){g(this,e),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=n,this.width=i,this.height=r}return y(e,[{key:"Location",get:function(){return new r.PointF2D(this.x,this.y)}},{key:"Size",get:function(){return new i.SizeF2D(this.width,this.height)}}],[{key:"createFromLocationAndSize",value:function(t,n){return new e(t.x,t.y,n.width,n.height)}}]),e}();t.RectangleF2D=a},739:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeF2D=void 0,t.SizeF2D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;g(this,e),this.width=t,this.height=n}return e}()},8918:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(1797),t),r(n(8363),t),r(n(9651),t),r(n(9855),t),r(n(8640),t),r(n(9086),t),r(n(3278),t),r(n(739),t)},2562:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FontStyleString=t.FontStyles=void 0,(n=t.FontStyles||(t.FontStyles={}))[n.Regular=0]="Regular",n[n.Bold=1]="Bold",n[n.Italic=2]="Italic",n[n.BoldItalic=3]="BoldItalic",n[n.Underlined=4]="Underlined",t.FontStyleString={Bold:1,BoldItalic:3,Italic:2,Regular:0,Underlined:4}},96:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FontStringNames=t.FontString=t.Fonts=void 0,(n=t.Fonts||(t.Fonts={}))[n.TimesNewRoman=0]="TimesNewRoman",n[n.Kokila=1]="Kokila",n[n.Gonville=2]="Gonville",t.FontString={Gonville:2,Kokila:1,TimesNewRoman:0},t.FontStringNames={0:"Times New Roman",1:"Kokila",2:"Gonville"}},4112:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionType=void 0,(n=t.InteractionType||(t.InteractionType={}))[n.SingleTouch=0]="SingleTouch",n[n.DoubleTouch=1]="DoubleTouch",n[n.TouchUp=2]="TouchUp",n[n.TouchDown=3]="TouchDown",n[n.Move=4]="Move"},2406:function(e,t){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBoxType=t.PlaybackState=void 0,(i=t.PlaybackState||(t.PlaybackState={}))[i.Stopped=0]="Stopped",i[i.Running=1]="Running",(n=t.MessageBoxType||(t.MessageBoxType={}))[n.Info=0]="Info",n[n.Warning=1]="Warning",n[n.Error=2]="Error"},1274:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAlignment=t.TextAlignmentEnum=void 0,function(e){e[e.LeftTop=0]="LeftTop",e[e.LeftCenter=1]="LeftCenter",e[e.LeftBottom=2]="LeftBottom",e[e.CenterTop=3]="CenterTop",e[e.CenterCenter=4]="CenterCenter",e[e.CenterBottom=5]="CenterBottom",e[e.RightTop=6]="RightTop",e[e.RightCenter=7]="RightCenter",e[e.RightBottom=8]="RightBottom"}(n=t.TextAlignmentEnum||(t.TextAlignmentEnum={})),t.TextAlignment=function(){function e(){g(this,e)}return y(e,null,[{key:"IsLeft",value:function(e){return e===n.LeftTop||e===n.LeftCenter||e===n.LeftBottom}},{key:"IsCenterAligned",value:function(e){return e===n.CenterTop||e===n.CenterCenter||e===n.CenterBottom}},{key:"IsRight",value:function(e){return e===n.RightTop||e===n.RightCenter||e===n.RightBottom}}]),e}()},7119:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TieTypes=void 0,(n=t.TieTypes||(t.TieTypes={})).SIMPLE="",n.HAMMERON="H",n.PULLOFF="P",n.SLIDE="S",n.TAPPING="T"},5544:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(2562),t),r(n(96),t),r(n(1274),t),r(n(7119),t),r(n(2406),t)},7056:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MXLHelper=void 0;var r=n(9228),a=i(n(5733)),s=i(n(2043));t.MXLHelper=function(){function e(){g(this,e)}return y(e,null,[{key:"MXLtoIXmlElement",value:function(e){var t=new a.default;return t.loadAsync(e).then((function(e){return t.file("META-INF/container.xml").async("text")}),(function(e){throw e})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("rootfile")[0].getAttribute("full-path");return t.file(n).async("text")}),(function(e){throw e})).then((function(e){var t=(new DOMParser).parseFromString(e,"text/xml"),n=new r.IXmlElement(t.documentElement);return Promise.resolve(n)}),(function(e){throw e})).then((function(e){return e}),(function(e){throw new Error("extractSheetFromMxl: "+e.message)}))}},{key:"MXLtoXMLstring",value:function(e){var t=new a.default;return t.loadAsync(e).then((function(e){return t.file("META-INF/container.xml").async("text")}),(function(e){throw s.default.error(e),e})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("rootfile")[0].getAttribute("full-path");return t.file(n).async("text")}),(function(e){throw e}))}}]),e}()},9228:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IXmlElement=void 0;var n=function(){function e(t){if(g(this,e),this.hasAttributes=!1,!t)throw new Error("IXmlElement: expected Element, got undefined");this.elem=t,this.name=t.nodeName.toLowerCase(),t.hasAttributes()&&(this.hasAttributes=!0,this.firstAttribute=t.attributes[0]),this.hasElements=t.hasChildNodes(),1===t.childNodes.length&&t.childNodes[0].nodeType===Node.TEXT_NODE?this.value=t.childNodes[0].nodeValue:this.value=""}return y(e,[{key:"attribute",value:function(e){return this.elem.attributes.getNamedItem(e)}},{key:"attributes",value:function(){if(!this.attrs){for(var e=this.elem.attributes,t=[],n=0;n<e.length;n+=1)t.push(e[n]);this.attrs=t}return this.attrs}},{key:"element",value:function(t){for(var n=this.elem.childNodes,i=0,r=n.length;i<r;i+=1){var a=n[i];if(a.nodeType===Node.ELEMENT_NODE&&a.nodeName.toLowerCase()===t)return new e(a)}}},{key:"elements",value:function(t){var n=this.elem.childNodes,i=[],r=!t;r||(t=t.toLowerCase());for(var a=0;a<n.length;a+=1){var s=n[a];s.nodeType!==Node.ELEMENT_NODE||!r&&s.nodeName.toLowerCase()!==t||i.push(new e(s))}return i}}]),e}();t.IXmlElement=n},9633:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(7056),t),r(n(9228),t)},9733:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AClassHierarchyTrackable=void 0,t.AClassHierarchyTrackable=function(){function e(){g(this,e)}return y(e,[{key:"isInstanceOfClass",value:function(e){for(var t=this.constructor.prototype;t;){if(e===t.constructor.name)return!0;t=t.__proto__}return!1}}]),e}()},834:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2245:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5015:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2890:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7596:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5569:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5627:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9888:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3582:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8282:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},702:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7872:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5028:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7331:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(9733),t),r(n(834),t),r(n(2245),t),r(n(5015),t),r(n(2890),t),r(n(7596),t),r(n(5569),t),r(n(5627),t),r(n(9888),t),r(n(3582),t),r(n(8282),t),r(n(702),t),r(n(7872),t),r(n(5028),t)},1211:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtil=void 0,t.StringUtil=function(){function e(){g(this,e)}return y(e,null,[{key:"StringContainsSeparatedWord",value:function(e,t){return new RegExp("( |^)"+t+"([ .]|$)",arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"i":void 0).test(e)}}]),e}()},9986:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextTranslation=void 0;var n=function(){function e(){g(this,e)}return y(e,[{key:"translate",value:function(e,t){return t}}],[{key:"translateText",value:function(t,n){return void 0===e.DefaultTextTranslation?n:e.DefaultTextTranslation.translate(t,n)}}]),e}();t.TextTranslation=n},5205:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(8918),t),r(n(5544),t),r(n(9633),t),r(n(7331),t)},415:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractDisplayInteractionManager=void 0,t.AbstractDisplayInteractionManager=function(){function e(){g(this,e),this.listeners=[],this.zoomGestureActive=!1,this.touchCount=0,this.touchActive=!1,this.touchMoving=!1,this.displayWidth=1,this.displayHeight=1,this.displayDpi=96,this.maxNumerOfFingers=2,this.movementThreshInch=.075,this.interactionWasZoomGesture=!1}return y(e,[{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"ZoomGestureActive",get:function(){return this.zoomGestureActive}},{key:"WasZoomGestureActive",get:function(){return this.interactionWasZoomGesture}},{key:"displaySizeChanged",value:function(e,t){this.displayWidth=e,this.displayHeight=t;var n,i=b(this.listeners);try{for(i.s();!(n=i.n()).done;)n.value.displaySizeChanged(this.displayWidth,this.displayHeight)}catch(r){i.e(r)}finally{i.f()}}},{key:"Dispose",value:function(){this.dispose()}},{key:"Initialize",value:function(){this.initialize()}},{key:"DisplayDpi",get:function(){return this.displayDpi}},{key:"TouchActive",get:function(){return this.touchActive}},{key:"TouchMoving",get:function(){return this.touchMoving}},{key:"touchDown",value:function(e,t,n){this.interactionWasZoomGesture=!1;var i=e/this.displayWidth,r=t/this.displayHeight;this.lastRelPosX=i,this.lastRelPosY=r,this.lastPixelX=e,this.lastPixelY=t,this.touchActive=!0,this.touchMoving=!1,this.touchCount=Math.min(this.touchCount+1,this.maxNumerOfFingers);var a,s=b(this.listeners);try{for(s.s();!(a=s.n()).done;)a.value.mouseDown(i,r,!n)}catch(o){s.e(o)}finally{s.f()}}},{key:"move",value:function(e,t){if(this.touchActive&&!this.zoomGestureActive){var n=e/this.displayWidth,i=t/this.displayHeight,r=n-this.lastRelPosX,a=i-this.lastRelPosY;this.touchMoving=!0;var s,o=b(this.listeners);try{for(o.s();!(s=o.n()).done;)s.value.mouseMove(n,i,r,a)}catch(u){o.e(u)}finally{o.f()}}}},{key:"zoomGestureStarted",value:function(){this.zoomGestureActive=!0}},{key:"zoomGestureCompleted",value:function(){this.zoomGestureActive=!1,this.interactionWasZoomGesture=!0}},{key:"zoomGestureMove",value:function(e){this.zoomGestureActive&&this.listeners.forEach((function(t){t.zoom(e)}))}},{key:"touchUp",value:function(e,t){this.touchActive=!1,this.touchMoving=!1,this.touchCount=Math.max(0,this.touchCount-1);var n,i=e/this.displayWidth,r=t/this.displayHeight,a=b(this.listeners);try{for(a.s();!(n=a.n()).done;)n.value.mouseUp(i,r)}catch(s){a.e(s)}finally{a.f()}}},{key:"click",value:function(e,t){if(!this.mouseDidMove(this.lastPixelX,e,this.lastPixelY,t)&&!this.ZoomGestureActive){var n,i=e/this.displayWidth,r=t/this.displayHeight,a=b(this.listeners);try{for(a.s();!(n=a.n()).done;)n.value.positionTouched(i,r)}catch(s){a.e(s)}finally{a.f()}}}},{key:"doubleClick",value:function(e,t){if(!this.mouseDidMove(this.lastPixelX,e,this.lastPixelY,t)&&!this.ZoomGestureActive){var n,i=e/this.displayWidth,r=t/this.displayHeight,a=b(this.listeners);try{for(a.s();!(n=a.n()).done;)n.value.positionDoubleTouched(i,r)}catch(s){a.e(s)}finally{a.f()}}}},{key:"mouseDidMove",value:function(e,t,n,i){var r=Math.abs(e-t)/this.displayDpi,a=Math.abs(n-i)/this.displayDpi;return r>this.movementThreshInch||a>this.movementThreshInch}}]),e}()},6045:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractZoomView=void 0,t.AbstractZoomView=function(){function e(t){g(this,e),this.aspectRatio=1,this.zoomViews=[],this.mouseZoomMode=!1,this.autoScrollY=!0,this.displayInteractionManager=t,this.displayInteractionManager.addListener(this),this.offsetXMin=Number.MIN_VALUE,this.offsetYMin=Number.MIN_VALUE,this.rangeXMin=1,this.rangeYMin=1,this.offsetXMax=Number.MAX_VALUE,this.offsetYMax=Number.MAX_VALUE,this.rangeXMax=1e9,this.rangeYMax=1e9,this.XScrollingEnabled=!1,this.YScrollingEnabled=!0}return y(e,[{key:"positionTouched",value:function(e,t){if(this.convertToUnitsReady()){var n=this.getPositionInUnits(e,t);this.unitPosTouched(n,e,t)}}},{key:"TouchActive",get:function(){return this.displayInteractionManager.TouchActive}},{key:"TouchMoving",get:function(){return this.displayInteractionManager.TouchMoving}},{key:"positionDoubleTouched",value:function(e,t){if(this.convertToUnitsReady()){var n=this.getPositionInUnits(e,t);this.unitPosDoubleTouched(n,e,t)}}},{key:"UsesManuallyControlledZoomMode",get:function(){return this.usesManuallyControlledZoomMode},set:function(e){this.usesManuallyControlledZoomMode=e}},{key:"mouseDown",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.convertToUnitsReady()){this.selectScrollControllerY(!1),this.lastRangeX=Math.max(1,this.RangeX),this.lastRangeY=Math.max(1,this.RangeY),this.lastOffsetX=this.OffsetX,this.lastOffsetY=this.OffsetY;var i=this.getPositionInUnits(e,t);this.unitPosTouchDown(i,e,t),this.usesManuallyControlledZoomMode||(this.mouseZoomMode=!!n)}}},{key:"mouseUp",value:function(e,t){var n=this.getPositionInUnits(e,t);this.unitPosTouchUp(n,e,t)}},{key:"mouseMove",value:function(e,t,n,i){this.mouseZoomMode?(Math.abs(n-0)>1e-8&&(this.RangeX=Math.abs(this.lastRangeX/(1+n))),!this.lockRanges&&Math.abs(i-0)>1e-8&&(this.RangeY=Math.abs(this.lastRangeY/(1-i)))):(Math.abs(n-0)>1e-8&&(this.OffsetX=this.lastOffsetX-n*this.RangeX),Math.abs(i-0)>1e-8&&(this.OffsetY=this.lastOffsetY-i*this.RangeY));var r=this.getPositionInUnits(e,t);this.unitPosMove(r,e,t)}},{key:"zoom",value:function(e){this.RangeX=Math.abs(this.lastRangeX/e)}},{key:"addZoomView",value:function(e){this.zoomViews.push(e)}},{key:"OffsetX",get:function(){return this.offsetX},set:function(e){this.offsetX=Math.min(this.offsetXMax,Math.max(this.offsetXMin,e));var t,n=b(this.zoomViews);try{for(n.s();!(t=n.n()).done;)t.value.viewportXChanged(this.offsetX,this.RangeX)}catch(i){n.e(i)}finally{n.f()}}},{key:"OffsetY",get:function(){return this.offsetY},set:function(e){this.offsetY=e,this.offsetY>this.offsetYMax?this.offsetY=this.offsetYMax:this.offsetY<this.offsetYMin&&(this.offsetY=this.offsetYMin);var t,n=b(this.zoomViews);try{for(n.s();!(t=n.n()).done;)t.value.viewportYChanged(this.offsetY,this.RangeY)}catch(i){n.e(i)}finally{n.f()}}},{key:"RangeX",get:function(){return this.rangeX},set:function(e){if(this.rangeX=Math.min(this.rangeXMax,Math.max(this.rangeXMin,e)),this.lockRanges){this.RangeY=this.RangeX/this.aspectRatio;var t,n=b(this.zoomViews);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.viewportXChanged(this.OffsetX,this.RangeX),i.viewportYChanged(this.OffsetY,this.RangeY)}}catch(s){n.e(s)}finally{n.f()}}else{var r,a=b(this.zoomViews);try{for(a.s();!(r=a.n()).done;)r.value.viewportXChanged(this.OffsetX,this.RangeX)}catch(s){a.e(s)}finally{a.f()}}}},{key:"RangeY",get:function(){return this.rangeY},set:function(e){this.rangeY=Math.min(this.rangeYMax,Math.max(this.rangeYMin,e));var t,n=b(this.zoomViews);try{for(n.s();!(t=n.n()).done;)t.value.viewportYChanged(this.OffsetY,this.RangeY)}catch(i){n.e(i)}finally{n.f()}}},{key:"AspectRatio",set:function(e){this.aspectRatio=e}},{key:"initialize",value:function(e,t,n,i){this.setVerticalViewport(n,i),this.setHorizontalViewport(e,t)}},{key:"setHorizontalViewport",value:function(e,t){this.RangeX=t,this.OffsetX=e,this.lastRangeX=this.RangeX,this.lastOffsetX=this.OffsetX}},{key:"setVerticalViewport",value:function(e,t){this.RangeY=t,this.OffsetY=e,this.lastRangeY=this.RangeY,this.lastOffsetY=this.OffsetY}},{key:"viewSizeChanged",value:function(e,t){this.lockRanges&&(this.aspectRatio=e/t,this.RangeY=this.RangeX/this.aspectRatio,this.lastRangeY=this.RangeY)}},{key:"outputChanged",value:function(e,t,n){this.OffsetY=t}},{key:"setOffsetXValueOnly",value:function(e){this.offsetX=Math.min(this.offsetXMax,Math.max(this.offsetXMin,e))}},{key:"setXOffset",value:function(e,t){!this.displayInteractionManager.TouchActive&&this.XScrollingEnabled}},{key:"setOffsetYValueOnly",value:function(e){this.offsetY=Math.min(this.offsetYMax,Math.max(this.offsetYMin,e))}},{key:"setYOffset",value:function(e,t){!this.displayInteractionManager.TouchActive&&this.YScrollingEnabled&&t&&this.selectScrollControllerY(!0)}},{key:"selectScrollControllerY",value:function(e){this.autoScrollY!==e&&(this.autoScrollY=e)}},{key:"displaySizeChanged",value:function(e,t){throw new Error("Method not implemented.")}}]),e}()},7570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackCursorUserInteractionManager=void 0;var i=n(4112);t.PlaybackCursorUserInteractionManager=function(){function e(t,n){g(this,e),this.graphic=t}return y(e,[{key:"userDisplayInteraction",value:function(e,t,n){if(n===i.InteractionType.SingleTouch){var r=this.graphic.GetNearestVoiceEntry(t);console.log(r)}}}]),e}()},56:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenViewingRegion=void 0;var i=n(4759),r=n(8918),a=function(){function e(t,n,r,a){g(this,e),this.psi=new i.BoundingBox(void 0),this.displaySizeInPixel=t,this.RelativeDisplaySize=n,this.RelativeDisplayPosition=r,this.WidthInUnits=a}return y(e,[{key:"UpperLeftPositionInUnits",get:function(){return this.psi.AbsolutePosition},set:function(e){this.psi.AbsolutePosition=e}},{key:"DisplaySizeInPixel",get:function(){return this.displaySizeInPixel},set:function(e){this.displaySizeInPixel=e,this.regionSizeInPixel=new r.SizeF2D(this.displaySizeInPixel.width*this.relativeRegionSize.width,this.displaySizeInPixel.height*this.relativeRegionSize.height),this.recalculateDependentVariables()}},{key:"RelativeDisplaySize",get:function(){return this.relativeRegionSize},set:function(e){this.relativeRegionSize=e,this.regionSizeInPixel=new r.SizeF2D(this.displaySizeInPixel.width*this.relativeRegionSize.width,this.displaySizeInPixel.height*this.relativeRegionSize.height),this.recalculateDependentVariables()}},{key:"RegionSizeInPixel",get:function(){return this.regionSizeInPixel}},{key:"WidthInUnits",get:function(){return this.psi.BorderRight},set:function(e){this.psi.BorderRight=e,this.recalculateDependentVariables()}},{key:"ViewRegionInUnits",get:function(){return new r.SizeF2D(this.psi.BorderRight,this.psi.BorderBottom)}},{key:"isVisible",value:function(e,t){var n=this.psi.collisionDetection(e);return this.psi.liesInsideBorders(e),n}},{key:"isInsideDisplayArea",value:function(e,t){return this.RelativeDisplayPosition.x<=e&&e<=this.RelativeDisplayPosition.x+this.RelativeDisplaySize.width&&this.RelativeDisplayPosition.y<=t&&t<=this.RelativeDisplayPosition.y+this.RelativeDisplaySize.height}},{key:"transformToUnitCoordinates",value:function(e){return new r.PointF2D(this.UpperLeftPositionInUnits.x+this.ViewRegionInUnits.width*((e.x-this.RelativeDisplayPosition.x)/this.RelativeDisplaySize.width),this.UpperLeftPositionInUnits.y+this.ViewRegionInUnits.height*((e.y-this.RelativeDisplayPosition.y)/this.RelativeDisplaySize.height))}},{key:"transformLengthXToUnitCoordinates",value:function(e){return e/this.horizontalUnitToPixelRatio}},{key:"transformLengthYToUnitCoordinates",value:function(e){return e/this.verticalUnitToPixelRatio}},{key:"recalculateDependentVariables",value:function(){var e=this.regionSizeInPixel.width/this.regionSizeInPixel.height;this.psi.BorderBottom=this.psi.BorderRight/e,this.horizontalUnitToPixelRatio=this.regionSizeInPixel.width/this.ViewRegionInUnits.width,this.verticalUnitToPixelRatio=this.regionSizeInPixel.height/this.ViewRegionInUnits.height}}],[{key:"createWithRelativeDefaults",value:function(t,n){return new e(t,new r.SizeF2D(1,1),new r.PointF2D(0,0),n)}},{key:"createWithDefaults",value:function(){return new e(new r.SizeF2D(1,1),new r.SizeF2D(1,1),new r.PointF2D(0,0),1)}}]),e}();t.ScreenViewingRegion=a},7969:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SheetRenderingManager=void 0;var i=n(56),r=n(8918),a=n(6045),s=n(4112),l=n(7108),f=function(e){h(n,e);var t=d(n);function n(e,r){var a;return g(this,n),(a=t.call(this,e)).mainViewingRegion=i.ScreenViewingRegion.createWithDefaults(),a.tryAgainToRenderCount=0,a.yOffsetMouseDown=Number.MIN_VALUE,a.unlockCursorDistancePixel=50,a.relativeTopPosition=.06,a.internalPreviewImageScale=3,a.listeners=[],a.LockDisplayToCursor=!0,a.ZoomActive=!1,a.rules=r,a.addZoomView(c(a)),a.lockRanges=!0,a.TopBarHeightInPixel=70,a.BottomBarHeightInPixel=0,a.rules.UseDefaultVoiceInteractionListener&&a.listeners.push(new l.VoiceEntryInteractionListener(c(a))),a}return y(n,[{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"Listeners",get:function(){return this.listeners}},{key:"convertToUnitsReady",value:function(){return void 0!==this.graphicalMusicSheet}},{key:"unitPosTouched",value:function(e,t,n){if(!this.SingleTouchDisabled){var i=new r.PointF2D(t,n);this.handleUserDisplayInteraction(i,e,s.InteractionType.SingleTouch)}}},{key:"unitPosDoubleTouched",value:function(e,t,n){if(!this.DoubleTouchDisabled){var i=new r.PointF2D(t,n);this.handleUserDisplayInteraction(i,e,s.InteractionType.DoubleTouch)}}},{key:"unitPosTouchDown",value:function(e,t,n){var i=new r.PointF2D(t,n);this.handleUserDisplayInteraction(i,e,s.InteractionType.TouchDown),this.yOffsetMouseDown=e.y}},{key:"unitPosTouchUp",value:function(e,t,n){var i=new r.PointF2D(t,n);this.handleUserDisplayInteraction(i,e,s.InteractionType.TouchUp),!1===this.displayInteractionManager.WasZoomGestureActive&&this.unlockFromCursorIfNecessary(e),this.yOffsetMouseDown=Number.MIN_VALUE}},{key:"unitPosMove",value:function(e,t,n){var i=new r.PointF2D(t,n);this.handleUserDisplayInteraction(i,e,s.InteractionType.Move),this.unlockFromCursorIfNecessary(e)}},{key:"MainViewingRegion",get:function(){return this.mainViewingRegion}},{key:"setMusicSheet",value:function(e){this.graphicalMusicSheet=e,this.adaptDisplayLimitsToSheet(),this.setYOffset(0,!0)}},{key:"viewportXChanged",value:function(e,t){void 0!==this.graphicalMusicSheet&&this.horizontalViewportChanged(e,t)}},{key:"viewportYChanged",value:function(e,t){void 0!==this.graphicalMusicSheet&&(this.yOffsetMouseDown<=Number.MIN_VALUE+.5&&(this.yOffsetMouseDown=e),this.verticalViewportChanged(e,t))}},{key:"displaySizeChanged",value:function(e,t){o(u(n.prototype),"viewSizeChanged",this).call(this,e,t),Math.abs(e-0)<1e-7||Math.abs(t-0)<1e-7||(void 0!==this.graphicalMusicSheet&&this.graphicalMusicSheet.EnforceRedrawOfMusicSystems(),this.mainViewingRegion.DisplaySizeInPixel=new r.SizeF2D(e,t),this.adaptDisplayLimitsToSheet())}},{key:"calcDisplayYPosition",value:function(e){return e.PositionAndShape.AbsolutePosition.y+e.PositionAndShape.BorderMarginTop-this.topBarHeightInUnits()-this.relativeTopPosition*this.heightWithoutTopBottomBarsInUnits()}},{key:"yPositionForLastSystem",value:function(e){return e.PositionAndShape.AbsolutePosition.y+e.PositionAndShape.BorderMarginBottom-this.topBarHeightInUnits()-(1-this.relativeTopPosition)*this.heightWithoutTopBottomBarsInUnits()}},{key:"scorePositionChanged",value:function(e,t,n,i,r,a){var s=this.calcDisplayYPosition(i);this.setYPosition(s,a)}},{key:"setXPosition",value:function(e,t){this.LockDisplayToCursor&&this.setXOffset(e,t)}},{key:"setYPosition",value:function(e,t){this.LockDisplayToCursor&&this.setYOffset(e,t)}},{key:"DrawingParameters",get:function(){return this.musicSheetDrawer.drawingParameters}},{key:"topBarHeightInUnits",value:function(){return this.mainViewingRegion.transformLengthYToUnitCoordinates(this.TopBarHeightInPixel)}},{key:"bottomBarHeightInUnits",value:function(){return this.mainViewingRegion.transformLengthYToUnitCoordinates(this.BottomBarHeightInPixel)}},{key:"heightWithoutTopBottomBarsInUnits",value:function(){return this.mainViewingRegion.ViewRegionInUnits.height-this.topBarHeightInUnits()-this.bottomBarHeightInUnits()}},{key:"activePositionToBottomBarHeight",value:function(){return(this.mainViewingRegion.ViewRegionInUnits.height-this.topBarHeightInUnits()-this.bottomBarHeightInUnits())*(1-2*this.relativeTopPosition)}},{key:"getClickPosition",value:function(e,t){return this.mainViewingRegion.transformToUnitCoordinates(new r.PointF2D(e,t))}},{key:"graphicalObjectIsVisible",value:function(e){return this.mainViewingRegion.isVisible(e,!1)}},{key:"adaptDisplayLimitsToSheet",value:function(){if(void 0!==this.graphicalMusicSheet&&0!==this.graphicalMusicSheet.MusicPages.length&&0!==this.graphicalMusicSheet.MusicPages[0].MusicSystems.length){this.offsetXMin=0,this.rangeXMin=this.graphicalMusicSheet.MinAllowedSystemWidth,this.rangeXMax=300,this.offsetYMin=-.3*this.RangeY;var e=this.graphicalMusicSheet.MusicPages.last().PositionAndShape;this.offsetYMax=Math.max(0,e.BorderMarginBottom-.7*this.RangeY),this.OffsetY>this.offsetYMax&&this.setYOffset(this.offsetYMax,!0)}}},{key:"horizontalViewportChanged",value:function(e,t){this.mainViewingRegion.WidthInUnits!==t&&(this.mainViewingRegion.WidthInUnits=t)}},{key:"verticalViewportChanged",value:function(e,t){this.mainViewingRegion.UpperLeftPositionInUnits=new r.PointF2D(this.mainViewingRegion.UpperLeftPositionInUnits.x,e)}},{key:"unlockFromCursorIfNecessary",value:function(e){!1===this.LockDisplayToCursor||this.ZoomActive||this.displayInteractionManager.ZoomGestureActive||this.displayInteractionManager.WasZoomGestureActive||Math.abs((e.y-this.yOffsetMouseDown)*this.mainViewingRegion.RegionSizeInPixel.height/this.mainViewingRegion.ViewRegionInUnits.height)>this.unlockCursorDistancePixel&&(this.LockDisplayToCursor=!1)}},{key:"getPositionInUnits",value:function(e,t){return this.mainViewingRegion.transformToUnitCoordinates(new r.PointF2D(e,t))}},{key:"handleUserDisplayInteraction",value:function(e,t,n){switch(n){case s.InteractionType.TouchDown:case s.InteractionType.SingleTouch:case s.InteractionType.DoubleTouch:case s.InteractionType.TouchUp:case s.InteractionType.TouchDown:case s.InteractionType.Move:var i,r=b(this.listeners);try{for(r.s();!(i=r.n()).done;)i.value.userDisplayInteraction(e,t,n)}catch(a){r.e(a)}finally{r.f()}break;default:throw new Error("type")}}},{key:"setStartPosition",value:function(e){var t;void 0!==this.graphicalMusicSheet&&(this.graphicalMusicSheet.ParentMusicSheet.SelectionStart=e,null===(t=this.PlaybackManager)||void 0===t||t.reset())}},{key:"GraphicalMusicSheet",get:function(){return this.graphicalMusicSheet}}]),n}(a.AbstractZoomView);t.SheetRenderingManager=f},7108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceEntryInteractionListener=void 0;var i=n(4112);t.VoiceEntryInteractionListener=function(){function e(t){g(this,e),this.renderingManager=t}return y(e,[{key:"userDisplayInteraction",value:function(e,t,n){var r,a;switch(n){case i.InteractionType.TouchDown:case i.InteractionType.SingleTouch:case i.InteractionType.DoubleTouch:var s=this.renderingManager.GraphicalMusicSheet.GetNearestVoiceEntry(t);if(s&&void 0!==s.parentStaffEntry.parentVerticalContainer){var o=s.parentStaffEntry.parentVerticalContainer.AbsoluteTimestamp;this.renderingManager.setStartPosition(o),void 0!==(null===(r=s.notes[0])||void 0===r?void 0:r.sourceNote.Pitch)&&(null===(a=this.renderingManager.PlaybackManager)||void 0===a||a.playVoiceEntry(s.parentVoiceEntry))}}}}]),e}()},4821:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebDisplayInteractionManager=void 0;var i=n(415),r=n(9086),a=n(1649),s=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).fullOffsetLeft=0,i.fullOffsetTop=0,i.fullScrollTop=0,i.fullScrollLeft=0,i.parentScrollMap=new Map,i.scrollCallbackMap=new Map,i.timeout=void 0,i.resizeObserver=void 0,i.EventCallbackMap=new a.Dictionary,i.DOUBLE_CLICK_WINDOW=200,i.lastClick=0,i.osmdSheetMusicContainer=e,i.listenForInteractions(),i}return y(n,[{key:"FullOffsetTop",get:function(){return this.fullOffsetTop}},{key:"FullScrollTop",get:function(){return this.fullScrollTop}},{key:"FullOffsetLeft",get:function(){return this.fullOffsetLeft}},{key:"FullScrollLeft",get:function(){return this.fullScrollLeft}},{key:"registerScrollOffsets",value:function(){var e=this.osmdSheetMusicContainer;this.fullScrollTop=0,this.fullScrollLeft=0;for(var t=this;e&&e!==document.documentElement;){if(this.parentScrollMap.set(e,[e.scrollTop,e.scrollLeft]),this.fullScrollLeft+=e.scrollLeft,this.fullScrollTop+=e.scrollTop,e.scrollHeight>e.clientHeight){var n=function(e){var n=t.parentScrollMap.get(this),i=n[0],r=n[1];t.fullScrollTop=t.fullScrollTop-i+this.scrollTop,t.fullScrollLeft=t.fullScrollLeft-r+this.scrollLeft,t.parentScrollMap.set(this,[this.scrollTop,this.scrollLeft])};this.scrollCallbackMap.set(e,n),e.addEventListener("scroll",n)}e=e.parentElement}}},{key:"deregisterScrollOffsets",value:function(){var e,t=b(this.scrollCallbackMap.keys());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.removeEventListener("scroll",this.scrollCallbackMap.get(n))}}catch(i){t.e(i)}finally{t.f()}this.scrollCallbackMap.clear()}},{key:"initialize",value:function(){this.fullOffsetLeft=0,this.fullOffsetTop=0;var e=this.osmdSheetMusicContainer,t=[],i=this;for(window.ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(e){n.resizeCallback(e,i)})));e;)this.fullOffsetLeft+=e.offsetLeft,this.fullOffsetTop+=e.offsetTop,this.resizeObserver?this.resizeObserver.observe(e):t.push(e),e=e.offsetParent;if(this.resizeObserver)this.disposeResizeListener=function(){i.resizeObserver.disconnect(),i.resizeObserver=void 0};else{var r=function(){n.resizeCallback(t,i)};window.addEventListener("resize",r),this.disposeResizeListener=function(){window.removeEventListener("resize",r),r=void 0}}i.registerScrollOffsets()}},{key:"dispose",value:function(){this.disposeResizeListener();var e,t=b(this.EventCallbackMap.keys());try{for(t.s();!(e=t.n()).done;){var n=e.value,i=this.EventCallbackMap.getValue(n);i[0].removeEventListener(n,i[1])}}catch(r){t.e(r)}finally{t.f()}this.EventCallbackMap.clear(),this.deregisterScrollOffsets(),this.scrollCallbackMap.clear(),this.parentScrollMap.clear()}},{key:"isTouch",value:function(){if("ontouchstart"in window||window.DocumentTouch)return!0;if(!window.matchMedia)return!1;var e=["(",["-webkit-","-moz-","-o-","-ms-"].join("touch-enabled),("),"heartz",")"].join("");return window.matchMedia(e).matches}},{key:"downEventName",get:function(){return this.isTouch()?"touchstart":"mousedown"}},{key:"moveEventName",get:function(){return this.isTouch()?"touchmove":"mousemove"}},{key:"listenForInteractions",value:function(){var e=this.downEventListener.bind(this),t=this.touchEndEventListener.bind(this),n=this.moveEventListener.bind(this);this.osmdSheetMusicContainer.addEventListener("mousedown",e),this.osmdSheetMusicContainer.addEventListener("touchend",t),document.addEventListener(this.moveEventName,n),this.EventCallbackMap.setValue("mousedown",[this.osmdSheetMusicContainer,e]),this.EventCallbackMap.setValue("touchend",[this.osmdSheetMusicContainer,t]),this.EventCallbackMap.setValue(this.moveEventName,[document,n])}},{key:"downEventListener",value:function(e){var t=(new Date).getTime(),n=t-this.lastClick;clearTimeout(this.clickTimeout);var i=0,r=0;this.isTouch()&&e instanceof TouchEvent?(i=e.touches[0].pageX,r=e.touches[0].pageY):e instanceof MouseEvent&&(i=e.pageX,r=e.pageY);var a=this.getOffsetCoordinates(i,r);if(n<this.DOUBLE_CLICK_WINDOW&&n>0)this.doubleClick(a.x,a.y);else{var s=this;this.clickTimeout=setTimeout((function(){clearTimeout(this.clickTimeout),s.isTouch()?s.touchDown(a.x,a.y,void 0):s.click(a.x,a.y)}),this.DOUBLE_CLICK_WINDOW)}this.lastClick=t}},{key:"moveEventListener",value:function(e){var t,n=0,i=0;this.isTouch()&&e instanceof TouchEvent?(e.touches&&e.touches.length>0?t=e.touches[0]:e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0]),n=null==t?void 0:t.clientX,i=null==t?void 0:t.clientY):e instanceof MouseEvent&&(n=e.clientX,i=e.clientY);var r=this.getOffsetCoordinates(n,i);this.move(r.x,r.y)}},{key:"touchEndEventListener",value:function(e){var t;e.touches&&e.touches.length>0?t=e.touches[0]:e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0]);var n=this.getOffsetCoordinates(null==t?void 0:t.pageX,null==t?void 0:t.pageY);this.touchUp(n.x,n.y)}},{key:"resizeEventListener",value:function(){this.displaySizeChanged(this.osmdSheetMusicContainer.clientWidth,this.osmdSheetMusicContainer.clientHeight)}},{key:"getOffsetCoordinates",value:function(e,t){var n=e-this.fullOffsetLeft+this.fullScrollLeft,i=t-this.fullOffsetTop+this.fullScrollTop;return new r.PointF2D(n,i)}}],[{key:"resizeCallback",value:function(e,t){clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.fullOffsetLeft=0,t.fullOffsetTop=0;for(var e=t.osmdSheetMusicContainer;e;)t.fullOffsetLeft+=e.offsetLeft,t.fullOffsetTop+=e.offsetTop,e=e.offsetParent;t.resizeEventListener(),t.deregisterScrollOffsets(),t.registerScrollOffsets()}),500)}}]),n}(i.AbstractDisplayInteractionManager);t.WebDisplayInteractionManager=s},2660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebSheetRenderingManager=void 0;var i=function(e){h(n,e);var t=d(n);function n(){return g(this,n),t.apply(this,arguments)}return y(n,[{key:"mouseMove",value:function(e,t,n,i){var r=this.getPositionInUnits(e,t);this.unitPosMove(r,e,t)}}]),n}(n(7969).SheetRenderingManager);t.WebSheetRenderingManager=i},2571:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(415),t),r(n(6045),t),r(n(7570),t),r(n(56),t),r(n(7969),t),r(n(4821),t)},1703:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidEnumArgumentException=t.ArgumentOutOfRangeException=t.MusicSheetReadingException=void 0,t.MusicSheetReadingException=function(){function e(t,n){g(this,e),this.message=t,n&&(this.message+=" "+n.toString())}return e}(),t.ArgumentOutOfRangeException=function(){function e(t){g(this,e),this.message=t}return e}(),t.InvalidEnumArgumentException=function(){function e(t){g(this,e),this.message=t}return e}()},6791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractGraphicalExpression=void 0;var i=n(4785),r=n(8911),a=function(e){h(n,e);var t=d(n);function n(e,i,a){var s;return g(this,n),(s=t.call(this)).expression=i,s.parentMeasure=a,s.boundingBox=new r.BoundingBox(c(s),e.PositionAndShape),s.parentStaffLine=e,s.parentStaffLine.AbstractExpressions.push(c(s)),s.rules=e.ParentMusicSystem.rules,s}return y(n,[{key:"Label",get:function(){return this.label}},{key:"ParentStaffLine",get:function(){return this.parentStaffLine}},{key:"SourceExpression",get:function(){return this.expression}},{key:"Placement",get:function(){return this.expression.Placement}}]),n}(i.GraphicalObject);t.AbstractGraphicalExpression=a},6055:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractGraphicalInstruction=void 0;var i=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).parent=e,i}return y(n,[{key:"Parent",get:function(){return this.parent},set:function(e){this.parent=e}}]),n}(n(4785).GraphicalObject);t.AbstractGraphicalInstruction=i},1070:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccidentalCalculator=void 0;var i=n(8640),r=n(8640),a=n(1649),s=n(4040);t.AccidentalCalculator=function(){function e(){g(this,e),this.keySignatureNoteAlterationsDict=new a.Dictionary,this.currentAlterationsComparedToKeyInstructionList=[],this.currentInMeasureNoteAlterationsDict=new a.Dictionary}return y(e,[{key:"ActiveKeyInstruction",get:function(){return this.activeKeyInstruction},set:function(e){this.activeKeyInstruction=e,this.reactOnKeyInstructionChange()}},{key:"doCalculationsAtEndOfMeasure",value:function(){this.currentInMeasureNoteAlterationsDict.clear(),this.currentAlterationsComparedToKeyInstructionList.clear();var e,t=b(this.keySignatureNoteAlterationsDict.keys());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.currentInMeasureNoteAlterationsDict.setValue(n,this.keySignatureNoteAlterationsDict.getValue(n))}}catch(i){t.e(i)}finally{t.f()}}},{key:"checkAccidental",value:function(e,t){if(t){var n=t.FundamentalNote+12*t.Octave,a=this.currentAlterationsComparedToKeyInstructionList.indexOf(n)>=0;if(this.currentInMeasureNoteAlterationsDict.containsKey(n)){if(a&&this.currentAlterationsComparedToKeyInstructionList.splice(this.currentAlterationsComparedToKeyInstructionList.indexOf(n),1),this.currentInMeasureNoteAlterationsDict.getValue(n)!==t.AccidentalHalfTones){this.keySignatureNoteAlterationsDict.containsKey(n)&&this.keySignatureNoteAlterationsDict.getValue(n)!==t.AccidentalHalfTones?(this.currentAlterationsComparedToKeyInstructionList.push(n),this.currentInMeasureNoteAlterationsDict.setValue(n,t.AccidentalHalfTones)):t.Accidental!==i.AccidentalEnum.NONE&&this.currentInMeasureNoteAlterationsDict.remove(n);var o=this.currentInMeasureNoteAlterationsDict.getValue(n);if(t.Accidental===i.AccidentalEnum.NONE&&(t=.5===Math.abs(o)?new r.Pitch(t.FundamentalNote,t.Octave,i.AccidentalEnum.NONE):new r.Pitch(t.FundamentalNote,t.Octave,i.AccidentalEnum.NATURAL)),this.isAlterAmbiguousAccidental(t.Accidental)&&!t.AccidentalXml)return;s.MusicSheetCalculator.symbolFactory.addGraphicalAccidental(e,t)}}else if(t.Accidental!==i.AccidentalEnum.NONE){if(a||this.currentAlterationsComparedToKeyInstructionList.push(n),this.currentInMeasureNoteAlterationsDict.setValue(n,t.AccidentalHalfTones),this.isAlterAmbiguousAccidental(t.Accidental)&&!t.AccidentalXml)return;s.MusicSheetCalculator.symbolFactory.addGraphicalAccidental(e,t)}else a&&(t=new r.Pitch(t.FundamentalNote,t.Octave,i.AccidentalEnum.NATURAL),this.currentAlterationsComparedToKeyInstructionList.splice(this.currentAlterationsComparedToKeyInstructionList.indexOf(n),1),s.MusicSheetCalculator.symbolFactory.addGraphicalAccidental(e,t))}}},{key:"isAlterAmbiguousAccidental",value:function(e){return e===i.AccidentalEnum.SLASHFLAT||e===i.AccidentalEnum.QUARTERTONEFLAT}},{key:"reactOnKeyInstructionChange",value:function(){var e,t=this.activeKeyInstruction.AlteratedNotes;e=this.activeKeyInstruction.Key>0?i.AccidentalEnum.SHARP:i.AccidentalEnum.FLAT,this.keySignatureNoteAlterationsDict.clear(),this.currentAlterationsComparedToKeyInstructionList.length=0;for(var n=-9;n<9;n++)for(var a=0;a<t.length;a++)this.keySignatureNoteAlterationsDict.setValue(t[a]+12*n,r.Pitch.HalfTonesFromAccidental(e));this.doCalculationsAtEndOfMeasure()}}]),e}()},8911:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ColDirEnum=t.BoundingBox=void 0;var r,a=i(n(2043)),s=n(1703),o=n(9086),u=n(739),l=n(3278),c=n(4785),h=n(4278);t.BoundingBox=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];g(this,e),this.isSymbol=!1,this.relativePositionHasBeenSet=!1,this.xBordersHaveBeenSet=!1,this.yBordersHaveBeenSet=!1,this.absolutePosition=new o.PointF2D,this.relativePosition=new o.PointF2D,this.size=new u.SizeF2D,this.marginSize=new u.SizeF2D,this.upperLeftCorner=new o.PointF2D,this.upperLeftMarginCorner=new o.PointF2D,this.borderLeft=0,this.borderRight=0,this.borderTop=0,this.borderBottom=0,this.borderMarginLeft=0,this.borderMarginRight=0,this.borderMarginTop=0,this.borderMarginBottom=0,this.childElements=[],this.parent=n,this.dataObject=t,this.isSymbol=i,this.xBordersHaveBeenSet=!1,this.yBordersHaveBeenSet=!1,n&&(this.Parent=n)}return y(e,[{key:"RelativePositionHasBeenSet",get:function(){return this.relativePositionHasBeenSet}},{key:"XBordersHaveBeenSet",get:function(){return this.xBordersHaveBeenSet},set:function(e){this.xBordersHaveBeenSet=e}},{key:"YBordersHaveBeenSet",get:function(){return this.yBordersHaveBeenSet},set:function(e){this.yBordersHaveBeenSet=e}},{key:"AbsolutePosition",get:function(){return this.absolutePosition},set:function(e){this.absolutePosition=e}},{key:"RelativePosition",get:function(){return this.relativePosition},set:function(e){this.relativePosition=e,this.relativePositionHasBeenSet=!0}},{key:"Size",get:function(){return this.size},set:function(e){this.size=e}},{key:"MarginSize",get:function(){return this.marginSize}},{key:"UpperLeftCorner",get:function(){return this.upperLeftCorner}},{key:"UpperLeftMarginCorner",get:function(){return this.upperLeftMarginCorner}},{key:"BorderLeft",get:function(){return this.borderLeft},set:function(e){this.borderLeft=e,this.calculateRectangle()}},{key:"BorderRight",get:function(){return this.borderRight},set:function(e){this.borderRight=e,this.calculateRectangle()}},{key:"BorderTop",get:function(){return this.borderTop},set:function(e){this.borderTop=e,this.calculateRectangle()}},{key:"BorderBottom",get:function(){return this.borderBottom},set:function(e){this.borderBottom=e,this.calculateRectangle()}},{key:"BorderMarginLeft",get:function(){return this.borderMarginLeft>this.borderLeft?this.borderLeft:this.borderMarginLeft},set:function(e){this.borderMarginLeft=e,this.calculateMarginRectangle()}},{key:"BorderMarginRight",get:function(){return this.borderMarginRight<this.borderRight?this.borderRight:this.borderMarginRight},set:function(e){this.borderMarginRight=e,this.calculateMarginRectangle()}},{key:"BorderMarginTop",get:function(){return this.borderMarginTop>this.borderTop?this.borderTop:this.borderMarginTop},set:function(e){this.borderMarginTop=e,this.calculateMarginRectangle()}},{key:"BorderMarginBottom",get:function(){return this.borderMarginBottom<this.borderBottom?this.borderBottom:this.borderMarginBottom},set:function(e){this.borderMarginBottom=e,this.calculateMarginRectangle()}},{key:"BoundingRectangle",get:function(){return this.boundingRectangle}},{key:"BoundingMarginRectangle",get:function(){return this.boundingMarginRectangle}},{key:"ChildElements",get:function(){return this.childElements},set:function(e){this.childElements=e}},{key:"Parent",get:function(){return this.parent},set:function(e){var t,n,i,r;if(this.parent){var s=this.parent.ChildElements.indexOf(this,0);s>-1&&this.parent.ChildElements.splice(s,1)}this.parent=e,(null===(n=null===(t=this.parent)||void 0===t?void 0:t.ChildElements)||void 0===n?void 0:n.indexOf(this))>-1?a.default.error("BoundingBox of "+this.dataObject.constructor.name+" already in children list of "+this.parent.dataObject.constructor.name+"'s BoundingBox"):null===(r=null===(i=this.parent)||void 0===i?void 0:i.ChildElements)||void 0===r||r.push(this)}},{key:"DataObject",get:function(){return this.dataObject}},{key:"Center",get:function(){return new o.PointF2D(this.RelativePosition.x+(this.BorderMarginRight+this.BorderMarginLeft),this.RelativePosition.y+(this.BorderMarginBottom+this.BorderMarginTop))}},{key:"setAbsolutePositionFromParent",value:function(){this.parent?(this.absolutePosition.x=this.parent.AbsolutePosition.x+this.relativePosition.x,this.absolutePosition.y=this.parent.AbsolutePosition.y+this.relativePosition.y):this.absolutePosition=this.relativePosition}},{key:"calculateAbsolutePosition",value:function(){this.absolutePosition.x=this.relativePosition.x,this.absolutePosition.y=this.relativePosition.y;for(var e=this.parent;e;)this.absolutePosition.x+=e.relativePosition.x,this.absolutePosition.y+=e.relativePosition.y,e=e.parent}},{key:"calculateAbsolutePositionsRecursiveWithoutTopelement",value:function(){this.absolutePosition.x=0,this.absolutePosition.y=0;for(var e=0,t=this.ChildElements.length;e<t;++e)this.ChildElements[e].calculateAbsolutePositionsRecursive(this.absolutePosition.x,this.absolutePosition.y)}},{key:"calculateAbsolutePositionsRecursive",value:function(e,t){this.absolutePosition.x=this.relativePosition.x+e,this.absolutePosition.y=this.relativePosition.y+t;for(var n=0,i=this.ChildElements.length;n<i;++n)this.ChildElements[n].calculateAbsolutePositionsRecursive(this.absolutePosition.x,this.absolutePosition.y)}},{key:"calculateAbsolutePositionsOfChildren",value:function(){for(var e=0,t=this.ChildElements.length;e<t;++e)this.ChildElements[e].calculateAbsolutePositionsRecursive(this.absolutePosition.x,this.absolutePosition.y)}},{key:"calculateBoundingBox",value:function(){if(0!==this.childElements.length){for(var e=0,t=this.ChildElements.length;e<t;++e)this.ChildElements[e].calculateBoundingBox();var n=Number.MAX_VALUE,i=Number.MIN_VALUE,r=Number.MAX_VALUE,a=Number.MIN_VALUE,s=Number.MAX_VALUE,o=Number.MIN_VALUE,u=Number.MAX_VALUE,l=Number.MIN_VALUE;this.isSymbol&&(n=this.borderLeft,i=this.borderRight,r=this.borderTop,a=this.borderBottom,s=this.borderMarginLeft,o=this.borderMarginRight,u=this.borderMarginTop,l=this.borderMarginBottom);for(var c=0,h=this.ChildElements.length;c<h;++c){var d=this.ChildElements[c];n=Math.min(n,d.relativePosition.x+d.borderLeft),i=Math.max(i,d.relativePosition.x+d.borderRight),r=Math.min(r,d.relativePosition.y+d.borderTop),a=Math.max(a,d.relativePosition.y+d.borderBottom),s=Math.min(s,d.relativePosition.x+d.borderMarginLeft),o=Math.max(o,d.relativePosition.x+d.borderMarginRight),u=Math.min(u,d.relativePosition.y+d.borderMarginTop),l=Math.max(l,d.relativePosition.y+d.borderMarginBottom)}this.borderLeft=n,this.borderRight=i,this.borderTop=r,this.borderBottom=a,this.borderMarginLeft=s,this.borderMarginRight=o,this.borderMarginTop=u,this.borderMarginBottom=l,this.calculateRectangle(),this.calculateMarginRectangle(),this.xBordersHaveBeenSet=!0,this.yBordersHaveBeenSet=!0}}},{key:"calculateTopBottomBorders",value:function(){if(0!==this.childElements.length){for(var e=0,t=this.ChildElements.length;e<t;++e)this.ChildElements[e].calculateTopBottomBorders();var n=Number.MAX_VALUE,i=Number.MIN_VALUE,r=Number.MAX_VALUE,a=Number.MIN_VALUE;this.yBordersHaveBeenSet&&(n=this.borderTop,i=this.borderBottom,r=this.borderMarginTop,a=this.borderMarginBottom);for(var s=0,o=this.ChildElements.length;s<o;++s){var u=this.ChildElements[s];n=Math.min(n,u.relativePosition.y+u.borderTop),i=Math.max(i,u.relativePosition.y+u.borderBottom),r=Math.min(r,u.relativePosition.y+u.borderMarginTop),a=Math.max(a,u.relativePosition.y+u.borderMarginBottom)}this.borderTop=n,this.borderBottom=i,this.borderMarginTop=r,this.borderMarginBottom=a,this.calculateRectangle(),this.calculateMarginRectangle()}}},{key:"computeNonOverlappingPositionWithMargin",value:function(e,t,n){this.RelativePosition=new o.PointF2D(n.x,n.y),this.setAbsolutePositionFromParent();var i=0,a=!1;do{switch(t){case r.Left:case r.Right:i=this.relativePosition.x,e.calculateMarginPositionAlongDirection(this,t),a=Math.abs(i-this.relativePosition.x)>.001;break;case r.Up:case r.Down:i=this.relativePosition.y,e.calculateMarginPositionAlongDirection(this,t),a=Math.abs(i-this.relativePosition.y)>.001;break;default:throw new s.ArgumentOutOfRangeException("direction")}}while(a)}},{key:"collisionDetection",value:function(e){var t=Math.min(this.AbsolutePosition.x+this.borderRight,e.absolutePosition.x+e.borderRight)-Math.max(this.AbsolutePosition.x+this.borderLeft,e.absolutePosition.x+e.borderLeft),n=Math.min(this.AbsolutePosition.y+this.borderBottom,e.absolutePosition.y+e.borderBottom)-Math.max(this.AbsolutePosition.y+this.borderTop,e.absolutePosition.y+e.borderTop);return t>0&&n>0}},{key:"liesInsideBorders",value:function(e){var t=this.AbsolutePosition.x+this.borderLeft<=e.absolutePosition.x+e.borderLeft&&e.absolutePosition.x+e.borderLeft<=this.AbsolutePosition.x+this.borderRight,n=this.AbsolutePosition.x+this.borderLeft<=e.absolutePosition.x+e.borderRight&&e.absolutePosition.x+e.borderRight<=this.AbsolutePosition.x+this.borderRight;if(t&&n){var i=this.AbsolutePosition.y+this.borderTop<=e.absolutePosition.y+e.borderTop&&e.absolutePosition.y+e.borderTop<=this.AbsolutePosition.y+this.borderBottom,r=this.AbsolutePosition.y+this.borderTop<=e.absolutePosition.y+e.borderBottom&&e.absolutePosition.y+e.borderBottom<=this.AbsolutePosition.y+this.borderBottom;if(i&&r)return!0}return!1}},{key:"pointLiesInsideBorders",value:function(e){return this.AbsolutePosition.x+this.borderLeft<=e.x&&e.x<=this.AbsolutePosition.x+this.borderRight&&this.AbsolutePosition.y+this.borderTop<=e.y&&e.y<=this.AbsolutePosition.y+this.borderBottom}},{key:"marginCollisionDetection",value:function(e){var t=Math.min(this.AbsolutePosition.x+this.borderMarginRight,e.absolutePosition.x+e.borderMarginRight)-Math.max(this.AbsolutePosition.x+this.borderMarginLeft,e.absolutePosition.x+e.borderMarginLeft),n=Math.min(this.AbsolutePosition.y+this.borderMarginBottom,e.absolutePosition.y+e.borderMarginBottom)-Math.max(this.AbsolutePosition.y+this.borderMarginTop,e.absolutePosition.y+e.borderMarginTop);return t>0&&n>0}},{key:"liesInsideMargins",value:function(e){var t=this.AbsolutePosition.x+this.borderMarginLeft<=e.absolutePosition.x+e.borderMarginLeft&&e.absolutePosition.x+e.borderMarginLeft<=this.AbsolutePosition.x+this.borderMarginRight,n=this.AbsolutePosition.x+this.borderMarginLeft<=e.absolutePosition.x+e.borderMarginRight&&e.absolutePosition.x+e.borderMarginRight<=this.AbsolutePosition.x+this.borderMarginRight;if(t&&n){var i=this.AbsolutePosition.y+this.borderMarginTop<=e.absolutePosition.y+e.borderMarginTop&&e.absolutePosition.y+e.borderMarginTop<=this.AbsolutePosition.y+this.borderMarginBottom,r=this.AbsolutePosition.y+this.borderMarginTop<=e.absolutePosition.y+e.borderMarginBottom&&e.absolutePosition.y+e.borderMarginBottom<=this.AbsolutePosition.y+this.borderMarginBottom;if(i&&r)return!0}return!1}},{key:"pointLiesInsideMargins",value:function(e){return this.AbsolutePosition.x+this.borderMarginLeft<=e.x&&e.x<=this.AbsolutePosition.x+this.borderMarginRight&&this.AbsolutePosition.y+this.borderMarginTop<=e.y&&e.y<=this.AbsolutePosition.y+this.borderMarginBottom}},{key:"computeNonOverlappingPosition",value:function(e,t,n){this.RelativePosition=new o.PointF2D(n.x,n.y),this.setAbsolutePositionFromParent();var i=0,a=!1;do{switch(t){case r.Left:case r.Right:i=this.relativePosition.x,e.calculatePositionAlongDirection(this,t),a=Math.abs(i-this.relativePosition.x)>1e-4;break;case r.Up:case r.Down:i=this.relativePosition.y,e.calculatePositionAlongDirection(this,t),a=Math.abs(i-this.relativePosition.y)>1e-4;break;default:throw new s.ArgumentOutOfRangeException("direction")}}while(a)}},{key:"getClickedObjectOfType",value:function(e){var t=this.dataObject;if(this.pointLiesInsideBorders(e)&&t)return t;for(var n=0,i=this.childElements.length;n<i;++n){var r=this.childElements[n].getClickedObjectOfType(e);if(r)return r}}},{key:"getClickedClickable",value:function(e){var t=this.dataObject;if(this.pointLiesInsideBorders(e)&&t&&t instanceof h.Clickable)return t;for(var n=0,i=this.childElements.length;n<i;++n){var r=this.childElements[n].getClickedClickable(e);if(r&&r instanceof h.Clickable)return r}}},{key:"getObjectsInRegion",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.GraphicalObject.name,r=[],a=b(this.childElements);try{for(a.s();!(t=a.n()).done;){var s=t.value;r=r.concat(s.getObjectsInRegion(e,n,i))}}catch(o){a.e(o)}finally{a.f()}return this.dataObject&&this.dataObject.isInstanceOfClass(i)&&(n?e.liesInsideBorders(this)&&r.push(this.dataObject):e.collisionDetection(this)&&r.push(this.dataObject)),r}},{key:"calculateRectangle",value:function(){this.upperLeftCorner=new o.PointF2D(this.BorderLeft,this.BorderTop),this.size=new u.SizeF2D(this.BorderRight-this.BorderLeft,this.BorderBottom-this.BorderTop),this.boundingRectangle=l.RectangleF2D.createFromLocationAndSize(this.upperLeftCorner,this.size)}},{key:"calculateMarginRectangle",value:function(){this.upperLeftMarginCorner=new o.PointF2D(this.BorderMarginLeft,this.BorderMarginTop),this.marginSize=new u.SizeF2D(this.BorderMarginRight-this.BorderMarginLeft,this.BorderMarginBottom-this.BorderMarginTop),this.boundingMarginRectangle=l.RectangleF2D.createFromLocationAndSize(this.upperLeftMarginCorner,this.marginSize)}},{key:"calculateMarginPositionAlongDirection",value:function(e,t){if(this!==e){if(this.isSymbol&&this.marginCollisionDetection(e)){var n=0;switch(t){case r.Left:return n=this.absolutePosition.x+this.borderMarginLeft-(e.absolutePosition.x+e.borderMarginRight),e.relativePosition.x+=n,void(e.absolutePosition.x+=n);case r.Right:return n=this.absolutePosition.x+this.borderMarginRight-(e.absolutePosition.x+e.borderMarginLeft),e.relativePosition.x+=n,void(e.absolutePosition.x+=n);case r.Up:return n=this.absolutePosition.y+this.borderMarginTop-(e.absolutePosition.y+e.borderMarginBottom),e.relativePosition.y+=n,void(e.absolutePosition.y+=n);case r.Down:return n=this.absolutePosition.y+this.borderMarginBottom-(e.absolutePosition.y+e.borderMarginTop),e.relativePosition.y+=n,void(e.absolutePosition.y+=n);default:throw new s.ArgumentOutOfRangeException("direction")}}for(var i=0,a=this.ChildElements.length;i<a;++i)this.ChildElements[i].calculateMarginPositionAlongDirection(e,t)}}},{key:"calculatePositionAlongDirection",value:function(e,t){if(this!==e){var n;if(this.isSymbol&&this.collisionDetection(e))switch(t){case r.Left:return n=this.absolutePosition.x+this.borderLeft-(e.absolutePosition.x+e.borderRight),e.relativePosition.x+=n,void(e.absolutePosition.x+=n);case r.Right:return n=this.absolutePosition.x+this.borderRight-(e.absolutePosition.x+e.borderLeft),e.relativePosition.x+=n,void(e.absolutePosition.x+=n);case r.Up:return n=this.absolutePosition.y+this.borderTop-(e.absolutePosition.y+e.borderBottom),e.relativePosition.y+=n,void(e.absolutePosition.y+=n);case r.Down:return n=this.absolutePosition.y+this.borderBottom-(e.absolutePosition.y+e.borderTop),e.relativePosition.y+=n,void(e.absolutePosition.y+=n);default:throw new s.ArgumentOutOfRangeException("direction")}for(var i=0,a=this.ChildElements.length;i<a;++i)this.ChildElements[i].calculatePositionAlongDirection(e,t)}}}]),e}(),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(r=t.ColDirEnum||(t.ColDirEnum={}))},4278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Clickable=void 0;var i=function(e){h(n,e);var t=d(n);function n(){return g(this,n),t.apply(this,arguments)}return n}(n(4785).GraphicalObject);t.Clickable=i},8155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoColorSet=t.NoteState=t.GraphicalLayers=t.StyleSets=t.OUTLINE_AND_FILL_STYLE_DICT=t.OutlineAndFillStyleEnum=void 0;var i,r,a,s,o,u=n(1649);!function(e){e[e.BaseWritingColor=0]="BaseWritingColor",e[e.FollowingCursor=1]="FollowingCursor",e[e.AlternativeFollowingCursor=2]="AlternativeFollowingCursor",e[e.PlaybackCursor=3]="PlaybackCursor",e[e.Highlighted=4]="Highlighted",e[e.ErrorUnderlay=5]="ErrorUnderlay",e[e.Selected=6]="Selected",e[e.SelectionSymbol=7]="SelectionSymbol",e[e.DebugColor1=8]="DebugColor1",e[e.DebugColor2=9]="DebugColor2",e[e.DebugColor3=10]="DebugColor3",e[e.SplitScreenDivision=11]="SplitScreenDivision",e[e.GreyTransparentOverlay=12]="GreyTransparentOverlay",e[e.MarkedArea1=13]="MarkedArea1",e[e.MarkedArea2=14]="MarkedArea2",e[e.MarkedArea3=15]="MarkedArea3",e[e.MarkedArea4=16]="MarkedArea4",e[e.MarkedArea5=17]="MarkedArea5",e[e.MarkedArea6=18]="MarkedArea6",e[e.MarkedArea7=19]="MarkedArea7",e[e.MarkedArea8=20]="MarkedArea8",e[e.MarkedArea9=21]="MarkedArea9",e[e.MarkedArea10=22]="MarkedArea10",e[e.Comment1=23]="Comment1",e[e.Comment2=24]="Comment2",e[e.Comment3=25]="Comment3",e[e.Comment4=26]="Comment4",e[e.Comment5=27]="Comment5",e[e.Comment6=28]="Comment6",e[e.Comment7=29]="Comment7",e[e.Comment8=30]="Comment8",e[e.Comment9=31]="Comment9",e[e.Comment10=32]="Comment10"}(i=t.OutlineAndFillStyleEnum||(t.OutlineAndFillStyleEnum={})),t.OUTLINE_AND_FILL_STYLE_DICT=new u.Dictionary,t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.BaseWritingColor,"Thistle"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.FollowingCursor,"Aqua"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.AlternativeFollowingCursor,"Azure"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.PlaybackCursor,"Bisque"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Highlighted,"CadetBlue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.ErrorUnderlay,"DarkBlue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Selected,"DarkGoldenRod"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.SelectionSymbol,"BlanchedAlmond"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.DebugColor1,"Chartreuse"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.DebugColor2,"DarkGreen"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.DebugColor3,"DarkOrange"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.SplitScreenDivision,"FireBrick"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.GreyTransparentOverlay,"DarkSalmon"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea1,"DarkSeaGreen"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea2,"DarkOrchid"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea3,"Aquamarine"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea4,"DarkKhaki"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea5,"ForestGreen"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea6,"AliceBlue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea7,"DeepPink"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea8,"Coral"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea9,"DarkOliveGreen"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.MarkedArea10,"Chocolate"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment1,"DodgerBlue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment2,"Blue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment3,"Beige"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment4,"Crimson"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment5,"Fuchsia"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment6,"Brown"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment7,"BlanchedAlmond"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment8,"CornflowerBlue"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment9,"Cornsilk"),t.OUTLINE_AND_FILL_STYLE_DICT.setValue(i.Comment10,"DarkGrey"),(o=t.StyleSets||(t.StyleSets={}))[o.MarkedArea=0]="MarkedArea",o[o.Comment=1]="Comment",(s=t.GraphicalLayers||(t.GraphicalLayers={}))[s.Background=0]="Background",s[s.Highlight=1]="Highlight",s[s.MeasureError=2]="MeasureError",s[s.SelectionSymbol=3]="SelectionSymbol",s[s.Cursor=4]="Cursor",s[s.PSI_Debug=5]="PSI_Debug",s[s.Notes=6]="Notes",s[s.Comment=7]="Comment",s[s.Debug_above=8]="Debug_above",(a=t.NoteState||(t.NoteState={}))[a.Normal=0]="Normal",a[a.Selected=1]="Selected",a[a.Follow_Confirmed=2]="Follow_Confirmed",a[a.QFeedback_NotFound=3]="QFeedback_NotFound",a[a.QFeedback_OK=4]="QFeedback_OK",a[a.QFeedback_Perfect=5]="QFeedback_Perfect",a[a.Debug1=6]="Debug1",a[a.Debug2=7]="Debug2",a[a.Debug3=8]="Debug3",(r=t.AutoColorSet||(t.AutoColorSet={})).C="#d82c6b",r.D="#F89D15",r.E="#FFE21A",r.F="#4dbd5c",r.G="#009D96",r.A="#43469d",r.B="#76429c",r.Rest="#000000"},5074:function(e,t){"use strict";var n,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.PhonicScoreModes=t.MusicSymbolDrawingStyle=t.DrawingMode=void 0,(r=t.DrawingMode||(t.DrawingMode={}))[r.All=0]="All",r[r.NoOverlays=1]="NoOverlays",r[r.Leadsheet=2]="Leadsheet",(i=t.MusicSymbolDrawingStyle||(t.MusicSymbolDrawingStyle={}))[i.Normal=0]="Normal",i[i.Disabled=1]="Disabled",i[i.Selected=2]="Selected",i[i.Clickable=3]="Clickable",i[i.PlaybackSymbols=4]="PlaybackSymbols",i[i.FollowSymbols=5]="FollowSymbols",i[i.QFeedbackNotFound=6]="QFeedbackNotFound",i[i.QFeedbackOk=7]="QFeedbackOk",i[i.QFeedbackPerfect=8]="QFeedbackPerfect",i[i.Debug1=9]="Debug1",i[i.Debug2=10]="Debug2",i[i.Debug3=11]="Debug3",(n=t.PhonicScoreModes||(t.PhonicScoreModes={}))[n.Following=0]="Following",n[n.Midi=1]="Midi",n[n.Manual=2]="Manual"},7459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrawingParameters=t.DrawingParametersEnum=t.ColoringModes=void 0;var i,r,a=n(1405),s=n(3748);(r=t.ColoringModes||(t.ColoringModes={}))[r.XML=0]="XML",r[r.AutoColoring=1]="AutoColoring",r[r.CustomColorSet=2]="CustomColorSet",function(e){e.allon="allon",e.compact="compact",e.compacttight="compacttight",e.default="default",e.leadsheet="leadsheet",e.preview="preview",e.thumbnail="thumbnail"}(i=t.DrawingParametersEnum||(t.DrawingParametersEnum={})),t.DrawingParameters=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default,n=arguments.length>1?arguments[1]:void 0;g(this,e),this.drawCursors=!0,this.drawTitle=!0,this.drawSubtitle=!0,this.drawLyricist=!0,this.drawComposer=!0,this.drawCredits=!0,this.drawPartNames=!0,this.fingeringPosition=s.PlacementEnum.Left,this.drawHiddenNotes=!1,this.rules=n,this.rules||(this.rules=new a.EngravingRules),this.DrawingParametersEnum=t}return y(e,[{key:"DrawingParametersEnum",get:function(){return this.drawingParametersEnum},set:function(e){switch(this.drawingParametersEnum=e,e){case i.allon:this.setForAllOn();break;case i.thumbnail:this.setForThumbnail();break;case i.leadsheet:this.setForLeadsheet();break;case i.compact:this.setForCompactMode();break;case i.compacttight:this.setForCompactTightMode();break;case i.default:default:this.setForDefault()}}},{key:"setForAllOn",value:function(){this.drawHighlights=!0,this.drawErrors=!0,this.drawSelectionStartSymbol=!0,this.drawSelectionEndSymbol=!0,this.drawCursors=!0,this.drawActivitySymbols=!0,this.drawScrollIndicator=!0,this.drawAnnotations=!0,this.drawComments=!0,this.drawMarkedAreas=!0,this.DrawTitle=!0,this.DrawSubtitle=!0,this.DrawComposer=!0,this.DrawLyricist=!0,this.drawCredits=!0,this.DrawPartNames=!0,this.drawHiddenNotes=!0,this.rules.CompactMode=!1}},{key:"setForDefault",value:function(){this.rules.loadDefaultValues(),this.setForAllOn(),this.drawHiddenNotes=!1}},{key:"setForThumbnail",value:function(){this.drawHighlights=!1,this.drawErrors=!1,this.drawSelectionStartSymbol=!1,this.drawSelectionStartSymbol=!1,this.drawCursors=!1,this.drawActivitySymbols=!1,this.drawScrollIndicator=!1,this.drawAnnotations=!0,this.drawComments=!0,this.drawMarkedAreas=!0,this.drawHiddenNotes=!1}},{key:"setForCompactMode",value:function(){this.rules.CompactMode=!0,this.DrawCredits=!1,this.drawHiddenNotes=!1}},{key:"setForCompactTightMode",value:function(){this.setForCompactMode(),this.DrawPartNames=!1,this.rules.VoiceSpacingMultiplierVexflow=.65,this.rules.VoiceSpacingAddendVexflow=2,this.rules.MinSkyBottomDistBetweenStaves=1,this.rules.MinSkyBottomDistBetweenSystems=1,this.rules.BetweenStaffDistance=2.5,this.rules.StaffDistance=3.5,this.rules.MinimumDistanceBetweenSystems=1,this.rules.PageBottomMargin=0,this.rules.PageLeftMargin=2,this.rules.PageRightMargin=2}},{key:"setForLeadsheet",value:function(){this.drawHighlights=!1,this.drawErrors=!1,this.drawSelectionStartSymbol=!0,this.drawSelectionEndSymbol=!0,this.drawCursors=!0,this.drawActivitySymbols=!1,this.drawScrollIndicator=!0,this.drawAnnotations=!0,this.drawComments=!0,this.drawMarkedAreas=!0}},{key:"DrawCredits",get:function(){return this.drawCredits},set:function(e){this.drawCredits=e,this.DrawComposer=e,this.DrawTitle=e,this.DrawSubtitle=e,this.DrawLyricist=e}},{key:"DrawTitle",get:function(){return this.drawTitle},set:function(e){this.drawTitle=e,this.rules.RenderTitle=e,e||(this.DrawSubtitle=!1)}},{key:"DrawSubtitle",get:function(){return this.drawSubtitle},set:function(e){this.drawSubtitle=e,this.rules.RenderSubtitle=e,e&&(this.DrawTitle=!0)}},{key:"DrawComposer",get:function(){return this.drawComposer},set:function(e){this.drawComposer=e,this.rules.RenderComposer=e}},{key:"DrawLyricist",get:function(){return this.drawLyricist},set:function(e){this.drawLyricist=e,this.rules.RenderLyricist=e}},{key:"DrawPartNames",get:function(){return this.drawPartNames},set:function(e){this.drawPartNames=e,this.rules.RenderPartNames=e,this.rules.RenderPartNames||(this.rules.RenderPartAbbreviations=!1)}},{key:"FingeringPosition",get:function(){return this.fingeringPosition},set:function(e){this.fingeringPosition=e,this.rules.FingeringPosition=e}},{key:"Rules",get:function(){return this.rules},set:function(e){this.rules=e}}]),e}()},1405:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PageFormat=t.EngravingRules=void 0;var r=n(599),a=i(n(2043)),s=n(1274),o=n(3748),u=n(41),l=n(7459),c=n(1649),h=n(5544),d=n(8640),f=n(4123),p=n(3486),m=function(){function t(){g(this,t),this.NoteDistances=[1,1,1.3,1.6,2,2.5,3,4],this.NoteDistancesScalingFactors=[1,2,4,8,16,32,64,128],this.DurationDistanceDict={},this.DurationScalingDistanceDict={},this.NoteToGraphicalNoteMapObjectCount=0,this.PlayAlreadyStartedNotesFromCursorPosition=!1,this.PlaybackSkipNotesSafetyInterval=.02,this.UseDefaultVoiceInteractionListener=!0,this.LimitCursorPositionToCurrentMeasure=!0,this.loadDefaultValues()}return y(t,[{key:"loadDefaultValues",value:function(){this.SamplingUnit=3*t.unit,this.MpatMode=!0,this.SheetTitleHeight=4,this.SheetSubtitleHeight=2,this.SheetMinimumDistanceBetweenTitleAndSubtitle=1,this.SheetComposerHeight=2,this.SheetAuthorHeight=2,this.CompactMode=!1,this.PagePlacementEnum=r.PagePlacementEnum.Down,this.PageHeight=100001,this.PageTopMargin=5,this.PageTopMarginNarrow=0,this.PageBottomMargin=5,this.PageLeftMargin=5,this.PageRightMargin=5,this.TitleTopDistance=5,this.TitleBottomDistance=1,this.StaffDistance=7,this.BetweenStaffDistance=5,this.MinimumStaffLineDistance=4,this.MinSkyBottomDistBetweenStaves=1,this.StaffHeight=4,this.TabStaffInterlineHeight=1.1111,this.BetweenStaffLinesDistance=t.unit,this.SystemLeftMargin=0,this.SystemRightMargin=0,this.SystemLabelsRightMargin=2,this.SystemComposerDistance=2,this.InstrumentLabelTextHeight=2,this.MinimumDistanceBetweenSystems=7,this.MinSkyBottomDistBetweenSystems=5,this.LastSystemMaxScalingFactor=1.4,this.AutoBeamNotes=!1,this.AutoBeamOptions={beam_middle_rests_only:!1,beam_rests:!1,maintain_stem_directions:!1},this.AutoBeamTabs=!1,this.BeamWidth=t.unit/2,this.BeamSpaceWidth=t.unit/3,this.BeamForwardLength=1.25*t.unit,this.FlatBeams=!1,this.FlatBeamOffset=20,this.FlatBeamOffsetPerBeam=10,this.ClefLeftMargin=.5,this.ClefRightMargin=.75,this.PercussionOneLineCutoff=3,this.PercussionForceVoicesOneLineCutoff=1,this.PercussionUseXMLDisplayStep=!0,this.PercussionXMLDisplayStepNoteValueShift=0,this.PercussionOneLineXMLDisplayStepOctaveOffset=0,this.BetweenKeySymbolsDistance=.2,this.KeyRightMargin=.75,this.RhythmRightMargin=1.25,this.ShowRhythmAgainAfterPartEndOrFinalBarline=!0,this.NewPartAndSystemAfterFinalBarline=!1,this.InStaffClefScalingFactor=.8,this.DistanceBetweenNaturalAndSymbolWhenCancelling=.4,this.NoteHelperLinesOffset=.25,this.MeasureLeftMargin=.7,this.MeasureRightMargin=0,this.DistanceBetweenLastInstructionAndRepetitionBarline=1,this.ArpeggioDistance=.6,this.StaccatoShorteningFactor=2,this.IdealStemLength=3,this.StemNoteHeadBorderYOffset=.2,this.StemMargin=.2,this.StemMinLength=2.5,this.StemMaxLength=4.5,this.BeamSlopeMaxAngle=10,this.StemMinAllowedDistanceBetweenNoteHeadAndBeamLine=1,this.SetWantedStemDirectionByXml=!0,this.GraceNoteScalingFactor=.6,this.GraceNoteXOffset=.2,this.GraceNoteGroupXMargin=0,this.WedgeOpeningLength=1.2,this.WedgeMeasureEndOpeningLength=.75,this.WedgeMeasureBeginOpeningLength=.75,this.WedgePlacementAboveY=-1.5,this.WedgePlacementBelowY=1.5,this.WedgeHorizontalMargin=.6,this.WedgeVerticalMargin=.5,this.DistanceOffsetBetweenTwoHorizontallyCrossedWedges=.3,this.WedgeMinLength=2,this.WedgeEndDistanceBetweenTimestampsFactor=1.75,this.SoftAccentWedgePadding=.4,this.SoftAccentSizeFactor=.6,this.DistanceBetweenAdjacentDynamics=.75,this.TempoChangeMeasureValidity=4,this.TempoContinousFactor=.7,this.StaccatoScalingFactor=.8,this.BetweenDotsDistance=.8,this.OrnamentAccidentalScalingFactor=.65,this.ChordSymbolTextHeight=2,this.ChordSymbolTextAlignment=s.TextAlignmentEnum.LeftBottom,this.ChordSymbolRelativeXOffset=-1,this.ChordSymbolXSpacing=1,this.ChordOverlapAllowedIntoNextMeasure=0,this.ChordSymbolYOffset=.1,this.ChordSymbolYPadding=0,this.ChordSymbolYAlignment=!0,this.ChordSymbolYAlignmentScope="staffline",this.ChordAccidentalTexts=new c.Dictionary,this.resetChordAccidentalTexts(this.ChordAccidentalTexts,!1),this.ChordSymbolLabelTexts=new c.Dictionary,this.resetChordSymbolLabelTexts(this.ChordSymbolLabelTexts),this.CustomChords=[],this.resetChordNames(),this.RepetitionSymbolsYOffset=0,this.RehearsalMarkXOffsetDefault=10,this.RehearsalMarkXOffset=0,this.RehearsalMarkXOffsetSystemStartMeasure=-20,this.RehearsalMarkYOffsetDefault=-15,this.RehearsalMarkYOffset=0,this.RehearsalMarkFontSize=10,this.MeasureNumberLabelHeight=1.5*t.unit,this.MeasureNumberLabelOffset=2,this.MeasureNumberLabelXOffset=-.5,this.TupletsRatioed=!1,this.TupletsBracketed=!1,this.TripletsBracketed=!1,this.TupletNumberLabelHeight=1.5*t.unit,this.TupletNumberYOffset=.5,this.TupletNumberLimitConsecutiveRepetitions=!0,this.TupletNumberMaxConsecutiveRepetitions=2,this.TupletNumberAlwaysDisableAfterFirstMax=!0,this.LabelMarginBorderFactor=.1,this.TupletVerticalLineLength=.5,this.TupletNumbersInTabs=!1,this.SlurPlacementFromXML=!0,this.BezierCurveStepSize=1e3,this.calculateCurveParametersArrays(),this.TieGhostObjectWidth=.75,this.TieYPositionOffsetFactor=.3,this.MinimumNeededXspaceForTieGhostObject=1,this.TieHeightMinimum=.28,this.TieHeightMaximum=1.2,this.TieHeightInterpolationK=.0288,this.TieHeightInterpolationD=.136,this.SlurNoteHeadYOffset=.5,this.SlurEndArticulationYOffset=.8,this.SlurStartArticulationYOffsetOfArticulation=.5,this.SlurStemXOffset=.3,this.SlurSlopeMaxAngle=15,this.SlurTangentMinAngle=30,this.SlurTangentMaxAngle=80,this.SlurHeightFactor=1,this.SlurHeightFlattenLongSlursFactorByWidth=.24,this.SlurHeightFlattenLongSlursFactorByAngle=.36,this.SlurHeightFlattenLongSlursCutoffAngle=47,this.SlurHeightFlattenLongSlursCutoffWidth=16,this.SlursStartingAtSameStaffEntryYOffset=.8,this.SlurMaximumYControlPointDistance=void 0,this.RepetitionEndingLabelHeight=2,this.RepetitionEndingLabelXOffset=.5,this.RepetitionEndingLabelYOffset=.3,this.RepetitionEndingLineYLowerOffset=.5,this.RepetitionEndingLineYUpperOffset=.3,this.VoltaOffset=2.5,this.LyricsAlignmentStandard=s.TextAlignmentEnum.LeftBottom,this.LyricsHeight=2,this.LyricsYOffsetToStaffHeight=0,this.LyricsYMarginToBottomLine=.2,this.VerticalBetweenLyricsDistance=.5,this.HorizontalBetweenLyricsDistance=.2,this.BetweenSyllableMaximumDistance=10,this.BetweenSyllableMinimumDistance=.5,this.LyricOverlapAllowedIntoNextMeasure=3.4,this.MinimumDistanceBetweenDashes=10,this.MaximumLyricsElongationFactor=2.5,this.TempoYSpacing=0,this.InstantaneousTempoTextHeight=2.3,this.ContinuousDynamicTextHeight=2.3,this.MoodTextHeight=2.3,this.UnknownTextHeight=2,this.ContinuousTempoTextHeight=2.3,this.DynamicExpressionMaxDistance=2,this.DynamicExpressionSpacer=.5,this.VexFlowDefaultNotationFontScale=39,this.VexFlowDefaultTabFontScale=39,this.TremoloStrokeScale=1,this.TremoloYSpacingScale=1,this.StemWidth=.15,this.StaffLineWidth=.1,this.StaffLineColor=void 0,this.LedgerLineWidth=1,this.LedgerLineStrokeStyle=void 0,this.LedgerLineColorDefault="#000000",this.WedgeLineWidth=.12,this.TupletLineWidth=.12,this.LyricUnderscoreLineWidth=.12,this.SystemThinLineWidth=.12,this.SystemBoldLineWidth=t.unit/2,this.SystemRepetitionEndingLineWidth=.12,this.SystemDotWidth=t.unit/2,this.DistanceBetweenVerticalSystemLines=.35,this.DistanceBetweenDotAndLine=.7,this.RepeatEndStartPadding=2,this.OctaveShiftLineWidth=.12,this.OctaveShiftVerticalLineLength=t.unit,this.GraceLineWidth=this.StaffLineWidth*this.GraceNoteScalingFactor,this.MultipleRestMeasureDefaultWidth=4,this.MinimumCrossedBeamDifferenceMargin=1e-4,this.SheetMaximumWidth=32767,this.VoiceSpacingMultiplierVexflow=.85,this.VoiceSpacingAddendVexflow=3,this.PickupMeasureWidthMultiplier=1,this.PickupMeasureRepetitionSpacing=.8,this.DisplacedNoteMargin=.1,this.MinNoteDistance=2,this.SubMeasureXSpacingThreshold=35,this.MeasureDynamicsMaxScalingFactor=2.5,this.WholeRestXShiftVexflow=-1.5,this.MetronomeMarksDrawn=!0,this.MetronomeMarkXShift=-6,this.MetronomeMarkYShift=-.5,this.SoftmaxFactorVexFlow=15,this.StaggerSameWholeNotes=!0,this.AlignRests=u.AlignRestOption.Never,this.RestCollisionYPadding=0,this.FillEmptyMeasuresWithWholeRest=u.FillEmptyMeasuresWithWholeRests.No,this.ArpeggiosGoAcrossVoices=!1,this.RenderArpeggios=!0,this.RenderSlurs=!0,this.ColoringMode=l.ColoringModes.XML,this.ColoringEnabled=!0,this.ColorStemsLikeNoteheads=!1,this.ColorBeams=!0,this.ColorFlags=!0,this.applyDefaultColorMusic("#000000"),this.DefaultColorCursor="#33e02f",this.DefaultFontFamily="Times New Roman",this.DefaultFontStyle=h.FontStyles.Regular,this.DefaultVexFlowNoteFont="gonville",this.MaxMeasureToDrawIndex=Number.MAX_VALUE,this.MinMeasureToDrawIndex=0,this.MaxSystemToDrawNumber=Number.MAX_VALUE,this.MaxPageToDrawNumber=Number.MAX_VALUE,this.RenderComposer=!0,this.RenderTitle=!0,this.RenderSubtitle=!0,this.RenderLyricist=!0,this.RenderPartNames=!0,this.RenderPartAbbreviations=!0,this.RenderFingerings=!0,this.RenderMeasureNumbers=!0,this.RenderMeasureNumbersOnlyAtSystemStart=!1,this.UseXMLMeasureNumbers=!0,this.RenderLyrics=!0,this.RenderChordSymbols=!0,this.RenderMultipleRestMeasures=!0,this.AutoGenerateMutipleRestMeasuresFromRestMeasures=!0,this.RenderRehearsalMarks=!0,this.RenderClefsAtBeginningOfStaffline=!0,this.RenderKeySignatures=!0,this.RenderTimeSignatures=!0,this.ArticulationPlacementFromXML=!0,this.FingeringPosition=o.PlacementEnum.AboveOrBelow,this.FingeringPositionFromXML=!0,this.FingeringPositionGrace=o.PlacementEnum.Left,this.FingeringInsideStafflines=!1,this.FingeringLabelFontHeight=1.7,this.FingeringOffsetX=0,this.FingeringOffsetY=0,this.FingeringPaddingY=-.2,this.FingeringTextSize=1.5,this.RenderStringNumbersClassical=!0,this.StringNumberOffsetY=0,this.NewSystemAtXMLNewSystemAttribute=!1,this.NewPageAtXMLNewPageAttribute=!1,this.RestoreCursorAfterRerender=!0,this.StretchLastSystemLine=!1,this.IgnoreBracketsWords=!0,this.UseJustifiedBuilder=!0,this.PageFormat=v.UndefinedPageFormat,this.PageBackgroundColor=void 0,this.PerformanceMode=!1,this.RenderSingleHorizontalStaffline=!1,this.SpacingBetweenTextLines=0,this.NoteToGraphicalNoteMap=new c.Dictionary,this.NoteToGraphicalNoteMapObjectCount=0,this.SkyBottomLineBatchMinMeasures=5,this.SkyBottomLineWebGLMinMeasures=80,this.AlwaysSetPreferredSkyBottomLineBackendAutomatically=!0,this.DisableWebGLInFirefox=!0,this.DisableWebGLInSafariAndIOS=!0,this.setPreferredSkyBottomLineBackendAutomatically();try{this.MaxInstructionsConstValue=this.ClefLeftMargin+this.ClefRightMargin+this.KeyRightMargin+this.RhythmRightMargin+11}catch(e){a.default.info("EngravingRules()",e)}this.MpatMode&&(this.NewPartAndSystemAfterFinalBarline=!0)}},{key:"setPreferredSkyBottomLineBackendAutomatically",value:function(){var e,t,n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,a=null!==(t=null===(e=globalThis.navigator)||void 0===e?void 0:e.vendor)&&void 0!==t?t:"",s=null!==(i=null===(n=globalThis.navigator)||void 0===n?void 0:n.userAgent)&&void 0!==i?i:"",o=!1;(this.DisableWebGLInSafariAndIOS&&/apple/i.test(a)||this.DisableWebGLInFirefox&&s.includes("Firefox"))&&(o=!0),this.PreferredSkyBottomLineBatchCalculatorBackend=u.SkyBottomLineBatchCalculatorBackendType.Plain,o||r>=this.SkyBottomLineWebGLMinMeasures&&(this.PreferredSkyBottomLineBatchCalculatorBackend=u.SkyBottomLineBatchCalculatorBackendType.WebGL)}},{key:"applyDefaultColorMusic",value:function(e){this.DefaultColorMusic=e,this.DefaultColorNotehead=e,this.DefaultColorRest=e,this.DefaultColorStem=e,this.DefaultColorLabel=e,this.DefaultColorLyrics=e,this.DefaultColorTitle=e,this.LedgerLineColorDefault=e}},{key:"addGraphicalNoteToNoteMap",value:function(e,t){e.NoteToGraphicalNoteObjectId=this.NoteToGraphicalNoteMapObjectCount,this.NoteToGraphicalNoteMap.setValue(e.NoteToGraphicalNoteObjectId,t),this.NoteToGraphicalNoteMapObjectCount++}},{key:"GNote",value:function(e){return p.GraphicalNote.FromNote(e,this)}},{key:"clearMusicSheetObjects",value:function(){this.NoteToGraphicalNoteMap=new c.Dictionary,this.NoteToGraphicalNoteMapObjectCount=0}},{key:"resetChordAccidentalTexts",value:function(e,t){e.setValue(d.AccidentalEnum.SHARP,t?"\u266f":"#"),e.setValue(d.AccidentalEnum.FLAT,t?"\u266d":"b"),e.setValue(d.AccidentalEnum.DOUBLEFLAT,t?"\ud834\udd2b":"bb"),e.setValue(d.AccidentalEnum.DOUBLESHARP,t?"\ud834\udd2a":"x")}},{key:"setChordSymbolLabelText",value:function(e,t){this.ChordSymbolLabelTexts.setValue(e,t)}},{key:"resetChordSymbolLabelTexts",value:function(e){return e.setValue(f.ChordSymbolEnum.minor,"m"),e.setValue(f.ChordSymbolEnum.augmented,"aug"),e.setValue(f.ChordSymbolEnum.diminished,"dim"),e.setValue(f.ChordSymbolEnum.dominant,"7"),e.setValue(f.ChordSymbolEnum.majorseventh,"maj7"),e.setValue(f.ChordSymbolEnum.minorseventh,"m7"),e.setValue(f.ChordSymbolEnum.diminishedseventh,"dim7"),e.setValue(f.ChordSymbolEnum.augmentedseventh,"aug7"),e.setValue(f.ChordSymbolEnum.halfdiminished,"m7".concat(this.ChordAccidentalTexts.getValue(d.AccidentalEnum.FLAT),"5")),e.setValue(f.ChordSymbolEnum.majorminor,"m(maj7)"),e.setValue(f.ChordSymbolEnum.majorsixth,"maj6"),e.setValue(f.ChordSymbolEnum.minorsixth,"m6"),e.setValue(f.ChordSymbolEnum.dominantninth,"9"),e.setValue(f.ChordSymbolEnum.majorninth,"maj9"),e.setValue(f.ChordSymbolEnum.minorninth,"m9"),e.setValue(f.ChordSymbolEnum.dominant11th,"11"),e.setValue(f.ChordSymbolEnum.major11th,"maj11"),e.setValue(f.ChordSymbolEnum.minor11th,"m11"),e.setValue(f.ChordSymbolEnum.dominant13th,"13"),e.setValue(f.ChordSymbolEnum.major13th,"maj13"),e.setValue(f.ChordSymbolEnum.minor13th,"m13"),e.setValue(f.ChordSymbolEnum.suspendedsecond,"sus2"),e.setValue(f.ChordSymbolEnum.suspendedfourth,"sus4"),e.setValue(f.ChordSymbolEnum.power,"5"),e.setValue(f.ChordSymbolEnum.none,"N.C."),e}},{key:"addChordName",value:function(e,t,n,i,r){if(void 0!==f.ChordSymbolEnum[t]){var a={adds:n,alts:i,subs:r};this.CustomChords.push(f.CustomChord.createCustomChord(e,f.ChordSymbolEnum[t],a))}}},{key:"renameChord",value:function(e,t){f.CustomChord.renameCustomChord(e,t,this.CustomChords)}},{key:"resetChordNames",value:function(){var e=this.ChordAccidentalTexts.getValue(d.AccidentalEnum.SHARP),t=this.ChordAccidentalTexts.getValue(d.AccidentalEnum.FLAT);this.addChordName("alt","major",["".concat(e,"5"),"".concat(t,"9"),"".concat(e,"9")],["".concat(t,"5")],[]),this.addChordName("7alt","dominant",["".concat(e,"5"),"".concat(t,"9"),"".concat(e,"9")],["".concat(t,"5")],[]),this.addChordName("7sus4","dominant",["4"],[],["3"]),this.addChordName("7sus4","suspendedfourth",["7"],[],[]),this.addChordName("9sus4","dominantninth",["4"],[],["3"]),this.addChordName("9sus4","suspendedfourth",["9"],[],[]),this.addChordName("11sus4","dominant11th",["4"],[],["3"]),this.addChordName("11sus4","suspendedfourth",["11"],[],[]),this.addChordName("13sus4","dominant13th",["4"],[],["3"]),this.addChordName("13sus4","suspendedfourth",["13"],[],[]),this.addChordName("7sus2","dominant",["2"],[],["3"]),this.addChordName("7sus2","suspendedsecond",["7"],[],[]),this.addChordName("m7".concat(t,"5"),"minorseventh",[],["".concat(t,"5")],[]),this.addChordName("9sus2","dominantninth",["2"],[],["3"]),this.addChordName("9sus2","suspendedsecond",["9"],[],[]),this.addChordName("11sus2","dominant11th",["2"],[],["3"]),this.addChordName("11sus2","suspendedsecond",["11"],[],[]),this.addChordName("13sus2","dominant13th",["2"],[],["3"]),this.addChordName("13sus2","suspendedsecond",["13"],[],[]),this.addChordName("m(maj9)","majorminor",["9"],[],[]),this.addChordName("m(maj11)","majorminor",["11"],[],[]),this.addChordName("m(maj13)","majorminor",["13"],[],[]),this.addChordName("69","majorsixth",["9"],[],[]),this.addChordName("mi69","minorsixth",["9"],[],[])}},{key:"calculateCurveParametersArrays",value:function(){this.TPower3=new Array(this.BezierCurveStepSize),this.OneMinusTPower3=new Array(this.BezierCurveStepSize),this.FactorOne=new Array(this.BezierCurveStepSize),this.FactorTwo=new Array(this.BezierCurveStepSize);for(var e=0;e<this.BezierCurveStepSize;e++){var t=e/this.BezierCurveStepSize;this.TPower3[e]=Math.pow(t,3),this.OneMinusTPower3[e]=Math.pow(1-t,3),this.FactorOne[e]=3*Math.pow(1-t,2)*t,this.FactorTwo[e]=3*(1-t)*Math.pow(t,2)}}}]),t}();t.EngravingRules=m,m.unit=1;var v=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"noIdStringGiven";g(this,e),this.width=t,this.height=n,this.idString=i}return y(e,[{key:"aspectRatio",get:function(){return this.IsUndefined?0:this.width/this.height}},{key:"IsUndefined",get:function(){return void 0===this.width||void 0===this.height||0===this.height||0===this.width}},{key:"Equals",value:function(e){return!!e&&e.width===this.width&&e.height===this.height}}],[{key:"UndefinedPageFormat",get:function(){return new e(0,0)}}]),e}();t.PageFormat=v},4146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalChordSymbolContainer=void 0;var i=n(2255),r=n(9946),a=n(4123),s=n(8911),o=n(4785),u=n(9086),l=function(e){h(n,e);var t=d(n);function n(e,i,r,a,o,u){var l;return g(this,n),(l=t.call(this)).chordSymbolContainer=e,l.boundingBox=new s.BoundingBox(c(l),i),l.rules=u,l.calculateLabel(r,o,a),l}return y(n,[{key:"GetChordSymbolContainer",get:function(){return this.chordSymbolContainer}},{key:"GraphicalLabel",get:function(){return this.graphicalLabel}},{key:"calculateLabel",value:function(e,t,n){var s=a.ChordSymbolContainer.calculateChordText(this.chordSymbolContainer,t,n);this.graphicalLabel=new r.GraphicalLabel(new i.Label(s),e,this.rules.ChordSymbolTextAlignment,this.rules,this.boundingBox),this.graphicalLabel.PositionAndShape.RelativePosition=new u.PointF2D(this.rules.ChordSymbolRelativeXOffset,0),this.graphicalLabel.Label.colorDefault=this.rules.DefaultColorChordSymbol}}]),n}(o.GraphicalObject);t.GraphicalChordSymbolContainer=l},374:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalContinuousDynamicExpression=void 0;var r=n(6729),a=n(7839),s=n(9086),o=n(6791),u=n(3748),l=i(n(2043)),c=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,i,e,r)).lines=[],a.isSplittedPart=!1,a.notToBeRemoved=!1,a}return y(n,[{key:"StartMeasure",get:function(){return this.startMeasure},set:function(e){this.startMeasure=e}},{key:"EndMeasure",get:function(){return this.endMeasure},set:function(e){this.endMeasure=e}},{key:"EndStaffLine",get:function(){return this.endMeasure?this.endMeasure.ParentStaffLine:void 0}},{key:"IsSplittedPart",get:function(){return this.isSplittedPart},set:function(e){this.isSplittedPart=e}},{key:"IsVerbal",get:function(){return this.ContinuousDynamic.Label&&this.ContinuousDynamic.Label.length>0}},{key:"NotToBeRemoved",get:function(){return this.notToBeRemoved},set:function(e){this.notToBeRemoved=e}},{key:"Lines",get:function(){return this.lines}},{key:"ContinuousDynamic",get:function(){return this.SourceExpression}},{key:"updateSkyBottomLine",value:function(){var e,t=this.parentStaffLine.SkyBottomLineCalculator,n=this.IsVerbal?this.label.PositionAndShape.RelativePosition.x+this.label.PositionAndShape.BorderMarginLeft:0,i=this.IsVerbal?this.label.PositionAndShape.RelativePosition.x+this.label.PositionAndShape.BorderMarginRight:0;switch(!this.IsSoftAccent&&!this.IsVerbal&&this.lines.length<2&&l.default.warn("Not enough lines for SkyBottomLine calculation"),this.IsVerbal||this.ContinuousDynamic.DynamicType!==a.ContDynamicEnum.crescendo&&this.ContinuousDynamic.DynamicType!==a.ContDynamicEnum.diminuendo&&l.default.warn("GraphicalContinuousDynamicExpression.updateSkyBottomLine(): unhandled continuous dynamic type. start measure: "+(null===(e=this.startMeasure)||void 0===e?void 0:e.MeasureNumber)),this.Placement){case u.PlacementEnum.Above:if(this.IsSoftAccent)t.updateSkyLineWithWedge(this.lines[0].Start,this.lines[0].End),t.updateSkyLineWithWedge(this.lines[2].End,this.lines[2].Start),t.updateSkyLineWithLine(this.lines[0].End,this.lines[2].End,this.lines[0].End.y);else if(this.IsVerbal){var r=this.label.PositionAndShape.BorderMarginTop+this.label.PositionAndShape.RelativePosition.y;t.updateSkyLineInRange(n,i,r)}else this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.crescendo?t.updateSkyLineWithWedge(this.lines[0].Start,this.lines[0].End):this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.diminuendo&&t.updateSkyLineWithWedge(this.lines[0].End,this.lines[0].Start);break;case u.PlacementEnum.Below:if(this.IsVerbal){var s=this.label.PositionAndShape.BorderMarginBottom+this.label.PositionAndShape.RelativePosition.y;t.updateBottomLineInRange(n,i,s)}else this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.crescendo?t.updateBottomLineWithWedge(this.lines[1].Start,this.lines[1].End):this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.diminuendo&&t.updateBottomLineWithWedge(this.lines[1].End,this.lines[1].Start);break;default:l.default.error("Placement for GraphicalContinuousDynamicExpression is unknown")}}},{key:"createCrescendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeLineWidth,a=new s.PointF2D(e,n),o=new s.PointF2D(t,n-i/2),u=new s.PointF2D(t,n+i/2);this.addWedgeLines(a,o,u,r)}},{key:"createFirstHalfCrescendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeMeasureEndOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeLineWidth,a=new s.PointF2D(e,n),o=new s.PointF2D(t,n-i/2),u=new s.PointF2D(t,n+i/2);this.addWedgeLines(a,o,u,r)}},{key:"createSecondHalfCrescendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeMeasureBeginOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeOpeningLength,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.rules.WedgeLineWidth,o=new s.PointF2D(e,n-i/2),u=new s.PointF2D(e,n+i/2),l=new s.PointF2D(t,n-r/2),c=new s.PointF2D(t,n+r/2);this.addDoubleLines(o,l,u,c,a)}},{key:"recalculateCrescendoLines",value:function(e,t,n){var i=Math.abs(this.lines[0].Start.y-this.lines[1].Start.y)>1e-4;this.lines.clear(),i?this.createSecondHalfCrescendoLines(e,t,n):this.isSplittedPart?this.createFirstHalfCrescendoLines(e,t,n):this.createCrescendoLines(e,t,n)}},{key:"createDiminuendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeLineWidth,a=new s.PointF2D(e,n-i/2),o=new s.PointF2D(e,n+i/2),u=new s.PointF2D(t,n);this.addWedgeLines(u,a,o,r)}},{key:"createFirstHalfDiminuendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeMeasureEndOpeningLength,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.rules.WedgeLineWidth,o=new s.PointF2D(e,n-i/2),u=new s.PointF2D(e,n+i/2),l=new s.PointF2D(t,n-r/2),c=new s.PointF2D(t,n+r/2);this.addDoubleLines(o,l,u,c,a)}},{key:"createSecondHalfDiminuendoLines",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rules.WedgeMeasureBeginOpeningLength,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.rules.WedgeLineWidth,a=new s.PointF2D(e,n-i/2),o=new s.PointF2D(e,n+i/2),u=new s.PointF2D(t,n);this.addWedgeLines(u,a,o,r)}},{key:"recalculateDiminuendoLines",value:function(e,t,n){var i=Math.abs(this.lines[0].End.y-this.lines[1].End.y)>1e-4;this.lines.clear(),i?this.createFirstHalfDiminuendoLines(e,t,n):this.isSplittedPart?this.createSecondHalfDiminuendoLines(e,t,n):this.createDiminuendoLines(e,t,n)}},{key:"calcPsi",value:function(){this.IsVerbal?this.PositionAndShape.calculateBoundingBox():(this.PositionAndShape.RelativePosition=this.lines[0].Start,this.PositionAndShape.BorderMarginTop=this.lines[0].End.y-this.lines[0].Start.y,this.PositionAndShape.BorderMarginBottom=this.lines[1].End.y-this.lines[1].Start.y,this.PositionAndShape.Center.y=(this.PositionAndShape.BorderMarginTop+this.PositionAndShape.BorderMarginBottom)/2,this.IsSoftAccent?(this.PositionAndShape.BorderMarginLeft=0,this.PositionAndShape.BorderMarginRight=this.lines[3].Start.x-this.lines[0].Start.x):this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.crescendo?(this.PositionAndShape.BorderMarginLeft=0,this.PositionAndShape.BorderMarginRight=this.lines[0].End.x-this.lines[0].Start.x):(this.PositionAndShape.BorderMarginLeft=this.lines[0].End.x-this.lines[0].Start.x,this.PositionAndShape.BorderMarginRight=0))}},{key:"cleanUp",value:function(){this.lines.clear()}},{key:"shiftYPosition",value:function(e){this.IsVerbal?(this.PositionAndShape.RelativePosition.y+=e,this.PositionAndShape.calculateBoundingBox()):(this.lines[0].Start.y+=e,this.lines[0].End.y+=e,this.lines[1].End.y+=e)}},{key:"squeeze",value:function(e){this.IsVerbal||Math.abs(this.lines[0].End.x-this.lines[0].Start.x)<Math.abs(e)||(this.ContinuousDynamic.DynamicType===a.ContDynamicEnum.crescendo?e>0?this.lines[0].Start.x+=e:(this.lines[0].End.x+=e,this.lines[1].End.x+=e):e<0?this.lines[0].Start.x+=e:(this.lines[0].End.x+=e,this.lines[1].End.x+=e),this.calcPsi())}},{key:"addWedgeLines",value:function(e,t,n,i){var a=new r.GraphicalLine(e,t,i),s=new r.GraphicalLine(e,n,i);this.rules.DefaultColorMusic&&(a.colorHex=this.rules.DefaultColorMusic,s.colorHex=this.rules.DefaultColorMusic),this.lines.push(a),this.lines.push(s)}},{key:"addDoubleLines",value:function(e,t,n,i,a){var s=new r.GraphicalLine(e,t,a),o=new r.GraphicalLine(n,i,a);this.rules.DefaultColorMusic&&(s.colorHex=this.rules.DefaultColorMusic,o.colorHex=this.rules.DefaultColorMusic),this.lines.push(s),this.lines.push(o)}}]),n}(o.AbstractGraphicalExpression);t.GraphicalContinuousDynamicExpression=c},5330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalCurve=void 0;var i=n(9086),r=function(){function e(){g(this,e),e.tPow3=new Array(e.bezierCurveStepSize),e.oneMinusTPow3=new Array(e.bezierCurveStepSize),e.bezierFactorOne=new Array(e.bezierCurveStepSize),e.bezierFactorTwo=new Array(e.bezierCurveStepSize);for(var t=0;t<e.bezierCurveStepSize;t++){var n=t/e.bezierCurveStepSize;e.tPow3[t]=Math.pow(n,3),e.oneMinusTPow3[t]=Math.pow(1-n,3),e.bezierFactorOne[t]=3*Math.pow(1-n,2)*n,e.bezierFactorTwo[t]=3*(1-n)*Math.pow(n,2)}}return y(e,[{key:"calculateCurvePointAtIndex",value:function(t){var n=Math.round(t*e.bezierCurveStepSize);return n<0||n>=e.bezierCurveStepSize?new i.PointF2D:new i.PointF2D(e.oneMinusTPow3[n]*this.bezierStartPt.x+e.bezierFactorOne[n]*this.bezierStartControlPt.x+e.bezierFactorTwo[n]*this.bezierEndControlPt.x+e.tPow3[n]*this.bezierEndPt.x,e.oneMinusTPow3[n]*this.bezierStartPt.y+e.bezierFactorOne[n]*this.bezierStartControlPt.y+e.bezierFactorTwo[n]*this.bezierEndControlPt.y+e.tPow3[n]*this.bezierEndPt.y)}}]),e}();t.GraphicalCurve=r,r.bezierCurveStepSize=1e3},9428:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalInstantaneousDynamicExpression=void 0;var r=n(6791),a=n(3748),s=i(n(2043)),o=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,i,e,r.parentSourceMeasure)).mInstantaneousDynamicExpression=e,a.mMeasure=r,a}return y(n,[{key:"updateSkyBottomLine",value:function(){var e=this.parentStaffLine.SkyBottomLineCalculator,t=this.PositionAndShape.RelativePosition.x+this.PositionAndShape.BorderMarginLeft,n=this.PositionAndShape.RelativePosition.x+this.PositionAndShape.BorderMarginRight,i=0;switch(this.Placement){case a.PlacementEnum.Above:i=this.PositionAndShape.RelativePosition.y+this.PositionAndShape.BorderMarginTop,e.updateSkyLineInRange(t,n,i);break;case a.PlacementEnum.Below:i=this.PositionAndShape.RelativePosition.y+this.PositionAndShape.BorderMarginBottom,e.updateBottomLineInRange(t,n,i);break;default:s.default.error("Placement for GraphicalInstantaneousDynamicExpression is unknown")}}}]),n}(r.AbstractGraphicalExpression);t.GraphicalInstantaneousDynamicExpression=o},5277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalInstantaneousTempoExpression=void 0;var i=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this,i.PositionAndShape.Parent.DataObject,e,e.parentMeasure)).label=i,r}return y(n,[{key:"GraphicalLabel",get:function(){return this.label}},{key:"updateSkyBottomLine",value:function(){}}]),n}(n(6791).AbstractGraphicalExpression);t.GraphicalInstantaneousTempoExpression=i},9946:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalLabel=void 0;var i=n(1274),r=n(8911),a=n(4278),s=n(4040),o=function(e){h(n,e);var t=d(n);function n(e,i,a,s,o){var u;return g(this,n),(u=t.call(this)).label=e,u.boundingBox=new r.BoundingBox(c(u),o),u.label.fontHeight=i,u.label.textAlignment=a,u.rules=s,u.rules.MpatMode&&"TRIO"===u.label.text&&(u.label.fontFamily="Arial"),u}return y(n,[{key:"Label",get:function(){return this.label}},{key:"toString",value:function(){return"".concat(this.label.text," (").concat(this.boundingBox.RelativePosition.x,",").concat(this.boundingBox.RelativePosition.y,")")}},{key:"setLabelPositionAndShapeBorders",value:function(){var e,t;if(""!==this.Label.text.trim()){this.TextLines=[];for(var n=null!==(t=null===(e=this.rules)||void 0===e?void 0:e.LabelMarginBorderFactor)&&void 0!==t?t:.1,r=this.Label.text.split(/[\n\r]+/g),a=r.length,o=0,u=0;u<a;u++){var l=r[u].trim();if(l&&""!==l){var c=s.MusicSheetCalculator.TextMeasurer.computeTextWidthToHeightRatio(l,this.Label.font,this.Label.fontStyle,this.label.fontFamily),h=this.Label.fontHeight*c;o=Math.max(o,h),this.TextLines.push({text:l,xOffset:0,width:h})}}var d,f=b(this.TextLines);try{for(f.s();!(d=f.n()).done;){var p=d.value,m=0;switch(this.Label.textAlignment){case i.TextAlignmentEnum.RightBottom:case i.TextAlignmentEnum.RightCenter:case i.TextAlignmentEnum.RightTop:m=o-p.width;break;case i.TextAlignmentEnum.CenterBottom:case i.TextAlignmentEnum.CenterCenter:case i.TextAlignmentEnum.CenterTop:m=(o-p.width)/2}p.xOffset=m}}catch(y){f.e(y)}finally{f.f()}var v=this.Label.fontHeight*a;this.rules.SpacingBetweenTextLines>0&&this.TextLines.length>1&&(v+=this.rules.SpacingBetweenTextLines*a/10);var g=this.PositionAndShape;switch(this.Label.textAlignment){case i.TextAlignmentEnum.CenterBottom:g.BorderTop=-v,g.BorderLeft=-o/2,g.BorderBottom=0,g.BorderRight=o/2;break;case i.TextAlignmentEnum.CenterCenter:g.BorderTop=-v/2,g.BorderLeft=-o/2,g.BorderBottom=v/2,g.BorderRight=o/2;break;case i.TextAlignmentEnum.CenterTop:g.BorderTop=0,g.BorderLeft=-o/2,g.BorderBottom=v,g.BorderRight=o/2;break;case i.TextAlignmentEnum.LeftBottom:g.BorderTop=-v,g.BorderLeft=0,g.BorderBottom=0,g.BorderRight=o;break;case i.TextAlignmentEnum.LeftCenter:g.BorderTop=-v/2,g.BorderLeft=0,g.BorderBottom=v/2,g.BorderRight=o;break;case i.TextAlignmentEnum.LeftTop:g.BorderTop=0,g.BorderLeft=0,g.BorderBottom=v,g.BorderRight=o;break;case i.TextAlignmentEnum.RightBottom:g.BorderTop=-v,g.BorderLeft=-o,g.BorderBottom=0,g.BorderRight=0;break;case i.TextAlignmentEnum.RightCenter:g.BorderTop=-v/2,g.BorderLeft=-o,g.BorderBottom=v/2,g.BorderRight=0;break;case i.TextAlignmentEnum.RightTop:g.BorderTop=0,g.BorderLeft=-o,g.BorderBottom=v,g.BorderRight=0}g.BorderMarginTop=g.BorderTop-v*n,g.BorderMarginLeft=g.BorderLeft-v*n,g.BorderMarginBottom=g.BorderBottom+v*n,g.BorderMarginRight=g.BorderRight+v*n}}}]),n}(a.Clickable);t.GraphicalLabel=o},6729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalLine=void 0;var i=n(8155);t.GraphicalLine=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.OutlineAndFillStyleEnum.BaseWritingColor,s=arguments.length>4?arguments[4]:void 0;g(this,e),this.start=t,this.end=n,this.width=r,this.styleId=a,this.colorHex=s}return y(e,[{key:"Start",get:function(){return this.start},set:function(e){this.start=e}},{key:"End",get:function(){return this.end},set:function(e){this.end=e}},{key:"Width",get:function(){return this.width},set:function(e){this.width=e}}]),e}()},5091:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalLyricEntry=void 0;var i=n(9946),r=n(2255),a=n(9086),s=n(1274);t.GraphicalLyricEntry=function(){function e(t,n,o,u){g(this,e),this.lyricsEntry=t,this.graphicalStaffEntry=n;var l=n.parentMeasure.parentSourceMeasure.Rules.LyricsAlignmentStandard;t.Text.length>=4&&t.Parent.Notes[0].Length.Denominator>4&&s.TextAlignmentEnum.LeftBottom;var c=new r.Label(t.Text),h=this.graphicalStaffEntry.parentMeasure.parentSourceMeasure.Rules;this.graphicalLabel=new i.GraphicalLabel(c,o,l,h,n.PositionAndShape),this.graphicalLabel.Label.colorDefault=h.DefaultColorLyrics,this.graphicalLabel.PositionAndShape.RelativePosition=new a.PointF2D(0,u),l===s.TextAlignmentEnum.LeftBottom&&(this.graphicalLabel.PositionAndShape.RelativePosition.x-=1)}return y(e,[{key:"LyricsEntry",get:function(){return this.lyricsEntry}},{key:"ParentLyricWord",get:function(){return this.graphicalLyricWord},set:function(e){this.graphicalLyricWord=e}},{key:"GraphicalLabel",get:function(){return this.graphicalLabel},set:function(e){this.graphicalLabel=e}},{key:"StaffEntryParent",get:function(){return this.graphicalStaffEntry},set:function(e){this.graphicalStaffEntry=e}}]),e}()},8720:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalLyricWord=void 0,t.GraphicalLyricWord=function(){function e(t){g(this,e),this.graphicalLyricsEntries=[],this.lyricWord=t,this.initialize()}return y(e,[{key:"GetLyricWord",get:function(){return this.lyricWord}},{key:"GraphicalLyricsEntries",get:function(){return this.graphicalLyricsEntries},set:function(e){this.graphicalLyricsEntries=e}},{key:"isFilled",value:function(){for(var e=0;e<this.graphicalLyricsEntries.length;e++)if(!this.graphicalLyricsEntries[e])return!1;return!0}},{key:"initialize",value:function(){for(var e=0;e<this.lyricWord.Syllables.length;e++)this.graphicalLyricsEntries.push(void 0)}}]),e}()},7963:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalMarkedArea=void 0,t.GraphicalMarkedArea=function(){function e(t,n,i,r){g(this,e),this.systemRectangle=t,this.labelRectangle=n,this.label=i,this.settings=r}return e}()},1513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalMeasure=void 0;var i=n(4785),r=n(1797),a=n(8911),s=n(9086),o=function(e){h(n,e);var t=d(n);function n(e,i,r){var s;return g(this,n),(s=t.call(this)).hasOnlyRests=!1,s.measureNumber=-1,s.ShowTimeSignature=!0,s.parentStaff=e,s.parentSourceMeasure=i,s.parentStaffLine=r,r?(s.parentStaff=r.ParentStaff,s.PositionAndShape=new a.BoundingBox(c(s),r.PositionAndShape)):s.PositionAndShape=new a.BoundingBox(c(s)),s.PositionAndShape.BorderBottom=4,s.parentSourceMeasure&&(s.measureNumber=s.parentSourceMeasure.MeasureNumber),s.staffEntries=[],s}return y(n,[{key:"ParentStaff",get:function(){return this.parentStaff}},{key:"ParentMusicSystem",get:function(){return this.parentMusicSystem},set:function(e){this.parentMusicSystem=e}},{key:"MeasureNumber",get:function(){return this.measureNumber}},{key:"FirstInstructionStaffEntry",get:function(){return this.firstInstructionStaffEntry},set:function(e){this.firstInstructionStaffEntry=e}},{key:"LastInstructionStaffEntry",get:function(){return this.lastInstructionStaffEntry},set:function(e){this.lastInstructionStaffEntry=e}},{key:"ParentStaffLine",get:function(){return this.parentStaffLine},set:function(e){this.parentStaffLine=e,this.parentStaffLine&&(this.PositionAndShape.Parent=this.parentStaffLine.PositionAndShape)}},{key:"resetLayout",value:function(){throw new Error("not implemented")}},{key:"getLineWidth",value:function(e){throw new Error("not implemented")}},{key:"addClefAtBegin",value:function(e){throw new Error("not implemented")}},{key:"addKeyAtBegin",value:function(e,t,n){throw new Error("not implemented")}},{key:"addRhythmAtBegin",value:function(e){throw new Error("not implemented")}},{key:"addClefAtEnd",value:function(e){throw new Error("not implemented")}},{key:"setPositionInStaffline",value:function(e){this.PositionAndShape.RelativePosition=new s.PointF2D(e,0)}},{key:"setWidth",value:function(e){this.PositionAndShape.BorderRight=e}},{key:"layoutSymbols",value:function(){throw new Error("not implemented")}},{key:"findGraphicalStaffEntryFromTimestamp",value:function(e){for(var t,n=0,i=this.staffEntries.length;n<i;++n){var r=this.staffEntries[n];if(null===(t=r.relInMeasureTimestamp)||void 0===t?void 0:t.Equals(e))return r}}},{key:"findGraphicalStaffEntryFromVerticalContainerTimestamp",value:function(e){for(var t=0,n=this.staffEntries.length;t<n;++t){var i=this.staffEntries[t];if(i.sourceStaffEntry.VerticalContainerParent.getAbsoluteTimestamp().Equals(e))return i}}},{key:"hasSameDurationWithSourceMeasureParent",value:function(){for(var e=new r.Fraction(0,1),t=0,n=this.staffEntries.length;t<n;++t){var i=this.staffEntries[t];e.Add(i.findStaffEntryMinNoteLength())}return e.Equals(this.parentSourceMeasure.Duration)}},{key:"hasMultipleVoices",value:function(){if(0===this.staffEntries.length)return!1;for(var e=[],t=0,n=this.staffEntries.length;t<n;++t)for(var i=this.staffEntries[t],r=0,a=i.sourceStaffEntry.VoiceEntries.length;r<a;++r){var s=i.sourceStaffEntry.VoiceEntries[r];e.indexOf(s.ParentVoice)<0&&e.push(s.ParentVoice)}return e.length>1}},{key:"isVisible",value:function(){return this.ParentStaff.ParentInstrument.Visible}},{key:"getGraphicalMeasureDurationFromStaffEntries",value:function(){for(var e=new r.Fraction(0,1),t=[],n=0,i=this.staffEntries.length;n<i;++n)for(var a=this.staffEntries[n],s=0,o=a.sourceStaffEntry.VoiceEntries.length;s<o;++s){var u=a.sourceStaffEntry.VoiceEntries[s];t.indexOf(u.ParentVoice)<0&&t.push(u.ParentVoice)}for(var l=0,c=t.length;l<c;++l){var h,d=t[l],f=new r.Fraction(0,1),p=b(this.staffEntries);try{for(p.s();!(h=p.n()).done;){var m,v=h.value,g=b(v.graphicalVoiceEntries);try{for(g.s();!(m=g.n()).done;){var y=m.value;y.parentVoiceEntry.ParentVoice===d&&y.notes.length>0&&f.Add(y.notes[0].graphicalNoteLength)}}catch(S){g.e(S)}finally{g.f()}}}catch(S){p.e(S)}finally{p.f()}e.lt(f)&&(e=r.Fraction.createFromFraction(f))}return e}},{key:"addGraphicalStaffEntry",value:function(e){this.staffEntries.push(e)}},{key:"addGraphicalStaffEntryAtTimestamp",value:function(e){if(e)if(0===this.staffEntries.length||this.staffEntries[this.staffEntries.length-1].relInMeasureTimestamp.lt(e.relInMeasureTimestamp))this.staffEntries.push(e);else for(var t=this.staffEntries.length-1;t>=0;t--){if(this.staffEntries[t].relInMeasureTimestamp.lt(e.relInMeasureTimestamp)){this.staffEntries.splice(t+1,0,e);break}0===t&&this.staffEntries.splice(t,0,e)}}},{key:"isPianoRightHand",value:function(){return this.isUpperStaffOfInstrument()}},{key:"isPianoLeftHand",value:function(){return this.isLowerStaffOfInstrument()}},{key:"isUpperStaffOfInstrument",value:function(){return 1===this.parentStaff.ParentInstrument.Staves.length||this.ParentStaff===this.parentStaff.ParentInstrument.Staves[0]}},{key:"isLowerStaffOfInstrument",value:function(){return 1!==this.parentStaff.ParentInstrument.Staves.length&&this.ParentStaff===this.ParentStaff.ParentInstrument.Staves.last()}},{key:"beginsWithLineRepetition",value:function(){var e=this.parentSourceMeasure;return!!e&&e.beginsWithLineRepetition()}},{key:"endsWithLineRepetition",value:function(){var e=this.parentSourceMeasure;return!!e&&e.endsWithLineRepetition()}},{key:"beginsWithWordRepetition",value:function(){var e=this.parentSourceMeasure;return!!e&&e.beginsWithWordRepetition()}},{key:"endsWithWordRepetition",value:function(){var e=this.parentSourceMeasure;return!!e&&e.endsWithWordRepetition()}},{key:"getTransposedHalftones",value:function(){return this.parentStaff.ParentInstrument.GetMusicSheet.Transpose+this.parentStaff.ParentInstrument.Transpose}}]),n}(i.GraphicalObject);t.GraphicalMeasure=o},599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PagePlacementEnum=t.GraphicalMusicPage=void 0;var i,r=n(8911),a=n(4785),s=n(9086),o=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).musicSystems=[],i.labels=[],i.parent=e,i.boundingBox=new r.BoundingBox(c(i),void 0),i}return y(n,[{key:"MusicSystems",get:function(){return this.musicSystems},set:function(e){this.musicSystems=e}},{key:"Labels",get:function(){return this.labels},set:function(e){this.labels=e}},{key:"Parent",get:function(){return this.parent},set:function(e){this.parent=e}},{key:"PageNumber",get:function(){return this.pageNumber},set:function(e){this.pageNumber=e}},{key:"setMusicPageAbsolutePosition",value:function(e,t){return new s.PointF2D(0,0)}}]),n}(a.GraphicalObject);t.GraphicalMusicPage=o,(i=t.PagePlacementEnum||(t.PagePlacementEnum={}))[i.Down=0]="Down",i[i.Right=1]="Right",i[i.RightDown=2]="RightDown"},4324:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemImageProperties=t.GraphicalMusicSheet=void 0;var r=n(525),a=n(6729),s=n(9086),o=n(289),u=n(5198),l=n(1797),c=n(8911),h=i(n(2043)),d=n(2337),f=n(4278),p=n(5974),m=n(4785);t.GraphicalMusicSheet=function(){function e(t,n){g(this,e),this.musicPages=[],this.measureList=[],this.verticalGraphicalStaffEntryContainers=[],this.cursors=[],this.leadSheet=!1,this.musicSheet=t,this.numberOfStaves=this.musicSheet.Staves.length,this.calculator=n,this.calculator.initialize(this)}return y(e,[{key:"ParentMusicSheet",get:function(){return this.musicSheet}},{key:"GetCalculator",get:function(){return this.calculator}},{key:"MusicPages",get:function(){return this.musicPages},set:function(e){this.musicPages=e}},{key:"MeasureList",get:function(){return this.measureList},set:function(e){this.measureList=e}},{key:"VerticalGraphicalStaffEntryContainers",get:function(){return this.verticalGraphicalStaffEntryContainers},set:function(e){this.verticalGraphicalStaffEntryContainers=e}},{key:"Title",get:function(){return this.title},set:function(e){this.title=e}},{key:"Subtitle",get:function(){return this.subtitle},set:function(e){this.subtitle=e}},{key:"Composer",get:function(){return this.composer},set:function(e){this.composer=e}},{key:"Lyricist",get:function(){return this.lyricist},set:function(e){this.lyricist=e}},{key:"Cursors",get:function(){return this.cursors}},{key:"SelectionStartSymbol",get:function(){return this.selectionStartSymbol}},{key:"SelectionEndSymbol",get:function(){return this.selectionEndSymbol}},{key:"MinAllowedSystemWidth",get:function(){return this.minAllowedSystemWidth},set:function(e){this.minAllowedSystemWidth=e}},{key:"NumberOfStaves",get:function(){return this.numberOfStaves}},{key:"LeadSheet",get:function(){return this.leadSheet},set:function(e){this.leadSheet=e}},{key:"Initialize",value:function(){this.verticalGraphicalStaffEntryContainers=[],this.musicPages=[],this.measureList=[]}},{key:"reCalculate",value:function(){this.calculator.calculate()}},{key:"EnforceRedrawOfMusicSystems",value:function(){for(var e=0,t=this.musicPages.length;e<t;++e)for(var n=this.musicPages[e],i=0,r=n.MusicSystems.length;i<r;++i)n.MusicSystems[i].needsToBeRedrawn=!0}},{key:"getClickedObject",value:function(e){for(var t=0,n=this.MusicPages.length;t<n;++t)return this.MusicPages[t].PositionAndShape.getClickedObjectOfType(e)}},{key:"findGraphicalMeasure",value:function(e,t){for(var n=e;n>=0;n--){var i=this.measureList[n][t];if(i)return i}}},{key:"findGraphicalStaffEntryFromMeasureList",value:function(e,t,n){for(var i=t;i<this.measureList.length;i++){var r=this.measureList[i][e];if(r)for(var a=0,s=r.staffEntries.length;a<s;++a){var o=r.staffEntries[a];if(o.sourceStaffEntry===n)return o}}}},{key:"findNextGraphicalStaffEntry",value:function(e,t,n){var i=n.parentMeasure,r=i.staffEntries.indexOf(n);if(r<i.staffEntries.length-1)return i.staffEntries[r+1];if(t<this.measureList.length-1){var a=this.measureList[t+1][e];if(a.staffEntries.length>0)return a.staffEntries[0]}}},{key:"getFirstVisibleMeasuresListFromIndices",value:function(e,t){for(var n=[],i=this.measureList[0].length,r=e;r<=t;r++)for(var a=0;a<i;a++)if(this.measureList[r][a].isVisible()){n.push(this.measureList[r][a]);break}return n}},{key:"orderMeasuresByStaffLine",value:function(e){var t=[],n=[];t.push(n);for(var i=0;i<e.length;i++)0===i?n.push(e[0]):(e[i].ParentStaffLine===e[i-1].ParentStaffLine||(-1===t.indexOf(n)&&t.push(n),n=[],t.push(n)),n.push(e[i]));return t}},{key:"initializeActiveClefs",value:function(){var e=[],t=this.musicSheet.getFirstSourceMeasure();if(t)for(var n=0;n<t.CompleteNumberOfStaves;n++){var i=new o.ClefInstruction;if(t.FirstInstructionsStaffEntries[n])for(var r=0,a=t.FirstInstructionsStaffEntries[n].Instructions.length;r<a;++r){var s=t.FirstInstructionsStaffEntries[n].Instructions[r];s instanceof o.ClefInstruction&&(i=s)}e.push(i)}return e}},{key:"GetMainKey",value:function(){var e=this.musicSheet.getFirstSourceMeasure();if(e)for(var t=0;t<e.CompleteNumberOfStaves;t++)for(var n=0,i=e.FirstInstructionsStaffEntries[t].Instructions.length;n<i;++n){var r=e.FirstInstructionsStaffEntries[t].Instructions[n];if(r instanceof u.KeyInstruction)return r}}},{key:"getOrCreateVerticalContainer",value:function(e){if(0===this.verticalGraphicalStaffEntryContainers.length||d.CollectionUtil.getLastElement(this.verticalGraphicalStaffEntryContainers).AbsoluteTimestamp.lt(e)){var t=new r.VerticalGraphicalStaffEntryContainer(this.numberOfStaves,e);return this.verticalGraphicalStaffEntryContainers.push(t),t}for(var n=this.verticalGraphicalStaffEntryContainers.length-1;n>=0;n--){if(this.verticalGraphicalStaffEntryContainers[n].AbsoluteTimestamp.lt(e)){var i=new r.VerticalGraphicalStaffEntryContainer(this.numberOfStaves,e);return this.verticalGraphicalStaffEntryContainers.splice(n+1,0,i),i}if(this.verticalGraphicalStaffEntryContainers[n].AbsoluteTimestamp.Equals(e))return this.verticalGraphicalStaffEntryContainers[n]}}},{key:"GetVerticalContainerFromTimestamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=d.CollectionUtil.binarySearch(this.verticalGraphicalStaffEntryContainers,new r.VerticalGraphicalStaffEntryContainer(0,e),r.VerticalGraphicalStaffEntryContainer.compareByTimestamp,t);if(n>=0)return this.verticalGraphicalStaffEntryContainers[n]}},{key:"GetInterpolatedIndexInVerticalContainers",value:function(e){var t,n,i=this.verticalGraphicalStaffEntryContainers,r=0,a=i.length-1;if(e.lte(i[i.length-1].AbsoluteTimestamp)){for(;a-r>1;){var s=Math.floor((a+r)/2);if(i[r].AbsoluteTimestamp.Equals(e)){a=r;break}if(i[a].AbsoluteTimestamp.Equals(e)){r=a;break}if(i[s].AbsoluteTimestamp.Equals(e))return this.verticalGraphicalStaffEntryContainers.indexOf(i[s]);e.lt(i[s].AbsoluteTimestamp)?a=s:r=s}if(r===a)return this.verticalGraphicalStaffEntryContainers.indexOf(i[r]);t=i[r].AbsoluteTimestamp,n=i[a].AbsoluteTimestamp}else t=i[i.length-1].AbsoluteTimestamp,n=l.Fraction.plus(this.getLongestStaffEntryDuration(i.length-1),t),a=i.length;var o=n.RealValue-t.RealValue,u=a-(n.RealValue-e.RealValue)/o;return Math.min(u,this.verticalGraphicalStaffEntryContainers.length)}},{key:"getVisibleStavesIndicesFromSourceMeasure",value:function(e){for(var t=[],n=[],i=0,r=e.length;i<r;++i){var a=e[i].ParentStaff.ParentInstrument;-1===t.indexOf(a)&&t.push(a)}for(var s=0,o=t.length;s<o;++s)for(var u=t[s],l=this.musicSheet.getGlobalStaffIndexOfFirstStaff(u),c=0;c<u.Staves.length;c++)n.push(l+c);return n}},{key:"getGraphicalMeasureFromSourceMeasureAndIndex",value:function(e,t){for(var n,i=0;i<this.measureList.length;i++)if((null===(n=this.measureList[i][0])||void 0===n?void 0:n.parentSourceMeasure)===e)return this.measureList[i][t]}},{key:"getLastGraphicalMeasureFromIndex",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.measureList.length-1;return t&&(n=Math.min(n,this.musicSheet.Rules.MaxMeasureToDrawIndex)),this.measureList[n][e]}},{key:"getMeasureIndex",value:function(e,t,n){for(t=0;t<this.measureList.length;t++)for(var i=0,r=this.measureList[t].length;i<r;++i)if(this.measureList[t][i]===e)return!0;return!1}},{key:"GetNearestGraphicalObject",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.GraphicalObject.name,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,o=arguments.length>5?arguments[5]:void 0,u=[];0===u.length&&i<=r;){var l=new c.BoundingBox(void 0);l.BorderLeft=e.x-i,l.BorderTop=e.y-i,l.BorderRight=e.x+i,l.BorderBottom=e.y+i,l.AbsolutePosition=new s.PointF2D(e.x,e.y),l.calculateAbsolutePosition();for(var h=0,d=this.MusicPages.length;h<d;++h){var f=this.MusicPages[h].PositionAndShape.getObjectsInRegion(l,!1,n);if(f&&0!==f.length)for(var p=0,v=f.length;p<v;++p)o?o(f[p])&&u.push(f[p]):u.push(f[p])}i+=a}for(var g=0,y=u.length;g<y;++g){var b=u[g];(void 0===t||this.CalculateDistance(b.PositionAndShape.AbsolutePosition,e)<this.CalculateDistance(t.PositionAndShape.AbsolutePosition,e))&&(t=b)}if(t)return t}},{key:"GetNearestVoiceEntry",value:function(e){return this.GetNearestGraphicalObject(e,p.GraphicalVoiceEntry.name,5,20,5,(function(e){var t;return void 0!==(null===(t=e.parentStaffEntry)||void 0===t?void 0:t.relInMeasureTimestamp)}))}},{key:"GetNearestNote",value:function(e,t){var n=this.GetNearestVoiceEntry(e);if(n){var i,r,a=Number.MAX_SAFE_INTEGER,s=b(n.notes);try{for(s.s();!(r=s.n()).done;){var o=r.value,u=o.PositionAndShape.AbsolutePosition.y,l=Math.abs(o.PositionAndShape.AbsolutePosition.x-e.x),c=Math.abs(u-e.y);l+c<a&&(i=o,a=l+c)}}catch(h){s.e(h)}finally{s.f()}return i}}},{key:"domToSvg",value:function(e){return this.domToSvgTransform(e,!0)}},{key:"svgToDom",value:function(e){return this.domToSvgTransform(e,!1)}},{key:"svgToOsmd",value:function(e){var t=new s.PointF2D(e.x,e.y);return t.x/=10,t.y/=10,t}},{key:"domToSvgTransform",value:function(e,t){var n=this.drawer.Backends[0].getSvgElement(),i=n.createSVGPoint();i.x=e.x,i.y=e.y;var r=n.getScreenCTM();t&&(r=r.inverse());var a=i.matrixTransform(r);return new s.PointF2D(a.x,a.y)}},{key:"GetClickableLabel",value:function(e){var t=new c.BoundingBox;t.BorderLeft=e.x-4,t.BorderTop=e.y-4,t.BorderRight=e.x+4,t.BorderBottom=e.y+4,t.AbsolutePosition=new s.PointF2D(0,0);for(var n=0,i=this.MusicPages.length;n<i;++n){var r=this.MusicPages[n].PositionAndShape.getObjectsInRegion(t);if(1===r.length)for(var a=0,o=r.length;a<o;++a)return r[a]}}},{key:"GetPossibleCommentAnchor",value:function(e){var t=this.GetNearestVoiceEntry(e);if(t)return t.parentStaffEntry.sourceStaffEntry}},{key:"GetClickedObjectOfType",value:function(e){for(var t=0,n=this.musicPages.length;t<n;++t){var i=this.musicPages[t].PositionAndShape.getClickedObjectOfType(e);if(i)return i}}},{key:"GetClickedClickable",value:function(e){for(var t=0,n=this.musicPages.length;t<n;++t){var i=this.musicPages[t].PositionAndShape.getClickedClickable(e);if(i&&i instanceof f.Clickable)return i}}},{key:"tryGetTimestampFromPosition",value:function(e){var t=this.GetClickedObjectOfType(e);if(t)return t.getAbsoluteTimestamp()}},{key:"tryGetClickableLabel",value:function(e){try{return this.GetClickableLabel(e)}catch(t){h.default.info("GraphicalMusicSheet.tryGetClickableObject","positionOnMusicSheet: "+e,t)}}},{key:"tryGetTimeStampFromPosition",value:function(e){try{var n=this.GetNearestVoiceEntry(e);if(!n)return;return n.parentStaffEntry.getAbsoluteTimestamp()}catch(t){h.default.info("GraphicalMusicSheet.tryGetTimeStampFromPosition","positionOnMusicSheet: "+e,t)}}},{key:"getStaffEntry",value:function(e){var t,n=this.VerticalGraphicalStaffEntryContainers[e];try{for(var i=0,r=n.StaffEntries.length;i<r;++i){var a=n.StaffEntries[i];a&&a.sourceStaffEntry.ParentStaff.ParentInstrument.Visible&&(t?a.PositionAndShape&&t.PositionAndShape&&t.PositionAndShape.RelativePosition.x>a.PositionAndShape.RelativePosition.x&&(t=a):t=a)}}catch(e){h.default.info("GraphicalMusicSheet.getStaffEntry",e)}return t}},{key:"GetPreviousVisibleContainerIndex",value:function(e){for(var t=e-1;t>=0;t--)for(var n=this.verticalGraphicalStaffEntryContainers[t].StaffEntries,i=0,r=n.length;i<r;++i){var a=n[i];if(a&&a.sourceStaffEntry.ParentStaff.ParentInstrument.Visible)return t}return-1}},{key:"GetNextVisibleContainerIndex",value:function(e){for(var t=e+1;t<this.verticalGraphicalStaffEntryContainers.length;++t)for(var n=this.verticalGraphicalStaffEntryContainers[t].StaffEntries,i=0,r=n.length;i<r;++i){var a=n[i];if(a&&a.sourceStaffEntry.ParentStaff.ParentInstrument.Visible)return t}return-1}},{key:"findClosestLeftStaffEntry",value:function(e,t){for(var n,i=Math.floor(e),r=i=Math.min(this.VerticalGraphicalStaffEntryContainers.length-1,i);r>=0;r--)if(n=this.getStaffEntry(r)){if(!t)return n;if(n.sourceStaffEntry.ParentStaff.ParentInstrument.Visible)return n}}},{key:"findClosestRightStaffEntry",value:function(e,t){for(var n,i=Math.max(0,Math.ceil(e));i<this.VerticalGraphicalStaffEntryContainers.length;i++)if(n=this.getStaffEntry(i)){if(!t)return n;if(n.sourceStaffEntry.ParentStaff.ParentInstrument.Visible)return n}}},{key:"calculateCursorLineAtTimestamp",value:function(e,t){var n=this.calculateXPositionFromTimestamp(e),i=n[0],r=n[1];if(r&&0!==r.StaffLines.length){var o=r.PositionAndShape.AbsolutePosition.y,u=d.CollectionUtil.last(r.StaffLines).PositionAndShape.RelativePosition.y+4;return new a.GraphicalLine(new s.PointF2D(i,o),new s.PointF2D(i,o+u),3,t)}}},{key:"calculateXPositionFromTimestamp",value:function(e){var t,n,i,r,a,s,o,u,c=this.GetInterpolatedIndexInVerticalContainers(e),h=this.findClosestLeftStaffEntry(c,!0),d=this.findClosestRightStaffEntry(c,!0),f=e.RealValue;if(!h&&!d)return[0,void 0,void 0];if((s=h?null===(t=h.parentMeasure.ParentStaffLine)||void 0===t?void 0:t.ParentMusicSystem:null===(n=d.parentMeasure.ParentStaffLine)||void 0===n?void 0:n.ParentMusicSystem)===(o=d?null===(i=d.parentMeasure.ParentStaffLine)||void 0===i?void 0:i.ParentMusicSystem:null===(r=h.parentMeasure.ParentStaffLine)||void 0===r?void 0:r.ParentMusicSystem)){var p,m,v;a=s,h?d?(m=h.PositionAndShape.AbsolutePosition.x,v=d.PositionAndShape.AbsolutePosition.x,u=h.parentMeasure.parentSourceMeasure,p=h===d?0:(f-h.getAbsoluteTimestamp().RealValue)/(d.getAbsoluteTimestamp().RealValue-h.getAbsoluteTimestamp().RealValue)):(m=h.PositionAndShape.AbsolutePosition.x,v=a.GetRightBorderAbsoluteXPosition(),u=h.parentMeasure.parentSourceMeasure,p=(f-h.getAbsoluteTimestamp().RealValue)/(l.Fraction.plus(u.AbsoluteTimestamp,u.Duration).RealValue-h.getAbsoluteTimestamp().RealValue)):(m=v=d.PositionAndShape.AbsolutePosition.x,p=0),p=Math.min(1,Math.max(0,p));var g=v;return(null==u?void 0:u.Rules.LimitCursorPositionToCurrentMeasure)&&(g=Math.min(h.parentMeasure.PositionAndShape.AbsolutePosition.x+h.parentMeasure.PositionAndShape.BorderRight,g)),[m+p*(g-m),a,h]}var y,b,S=d.parentMeasure.parentSourceMeasure.AbsoluteTimestamp.RealValue;if(f<S){a=s;var x=h.PositionAndShape.AbsolutePosition.x,_=a.GetRightBorderAbsoluteXPosition();y=(f-h.getAbsoluteTimestamp().RealValue)/(S-h.getAbsoluteTimestamp().RealValue),b=x+(y=Math.min(1,Math.max(0,y)))*(_-x)}else{a=o;var E=d.PositionAndShape.AbsolutePosition.x,k=a.GetLeftBorderAbsoluteXPosition();y=(f-S)/(d.getAbsoluteTimestamp().RealValue-S),b=k+(y=Math.min(1,Math.max(0,y)))*(E-k)}return[b,a,h]}},{key:"calculateCursorPoints",value:function(e,t){if(void 0===t||0===t.StaffLines.length)return[new s.PointF2D,new s.PointF2D];var n=t.PositionAndShape.AbsolutePosition.y,i=t.StaffLines.last(),r=i.PositionAndShape.RelativePosition.y+i.StaffHeight;return[new s.PointF2D(e,n),new s.PointF2D(e,n+r)]}},{key:"GetNumberOfVisibleInstruments",value:function(){for(var e=0,t=0,n=this.musicSheet.Instruments.length;t<n;++t)!0===this.musicSheet.Instruments[t].Visible&&e++;return e}},{key:"GetNumberOfFollowedInstruments",value:function(){for(var e=0,t=0,n=this.musicSheet.Instruments.length;t<n;++t)!0===this.musicSheet.Instruments[t].Following&&e++;return e}},{key:"GetGraphicalFromSourceStaffEntry",value:function(e){var t;if(null===(t=e.VerticalContainerParent.ParentMeasure)||void 0===t?void 0:t.VerticalMeasureList){var n=e.VerticalContainerParent.ParentMeasure.VerticalMeasureList[e.ParentStaff.idInMusicSheet];return null==n?void 0:n.findGraphicalStaffEntryFromTimestamp(e.Timestamp)}}},{key:"CalculateDistance",value:function(e,t){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}},{key:"getLongestStaffEntryDuration",value:function(e){var t,n=new l.Fraction(0,1),i=b(this.verticalGraphicalStaffEntryContainers[e].StaffEntries);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r){var a=r.findStaffEntryMaxNoteLength();n.lt(a)&&(n=a)}}}catch(s){i.e(s)}finally{i.f()}return n}}],[{key:"transformRelativeToAbsolutePosition",value:function(e){for(var t=0;t<e.MusicPages.length;t++){var n=e.MusicPages[t].setMusicPageAbsolutePosition(t,e.ParentMusicSheet.Rules);e.MusicPages[t].PositionAndShape.calculateAbsolutePositionsRecursive(n.x,n.y)}}}]),e}(),t.SystemImageProperties=function(){function e(){g(this,e)}return e}()},3486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalNote=void 0;var i=n(8640),r=n(4785),a=n(4040),s=n(8911),o=function(e){h(n,e);var t=d(n);function n(e,r,a,o){var u;return g(this,n),(u=t.call(this)).DrawnAccidental=i.AccidentalEnum.NONE,u.lineShift=0,u.sourceNote=e,u.parentVoiceEntry=r,u.PositionAndShape=new s.BoundingBox(c(u),r.PositionAndShape),u.graphicalNoteLength=o||e.Length,u.numberOfDots=u.calculateNumberOfNeededDots(u.graphicalNoteLength),u.rules=a,u.rules.addGraphicalNoteToNoteMap(e,c(u)),u}return y(n,[{key:"Transpose",value:function(e,t,n,i){var r=this.sourceNote.Pitch;return a.MusicSheetCalculator.transposeCalculator&&(r=a.MusicSheetCalculator.transposeCalculator.transposePitch(this.sourceNote.Pitch,e,n)),r}},{key:"calculateNumberOfNeededDots",value:function(e){return this.sourceNote&&this.sourceNote.NoteTuplet?0:e.calculateNumberOfNeededDots()}},{key:"ParentMusicPage",get:function(){return this.parentVoiceEntry.parentStaffEntry.parentMeasure.ParentMusicSystem.Parent}}],[{key:"FromNote",value:function(e,t){return t.NoteToGraphicalNoteMap.getValue(e.NoteToGraphicalNoteObjectId)}}]),n}(r.GraphicalObject);t.GraphicalNote=o},4785:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalObject=void 0;var i=function(e){h(n,e);var t=d(n);function n(){return g(this,n),t.apply(this,arguments)}return y(n,[{key:"PositionAndShape",get:function(){return this.boundingBox},set:function(e){this.boundingBox=e}}]),n}(n(9733).AClassHierarchyTrackable);t.GraphicalObject=i},873:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalOctaveShift=void 0;var i=n(4785),r=n(5853),a=n(8911),s=n(158),o=n(1703),u=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this)).getOctaveShift=e,r.setSymbol(),r.PositionAndShape=new a.BoundingBox(c(r),i),r}return y(n,[{key:"setSymbol",value:function(){switch(this.getOctaveShift.Type){case r.OctaveEnum.VA8:this.octaveSymbol=s.MusicSymbol.VA8;break;case r.OctaveEnum.VB8:this.octaveSymbol=s.MusicSymbol.VB8;break;case r.OctaveEnum.MA15:this.octaveSymbol=s.MusicSymbol.MA15;break;case r.OctaveEnum.MB15:this.octaveSymbol=s.MusicSymbol.MB15;break;default:throw new o.ArgumentOutOfRangeException("")}}}]),n}(i.GraphicalObject);t.GraphicalOctaveShift=u},4082:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalPedal=void 0;var i=n(4785),r=n(8911),a=n(158),s=function(e){h(n,e);var t=d(n);function n(e,i){var a;return g(this,n),(a=t.call(this)).getPedal=e,a.setSymbol(),a.PositionAndShape=new r.BoundingBox(c(a),i),a}return y(n,[{key:"setSymbol",value:function(){!this.getPedal.IsLine&&this.getPedal.IsSign?this.pedalSymbol=a.MusicSymbol.PEDAL_SYMBOL:this.getPedal.IsLine&&this.getPedal.IsSign?this.pedalSymbol=a.MusicSymbol.PEDAL_MIXED:this.pedalSymbol=a.MusicSymbol.PEDAL_BRACKET}}]),n}(i.GraphicalObject);t.GraphicalPedal=s},3411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalRectangle=void 0;var i=n(8911),r=function(e){h(n,e);var t=d(n);function n(e,r,a,s){var o;return g(this,n),(o=t.call(this)).boundingBox=new i.BoundingBox(a),o.boundingBox.RelativePosition=e,o.boundingBox.BorderRight=r.x-e.x,o.boundingBox.BorderBottom=r.y-e.y,o.style=s,o}return n}(n(4785).GraphicalObject);t.GraphicalRectangle=r},9876:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalSlur=void 0;var r=n(9086),a=n(5330),s=n(3748),o=n(8363),u=n(2947),l=n(1797),c=n(908),f=i(n(6368)).default.Flow,p=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this)).staffEntries=[],r.slur=e,r.rules=i,r}return y(n,[{key:"calculateCurve",value:function(e){var t=this.staffEntries[0],n=this.staffEntries[this.staffEntries.length-1],i=t.findGraphicalNoteFromNote(this.slur.StartNote);!i&&this.graceStart&&(i=t.findGraphicalNoteFromGraceNote(this.slur.StartNote)),i||(i=t.findEndTieGraphicalNoteFromNoteWithStartingSlur(this.slur.StartNote,this.slur));var a=n.findGraphicalNoteFromNote(this.slur.EndNote);!a&&this.graceEnd&&(a=n.findGraphicalNoteFromGraceNote(this.slur.EndNote));var u=t.parentMeasure.ParentStaffLine,l=u.SkyBottomLineCalculator;this.calculatePlacement(l,u);var c,h=this.calculateStartAndEnd(i,a,u,e,l),d=h.startX,f=h.endX,p=h.startY,m=h.endY,v=e.SlurTangentMinAngle,g=e.SlurTangentMaxAngle;if(this.placement===s.PlacementEnum.Above){p-=e.SlurNoteHeadYOffset,m-=e.SlurNoteHeadYOffset;var y=new r.PointF2D(this.staffEntries[0].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[0].PositionAndShape.RelativePosition.x,p);i?y.x+=this.staffEntries[0].PositionAndShape.BorderRight:y.x=this.staffEntries[0].parentMeasure.beginInstructionsWidth,this.graceStart&&(y.x+=n.PositionAndShape.RelativePosition.x);var b=new r.PointF2D(this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[this.staffEntries.length-1].PositionAndShape.RelativePosition.x,m);if(a?b.x+=this.staffEntries[this.staffEntries.length-1].PositionAndShape.BorderLeft:b.x=this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.Size.width,this.graceEnd&&(b.x+=n.staffEntryParent.PositionAndShape.RelativePosition.x),0===(c=this.calculateTopPoints(y,b,u,l)).length){var S=new r.PointF2D((b.x-y.x)/2+y.x,(b.y-y.y)/2+y.y);c.push(S)}var x=Math.atan((m-p)/(f-d)),_=new r.PointF2D(0,0),E=new r.PointF2D(f-d,-(m-p)),k=o.Matrix2D.getRotationMatrix(x),M=k.getTransposeMatrix();E=k.vectorMultiplication(E);var w=this.calculateTranslatedAndRotatedPointListAbove(c,d,p,k),P=this.calculateMaxLeftSlope(w,_,E),T=this.calculateMaxRightSlope(w,_,E),C=_.y-_.x*P,I=E.y-E.x*T,A=new r.PointF2D,L=!1;Math.abs(Math.abs(P)-Math.abs(T))<1e-4?(A.x=E.x/2,A.y=0,L=!0):(A.x=(I-C)/(P-T),A.y=P*A.x+C);var O=this.calculateHeightWidthRatio(E.x,w),R=0,N=0,B=v,D=-v;if(!L){var F=this.calculateAngles(v,P,T,g);B=F.startAngle,D=F.endAngle}var j=this.calculateControlPoints(E.x,B,D,w,O,p,m),V=j.startControlPoint,G=j.endControlPoint;(V=M.vectorMultiplication(V)).x+=d,V.y=-V.y+p,(G=M.vectorMultiplication(G)).x+=d,G.y=-G.y+p,this.bezierStartPt=new r.PointF2D(d,p-R),this.bezierStartControlPt=new r.PointF2D(V.x,V.y-R),this.bezierEndControlPt=new r.PointF2D(G.x,G.y-N),this.bezierEndPt=new r.PointF2D(f,m-N);for(var W=u.SkyLine.length,U=l.getLeftIndexForPointX(this.bezierStartPt.x,W),z=l.getLeftIndexForPointX(this.bezierEndPt.x,W),H=this.bezierEndPt.x-this.bezierStartPt.x,X=l.SamplingUnit,Y=U;Y<z;Y++){var K=Y/X-this.bezierStartPt.x,q=this.calculateCurvePointAtIndex(Math.abs(K)/H),Z=l.getLeftIndexForPointX(q.x,W);Z>=U&&(u.SkyLine[Z]=Math.min(u.SkyLine[Z],q.y)),++Z<W&&(u.SkyLine[Z]=Math.min(u.SkyLine[Z],q.y))}}else{p+=e.SlurNoteHeadYOffset,m+=e.SlurNoteHeadYOffset;var J=new r.PointF2D(this.staffEntries[0].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[0].PositionAndShape.RelativePosition.x,p);i?J.x+=this.staffEntries[0].PositionAndShape.BorderRight:J.x=this.staffEntries[0].parentMeasure.beginInstructionsWidth,this.graceStart&&(J.x+=n.PositionAndShape.RelativePosition.x);var Q=new r.PointF2D(this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[this.staffEntries.length-1].PositionAndShape.RelativePosition.x,m);if(a?Q.x+=this.staffEntries[this.staffEntries.length-1].PositionAndShape.BorderLeft:Q.x=this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.RelativePosition.x+this.staffEntries[this.staffEntries.length-1].parentMeasure.PositionAndShape.Size.width,this.graceEnd&&(Q.x+=n.staffEntryParent.PositionAndShape.RelativePosition.x),0===(c=this.calculateBottomPoints(J,Q,u,l)).length){var $=new r.PointF2D((Q.x-J.x)/2+J.x,(Q.y-J.y)/2+J.y);c.push($)}var ee=Math.atan((m-p)/(f-d)),te=new r.PointF2D(0,0),ne=new r.PointF2D(f-d,m-p),ie=o.Matrix2D.getRotationMatrix(-ee),re=ie.getTransposeMatrix();ne=ie.vectorMultiplication(ne);var ae=this.calculateTranslatedAndRotatedPointListBelow(c,d,p,ie),se=this.calculateMaxLeftSlope(ae,te,ne),oe=this.calculateMaxRightSlope(ae,te,ne),ue=te.y-te.x*se,le=ne.y-ne.x*oe,ce=new r.PointF2D,he=!1;Math.abs(Math.abs(se)-Math.abs(oe))<1e-4?(ce.x=ne.x/2,ce.y=0,he=!0):(ce.x=(le-ue)/(se-oe),ce.y=se*ce.x+ue);var de=this.calculateHeightWidthRatio(ne.x,ae),fe=0,pe=0,me=v,ve=-v;if(!he){var ge=this.calculateAngles(v,se,oe,g);me=ge.startAngle,ve=ge.endAngle}var ye=this.calculateControlPoints(ne.x,me,ve,ae,de,p,m),be=ye.startControlPoint,Se=ye.endControlPoint;(be=re.vectorMultiplication(be)).x+=d,be.y+=p,(Se=re.vectorMultiplication(Se)).x+=d,Se.y+=p,this.bezierStartPt=new r.PointF2D(d,p+fe),this.bezierStartControlPt=new r.PointF2D(be.x,be.y+fe),this.bezierEndControlPt=new r.PointF2D(Se.x,Se.y+pe),this.bezierEndPt=new r.PointF2D(f,m+pe);for(var xe=u.BottomLine.length,_e=l.getLeftIndexForPointX(this.bezierStartPt.x,xe),Ee=l.getLeftIndexForPointX(this.bezierEndPt.x,xe),ke=this.bezierEndPt.x-this.bezierStartPt.x,Me=l.SamplingUnit,we=_e;we<Ee;we++){var Pe=we/Me-this.bezierStartPt.x,Te=this.calculateCurvePointAtIndex(Math.abs(Pe)/ke),Ce=l.getLeftIndexForPointX(Te.x,xe);Ce>=_e&&(u.BottomLine[Ce]=Math.max(u.BottomLine[Ce],Te.y)),++Ce<xe&&(u.BottomLine[Ce]=Math.max(u.BottomLine[Ce],Te.y))}}}},{key:"calculateStartAndEnd",value:function(e,t,n,i,r){var a=0,o=0,u=0,l=0;if(e){a=e.PositionAndShape.RelativePosition.x+e.parentVoiceEntry.parentStaffEntry.PositionAndShape.RelativePosition.x+e.parentVoiceEntry.parentStaffEntry.parentMeasure.PositionAndShape.RelativePosition.x,this.graceStart&&(a+=e.parentVoiceEntry.parentStaffEntry.staffEntryParent.PositionAndShape.RelativePosition.x);var h=e.parentVoiceEntry;o=this.placement===s.PlacementEnum.Above?h.PositionAndShape.RelativePosition.y+h.PositionAndShape.BorderTop:h.PositionAndShape.RelativePosition.y+h.PositionAndShape.BorderBottom,h.parentVoiceEntry.StemDirection===c.StemDirectionType.Down&&this.placement===s.PlacementEnum.Below&&(a-=.5),h.parentVoiceEntry.StemDirection===c.StemDirectionType.Up&&this.placement===s.PlacementEnum.Above&&(a+=.5)}else a=0;if(t){u=t.PositionAndShape.RelativePosition.x+t.parentVoiceEntry.parentStaffEntry.PositionAndShape.RelativePosition.x+t.parentVoiceEntry.parentStaffEntry.parentMeasure.PositionAndShape.RelativePosition.x,this.graceEnd&&(u+=t.parentVoiceEntry.parentStaffEntry.staffEntryParent.PositionAndShape.RelativePosition.x);var d,p,m=t.parentVoiceEntry,v=b(m.parentVoiceEntry.Articulations);try{for(v.s();!(p=v.n()).done;){var g=p.value;if(g.placement===s.PlacementEnum.NotYetDefined){var y,S=b(t.vfnote[0].modifiers);try{for(S.s();!(y=S.n()).done;){var x=y.value;if(x.getCategory()===f.Articulation.CATEGORY){x.position===f.Modifier.Position.ABOVE?(g.placement=s.PlacementEnum.Above,d=s.PlacementEnum.Above):x.position===f.Modifier.Position.BELOW&&(g.placement=s.PlacementEnum.Below,d=s.PlacementEnum.Below);break}}}catch(_){S.e(_)}finally{S.f()}}}}catch(_){v.e(_)}finally{v.f()}this.placement===s.PlacementEnum.Above?(l=m.PositionAndShape.RelativePosition.y+m.PositionAndShape.BorderTop,d===s.PlacementEnum.Above&&(l-=this.rules.SlurEndArticulationYOffset)):(l=m.PositionAndShape.RelativePosition.y+m.PositionAndShape.BorderBottom,d===s.PlacementEnum.Below&&(l+=this.rules.SlurEndArticulationYOffset)),m.parentVoiceEntry.StemDirection===c.StemDirectionType.Down&&this.placement===s.PlacementEnum.Below&&(u-=.5),m.parentVoiceEntry.StemDirection===c.StemDirectionType.Up&&this.placement===s.PlacementEnum.Above&&(u+=.5)}else u=n.PositionAndShape.Size.width;return e||t||(o=-1.5,l=-1.5),e||(o=this.placement===s.PlacementEnum.Above?l-1:l+1),t||(l=this.placement===s.PlacementEnum.Above?o-1:o+1),this.slur.startNoteHasMoreStartingSlurs()&&this.slur.isSlurLonger()&&(this.placement===s.PlacementEnum.Above?o-=i.SlursStartingAtSameStaffEntryYOffset:o+=i.SlursStartingAtSameStaffEntryYOffset),this.slur.endNoteHasMoreEndingSlurs()&&this.slur.isSlurLonger()&&(this.placement===s.PlacementEnum.Above?l-=i.SlursStartingAtSameStaffEntryYOffset:l+=i.SlursStartingAtSameStaffEntryYOffset),this.placement===s.PlacementEnum.Above?(o=Math.min(o,1.5),l=Math.min(l,1.5)):(o=Math.max(o,n.StaffHeight-1.5),l=Math.max(l,n.StaffHeight-1.5)),{startX:a,startY:o,endX:u,endY:l}}},{key:"calculatePlacement",value:function(e,t){if(this.rules.SlurPlacementFromXML)this.placement=this.slur.PlacementXml;else{for(var n=0,i=this.staffEntries.length;n<i;++n)if(this.staffEntries[n].parentMeasure.hasMultipleVoices())return void(this.slur.StartNote.ParentVoiceEntry.ParentVoice instanceof u.LinkedVoice||this.slur.EndNote.ParentVoiceEntry.ParentVoice instanceof u.LinkedVoice?this.placement=s.PlacementEnum.Below:this.placement=s.PlacementEnum.Above);for(var r=0,a=this.staffEntries.length;r<a;++r)if(this.staffEntries[r].LyricsEntries.length>0)return void(this.placement=s.PlacementEnum.Above);var o=this.staffEntries[0],l=this.staffEntries[this.staffEntries.length-1],h=o.graphicalVoiceEntries[0].parentVoiceEntry.StemDirection;if(h===l.graphicalVoiceEntries[0].parentVoiceEntry.StemDirection)this.placement=h===c.StemDirectionType.Up?s.PlacementEnum.Below:s.PlacementEnum.Above;else{var d=o.PositionAndShape.BorderLeft+o.PositionAndShape.RelativePosition.x+o.parentMeasure.PositionAndShape.RelativePosition.x,f=l.PositionAndShape.BorderRight+l.PositionAndShape.RelativePosition.x+l.parentMeasure.PositionAndShape.RelativePosition.x;this.graceStart&&(d+=l.PositionAndShape.RelativePosition.x),this.graceEnd&&(f+=l.staffEntryParent.PositionAndShape.RelativePosition.x);var p=-1*e.getSkyLineMinInRange(d,f),m=e.getBottomLineMaxInRange(d,f)-t.StaffHeight;this.placement=m>p?s.PlacementEnum.Above:s.PlacementEnum.Below}}}},{key:"calculateTopPoints",value:function(e,t,n,i){var a=[],s=i.getRightIndexForPointX(e.x,n.SkyLine.length),o=i.getLeftIndexForPointX(t.x,n.SkyLine.length);s<0&&(s=0),o>=n.SkyLine.length&&(o=n.SkyLine.length-1);for(var u=s;u<o;u++){var l=n.SkyLine[u];if(0!==l){var c=new r.PointF2D((.5+u)/i.SamplingUnit,l);a.push(c)}}return a}},{key:"calculateBottomPoints",value:function(e,t,n,i){var a=[],s=i.getRightIndexForPointX(e.x,n.BottomLine.length),o=i.getLeftIndexForPointX(t.x,n.BottomLine.length);s<0&&(s=0),o>=n.BottomLine.length&&(o=n.BottomLine.length-1);for(var u=s;u<o;u++){var l=n.BottomLine[u];if(0!==l){var c=new r.PointF2D((.5+u)/i.SamplingUnit,l);a.push(c)}}return a}},{key:"calculateMaxLeftSlope",value:function(e,t,n){for(var i=-Number.MAX_VALUE,r=t.x,a=t.y,s=0;s<e.length;s++)Math.abs(e[s].y-Number.MAX_VALUE)<1e-4||Math.abs(e[s].y- -Number.MAX_VALUE)<1e-4||(i=Math.max(i,(e[s].y-a)/(e[s].x-r)));return i=Math.max(i,Math.abs(n.y-a)/(n.x-r)),i=Math.min(i,5.6713)}},{key:"calculateMaxRightSlope",value:function(e,t,n){for(var i=Number.MAX_VALUE,r=n.x,a=n.y,s=0;s<e.length;s++)Math.abs(e[s].y-Number.MAX_VALUE)<1e-4||Math.abs(e[s].y- -Number.MAX_VALUE)<1e-4||(i=Math.min(i,(a-e[s].y)/(r-e[s].x)));return i=Math.min(i,(a-t.y)/(r-t.x)),i=Math.max(i,-5.6713)}},{key:"getPointListMaxY",value:function(e){for(var t=-Number.MAX_VALUE,n=0,i=e.length;n<i;++n){var r=e[n];Math.abs(r.y- -Number.MAX_VALUE)<1e-4||Math.abs(r.y-Number.MAX_VALUE)<1e-4||(t=Math.max(t,r.y))}return t}},{key:"calculateTranslatedAndRotatedPointListAbove",value:function(e,t,n,i){for(var a=[],s=0;s<e.length;s++)if(!(Math.abs(e[s].y-Number.MAX_VALUE)<1e-4||Math.abs(e[s].y- -Number.MAX_VALUE)<1e-4)){var o=new r.PointF2D(e[s].x-t,-(e[s].y-n));o=i.vectorMultiplication(o),a.push(o)}return a}},{key:"calculateTranslatedAndRotatedPointListBelow",value:function(e,t,n,i){for(var a=[],s=0;s<e.length;s++)if(!(Math.abs(e[s].y-Number.MAX_VALUE)<1e-4||Math.abs(e[s].y- -Number.MAX_VALUE)<1e-4)){var o=new r.PointF2D(e[s].x-t,e[s].y-n);o=i.vectorMultiplication(o),a.push(o)}return a}},{key:"calculateHeightWidthRatio",value:function(e,t){return 0===t.length?0:Math.max(0,this.getPointListMaxY(t))/e}},{key:"calculateControlPoints",value:function(e,t,i,a,s,o,u){var l=this.rules.SlurHeightFactor,c=1,h=this.rules.SlurHeightFlattenLongSlursCutoffAngle,d=this.rules.SlurHeightFlattenLongSlursCutoffWidth;t>h&&e>d&&(c+=e/70*this.rules.SlurHeightFlattenLongSlursFactorByWidth,l/=c*=1+t/30*this.rules.SlurHeightFlattenLongSlursFactorByAngle);var f=Math.min(.5,Math.max(.1,1.7*t/80*l*Math.pow(Math.max(s,.05),.4))),p=Math.min(.5,Math.max(.1,1.7*-i/80*l*Math.pow(Math.max(s,.05),.4))),m=new r.PointF2D;m.x=e*f*Math.cos(t*n.degreesToRadiansFactor),m.y=e*f*Math.sin(t*n.degreesToRadiansFactor);var v=new r.PointF2D;v.x=e-e*p*Math.cos(i*n.degreesToRadiansFactor),v.y=-e*p*Math.sin(i*n.degreesToRadiansFactor);for(var g=m.y-v.y;this.rules.SlurMaximumYControlPointDistance&&Math.abs(g)>this.rules.SlurMaximumYControlPointDistance;)g<0?(m.y+=1,v.y-=1):(m.y-=1,v.y+=1),g=m.y-v.y;return{startControlPoint:m,endControlPoint:v}}},{key:"calculateAngles",value:function(e,t,i,r){var a=Math.atan(t)/n.degreesToRadiansFactor;t>0?a+=20:a-=20;var s=Math.atan(i)/n.degreesToRadiansFactor;return i<0?s-=20:s+=20,{startAngle:Math.min(Math.max(e,a),r),endAngle:Math.max(Math.min(-e,s),-r)}}}],[{key:"Compare",value:function(e,t){if(e.staffEntries.length<1)return-1;if(t.staffEntries.length<1)return 1;var n=l.Fraction.minus(e.staffEntries[e.staffEntries.length-1].getAbsoluteTimestamp(),e.staffEntries[0].getAbsoluteTimestamp()),i=l.Fraction.minus(t.staffEntries[t.staffEntries.length-1].getAbsoluteTimestamp(),t.staffEntries[0].getAbsoluteTimestamp());return n.RealValue>i.RealValue?1:i.RealValue>n.RealValue?-1:0}}]),n}(a.GraphicalCurve);t.GraphicalSlur=p,p.degreesToRadiansFactor=Math.PI/180},3023:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalStaffEntry=void 0;var i=n(8911),r=n(1797),a=n(4785),s=n(2337),o=n(4040),u=function(e){h(n,e);var t=d(n);function n(e,r,a){var s;return g(this,n),(s=t.call(this)).graphicalChordContainers=[],s.tabStaffEntry=void 0,s.MaxAccidentals=0,s.graphicalInstructions=[],s.ties=[],s.graphicalTies=[],s.lyricsEntries=[],s.parentMeasure=e,s.graphicalVoiceEntries=[],s.sourceStaffEntry=r,a?(s.staffEntryParent=a,s.parentVerticalContainer=a.parentVerticalContainer,s.PositionAndShape=new i.BoundingBox(c(s),a.PositionAndShape)):s.PositionAndShape=new i.BoundingBox(c(s),e.PositionAndShape),r&&(s.relInMeasureTimestamp=r.Timestamp),s.FingeringEntries=[],s}return y(n,[{key:"GraphicalInstructions",get:function(){return this.graphicalInstructions}},{key:"GraphicalTies",get:function(){return this.graphicalTies}},{key:"LyricsEntries",get:function(){return this.lyricsEntries},set:function(e){this.lyricsEntries=e}},{key:"getAbsoluteTimestamp",value:function(){var e=this.parentMeasure.parentSourceMeasure.AbsoluteTimestamp.clone();return this.relInMeasureTimestamp&&e.Add(this.relInMeasureTimestamp),e}},{key:"findTieGraphicalNoteFromNote",value:function(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i,r=t.value,a=b(r.notes);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=s.sourceNote;if(!o.isRest()&&o.Pitch.FundamentalNote===e.Pitch.FundamentalNote&&o.Pitch.Octave===e.Pitch.Octave&&o.getAbsoluteTimestamp().Equals(e.getAbsoluteTimestamp()))return s}}catch(u){a.e(u)}finally{a.f()}}}catch(u){n.e(u)}finally{n.f()}}},{key:"findEndTieGraphicalNoteFromNoteWithStartingSlur",value:function(e,t){if(e){var n,i=b(this.graphicalVoiceEntries);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.parentVoiceEntry===e.ParentVoiceEntry){var a,s=b(r.notes);try{for(s.s();!(a=s.n()).done;){var o=a.value,u=o.sourceNote;if(u.NoteTie&&-1!==u.NoteSlurs.indexOf(t))return o}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}}}},{key:"findGraphicalNoteFromGraceNote",value:function(e){if(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.parentVoiceEntry===e.ParentVoiceEntry){var r,a=b(i.notes);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.sourceNote===e)return s}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){n.e(o)}finally{n.f()}}}},{key:"findGraphicalNoteFromNote",value:function(e){if(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.parentVoiceEntry===e.ParentVoiceEntry){var r,a=b(i.notes);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.sourceNote===e&&this.getAbsoluteTimestamp().Equals(e.getAbsoluteTimestamp()))return s}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){n.e(o)}finally{n.f()}}}},{key:"getGraphicalNoteDurationFromVoice",value:function(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.parentVoiceEntry.ParentVoice===e)return i.notes[0].graphicalNoteLength}}catch(a){n.e(a)}finally{n.f()}return new r.Fraction(0,1)}},{key:"findVoiceEntryGraphicalNotes",value:function(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.parentVoiceEntry===e)return i.notes}}catch(r){n.e(r)}finally{n.f()}}},{key:"isVoiceEntryPartOfLinkedVoiceEntry",value:function(e){if(this.sourceStaffEntry.Link)for(var t=0,n=this.sourceStaffEntry.Link.LinkStaffEntries.length;t<n;++t){var i=this.sourceStaffEntry.Link.LinkStaffEntries[t];if(-1!==i.VoiceEntries.indexOf(e)&&i!==this.sourceStaffEntry)return!0}return!1}},{key:"findStaffEntryMinNoteLength",value:function(){var e,t=new r.Fraction(Number.MAX_VALUE,1),n=b(this.graphicalVoiceEntries);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,s=b(a.notes);try{for(s.s();!(i=s.n()).done;){var o=i.value.graphicalNoteLength;o.lt(t)&&o.GetExpandedNumerator()>0&&(t=o)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){n.e(u)}finally{n.f()}return t}},{key:"findStaffEntryMaxNoteLength",value:function(){var e,t=new r.Fraction(0,1),n=b(this.graphicalVoiceEntries);try{for(n.s();!(e=n.n()).done;){var i,a=e.value,s=b(a.notes);try{for(s.s();!(i=s.n()).done;){var o=i.value.graphicalNoteLength;t.lt(o)&&o.GetExpandedNumerator()>0&&(t=o)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){n.e(u)}finally{n.f()}return t}},{key:"findOrCreateGraphicalVoiceEntry",value:function(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.parentVoiceEntry===e)return i}}catch(a){n.e(a)}finally{n.f()}var r=o.MusicSheetCalculator.symbolFactory.createVoiceEntry(e,this);return this.graphicalVoiceEntries.push(r),r}},{key:"findOrCreateGraphicalVoiceEntryFromGraphicalNote",value:function(e){var t,n=b(this.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i===e.parentVoiceEntry)return i}}catch(a){n.e(a)}finally{n.f()}var r=o.MusicSheetCalculator.symbolFactory.createVoiceEntry(e.sourceNote.ParentVoiceEntry,this);return this.graphicalVoiceEntries.push(r),r}},{key:"addGraphicalNoteToListAtCorrectYPosition",value:function(e,t){var n=e.notes;if(0===n.length||t.PositionAndShape.RelativePosition.y<s.CollectionUtil.last(n).PositionAndShape.RelativePosition.y)n.push(t);else for(var i=n.length-1;i>=0;i--){if(n[i].PositionAndShape.RelativePosition.y>t.PositionAndShape.RelativePosition.y){n.splice(i+1,0,t);break}if(0===i){n.splice(0,0,t);break}}}},{key:"hasOnlyRests",value:function(){var e,t=b(this.graphicalVoiceEntries);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.notes);try{for(r.s();!(n=r.n()).done;)if(!n.value.sourceNote.isRest())return!1}catch(a){r.e(a)}finally{r.f()}}}catch(a){t.e(a)}finally{t.f()}return!0}},{key:"getSkylineMin",value:function(){var e,t=null===(e=this.parentMeasure)||void 0===e?void 0:e.ParentStaffLine.SkyBottomLineCalculator;if(t){var n=this.getAbsoluteStartAndEnd(),i=x(n,2),r=i[0],a=i[1];return t.getSkyLineMinInRange(r,a)}}},{key:"getHighestYAtEntry",value:function(){return this.parentMeasure.ParentStaffLine.PositionAndShape.AbsolutePosition.y+this.getSkylineMin()}},{key:"getLowestYAtEntry",value:function(){return this.parentMeasure.ParentStaffLine.PositionAndShape.AbsolutePosition.y+this.getBottomlineMax()}},{key:"getBottomlineMax",value:function(){var e,t=null===(e=this.parentMeasure)||void 0===e?void 0:e.ParentStaffLine.SkyBottomLineCalculator;if(t){var n=this.getAbsoluteStartAndEnd(),i=x(n,2),r=i[0],a=i[1];return t.getBottomLineMaxInRange(r,a)}}},{key:"getAbsoluteStartAndEnd",value:function(){var e=this.PositionAndShape.AbsolutePosition.x;return[e-=this.parentMeasure.ParentStaffLine.PositionAndShape.AbsolutePosition.x,e+this.PositionAndShape.Size.width]}}]),n}(a.GraphicalObject);t.GraphicalStaffEntry=u},8898:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalStaffEntryLink=void 0,t.GraphicalStaffEntryLink=function(){function e(t){g(this,e),this.graphicalLinkedStaffEntries=[],this.staffEntryLink=t,this.initialize()}return y(e,[{key:"GetStaffEntryLink",get:function(){return this.staffEntryLink}},{key:"GraphicalLinkedStaffEntries",get:function(){return this.graphicalLinkedStaffEntries},set:function(e){this.graphicalLinkedStaffEntries=e}},{key:"isFilled",value:function(){for(var e=0;e<this.graphicalLinkedStaffEntries.length;e++)if(!this.graphicalLinkedStaffEntries[e])return!1;return!0}},{key:"getLinkedStaffEntriesGraphicalNotes",value:function(e){if(-1!==this.graphicalLinkedStaffEntries.indexOf(e)){for(var t=[],n=0,i=this.graphicalLinkedStaffEntries.length;n<i;++n){var r,a=this.graphicalLinkedStaffEntries[n],s=b(a.graphicalVoiceEntries);try{for(s.s();!(r=s.n()).done;){var o,u=r.value,l=b(u.notes);try{for(l.s();!(o=l.n()).done;){var c=o.value;c.sourceNote.ParentStaffEntry.Link&&c.sourceNote.ParentVoiceEntry===this.staffEntryLink.GetVoiceEntry&&t.push(c)}}catch(h){l.e(h)}finally{l.f()}}}catch(h){s.e(h)}finally{s.f()}}return t}}},{key:"initialize",value:function(){for(var e=0,t=this.staffEntryLink.LinkStaffEntries.length;e<t;++e)this.graphicalLinkedStaffEntries.push(void 0)}}]),e}()},5309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalTie=void 0,t.GraphicalTie=function(){function e(t,n,i){g(this,e),this.tie=t,this.startNote=n,this.endNote=i}return y(e,[{key:"SVGElement",get:function(){return this.vfTie.getAttribute("el")}},{key:"GetTie",get:function(){return this.tie}},{key:"StartNote",get:function(){return this.startNote},set:function(e){this.startNote=e}},{key:"Tie",get:function(){return this.tie}},{key:"EndNote",get:function(){return this.endNote},set:function(e){this.endNote=e}}]),e}()},4462:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalUnknownExpression=void 0;var r=n(6791),a=n(3748),s=i(n(2043)),o=function(e){h(n,e);var t=d(n);function n(e,i,r,s,o){var u;return g(this,n),(u=t.call(this,e,new a.AbstractExpression(r),s)).label=i,u.sourceMultiExpression=o,u}return y(n,[{key:"updateSkyBottomLine",value:function(){var e=this.parentStaffLine.SkyBottomLineCalculator,t=this.label.PositionAndShape.RelativePosition.x+this.label.PositionAndShape.BorderMarginLeft,n=this.label.PositionAndShape.RelativePosition.x+this.label.PositionAndShape.BorderMarginRight;switch(this.Placement){case a.PlacementEnum.Above:var i=this.label.PositionAndShape.BorderMarginTop+this.label.PositionAndShape.RelativePosition.y;e.updateSkyLineInRange(t,n,i);break;case a.PlacementEnum.Below:var r=this.label.PositionAndShape.BorderMarginBottom+this.label.PositionAndShape.RelativePosition.y;e.updateBottomLineInRange(t,n,r);break;default:s.default.error("Placement for GraphicalUnknownExpression is unknown")}}}]),n}(r.AbstractGraphicalExpression);t.GraphicalUnknownExpression=o},5974:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalVoiceEntry=void 0;var i=n(4785),r=n(8911),a=n(1405),s=function(e){h(n,e);var t=d(n);function n(e,i,s){var o;return g(this,n),(o=t.call(this)).parentVoiceEntry=e,o.parentStaffEntry=i,o.PositionAndShape=new r.BoundingBox(c(o),i?i.PositionAndShape:void 0,!0),o.notes=[],o.rules=s||(i?i.parentMeasure.parentSourceMeasure.Rules:new a.EngravingRules),o}return y(n,[{key:"sort",value:function(){return this.notes.sort((function(e,t){var n,i,r,a;return(null!==(i=null===(n=t.sourceNote.Pitch)||void 0===n?void 0:n.getHalfTone())&&void 0!==i?i:0)-(null!==(a=null===(r=e.sourceNote.Pitch)||void 0===r?void 0:r.getHalfTone())&&void 0!==a?a:0)})),this.notes}},{key:"sortForVexflow",value:function(){return this.notes.sort((function(e,t){var n,i,r;return(null!==(i=null===(n=e.sourceNote.Pitch)||void 0===n?void 0:n.getHalfTone())&&void 0!==i?i:0)-(null!==(r=t.sourceNote.Pitch.getHalfTone())&&void 0!==r?r:0)})),this.notes}},{key:"color",value:function(){}}]),n}(i.GraphicalObject);t.GraphicalVoiceEntry=s},8682:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicalWavyLine=void 0;var i=n(8911),r=function(e){h(n,e);var t=d(n);function n(e,r){var a;return g(this,n),(a=t.call(this)).getWavyLine=e,a.PositionAndShape=new i.BoundingBox(c(a),r),a}return n}(n(4785).GraphicalObject);t.GraphicalWavyLine=r},8823:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},642:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JustifiedMusicSystemBuilder=void 0;var i=n(5623),r=function(e){h(n,e);var t=d(n);function n(){return g(this,n),t.apply(this,arguments)}return y(n,[{key:"buildMusicSystems",value:function(){this.currentSystemParams=new i.SystemBuildParameters;for(var e=[],t=0,n=-1,r=0,a=this.measureList.length;r<a;++r){this.measureListIndex=r;var s=this.measureList[r];if(s&&s[0]){for(var o=0,u=s.length;o<u;++o)s[o].resetLayout();var l=s[0].parentSourceMeasure,c=this.rules.NewPageAtXMLNewPageAttribute&&l.printNewPageXml;(this.rules.NewSystemAtXMLNewSystemAttribute&&l.printNewSystemXml||c)&&r>0?(n=r-1,e.push({startIndex:t,endIndex:n}),t=r):l.HasEndLine&&this.rules.NewPartAndSystemAfterFinalBarline&&(n=r,e.push({startIndex:t,endIndex:n}),t=r+1)}}t<this.measureList.length&&n<t&&e.push({startIndex:t,endIndex:this.measureList.length-1});for(var h=[],d=[],f=[],p=0,m=e;p<m.length;p++){for(var v=m[p],g=0,y=v.startIndex;y<=v.endIndex;++y){this.measureListIndex=y;var b=this.measureList[y];if(b&&b[0]){for(var S=0,x=b.length;S<x;++S)b[S].resetLayout();var _=b[0].parentSourceMeasure===this.graphicalMusicSheet.ParentMusicSheet.getFirstSourceMeasure(),E=this.rules.MeasureLeftMargin,k=0,M=this.getMeasureStartLine();E+=this.getLineWidth(b[0],M,!1),this.leadSheet||(E+=this.addBeginInstructions(b,!1,_),k+=this.addEndInstructions(b));for(var w=0,P=0;P<this.numberOfVisibleStaffLines;P++)w=Math.max(w,b[P].minimumStaffEntriesWidth);var T=this.getMeasureEndLine(),C=E+(k+=this.getLineWidth(b[0],T,!1))+w;d.push(C),f.push(g+C/2),g+=C}else d.push(0),f.push(0)}for(var I=g,A=this.getFullPageSystemWidth()-8,L=Math.ceil(I/A)*A/I,O=1,R=0,N=v.startIndex;N<=v.endIndex;++N){var B=f[N];if(0!==B){var D=B*L/A;O===(D=d[N]>A?N+1:Math.ceil(D))?R+=1:(h.push(R),O=D,R=1)}}h.push(R)}return this.buildPreparedMusicSystems(h)}},{key:"buildPreparedMusicSystems",value:function(e){var t=!1;this.currentSystemParams=new i.SystemBuildParameters,this.currentSystemParams.currentSystem=this.initMusicSystem();for(var n=0,r=this.measureList.length;n<r;++n){this.measureListIndex=n;var a=this.measureList[n];if(a&&a[0]){var s=this.rules.NewPageAtXMLNewPageAttribute&&a[0].parentSourceMeasure.printNewPageXml;this.currentSystemParams.currentSystem.GraphicalMeasures.length===e[this.musicSystems.length-1]&&this.finalizeCurrentAndCreateNewSystem(a,!1,!t,s);for(var o=0,u=a.length;o<u;++o)a[o].resetLayout();var l=a[0].parentSourceMeasure,c=l.HasEndLine,h=this.currentSystemParams.IsSystemStartMeasure(),d=l===this.graphicalMusicSheet.ParentMusicSheet.getFirstSourceMeasure(),f=this.rules.MeasureLeftMargin,p=0,m=this.getMeasureStartLine();if(f+=this.getLineWidth(a[0],m,h),!this.leadSheet){var v=!1;t&&this.rules.ShowRhythmAgainAfterPartEndOrFinalBarline&&(v=!0),f+=this.addBeginInstructions(a,h,d||v),p+=this.addEndInstructions(a)}for(var g=0,y=0;y<this.numberOfVisibleStaffLines;y++)g=Math.max(g,a[y].minimumStaffEntriesWidth);var b=this.getMeasureEndLine(),S=f+(p+=this.getLineWidth(a[0],b,h))+g;this.addMeasureToSystem(a,m,b,S,f,g,p),this.updateActiveClefs(l,a),t=c}}return this.finalizeCurrentAndCreateNewSystem(void 0,!1,!1),this.musicSystems}}]),n}(i.MusicSystemBuilder);t.JustifiedMusicSystemBuilder=r},4040:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSheetCalculator=void 0;var r=n(4324),a=n(1797),s=n(5253),o=n(289),u=n(5853),l=n(908),c=n(5623),h=n(9086),d=n(9050),f=n(9946),p=n(1274),m=n(5198),v=n(2947),x=n(8911),_=n(4574),E=n(1070),k=n(289),M=i(n(2043)),w=n(1649),P=n(6729),T=n(2255),C=n(141),I=n(3748),A=n(5277),L=n(9667),O=n(280),R=n(7839),N=n(374),B=n(41),D=n(642),F=n(4462),j=function(){function e(){g(this,e),this.staffEntriesWithGraphicalTies=[],this.staffEntriesWithOrnaments=[],this.staffEntriesWithChordSymbols=[],this.staffLinesWithLyricWords=[],this.graphicalLyricWords=[],this.abstractNotImplementedErrorMessage="abstract, not implemented",this.dynamicExpressionMap=new Map}return y(e,[{key:"leadSheet",get:function(){return this.graphicalMusicSheet.LeadSheet}},{key:"initialize",value:function(e){this.graphicalMusicSheet=e,this.rules=e.ParentMusicSheet.Rules,this.rules.clearMusicSheetObjects(),this.prepareGraphicalMusicSheet()}},{key:"prepareGraphicalMusicSheet",value:function(){var e=this.graphicalMusicSheet.ParentMusicSheet;this.staffEntriesWithGraphicalTies=[],this.staffEntriesWithOrnaments=[],this.staffEntriesWithChordSymbols=[],this.staffLinesWithLyricWords=[],this.graphicalMusicSheet.Initialize();for(var t=this.graphicalMusicSheet.MeasureList,n=this.createAccidentalCalculators(),i=this.graphicalMusicSheet.initializeActiveClefs(),r=[],a=e.getCompleteNumberOfStaves(),s=[],u=0;u<a;u++)s.push(void 0);for(var l=0,c=e.SourceMeasures.length;l<c;++l){var h=e.SourceMeasures[l],d=this.createGraphicalMeasuresForSourceMeasure(h,n,r,s,i);if(t.push(d),h.multipleRestMeasures>0&&this.rules.RenderMultipleRestMeasures){h.isReducedToMultiRest=!0,h.multipleRestMeasureNumber=1;var f=h.multipleRestMeasures-1;l+=f;for(var p=1;p<=f;p++){var m=e.SourceMeasures[h.MeasureNumber-1+p];m.multipleRestMeasureNumber=p+1,m.isReducedToMultiRest=!0,t.push([void 0])}}}if(this.rules.AutoGenerateMutipleRestMeasuresFromRestMeasures&&this.rules.RenderMultipleRestMeasures){for(var v,g=0,y=0,b=e.SourceMeasures.length;y<b;++y){var S=e.SourceMeasures[y];if(!S.isReducedToMultiRest&&S.canBeReducedToMultiRest())if(g>0){v.isReducedToMultiRest=!0,v.multipleRestMeasureNumber=1,g++,S.multipleRestMeasureNumber=g,S.isReducedToMultiRest=!0;for(var x=0;x<t[y].length;x++)t[y][x]=void 0}else v=S,g=1;else if(g>1){v.multipleRestMeasures=g;var _=this.createGraphicalMeasuresForSourceMeasure(v,n,r,s,i);t[v.measureListIndex]=_,g=0,v=void 0}else g=0,v=void 0}if(g>1){v.multipleRestMeasures=g,v.isReducedToMultiRest=!0;var E=this.createGraphicalMeasuresForSourceMeasure(v,n,r,s,i);t[v.measureListIndex]=E,g=0,v=void 0}}var k=i.map((function(e){return e.ClefType===o.ClefEnum.percussion}));this.handleStaffEntries(k),this.calculateVerticalContainersList(),this.setIndicesToVerticalGraphicalContainers()}},{key:"calculate",value:function(){this.musicSystems=[],this.clearSystemsAndMeasures(),this.clearRecreatedObjects(),this.createGraphicalTies(),this.calculateSheetLabelBoundingBoxes(),this.calculateXLayout(this.graphicalMusicSheet,this.maxInstrNameLabelLength()),this.graphicalMusicSheet.MusicPages.length=0,this.calculateMusicSystems(),r.GraphicalMusicSheet.transformRelativeToAbsolutePosition(this.graphicalMusicSheet)}},{key:"calculateXLayout",value:function(t,n){if(this.graphicalMusicSheet.MeasureList.length>0){var i=this.graphicalMusicSheet.MeasureList[0],r=this.calculateMeasureXLayout(i);r=this.calculateMeasureWidthFromStaffEntries(i,r),e.setMeasuresMinStaffEntriesWidth(i,r);for(var a=1;a<this.graphicalMusicSheet.MeasureList.length;a++)i=this.graphicalMusicSheet.MeasureList[a],r=this.calculateMeasureXLayout(i),r=this.calculateMeasureWidthFromStaffEntries(i,r),e.setMeasuresMinStaffEntriesWidth(i,r)}}},{key:"calculateMeasureWidthFromStaffEntries",value:function(e,t){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"formatMeasures",value:function(){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateMeasureXLayout",value:function(e){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"initGraphicalMeasuresCreation",value:function(){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleBeam",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleTiedGraphicalNote",value:function(e,t,n,i,r,a,s,o){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleVoiceEntryLyrics",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleVoiceEntryOrnaments",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleVoiceEntryArticulations",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleVoiceEntryTechnicalInstructions",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"handleTuplet",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"layoutVoiceEntry",value:function(e,t,n,i){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"layoutStaffEntry",value:function(e){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"createGraphicalTie",value:function(e,t,n,i,r){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"updateStaffLineBorders",value:function(e){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateMeasureNumberPlacement",value:function(e){var t=e.StaffLines[0];if(t&&t.Measures[0])for(var n=t.Measures[0].MeasureNumber,i=0,r=0;r<t.Measures.length;r++){var a=t.Measures[r],s=this.rules.RenderMeasureNumbersOnlyAtSystemStart&&r>1;if(1===r&&t.Measures[0].parentSourceMeasure.ImplicitMeasure&&(s=!1),s)return;0!==a.MeasureNumber&&1!==a.MeasureNumber||(n=a.MeasureNumber),i=a!==t.Measures[0]&&this.rules.MeasureNumberLabelXOffset?this.rules.MeasureNumberLabelXOffset:0;var o=this.rules.UseXMLMeasureNumbers&&1===a.MeasureNumber&&1!==a.parentSourceMeasure.getPrintedMeasureNumber();((a.MeasureNumber===n||a.MeasureNumber>=n+this.rules.MeasureNumberLabelOffset)&&!a.parentSourceMeasure.ImplicitMeasure||o)&&((1!==a.MeasureNumber||1===a.MeasureNumber&&a!==t.Measures[0]||o)&&this.calculateSingleMeasureNumberPlacement(a,t,e,i),n=a.MeasureNumber)}else M.default.warn("calculateMeasureNumberPlacement: measure undefined for system.Id "+e.Id)}},{key:"calculateSingleMeasureNumberPlacement",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=e.parentSourceMeasure.getPrintedMeasureNumber().toString(),a=new T.Label(r),s=new f.GraphicalLabel(a,this.rules.MeasureNumberLabelHeight,p.TextAlignmentEnum.LeftBottom,this.rules),o=t.SkyBottomLineCalculator;s.setLabelPositionAndShapeBorders(),s.PositionAndShape.Parent=n.PositionAndShape;var u,l=t.PositionAndShape.RelativePosition.x+e.PositionAndShape.RelativePosition.x-s.PositionAndShape.BorderMarginLeft+i,c=l,d=l-s.PositionAndShape.BorderLeft+s.PositionAndShape.BorderRight,m=.5+(c-=t.PositionAndShape.RelativePosition.x),v=(d-=t.PositionAndShape.RelativePosition.x)-.5,g=o.getSkyLineMinInRange(m,v);if(e===t.Measures[0]){var y=0;if(n.GroupBrackets.length>0){var S,x=b(n.GroupBrackets);try{for(x.s();!(S=x.n()).done;){var _=S.value;y=Math.min(y,_.PositionAndShape.BorderTop)}}catch(E){x.e(E)}finally{x.f()}}u=Math.min(g,y)}else u=g;u=Math.min(0,u),s.PositionAndShape.RelativePosition=new h.PointF2D(l,u),n.MeasureNumberLabels.push(s)}},{key:"calculateMeasureNumberSkyline",value:function(e){var t,n=e.StaffLines[0],i=b(e.MeasureNumberLabels);try{for(i.s();!(t=i.n()).done;){var r=t.value,a=r.PositionAndShape.RelativePosition.x,s=a-r.PositionAndShape.BorderLeft+r.PositionAndShape.BorderRight;a-=n.PositionAndShape.RelativePosition.x,s-=n.PositionAndShape.RelativePosition.x,n.SkyBottomLineCalculator.updateSkyLineInRange(a,s,r.PositionAndShape.RelativePosition.y+r.PositionAndShape.BorderMarginTop)}}catch(o){i.e(o)}finally{i.f()}}},{key:"layoutGraphicalTie",value:function(e,t,n){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateSingleStaffLineLyricsPosition",value:function(e,t){for(var n=0,i=this.rules.StaffHeight,r=[],a=e.SkyBottomLineCalculator,s=e.Measures.length,o=0;o<s;++o)for(var u=e.Measures[o],l=u.PositionAndShape.RelativePosition,c=u.staffEntries.length,d=0;d<c;++d){var f=u.staffEntries[d];if(f.LyricsEntries.length>0){r.push(f),n=Math.max(n,f.LyricsEntries.length);for(var p=f.PositionAndShape.RelativePosition.x+l.x,m=Number.MAX_VALUE,v=Number.MIN_VALUE,g=0;g<f.LyricsEntries.length;g++){var y=f.LyricsEntries[g].GraphicalLabel;m=Math.min(m,p+y.PositionAndShape.BorderMarginLeft),v=Math.max(v,p+y.PositionAndShape.BorderMarginRight)}var b=a.getBottomLineMaxInRange(m,v);i=Math.max(i,b+this.rules.LyricsYMarginToBottomLine)}}var S=0;s=r.length;for(var x=0,_=r;x<_.length;x++)for(var E=_[x],k=0;k<E.LyricsEntries.length;k++){var M=E.LyricsEntries[k],w=M.GraphicalLabel,P=M.LyricsEntry.VerseNumber,T=t.indexOf(P),C=i+this.rules.LyricsHeight+this.rules.VerticalBetweenLyricsDistance+this.rules.LyricsYOffsetToStaffHeight+(this.rules.VerticalBetweenLyricsDistance+this.rules.LyricsHeight)*T;this.leadSheet&&(C=3.4+(this.rules.VerticalBetweenLyricsDistance+this.rules.LyricsHeight)*T);var I=w.PositionAndShape.RelativePosition.x;w.PositionAndShape.RelativePosition=new h.PointF2D(I,C),S=Math.max(S,C)}if(r.length>0){var A=e.PositionAndShape.Size.width,L=r[0].PositionAndShape.RelativePosition.x+r[0].PositionAndShape.BorderMarginLeft+r[0].parentMeasure.PositionAndShape.RelativePosition.x;L=L>A?A:L,a.updateBottomLineInRange(L,A,S)}return r}},{key:"calculateLyricsExtendsAndDashes",value:function(e){for(var t=0,n=e.length;t<n;++t)for(var i=e[t],r=0;r<i.LyricsEntries.length;r++){var a=i.LyricsEntries[r];a.ParentLyricWord&&a.ParentLyricWord.GraphicalLyricsEntries[a.ParentLyricWord.GraphicalLyricsEntries.length-1]!==a&&this.calculateSingleLyricWord(a),a.LyricsEntry.extend&&this.calculateLyricExtend(a)}}},{key:"calculateSingleOctaveShift",value:function(e,t,n,i){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateWordRepetitionInstruction",value:function(e,t){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateMoodAndUnknownExpression",value:function(e,t,n){var i,r=e.AbsoluteTimestamp,a=this.graphicalMusicSheet.MeasureList[t],s=new h.PointF2D;if(e.MoodList.length>0||e.UnknownList.length>0){for(var o="",u=0,l=e.EntriesList.length;u<l;++u){var c=e.EntriesList[u];""!==c.prefix&&(o+=""===o?c.prefix:" "+c.prefix),o+=""===o?c.label:" "+c.label}var d=a[n].ParentStaffLine;if(!d)return void M.default.debug("MusicSheetCalculator.calculateMoodAndUnknownExpression: staffLine undefined. Returning.");s=this.getRelativePositionInStaffLineFromTimestamp(r,n,d,null==d?void 0:d.isPartOfMultiStaffInstrument()),Math.abs(s.x-0)<1e-4&&(s.x=a[n].beginInstructionsWidth+this.rules.RhythmRightMargin);var f=this.rules.UnknownTextHeight,p=e.getPlacementOfFirstEntry(),m=this.calculateLabel(d,s,o,e.getFontstyleOfFirstEntry(),p,f),v=new F.GraphicalUnknownExpression(d,m,p,null===(i=a[n])||void 0===i?void 0:i.parentSourceMeasure,e);d.AbstractExpressions.push(v)}}},{key:"clearRecreatedObjects",value:function(){for(var e=0,t=this.staffEntriesWithGraphicalTies.length;e<t;++e)this.staffEntriesWithGraphicalTies[e].GraphicalTies.length=0;this.staffEntriesWithGraphicalTies.length=0}},{key:"handleStaffEntryLink",value:function(e,t){M.default.debug("handleStaffEntryLink not implemented")}},{key:"calculateMusicSystems",value:function(){if(this.graphicalMusicSheet.MeasureList){var e=this.graphicalMusicSheet.MeasureList;if(e){this.rules.MinMeasureToDrawIndex>e.length-1&&(M.default.debug("minimum measure to draw index out of range. resetting min measure index to limit."),this.rules.MinMeasureToDrawIndex=e.length-1);for(var t=[],n=this.rules.MinMeasureToDrawIndex,i=e.length;n<i&&n<=this.rules.MaxMeasureToDrawIndex;++n){for(var r=[],a=0,s=e[n].length;a<s;++a){var o=e[n][a];if((null==o?void 0:o.isVisible())&&(r.push(o),this.rules.ColoringEnabled)){var u,l=b(o.staffEntries);try{for(l.s();!(u=l.n()).done;){var d,f=u.value,p=b(f.graphicalVoiceEntries);try{for(p.s();!(d=p.n()).done;)d.value.color()}catch(Y){p.e(Y)}finally{p.f()}}}catch(Y){l.e(Y)}finally{l.f()}}}t.push(r)}for(var m,v=0,g=0,y=t.length;g<y;++g){var S=t[g];v=Math.max(S.length,v);break}if(0!==v){var x=e.length;if((m=!this.rules.UseJustifiedBuilder||1===x||this.rules.RenderSingleHorizontalStaffline?new c.MusicSystemBuilder:new D.JustifiedMusicSystemBuilder).initialize(this.graphicalMusicSheet,t,v),this.musicSystems=m.buildMusicSystems(),this.formatMeasures(),this.leadSheet||(this.optimizeRestPlacement(),this.calculateStaffEntryArticulationMarks(),this.rules.RenderSlurs&&this.calculateTieCurves()),this.calculateSkyBottomLines(),this.calculateTupletNumbers(),this.rules.RenderMeasureNumbers)for(var _=0,E=this.musicSystems.length;_<E;++_){var k=this.musicSystems[_];this.calculateMeasureNumberPlacement(k)}if(this.calculateFingerings(),!this.leadSheet&&this.rules.RenderSlurs&&this.calculateSlurs(),this.rules.RenderMeasureNumbers)for(var w=0,P=this.musicSystems.length;w<P;++w){var T=this.musicSystems[w];this.calculateMeasureNumberSkyline(T)}this.leadSheet||this.calculateOrnaments(),this.calculateChordSymbols(),this.leadSheet||(this.calculateDynamicExpressions(),this.calculateMoodAndUnknownExpressions(),this.calculateExpressionAlignements(),this.calculateOctaveShifts(),this.calculatePedals(),this.calculateWavyLines(),this.calculateWordRepetitionInstructions()),this.calculateRepetitionEndings(),this.leadSheet||this.calculateTempoExpressions(),this.calculateRehearsalMarks(),this.calculateLyricsPosition();for(var C=0,I=this.musicSystems.length;C<I;++C)for(var A=this.musicSystems[C],L=0,O=A.StaffLines.length;L<O;++L){var R=A.StaffLines[L];this.updateStaffLineBorders(R)}m.calculateSystemYLayout(),this.calculateMarkedAreas();for(var N=0,B=this.graphicalMusicSheet.MusicPages.length;N<B;++N){for(var F=this.graphicalMusicSheet.MusicPages[N],j=0,V=F.MusicSystems.length;j<V;++j){var G=0===N&&0===j,W=F.MusicSystems[j];W.setMusicSystemLabelsYPosition(),this.leadSheet?W===W.Parent.MusicSystems[0]&&W.createSystemLeftLine(this.rules.SystemThinLineWidth,this.rules.SystemLabelsRightMargin,G):(W.setYPositionsToVerticalLineObjectsAndCreateLines(this.rules),W.createSystemLeftLine(this.rules.SystemThinLineWidth,this.rules.SystemLabelsRightMargin,G),W.createInstrumentBrackets(this.graphicalMusicSheet.ParentMusicSheet.Instruments,this.rules.StaffHeight),W.createGroupBrackets(this.graphicalMusicSheet.ParentMusicSheet.InstrumentalGroups,this.rules.StaffHeight,0),W.alignBeginInstructions()),W.calculateBorders(this.rules)}for(var U=F.MusicSystems[0].PositionAndShape.BorderTop,z=0,H=F.MusicSystems.length;z<H;++z){var X=F.MusicSystems[z];X.PositionAndShape.RelativePosition=new h.PointF2D(X.PositionAndShape.RelativePosition.x,X.PositionAndShape.RelativePosition.y-U)}F.PositionAndShape.calculateTopBottomBorders(),F===this.graphicalMusicSheet.MusicPages[0]&&this.calculatePageLabels(F),F.PositionAndShape.calculateTopBottomBorders()}}}}}},{key:"calculateMarkedAreas",value:function(){}},{key:"calculateChordSymbols",value:function(){var e,t=b(this.musicSystems);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.StaffLines);try{for(r.s();!(n=r.n()).done;){var a=n.value,s=a.SkyBottomLineCalculator,o=Number.MAX_SAFE_INTEGER;if(this.rules.ChordSymbolYAlignment&&"staffline"===this.rules.ChordSymbolYAlignmentScope){var u,l=[],c=b(a.Measures);try{for(c.s();!(u=c.n()).done;){var h=u.value;l.push.apply(l,S(h.staffEntries))}}catch(T){c.e(T)}finally{c.f()}o=this.calculateAlignedChordSymbolsOffset(l,s)}var d,f=b(a.Measures);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.rules.ChordSymbolYAlignment&&"measure"===this.rules.ChordSymbolYAlignmentScope&&(o=this.calculateAlignedChordSymbolsOffset(p.staffEntries,s));var m,v=b(p.staffEntries);try{for(v.s();!(m=v.n()).done;){var g=m.value;if(g.graphicalChordContainers&&0!==g.graphicalChordContainers.length)for(var y=0;y<g.graphicalChordContainers.length;y++){var x=g.graphicalChordContainers[y],_=g.PositionAndShape,E=x.PositionAndShape,k=E.BorderMarginLeft+_.AbsolutePosition.x,M=E.BorderMarginRight+_.AbsolutePosition.x;(!this.rules.ChordSymbolYAlignment||o>0)&&(o=s.getSkyLineMinInRange(k,M));var w=0;0===y?(w+=this.rules.ChordSymbolYOffset,w+=.1):w+=this.rules.ChordSymbolYPadding,w*=-1;var P=x.GraphicalLabel;P.PositionAndShape.RelativePosition.y=o+w,P.setLabelPositionAndShapeBorders(),P.PositionAndShape.calculateBoundingBox(),s.updateSkyLineInRange(k,M,o+P.PositionAndShape.BorderMarginTop)}}}catch(T){v.e(T)}finally{v.f()}}}catch(T){f.e(T)}finally{f.f()}}}catch(T){r.e(T)}finally{r.f()}}}catch(T){t.e(T)}finally{t.f()}}},{key:"calculateAlignedChordSymbolsOffset",value:function(e,t){var n,i=Number.MAX_SAFE_INTEGER,r=b(e);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=b(s.graphicalChordContainers);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=s.PositionAndShape,c=u.PositionAndShape,h=c.BorderMarginLeft+l.AbsolutePosition.x,d=c.BorderMarginRight+l.AbsolutePosition.x;i=Math.min(i,t.getSkyLineMinInRange(h,d))}}catch(f){o.e(f)}finally{o.f()}}}catch(f){r.e(f)}finally{r.f()}return i}},{key:"layoutMeasureWithWholeRest",value:function(e,t,n){}},{key:"layoutBeams",value:function(e){}},{key:"layoutArticulationMarks",value:function(e,t,n){}},{key:"layoutOrnament",value:function(e,t,n){}},{key:"calculateRestNotePlacementWithinGraphicalBeam",value:function(e,t,n,i,r){}},{key:"calculateTupletNumbers",value:function(){if(this.rules.TupletNumberLimitConsecutiveRepetitions){var e,t,n,i=-1,r=0,a={},s=b(this.graphicalMusicSheet.ParentMusicSheet.Instruments);try{for(s.s();!(n=s.n()).done;){var o,u=n.value,l=b(u.Voices);try{for(l.s();!(o=l.n()).done;){var c=o.value;r=0,a[c.VoiceId]={};var h,d=b(c.VoiceEntries);try{for(d.s();!(h=d.n()).done;){var f=h.value;if(f.Notes.length>0){var p=f.Notes[0];if(!p.NoteTuplet){i=-1,r=0,e=void 0;continue}if(p.NoteTuplet===t)continue;var m=p.TypeLength;if(m||(M.default.warn("note missing TypeLength"),m=p.NoteTuplet.Fractions[0]),p.NoteTuplet!==e&&a[c.VoiceId][p.NoteTuplet.TupletLabelNumber]&&a[c.VoiceId][p.NoteTuplet.TupletLabelNumber][m.RealValue]){p.NoteTuplet.RenderTupletNumber=!1,t=p.NoteTuplet;continue}p.NoteTuplet.TupletLabelNumber!==i&&(i=p.NoteTuplet.TupletLabelNumber,r=0),e=p.NoteTuplet,++r<=this.rules.TupletNumberMaxConsecutiveRepetitions&&(p.NoteTuplet.RenderTupletNumber=!0),r===this.rules.TupletNumberMaxConsecutiveRepetitions&&this.rules.TupletNumberAlwaysDisableAfterFirstMax&&(a[c.VoiceId][i]||(a[c.VoiceId][i]={}),a[c.VoiceId][i][m.RealValue]=!0),r>this.rules.TupletNumberMaxConsecutiveRepetitions&&(p.NoteTuplet.RenderTupletNumber=!1,this.rules.TupletNumberAlwaysDisableAfterFirstMax&&(a[c.VoiceId][i]||(a[c.VoiceId][i]={}),a[c.VoiceId][i][m.RealValue]=!0)),t=e}}}catch(v){d.e(v)}finally{d.f()}}}catch(v){l.e(v)}finally{l.f()}}}catch(v){s.e(v)}finally{s.f()}}}},{key:"calculateSlurs",value:function(){}},{key:"calculateDynamicExpressionsForMultiExpression",value:function(e,t,n){}},{key:"calculateGraphicalVerbalContinuousDynamic",value:function(e,t){var n,i=e.Label,r=t.x+i.PositionAndShape.BorderMarginLeft,a=t.x+i.PositionAndShape.BorderMarginRight,s=e.ContinuousDynamic.Placement,o=e.ParentStaffLine.SkyBottomLineCalculator;s===I.PlacementEnum.Below?(n=o.getBottomLineMaxInRange(r,a),i.PositionAndShape.RelativePosition=new h.PointF2D(t.x,n-i.PositionAndShape.BorderMarginTop)):(n=o.getSkyLineMinInRange(r,a),i.PositionAndShape.RelativePosition=new h.PointF2D(t.x,n-i.PositionAndShape.BorderMarginBottom))}},{key:"calculateGraphicalContinuousDynamic",value:function(e,t){var n,i=e.IsSoftAccent,r=e.ParentStaffLine.ParentStaff.idInMusicSheet,s=this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(e.ContinuousDynamic.EndMultiExpression.SourceMeasureParent,r);if(s){e.EndMeasure=s;var o=e.ParentStaffLine,u=s.ParentStaffLine,l=u&&o===u,c=!1;u?c=null==u?void 0:u.isPartOfMultiStaffInstrument():o&&(c=null==o?void 0:o.isPartOfMultiStaffInstrument());var h,d=a.Fraction.createFromFraction(e.ContinuousDynamic.EndMultiExpression.AbsoluteTimestamp),f=this.graphicalMusicSheet.GetVerticalContainerFromTimestamp(d),p=f.getFirstNonNullStaffEntry().parentMeasure,m=p.PositionAndShape.AbsolutePosition.x+p.PositionAndShape.BorderRight,v=new a.Fraction(0,0,0),g=b(f.StaffEntries);try{for(g.s();!(h=g.n()).done;){var y=h.value,S=null===(n=null==y?void 0:y.sourceStaffEntry)||void 0===n?void 0:n.calculateMaxNoteLength();(null==S?void 0:S.gt(v))&&(v=S)}}catch(oe){g.e(oe)}finally{g.f()}var x=this.getRelativePositionInStaffLineFromTimestamp(d,r,u,c,0),_=a.Fraction.plus(d,v),E=this.getRelativePositionInStaffLineFromTimestamp(_,r,u,c,0),k=this.rules.SoftAccentWedgePadding,w=f.getFirstNonNullStaffEntry().PositionAndShape.Size.width,P=this.rules.SoftAccentSizeFactor;i?(t.x-=w/2*P+k,x.x=t.x+w/2*P):E.x>x.x&&E.x<m?x.x+=(E.x-x.x)/this.rules.WedgeEndDistanceBetweenTimestampsFactor:x.x=m-this.rules.WedgeHorizontalMargin;var T=this.dynamicExpressionMap.get(e.ContinuousDynamic.StartMultiExpression.AbsoluteTimestamp.RealValue);T&&(t.x=T.RelativePosition.x+T.BorderMarginRight+this.rules.WedgeHorizontalMargin);var C,A=o.ParentMusicSystem,L=A.StaffLines.indexOf(o),O=o.SkyBottomLineCalculator,B=e.ContinuousDynamic.Placement;l&&x.x-t.x<this.rules.WedgeMinLength&&!i&&(x.x=t.x+this.rules.WedgeMinLength);var D=t.x,F=u.Measures[0].beginInstructionsWidth-this.rules.WedgeHorizontalMargin-2,j=0,V=0;l?j=x.x:(j=o.PositionAndShape.Size.width,V=x.x,(C=new N.GraphicalContinuousDynamicExpression(e.ContinuousDynamic,u,s.parentSourceMeasure)).IsSplittedPart=!0,e.IsSplittedPart=!0),i&&(V=(F=x.x+k)+w/2*P);var G=0,W=0;if(B===I.PlacementEnum.Below){var U=0;if(L<A.StaffLines.length-1&&(U=L+1),U>L){var z=A.StaffLines[U].PositionAndShape.RelativePosition.y-o.PositionAndShape.RelativePosition.y-this.rules.StaffHeight;G=this.rules.StaffHeight+z/2}else G=this.rules.WedgePlacementBelowY;G-=this.rules.WedgeOpeningLength/2,l||(W=G);var H=O.getBottomLineMaxInRange(D,j);H>G&&(G=H);var X=!1;if(L<A.StaffLines.length-1){var Y=o.findClosestStaffEntry(j),K=o.findClosestStaffEntry(D);if(K&&Y&&(K.parentVerticalContainer,X)){var q=A.StaffLines[U],Z=q.SkyBottomLineCalculator.getSkyLineMinInRange(D,j),J=q.PositionAndShape.RelativePosition.y-o.PositionAndShape.RelativePosition.y+Z;G=J-this.rules.WedgeOpeningLength>this.rules.StaffHeight?J-this.rules.WedgeVerticalMargin:this.rules.StaffHeight+this.rules.WedgeOpeningLength,e.NotToBeRemoved=!0}}l||((H=u.SkyBottomLineCalculator.getBottomLineMaxInRange(F,V))>W&&(W=H),W+=this.rules.WedgeOpeningLength/2,W+=this.rules.WedgeVerticalMargin),X||(G+=this.rules.WedgeOpeningLength/2,G+=this.rules.WedgeVerticalMargin)}else if(B===I.PlacementEnum.Above){if(1===o.ParentStaff.ParentInstrument.Staves.length)G=this.rules.WedgePlacementAboveY;else{var Q=0;L>0&&(Q=L-1);var $=A.StaffLines[Q];G=-(o.PositionAndShape.RelativePosition.y-$.PositionAndShape.RelativePosition.y-this.rules.StaffHeight)/2}G+=this.rules.WedgeOpeningLength/2,l||(W=G);var ee=O.getSkyLineMinInRange(D,j);ee<G&&(G=ee);var te=!1;if(o.ParentStaff.ParentInstrument.Staves.length>1&&L>0){var ne=o.findClosestStaffEntry(D),ie=o.findClosestStaffEntry(j);if(ne&&ie){ne.parentVerticalContainer;var re=L-1;if(te){var ae=A.StaffLines[re],se=ae.SkyBottomLineCalculator.getBottomLineMaxInRange(D,j);G=(o.PositionAndShape.RelativePosition.y-ae.PositionAndShape.RelativePosition.y-se-this.rules.StaffHeight)/2+this.rules.StaffHeight}}}l||((ee=u.SkyBottomLineCalculator.getSkyLineMinInRange(F,V))<W&&(W=ee),W-=this.rules.WedgeOpeningLength/2),te||(G-=this.rules.WedgeOpeningLength/2,G-=this.rules.WedgeVerticalMargin),l||(W-=this.rules.WedgeVerticalMargin)}e.Lines.clear(),e.ContinuousDynamic.DynamicType===R.ContDynamicEnum.crescendo?i?(e.createFirstHalfCrescendoLines(D,j,G),e.createSecondHalfDiminuendoLines(F,V,G),e.calcPsi()):l&&!i?(e.createCrescendoLines(D,j,G),e.calcPsi()):(e.createFirstHalfCrescendoLines(D,j,G),e.calcPsi(),C.createSecondHalfCrescendoLines(F,V,W),C.calcPsi()):e.ContinuousDynamic.DynamicType===R.ContDynamicEnum.diminuendo&&(l?(e.createDiminuendoLines(D,j,G),e.calcPsi()):(e.createFirstHalfDiminuendoLines(D,j,G),e.calcPsi(),C.createSecondHalfDiminuendoLines(F,V,W),C.calcPsi())),this.dynamicExpressionMap.set(d.RealValue,e.PositionAndShape)}else M.default.warn("MusicSheetCalculator.calculateGraphicalContinuousDynamic: No endMeasure found")}},{key:"calculateGraphicalInstantaneousDynamicExpression",value:function(e,t,n){var i=e.ParentStaffLine;if(i){var r=t.x+e.PositionAndShape.BorderMarginLeft,a=t.x+e.PositionAndShape.BorderMarginRight,s=i.SkyBottomLineCalculator,o=0;if(e.Placement===I.PlacementEnum.Above){var u=s.getSkyLineMinInRange(r,a);if(i.isPartOfMultiStaffInstrument()&&i.ParentStaff!==i.ParentStaff.ParentInstrument.Staves[0]){var l=i.ParentMusicSystem.StaffLines[i.ParentMusicSystem.StaffLines.indexOf(i)-1],c=i.PositionAndShape.RelativePosition.y-l.PositionAndShape.RelativePosition.y-this.rules.StaffHeight;o=u>-c/2?-c/2:u-e.PositionAndShape.BorderMarginBottom}else o=u-e.PositionAndShape.BorderMarginBottom;e.PositionAndShape.RelativePosition=new h.PointF2D(t.x,o)}else if(e.Placement===I.PlacementEnum.Below){var d=s.getBottomLineMaxInRange(r,a),f=i.ParentStaff.ParentInstrument.Staves[i.ParentStaff.ParentInstrument.Staves.length-1];if(i.isPartOfMultiStaffInstrument()&&i.ParentStaff!==f){var p=i.ParentMusicSystem.StaffLines[i.ParentMusicSystem.StaffLines.indexOf(i)+1].PositionAndShape.RelativePosition.y-i.PositionAndShape.RelativePosition.y-this.rules.StaffHeight;o=d+e.PositionAndShape.BorderMarginBottom<this.rules.StaffHeight+p/2?this.rules.StaffHeight+p/2:d-e.PositionAndShape.BorderMarginTop}else o=d-e.PositionAndShape.BorderMarginTop;e.PositionAndShape.RelativePosition=new h.PointF2D(t.x,o)}e.updateSkyBottomLine()}}},{key:"calcGraphicalRepetitionEndingsRecursively",value:function(e){}},{key:"layoutSingleRepetitionEnding",value:function(e,t,n,i,r,a){}},{key:"calculateLabel",value:function(e,t,n,i,r,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:p.TextAlignmentEnum.CenterBottom,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=new T.Label(n,s);u.fontStyle=i,u.fontHeight=a;var l=new f.GraphicalLabel(u,a,u.textAlignment,this.rules,e.PositionAndShape),c=1.1;r===I.PlacementEnum.Below&&(l.Label.textAlignment=p.TextAlignmentEnum.LeftTop),l.setLabelPositionAndShapeBorders(),l.PositionAndShape.BorderMarginBottom*=c,l.PositionAndShape.BorderMarginTop*=c,l.PositionAndShape.BorderMarginLeft*=c,l.PositionAndShape.BorderMarginRight*=c;var d,m=t.x+l.PositionAndShape.BorderMarginLeft,v=t.x+l.PositionAndShape.BorderMarginRight;v>e.PositionAndShape.Size.width&&(m=(v=e.PositionAndShape.Size.width-this.rules.MeasureRightMargin)-l.PositionAndShape.MarginSize.width,t.x=m-l.PositionAndShape.BorderMarginLeft);var g=e.SkyBottomLineCalculator;return d=r===I.PlacementEnum.Below?g.getBottomLineMaxInRange(m,v)+o:g.getSkyLineMinInRange(m,v)-o,l.PositionAndShape.RelativePosition=new h.PointF2D(t.x,d),r===I.PlacementEnum.Below?g.updateBottomLineInRange(m,v,l.PositionAndShape.BorderMarginBottom+d):g.updateSkyLineInRange(m,v,l.PositionAndShape.BorderMarginTop+d),l}},{key:"calculateTempoExpressionsForMultiTempoExpression",value:function(e,t,n){var i=a.Fraction.plus(e.AbsoluteTimestamp,t.Timestamp),r=this.graphicalMusicSheet.MeasureList[n],s=new h.PointF2D;if(t.ContinuousTempo||t.InstantaneousTempo){if(this.rules.MinMeasureToDrawIndex>0)return;if(!r[0])return;for(var o=r[0].ParentStaffLine,u=r[0].PositionAndShape.RelativePosition.x,l=0,c=0;c<r.length;c++)if(r[c].ParentStaffLine&&0!==r[c].ParentStaffLine.Measures.length&&r[c].ParentStaffLine.Measures.length>0){o=r[c].ParentStaffLine,u=r[c].PositionAndShape.RelativePosition.x,l=c;break}if(s=this.getRelativePositionInStaffLineFromTimestamp(i,l,o,o.isPartOfMultiStaffInstrument(),u),t.EntriesList.length>0&&t.EntriesList[0].Expression instanceof L.InstantaneousTempoExpression&&(t.EntriesList[0].Expression.Placement=I.PlacementEnum.Above,o.Measures[0].staffEntries.length>0&&0===Math.abs(s.x-o.Measures[0].staffEntries[0].PositionAndShape.RelativePosition.x)&&o.ParentMusicSystem===this.musicSystems[0])){var d=o.Measures[0].FirstInstructionStaffEntry;if(d){var f=d.GraphicalInstructions.last();s.x=f.PositionAndShape.RelativePosition.x}this.rules.CompactMode&&(s.x=o.PositionAndShape.RelativePosition.x+o.Measures[0].PositionAndShape.RelativePosition.x)}var m,v=b(t.EntriesList);try{for(v.s();!(m=v.n()).done;){var g=m.value,y=p.TextAlignmentEnum.CenterBottom;this.rules.CompactMode&&(y=p.TextAlignmentEnum.LeftBottom);var S=this.calculateLabel(o,s,g.label,t.getFontstyleOfFirstEntry(),g.Expression.Placement,this.rules.UnknownTextHeight,y,this.rules.TempoYSpacing);if(g.Expression instanceof L.InstantaneousTempoExpression){var x,_=b(o.AbstractExpressions);try{for(_.s();!(x=_.n()).done;){var E=x.value;E instanceof A.GraphicalInstantaneousTempoExpression&&(E.SourceExpression.Label,g.Expression.Label)}}catch(k){_.e(k)}finally{_.f()}if(new A.GraphicalInstantaneousTempoExpression(g.Expression,S).ParentStaffLine||M.default.warn("Adding staffline didn't work"),this.rules.MetronomeMarksDrawn&&g.Expression.Enum===L.TempoEnum.metronomeMark){this.createMetronomeMark(g.Expression);continue}}else g.Expression,O.ContinuousTempoExpression}}catch(k){v.e(k)}finally{v.f()}}}},{key:"createMetronomeMark",value:function(e){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"graphicalMeasureCreatedCalculations",value:function(e){}},{key:"clearSystemsAndMeasures",value:function(){for(var e=0,t=this.graphicalMusicSheet.MusicPages.length;e<t;++e){for(var n=this.graphicalMusicSheet.MusicPages[e],i=0,r=n.MusicSystems.length;i<r;++i){for(var a=n.MusicSystems[i],s=0,o=a.StaffLines.length;s<o;++s){for(var u=a.StaffLines[s],l=0,c=u.Measures.length;l<c;++l){var h=u.Measures[l];if(h.FirstInstructionStaffEntry){var d=h.PositionAndShape.ChildElements.indexOf(h.FirstInstructionStaffEntry.PositionAndShape);d>-1&&h.PositionAndShape.ChildElements.splice(d,1),h.FirstInstructionStaffEntry=void 0,h.beginInstructionsWidth=0}if(h.LastInstructionStaffEntry){var f=h.PositionAndShape.ChildElements.indexOf(h.LastInstructionStaffEntry.PositionAndShape);f>-1&&h.PositionAndShape.ChildElements.splice(f,1),h.LastInstructionStaffEntry=void 0,h.endInstructionsWidth=0}}u.Measures=[],u.PositionAndShape.ChildElements=[]}a.StaffLines.length=0,a.PositionAndShape.ChildElements=[]}n.MusicSystems=[],n.PositionAndShape.ChildElements=[]}this.graphicalMusicSheet.MusicPages=[]}},{key:"handleVoiceEntry",value:function(t,n,i,r,a,s,o,u,c,h,d){t.StemDirectionXml!==l.StemDirectionType.Undefined&&this.rules.SetWantedStemDirectionByXml&&void 0!==t.StemDirectionXml?t.WantedStemDirection=t.StemDirectionXml:this.calculateStemDirectionFromVoices(t);var f=n.findOrCreateGraphicalVoiceEntry(t);f.octaveShiftValue=u;var p,m=n.tabStaffEntry;m&&(p=m.findOrCreateGraphicalVoiceEntry(t));for(var v=0,g=t.Notes.length;v<g;++v){var y=t.Notes[v];if(y&&!(void 0!==d&&void 0!==d.Link&&void 0!==h&&h.indexOf(y)>-1)){var b=void 0;if(t.IsGrace?b=e.symbolFactory.createGraceNote(y,f,a,this.rules,u):(b=e.symbolFactory.createNote(y,f,a,u,this.rules,void 0),e.stafflineNoteCalculator.trackNote(b)),y.Pitch&&this.checkNoteForAccidental(b,i,a,u),this.resetYPositionForLeadSheet(b.PositionAndShape),n.addGraphicalNoteToListAtCorrectYPosition(f,b),b.PositionAndShape.calculateBoundingBox(),this.leadSheet||(void 0!==y.NoteBeam&&y.PrintObject&&this.handleBeam(b,y.NoteBeam,o),void 0!==y.NoteTuplet&&y.PrintObject&&this.handleTuplet(b,y.NoteTuplet,s)),p){var S=e.symbolFactory.createNote(y,p,a,u,this.rules,void 0);m.addGraphicalNoteToListAtCorrectYPosition(p,S),S.PositionAndShape.calculateBoundingBox(),this.leadSheet||y.NoteTuplet&&this.handleTuplet(S,y.NoteTuplet,s)}}}return t.Articulations.length>0&&this.handleVoiceEntryArticulations(t.Articulations,t,n),t.TechnicalInstructions.length>0&&this.handleVoiceEntryTechnicalInstructions(t.TechnicalInstructions,t,n),t.LyricsEntries.size()>0&&this.handleVoiceEntryLyrics(t,n,r),t.OrnamentContainer&&this.handleVoiceEntryOrnaments(t.OrnamentContainer,t,n),u}},{key:"resetYPositionForLeadSheet",value:function(e){this.leadSheet&&(e.RelativePosition=new h.PointF2D(e.RelativePosition.x,0))}},{key:"layoutVoiceEntries",value:function(e,t){if(e.PositionAndShape.RelativePosition=new h.PointF2D(0,0),!this.leadSheet){var n,i=b(e.graphicalVoiceEntries);try{for(i.s();!(n=i.n()).done;){var r=n.value.notes;if(0!==r.length){var a=r[0].sourceNote.ParentVoiceEntry,s=void 0!==r[0].sourceNote.Pitch;this.layoutVoiceEntry(a,r,e,s)}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"maxInstrNameLabelLength",value:function(){var e,t,n=0,i=b(this.graphicalMusicSheet.ParentMusicSheet.Instruments);try{for(i.s();!(t=i.n()).done;){var r=t.value;if((null===(e=r.NameLabel)||void 0===e?void 0:e.print)&&r.Voices.length>0&&r.Voices[0].Visible){var a=r.NameLabel;this.rules.RenderPartNames||(a=new T.Label("",a.textAlignment,a.font));var s=new f.GraphicalLabel(a,this.rules.InstrumentLabelTextHeight,p.TextAlignmentEnum.LeftCenter,this.rules);s.setLabelPositionAndShapeBorders(),n=Math.max(n,s.PositionAndShape.MarginSize.width)}}}catch(o){i.e(o)}finally{i.f()}return this.rules.RenderPartNames?n:0}},{key:"calculateSheetLabelBoundingBoxes",value:function(){var e=this.graphicalMusicSheet.ParentMusicSheet,t=this.rules.DefaultColorTitle;if(void 0!==e.Title&&this.rules.RenderTitle){var n=new f.GraphicalLabel(e.Title,this.rules.SheetTitleHeight,p.TextAlignmentEnum.CenterBottom,this.rules);n.Label.IsCreditLabel=!0,n.Label.colorDefault=t,this.graphicalMusicSheet.Title=n,n.setLabelPositionAndShapeBorders()}else this.rules.RenderTitle||(this.graphicalMusicSheet.Title=void 0);if(void 0!==e.Subtitle&&this.rules.RenderSubtitle){var i=new f.GraphicalLabel(e.Subtitle,this.rules.SheetSubtitleHeight,p.TextAlignmentEnum.CenterCenter,this.rules);i.Label.IsCreditLabel=!0,i.Label.colorDefault=t,this.graphicalMusicSheet.Subtitle=i,i.setLabelPositionAndShapeBorders()}else this.rules.RenderSubtitle||(this.graphicalMusicSheet.Subtitle=void 0);if(void 0!==e.Composer&&this.rules.RenderComposer){var r=new f.GraphicalLabel(e.Composer,this.rules.SheetComposerHeight,p.TextAlignmentEnum.RightCenter,this.rules);r.Label.IsCreditLabel=!0,r.Label.colorDefault=t,this.graphicalMusicSheet.Composer=r,r.setLabelPositionAndShapeBorders()}else this.rules.RenderComposer||(this.graphicalMusicSheet.Composer=void 0);if(void 0!==e.Lyricist&&this.rules.RenderLyricist){var a=new f.GraphicalLabel(e.Lyricist,this.rules.SheetAuthorHeight,p.TextAlignmentEnum.LeftCenter,this.rules);a.Label.IsCreditLabel=!0,a.Label.colorDefault=t,this.graphicalMusicSheet.Lyricist=a,a.setLabelPositionAndShapeBorders()}else this.rules.RenderLyricist||(this.graphicalMusicSheet.Lyricist=void 0)}},{key:"checkMeasuresForWholeRestNotes",value:function(){for(var e=0,t=this.musicSystems.length;e<t;++e)for(var n=this.musicSystems[e],i=0,r=n.StaffLines.length;i<r;++i)for(var s=n.StaffLines[i],o=0,u=s.Measures.length;o<u;++o){var l=s.Measures[o];if(1===l.staffEntries.length){var c=l.staffEntries[0];if(c.graphicalVoiceEntries.length>0&&1===c.graphicalVoiceEntries[0].notes.length){var h=c.graphicalVoiceEntries[0].notes[0];!h.sourceNote.Pitch&&new a.Fraction(1,2).lt(h.sourceNote.Length)&&this.layoutMeasureWithWholeRest(h,c,l)}}}}},{key:"optimizeRestNotePlacement",value:function(e,t){if(0!==e.graphicalVoiceEntries.length){var n=e.graphicalVoiceEntries[0].notes;if(0!==n.length){var i=n[0],r=i.sourceNote.isRest();if(2===e.graphicalVoiceEntries.length){var a=!1,s=e.graphicalVoiceEntries[1].notes;s.length>0&&(a=s[0].sourceNote.isRest()),r&&a?this.calculateTwoRestNotesPlacementWithCollisionDetection(e):(r||a)&&this.calculateRestNotePlacementWithCollisionDetectionFromGraphicalNote(e)}else if(r&&e!==t.staffEntries[0]&&e!==t.staffEntries[t.staffEntries.length-1]){var o=t.staffEntries.indexOf(e),u=t.staffEntries[o-1],l=t.staffEntries[o+1];if(1===u.graphicalVoiceEntries.length){var c=u.graphicalVoiceEntries[0].notes[0];if(void 0!==c.sourceNote.NoteBeam&&1===l.graphicalVoiceEntries.length){var h=l.graphicalVoiceEntries[0].notes[0];void 0!==h.sourceNote.NoteBeam&&c.sourceNote.NoteBeam===h.sourceNote.NoteBeam&&(this.calculateRestNotePlacementWithinGraphicalBeam(e,i,c,l,h),e.PositionAndShape.calculateBoundingBox())}}}}}}},{key:"getRelativePositionInStaffLineFromTimestamp",value:function(e,t,n,i){var r,s,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=new h.PointF2D,l=this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers.length,c=this.graphicalMusicSheet.GetInterpolatedIndexInVerticalContainers(e),d=Math.min(Math.floor(c),l-1),f=Math.min(Math.ceil(c),l-1);if(d<0||t<0)return u;if(r=this.getFirstLeftNotNullStaffEntryFromContainer(d,t,i),s=this.getFirstRightNotNullStaffEntryFromContainer(f,t,i),r&&s){var p=r.parentMeasure.PositionAndShape.RelativePosition.x;o>0&&(p=o);var m=r.PositionAndShape.RelativePosition.x+p,v=s.PositionAndShape.RelativePosition.x+s.parentMeasure.PositionAndShape.RelativePosition.x;o>0&&(v=s.PositionAndShape.RelativePosition.x+p);var g=0;if(r!==s){var y=r.getAbsoluteTimestamp(),b=s.getAbsoluteTimestamp();g=a.Fraction.minus(e,y).RealValue/a.Fraction.minus(b,y).RealValue}r.parentMeasure.ParentStaffLine!==s.parentMeasure.ParentStaffLine&&(r.parentMeasure.ParentStaffLine===n?v=n.PositionAndShape.Size.width:m=n.PositionAndShape.RelativePosition.x),u=new h.PointF2D(m+(v-m)*g,0)}return u}},{key:"getRelativeXPositionFromTimestamp",value:function(e){var t=this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers.length,n=this.graphicalMusicSheet.GetInterpolatedIndexInVerticalContainers(e),i=Math.max(0,Math.min(Math.round(n),t-1)),r=this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[i].getFirstNonNullStaffEntry();return r.PositionAndShape.RelativePosition.x+r.parentMeasure.PositionAndShape.RelativePosition.x}},{key:"calculatePageLabels",value:function(e){var t;this.rules.RenderSingleHorizontalStaffline&&(e.PositionAndShape.BorderRight=e.PositionAndShape.Size.width,e.PositionAndShape.calculateBoundingBox(),this.graphicalMusicSheet.ParentMusicSheet.pageWidth=e.PositionAndShape.Size.width);var n=10;if(e.MusicSystems.length>0){var i=e.MusicSystems[0];n=i.PositionAndShape.RelativePosition.y+i.PositionAndShape.BorderTop}if(this.graphicalMusicSheet.Title&&this.rules.RenderTitle){var r=this.graphicalMusicSheet.Title;r.PositionAndShape.Parent=e.PositionAndShape;var a=new h.PointF2D;a.x=this.graphicalMusicSheet.ParentMusicSheet.pageWidth/2,a.y=this.rules.TitleTopDistance+this.rules.SheetTitleHeight,r.PositionAndShape.RelativePosition=a,e.Labels.push(r)}if(this.graphicalMusicSheet.Subtitle&&this.rules.RenderTitle&&this.rules.RenderSubtitle){var s=this.graphicalMusicSheet.Subtitle;s.PositionAndShape.Parent=e.PositionAndShape;var o=new h.PointF2D;o.x=this.graphicalMusicSheet.ParentMusicSheet.pageWidth/2,o.y=this.rules.TitleTopDistance+this.rules.SheetTitleHeight+this.rules.SheetMinimumDistanceBetweenTitleAndSubtitle,s.PositionAndShape.RelativePosition=o,e.Labels.push(s)}var u,l=this.graphicalMusicSheet.Composer;if(l&&this.rules.RenderComposer){l.PositionAndShape.Parent=e.PositionAndShape,l.setLabelPositionAndShapeBorders();var c=new h.PointF2D;c.x=this.graphicalMusicSheet.ParentMusicSheet.pageWidth-this.rules.PageRightMargin,c.y=n,c.y-=this.rules.SystemComposerDistance;var d=null===(t=l.TextLines)||void 0===t?void 0:t.length;d>1&&(c.y-=l.PositionAndShape.BorderBottom*(d-1)/d),u=c.y,l.PositionAndShape.RelativePosition=c,e.Labels.push(l)}var f=this.graphicalMusicSheet.Lyricist;if(f&&this.rules.RenderLyricist){f.PositionAndShape.Parent=e.PositionAndShape,f.setLabelPositionAndShapeBorders();var p=new h.PointF2D;p.x=this.rules.PageLeftMargin,p.y=n,p.y+=f.PositionAndShape.BorderBottom,p.y=Math.min(p.y,null!=u?u:Number.MAX_SAFE_INTEGER),f.PositionAndShape.RelativePosition=p,e.Labels.push(f)}}},{key:"createGraphicalTies",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++)for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0;n<t.CompleteNumberOfStaves;n++)for(var i=0;i<t.VerticalSourceStaffEntryContainers.length;i++){var r=t.VerticalSourceStaffEntryContainers[i].StaffEntries[n];if(r){var a=this.graphicalMusicSheet.findGraphicalStaffEntryFromMeasureList(n,e,r);a&&(a.GraphicalTies.clear(),a.ties.clear());for(var s=0,o=r.VoiceEntries.length;s<o;++s)for(var u=r.VoiceEntries[s],l=0,c=u.Notes.length;l<c;++l){var h=u.Notes[l];if(h.NoteTie){var d=h.NoteTie;if(h===h.NoteTie.Notes.last())continue;if(a){var f,p=b(a.GraphicalTies);try{for(p.s();!(f=p.n()).done;)f.value.Tie}catch(m){p.e(m)}finally{p.f()}}this.handleTie(d,a,n,e)}}this.setTieDirections(a)}}}},{key:"handleTie",value:function(e,t,n,i){if(t){t.ties.push(e);for(var r,a,s,o=t,u=1;u<e.Notes.length;u++)if(r=o.findTieGraphicalNoteFromNote(e.Notes[u-1]),a=this.graphicalMusicSheet.GetGraphicalFromSourceStaffEntry(e.Notes[u].ParentStaffEntry)){if(s=a.findTieGraphicalNoteFromNote(e.Notes[u]),void 0!==r&&void 0!==s&&a){if(!r.sourceNote.PrintObject||!s.sourceNote.PrintObject)continue;var l=this.createGraphicalTie(e,o,a,r,s);o.GraphicalTies.push(l),this.staffEntriesWithGraphicalTies.indexOf(o)>=0&&this.staffEntriesWithGraphicalTies.push(o)}o=a}}}},{key:"setTieDirections",value:function(e){if(e){var t=e.ties;if(1===t.length){var n=t[0];if(n.TieDirection===I.PlacementEnum.NotYetDefined){var i=n.Notes[0].ParentVoiceEntry.ParentVoice.VoiceId;2!==i&&6!==i||(n.TieDirection=I.PlacementEnum.Below)}}if(t.length>1){var r,a,s=b(t);try{for(s.s();!(a=s.n()).done;){var o=a.value.Notes[0];(!r||o.Pitch.getHalfTone()>r.Pitch.getHalfTone())&&(r=o)}}catch(h){s.e(h)}finally{s.f()}var u,l=b(t);try{for(l.s();!(u=l.n()).done;){var c=u.value;c.TieDirection===I.PlacementEnum.NotYetDefined&&(c.Notes[0]===r?c.TieDirection=I.PlacementEnum.Above:c.TieDirection=I.PlacementEnum.Below)}}catch(h){l.e(h)}finally{l.f()}}}}},{key:"createAccidentalCalculators",value:function(){var e=[],t=this.graphicalMusicSheet.ParentMusicSheet.getFirstSourceMeasure();if(t)for(var n=0;n<t.CompleteNumberOfStaves;n++){var i=new E.AccidentalCalculator;if(e.push(i),t.FirstInstructionsStaffEntries[n])for(var r=0,a=t.FirstInstructionsStaffEntries[n].Instructions.length;r<a;++r){var s=t.FirstInstructionsStaffEntries[n].Instructions[r];if(s instanceof m.KeyInstruction){var o=s;i.ActiveKeyInstruction=o}}}return e}},{key:"calculateVerticalContainersList",value:function(){for(var e=this.graphicalMusicSheet.MeasureList[0].length,t=0;t<this.graphicalMusicSheet.MeasureList.length;t++)for(var n=0;n<e;n++){var i=this.graphicalMusicSheet.MeasureList[t][n];if(i)for(var r=0,a=i.staffEntries.length;r<a;++r){var s=i.staffEntries[r],o=this.graphicalMusicSheet.getOrCreateVerticalContainer(s.getAbsoluteTimestamp());o&&(o.StaffEntries[n]=s,s.parentVerticalContainer=o)}}}},{key:"setIndicesToVerticalGraphicalContainers",value:function(){for(var e=0;e<this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers.length;e++)this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[e].Index=e}},{key:"createGraphicalMeasuresForSourceMeasure",value:function(e,t,n,i,r){this.initGraphicalMeasuresCreation();for(var a=[],s=[],o=[],u=[],l=!0,c=0;c<e.CompleteNumberOfStaves;c++){var h=this.createGraphicalMeasure(e,o,s,t[c],r,i,n,c,u);l=l&&h.hasOnlyRests,a.push(h)}return e.allRests=l,e.VerticalMeasureList=a,a}},{key:"createGraphicalMeasure",value:function(t,n,i,r,c,h,f,p,v){var g,y,S,x,E,M,w,P=this.graphicalMusicSheet.ParentMusicSheet.getStaffFromIndex(p);if(c[p].ClefType===o.ClefEnum.TAB)P.isTab=!0,w=e.symbolFactory.createTabStaffMeasure(t,P);else if(t.multipleRestMeasures&&this.rules.RenderMultipleRestMeasures)w=e.symbolFactory.createMultiRestMeasure(t,P);else{if(t.multipleRestMeasureNumber>1)return;w=e.symbolFactory.createGraphicalMeasure(t,P)}if(w.hasError=t.getErrorInMeasure(p),t.FirstInstructionsStaffEntries[p])for(var T=0,I=t.FirstInstructionsStaffEntries[p].Instructions.length;T<I;++T){var A=t.FirstInstructionsStaffEntries[p].Instructions[T];if(A instanceof m.KeyInstruction){var L=m.KeyInstruction.copy(A),O=w.getTransposedHalftones();0!==O&&w.ParentStaff.ParentInstrument.MidiInstrumentId!==k.MidiInstrument.Percussion&&e.transposeCalculator&&e.transposeCalculator.transposeKey(L,O),r.ActiveKeyInstruction=L}}for(var R=[],N=0,D=t.StaffLinkedExpressions[p].length;N<D;++N){var F=t.StaffLinkedExpressions[p][N];if(F.OctaveShiftStart){R.push(F);var j=F.OctaveShiftStart,V=null===(g=null==j?void 0:j.ParentEndMultiExpression)||void 0===g?void 0:g.AbsoluteTimestamp;(null==j?void 0:j.ParentEndMultiExpression)||(V=a.Fraction.plus(t.AbsoluteTimestamp,t.Duration)),h[p]=new _.OctaveShiftParams(j,null==F?void 0:F.AbsoluteTimestamp,V)}}for(var G=0;G<t.VerticalSourceStaffEntryContainers.length;G++){var W=t.VerticalSourceStaffEntryContainers[G].StaffEntries[p];if(W){for(var U=0,z=W.Instructions.length;U<z;++U){var H=W.Instructions[U];H instanceof o.ClefInstruction&&(c[p]=H)}var X=e.symbolFactory.createStaffEntry(W,w);G<w.staffEntries.length?w.addGraphicalStaffEntryAtTimestamp(X):w.addGraphicalStaffEntry(X);var Y=[];W.Link&&(W.findLinkedNotes(Y),this.handleStaffEntryLink(X,v));var K=u.OctaveEnum.NONE;if(h[p]&&h[p].getAbsoluteStartTimestamp.lte(W.AbsoluteTimestamp)&&W.AbsoluteTimestamp.lte(h[p].getAbsoluteEndTimestamp)&&(K=h[p].getOpenOctaveShift.Type),K===u.OctaveEnum.NONE){var q,Z=b(R);try{for(Z.s();!(q=Z.n()).done;){var J=q.value;if((null===(S=null===(y=J.OctaveShiftStart)||void 0===y?void 0:y.ParentStartMultiExpression)||void 0===S?void 0:S.AbsoluteTimestamp.lte(W.AbsoluteTimestamp))&&!(null===(E=null===(x=J.OctaveShiftStart)||void 0===x?void 0:x.ParentEndMultiExpression)||void 0===E?void 0:E.AbsoluteTimestamp.lt(W.AbsoluteTimestamp))){K=J.OctaveShiftStart.Type;break}}}catch(ke){Z.e(ke)}finally{Z.f()}}for(var Q=0,$=W.VoiceEntries.length;Q<$;++Q){var ee=W.VoiceEntries[Q];K=this.handleVoiceEntry(ee,X,r,f,c[p],n,i,K,p,Y,W)}if(W.Instructions.length>0){var te=W.Instructions[0];e.symbolFactory.createInStaffClef(X,te)}this.rules.RenderChordSymbols&&(null===(M=W.ChordContainers)||void 0===M?void 0:M.length)>0&&(W.ParentStaff.ParentInstrument.HasChordSymbols=!0,e.symbolFactory.createChordSymbols(W,X,r.ActiveKeyInstruction,this.graphicalMusicSheet.ParentMusicSheet.Transpose))}}if(r.doCalculationsAtEndOfMeasure(),t.LastInstructionsStaffEntries[p])for(var ne=t.LastInstructionsStaffEntries[p],ie=0,re=ne.Instructions.length;ie<re;++ie){var ae=ne.Instructions[ie];ae instanceof o.ClefInstruction&&(c[p]=ae)}for(var se=0,oe=t.StaffLinkedExpressions[p].length;se<oe;++se){var ue=t.StaffLinkedExpressions[p][se];void 0!==ue.OctaveShiftEnd&&void 0!==h[p]&&ue.OctaveShiftEnd===h[p].getOpenOctaveShift&&(h[p]=void 0)}var le,ce=b(w.staffEntries);try{for(ce.s();!(le=ce.n()).done;){var he,de=le.value,fe=b(de.graphicalVoiceEntries);try{for(fe.s();!(he=fe.n()).done;){var pe=he.value;this.setBeamNotesWantedStemDirections(pe.parentVoiceEntry)}}catch(ke){fe.e(ke)}finally{fe.f()}}}catch(ke){ce.e(ke)}finally{ce.f()}if(this.rules.FillEmptyMeasuresWithWholeRest>=1&&0===w.staffEntries.length){var me=new d.SourceStaffEntry(new C.VerticalSourceStaffEntryContainer(w.parentSourceMeasure,w.parentSourceMeasure.AbsoluteTimestamp,w.parentSourceMeasure.CompleteNumberOfStaves),P),ve=new l.VoiceEntry(new a.Fraction(0,1),P.Voices[0],me),ge=new s.Note(ve,me,a.Fraction.createFromFraction(t.Duration),void 0,t);ge.PrintObject=this.rules.FillEmptyMeasuresWithWholeRest===B.FillEmptyMeasuresWithWholeRests.YesVisible,ve.addNote(ge);var ye=e.symbolFactory.createStaffEntry(me,w);w.addGraphicalStaffEntry(ye),ye.relInMeasureTimestamp=ve.Timestamp;var be=e.symbolFactory.createVoiceEntry(ve,ye);ye.graphicalVoiceEntries.push(be);var Se=e.symbolFactory.createNote(ge,be,new o.ClefInstruction,u.OctaveEnum.NONE,void 0);e.stafflineNoteCalculator.trackNote(Se),be.notes.push(Se)}w.hasOnlyRests=!0;var xe,_e=b(w.staffEntries);try{for(_e.s();!(xe=_e.n()).done;){var Ee=xe.value;if(w.hasOnlyRests=Ee.hasOnlyRests(),!w.hasOnlyRests)break}}catch(ke){_e.e(ke)}finally{_e.f()}return w}},{key:"checkNoteForAccidental",value:function(e,t,n,i){var r=e.sourceNote.Pitch,a=e.parentVoiceEntry.parentStaffEntry.parentMeasure.getTransposedHalftones();0!==a&&e.sourceNote.ParentStaffEntry.ParentStaff.ParentInstrument.MidiInstrumentId!==k.MidiInstrument.Percussion&&(r=e.Transpose(t.ActiveKeyInstruction,n,a,i),e.sourceNote.TransposedPitch=r),e.sourceNote.halfTone=r.getHalfTone(),t.checkAccidental(e,r)}},{key:"handleStaffEntries",value:function(t){for(var n=0,i=this.graphicalMusicSheet.MeasureList.length;n<i;++n)for(var r=this.graphicalMusicSheet.MeasureList[n],a=0,s=r.length;a<s;++a){var o=r[a];if(o){void 0!==this.rules.PercussionOneLineCutoff&&0!==this.rules.PercussionOneLineCutoff&&t[a]&&(-1===this.rules.PercussionOneLineCutoff||e.stafflineNoteCalculator.getStafflineUniquePositionCount(a)<this.rules.PercussionOneLineCutoff)&&(o.ParentStaff.StafflineCount=1);var u,l=b(o.staffEntries);try{for(l.s();!(u=l.n()).done;){var c=u.value;void 0!==c.parentMeasure&&c.graphicalVoiceEntries.length>0&&c.graphicalVoiceEntries[0].notes.length>0&&(this.layoutVoiceEntries(c,a),this.layoutStaffEntry(c))}}catch(h){l.e(h)}finally{l.f()}this.graphicalMeasureCreatedCalculations(o)}}}},{key:"calculateSkyBottomLines",value:function(){}},{key:"calculateExpressionAlignements",value:function(){}},{key:"calculateStaffEntryArticulationMarks",value:function(){for(var e=0,t=this.musicSystems.length;e<t;++e)for(var n=this.musicSystems[e],i=0,r=n.StaffLines.length;i<r;++i)for(var a=n.StaffLines[i],s=0,o=a.Measures.length;s<o;++s)for(var u=a.Measures[s],l=0,c=u.staffEntries.length;l<c;++l)for(var h=u.staffEntries[l],d=0,f=h.sourceStaffEntry.VoiceEntries.length;d<f;++d){var p=h.sourceStaffEntry.VoiceEntries[d];p.Articulations.length>0&&this.layoutArticulationMarks(p.Articulations,p,h)}}},{key:"calculateOrnaments",value:function(){for(var e=0,t=this.musicSystems.length;e<t;++e)for(var n=this.musicSystems[e],i=0,r=n.StaffLines.length;i<r;++i)for(var a=n.StaffLines[i],s=0,o=a.Measures.length;s<o;++s)for(var u=a.Measures[s],l=0,c=u.staffEntries.length;l<c;++l)for(var h=u.staffEntries[l],d=0,f=h.sourceStaffEntry.VoiceEntries.length;d<f;++d){var p=h.sourceStaffEntry.VoiceEntries[d];if(p.OrnamentContainer){if(p.hasTie()&&!h.relInMeasureTimestamp.Equals(p.Timestamp))continue;this.layoutOrnament(p.OrnamentContainer,p,h),-1===this.staffEntriesWithOrnaments.indexOf(h)&&this.staffEntriesWithOrnaments.push(h)}}}},{key:"calculateFingerings",value:function(){if(this.rules.FingeringPosition!==I.PlacementEnum.Left&&this.rules.FingeringPosition!==I.PlacementEnum.Right){var e,t=b(this.musicSystems);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.StaffLines);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=b(s.Measures);try{for(o.s();!(a=o.n()).done;){var u,l=a.value,c=l.isUpperStaffOfInstrument()?I.PlacementEnum.Above:I.PlacementEnum.Below,h=b(l.staffEntries);try{for(h.s();!(u=h.n()).done;){var d=u.value;d.FingeringEntries=[];var m,v=s.SkyBottomLineCalculator,g=d.PositionAndShape.RelativePosition.x+l.PositionAndShape.RelativePosition.x,y=[],S=b(d.graphicalVoiceEntries);try{for(S.s();!(m=S.n()).done;){var x,_=m.value,E=b(_.notes);try{for(E.s();!(x=E.n()).done;){var k=x.value.sourceNote;k.Fingering&&!k.IsGraceNote&&y.push(k.Fingering)}}catch(F){E.e(F)}finally{E.f()}}}catch(F){S.e(F)}finally{S.f()}c===I.PlacementEnum.Below&&y.reverse();for(var M=0;M<y.length;M++){var w=y[M],P=c===I.PlacementEnum.Above?p.TextAlignmentEnum.CenterBottom:p.TextAlignmentEnum.CenterTop,C=new T.Label(w.value,P),A=new f.GraphicalLabel(C,this.rules.FingeringTextSize,C.textAlignment,this.rules,s.PositionAndShape),L=g+A.PositionAndShape.BorderMarginLeft,O=g+A.PositionAndShape.BorderMarginRight,R=void 0;R=c===I.PlacementEnum.Above?v.getSkyLineMinInRange(L,O):v.getBottomLineMaxInRange(L,O);var N=0;0===M?(N+=this.rules.FingeringOffsetY,c===I.PlacementEnum.Above&&(N+=.1)):N+=this.rules.FingeringPaddingY,c===I.PlacementEnum.Above&&(N*=-1),A.PositionAndShape.RelativePosition.y+=R+N,A.PositionAndShape.RelativePosition.x=g,A.setLabelPositionAndShapeBorders(),A.PositionAndShape.calculateBoundingBox(),d.FingeringEntries.push(A);var B=A.PositionAndShape.RelativePosition.x+A.PositionAndShape.BorderLeft,D=B-A.PositionAndShape.BorderLeft+A.PositionAndShape.BorderRight;c===I.PlacementEnum.Above?v.updateSkyLineInRange(B,D,A.PositionAndShape.RelativePosition.y+A.PositionAndShape.BorderTop):c===I.PlacementEnum.Below&&v.updateBottomLineInRange(B,D,A.PositionAndShape.RelativePosition.y+A.PositionAndShape.BorderBottom)}}}catch(F){h.e(F)}finally{h.f()}}}catch(F){o.e(F)}finally{o.f()}}}catch(F){r.e(F)}finally{r.f()}}}catch(F){t.e(F)}finally{t.f()}}}},{key:"optimizeRestPlacement",value:function(){for(var e=0,t=this.musicSystems.length;e<t;++e)for(var n=this.musicSystems[e],i=0,r=n.StaffLines.length;i<r;++i)for(var a=n.StaffLines[i],s=0,o=a.Measures.length;s<o;++s)for(var u=a.Measures[s],l=0,c=u.staffEntries.length;l<c;++l){var h=u.staffEntries[l];this.optimizeRestNotePlacement(h,u)}}},{key:"calculateTwoRestNotesPlacementWithCollisionDetection",value:function(e){var t=e.graphicalVoiceEntries[0].notes[0],n=e.graphicalVoiceEntries[1].notes[0];n.PositionAndShape.RelativePosition=new h.PointF2D(0,2.5),e.PositionAndShape.calculateAbsolutePositionsRecursiveWithoutTopelement(),t.PositionAndShape.computeNonOverlappingPositionWithMargin(e.PositionAndShape,x.ColDirEnum.Up,new h.PointF2D(0,n.PositionAndShape.RelativePosition.y));var i=t.PositionAndShape.RelativePosition;i.y-=1,t.PositionAndShape.RelativePosition=i,e.PositionAndShape.calculateBoundingBox()}},{key:"calculateRestNotePlacementWithCollisionDetectionFromGraphicalNote",value:function(e){var t,n;e.graphicalVoiceEntries[0].notes[0].sourceNote.isRest()?(t=e.graphicalVoiceEntries[0].notes[0],n=e.graphicalVoiceEntries[1].notes):(n=e.graphicalVoiceEntries[0].notes,t=e.graphicalVoiceEntries[1].notes[0]);var i=!1;e.PositionAndShape.calculateAbsolutePositionsRecursiveWithoutTopelement();for(var r=0,a=n.length;r<a;++r){var s=n[r];if(t.PositionAndShape.marginCollisionDetection(s.PositionAndShape)){i=!0;break}}if(i)if(t.sourceNote.ParentVoiceEntry.ParentVoice instanceof v.LinkedVoice){var o=n[0].PositionAndShape.BorderMarginBottom+n[0].PositionAndShape.RelativePosition.y;t.PositionAndShape.RelativePosition=new h.PointF2D(0,o-t.PositionAndShape.BorderMarginTop+.5)}else{var u=n[n.length-1],l=u.PositionAndShape.BorderMarginTop+u.PositionAndShape.RelativePosition.y;if(n[0].sourceNote.ParentVoiceEntry.ParentVoice instanceof v.LinkedVoice)t.PositionAndShape.RelativePosition=new h.PointF2D(0,l-t.PositionAndShape.BorderMarginBottom-.5);else{var c=n[0].PositionAndShape.BorderMarginBottom+n[0].PositionAndShape.RelativePosition.y;t.PositionAndShape.RelativePosition=c<2?new h.PointF2D(0,c-t.PositionAndShape.BorderMarginTop+.5):new h.PointF2D(0,l-t.PositionAndShape.BorderMarginBottom-0)}}e.PositionAndShape.calculateBoundingBox()}},{key:"calculateTieCurves",value:function(){var e,t=b(this.musicSystems);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.StaffLines);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=b(s.Measures);try{for(o.s();!(a=o.n()).done;){var u,l=a.value,c=b(l.staffEntries);try{for(c.s();!(u=c.n()).done;){var h,d=u.value,f=b(d.GraphicalTies);try{for(f.s();!(h=f.n()).done;){var p=h.value;if(void 0!==p.StartNote&&p.StartNote.parentVoiceEntry.parentStaffEntry===d){var m=p.StartNote.parentVoiceEntry.parentStaffEntry.parentMeasure.ParentStaffLine!==p.EndNote.parentVoiceEntry.parentStaffEntry.parentMeasure.ParentStaffLine;this.layoutGraphicalTie(p,m,l.ParentStaff.isTab)}}}catch(v){f.e(v)}finally{f.f()}}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}}}catch(v){r.e(v)}finally{r.f()}}}catch(v){t.e(v)}finally{t.f()}}},{key:"calculateLyricsPosition",value:function(){for(var e=new w.Dictionary,t=0,n=this.graphicalMusicSheet.ParentMusicSheet.Instruments.length;t<n;++t){var i=this.graphicalMusicSheet.ParentMusicSheet.Instruments[t];i.HasLyrics&&i.LyricVersesNumbers.length>0&&i.LyricVersesNumbers.sort()}for(var r=0,a=this.musicSystems.length;r<a;++r)for(var s=this.musicSystems[r],o=0,u=s.StaffLines.length;o<u;++o){var l=s.StaffLines[o],c=this.calculateSingleStaffLineLyricsPosition(l,l.ParentStaff.ParentInstrument.LyricVersesNumbers);e.setValue(l,c),this.calculateLyricsExtendsAndDashes(e.getValue(l))}for(var h=0,d=this.musicSystems.length;h<d;++h)for(var f=this.musicSystems[h],p=0,m=f.StaffLines.length;p<m;++p){var v=f.StaffLines[p];this.calculateLyricsExtendsAndDashes(e.getValue(v))}}},{key:"calculateSingleLyricWord",value:function(e){var t,n=e.ParentLyricWord,i=n.GraphicalLyricsEntries.indexOf(e);if(i>=0&&(t=n.GraphicalLyricsEntries[i+1]),t){var r=e.StaffEntryParent.parentMeasure.ParentStaffLine,a=t.StaffEntryParent.parentMeasure.ParentStaffLine,s=e.StaffEntryParent,o=t.StaffEntryParent;if(e.StaffEntryParent.parentMeasure.ParentStaffLine===t.StaffEntryParent.parentMeasure.ParentStaffLine){var u=s.parentMeasure.PositionAndShape.RelativePosition.x+s.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.BorderMarginRight,l=o.parentMeasure.PositionAndShape.RelativePosition.x+o.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.RelativePosition.x+t.GraphicalLabel.PositionAndShape.BorderMarginLeft,c=e.GraphicalLabel.PositionAndShape.RelativePosition.y,h=1;l-u>3*this.rules.MinimumDistanceBetweenDashes&&(h=Math.floor((l-u)/this.rules.MinimumDistanceBetweenDashes)-1),1===h?this.calculateSingleDashForLyricWord(r,u,l,c):this.calculateDashes(r,u,l,c)}else{var d=s.parentMeasure.PositionAndShape.RelativePosition.x+s.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.BorderMarginRight,f=r.Measures[r.Measures.length-1],p=f.PositionAndShape.RelativePosition.x+f.PositionAndShape.Size.width,m=e.GraphicalLabel.PositionAndShape.RelativePosition.y;if(this.calculateDashes(r,d,p,m),a&&a.Measures[0]&&o.parentMeasure.ParentStaffLine&&(o!==o.parentMeasure.staffEntries[0]||o.parentMeasure!==o.parentMeasure.ParentStaffLine.Measures[0])){var v=a.Measures[0].staffEntries[0].PositionAndShape.RelativePosition.x,g=o.parentMeasure.PositionAndShape.RelativePosition.x+o.PositionAndShape.RelativePosition.x+t.GraphicalLabel.PositionAndShape.BorderMarginLeft;m=t.GraphicalLabel.PositionAndShape.RelativePosition.y,this.calculateDashes(a,v,g,m)}}}}},{key:"calculateDashes",value:function(e,t,n,i){var r=n-t;if(r<3*this.rules.MinimumDistanceBetweenDashes)this.calculateSingleDashForLyricWord(e,t,n,i);else{var a=Math.floor(r/this.rules.MinimumDistanceBetweenDashes)-1,s=r/(a+1),o=0;for(t+=s,n-=s;o<=Math.floor(a/2)&&n>t;)r=this.calculateRightAndLeftDashesForLyricWord(e,t,n,i),t+=s,n-=s,o++;r>2*s&&this.calculateSingleDashForLyricWord(e,t,n,i)}}},{key:"calculateSingleDashForLyricWord",value:function(e,t,n,i){var r=new T.Label("-");r.colorDefault=this.rules.DefaultColorLyrics;var a=new f.GraphicalLabel(r,this.rules.LyricsHeight,p.TextAlignmentEnum.CenterBottom,this.rules);a.setLabelPositionAndShapeBorders(),e.LyricsDashes.push(a),-1===this.staffLinesWithLyricWords.indexOf(e)&&this.staffLinesWithLyricWords.push(e),a.PositionAndShape.Parent=e.PositionAndShape;var s=new h.PointF2D(t+(n-t)/2,i);a.PositionAndShape.RelativePosition=s}},{key:"calculateLyricExtend",value:function(e){for(var t,n,i=e.GraphicalLabel.PositionAndShape.RelativePosition.y,r=e.StaffEntryParent,a=r.parentMeasure.ParentStaffLine,s=r.parentMeasure.ParentStaff.idInMusicSheet,o=r.parentVerticalContainer.Index+1;o<this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers.length;++o){var u=this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[o].StaffEntries[s];if(u){if(u.hasOnlyRests())break;if(u.LyricsEntries.length>0)break;(n=(t=u).parentMeasure.ParentStaffLine)||(n=r.parentMeasure.ParentStaffLine)}}if(t&&n)if(a===n&&t.parentMeasure.ParentStaffLine){var l=r.parentMeasure.PositionAndShape.RelativePosition.x+r.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.BorderMarginRight,c=t.parentMeasure.PositionAndShape.RelativePosition.x+t.PositionAndShape.RelativePosition.x+t.PositionAndShape.BorderMarginRight;i-=e.GraphicalLabel.PositionAndShape.Size.height/4,this.calculateSingleLyricWordWithUnderscore(a,l,c,i)}else{var h=a.Measures[a.Measures.length-1].PositionAndShape,d=r.parentMeasure.PositionAndShape.RelativePosition.x+r.PositionAndShape.RelativePosition.x+e.GraphicalLabel.PositionAndShape.BorderMarginRight,f=h.RelativePosition.x+h.Size.width;if(i-=e.GraphicalLabel.PositionAndShape.Size.height/4,this.calculateSingleLyricWordWithUnderscore(a,d,f,i),!t)return;if(t.parentMeasure.ParentStaffLine&&t.parentMeasure.staffEntries&&(t!==t.parentMeasure.staffEntries[0]||t.parentMeasure!==t.parentMeasure.ParentStaffLine.Measures[0])){var p=n.Measures[0].staffEntries[0].PositionAndShape.RelativePosition.x,m=t.parentMeasure.PositionAndShape.RelativePosition.x+t.PositionAndShape.RelativePosition.x+t.PositionAndShape.BorderMarginRight;this.calculateSingleLyricWordWithUnderscore(n,p,m,i)}}}},{key:"calculateSingleLyricWordWithUnderscore",value:function(e,t,n,i){var r=new h.PointF2D(t,i),a=new h.PointF2D(n,i),s=new P.GraphicalLine(r,a,this.rules.LyricUnderscoreLineWidth);s.colorHex=this.rules.DefaultColorLyrics,e.LyricLines.push(s),-1===this.staffLinesWithLyricWords.indexOf(e)&&this.staffLinesWithLyricWords.push(e)}},{key:"calculateRightAndLeftDashesForLyricWord",value:function(e,t,n,i){var r=new T.Label("-");r.colorDefault=this.rules.DefaultColorLyrics;var a=new f.GraphicalLabel(r,this.rules.LyricsHeight,p.TextAlignmentEnum.CenterBottom,this.rules);a.setLabelPositionAndShapeBorders(),e.LyricsDashes.push(a),-1===this.staffLinesWithLyricWords.indexOf(e)&&this.staffLinesWithLyricWords.push(e),a.PositionAndShape.Parent=e.PositionAndShape;var s=new h.PointF2D(t,i);a.PositionAndShape.RelativePosition=s;var o=new T.Label("-"),u=new f.GraphicalLabel(o,this.rules.LyricsHeight,p.TextAlignmentEnum.CenterBottom,this.rules);u.setLabelPositionAndShapeBorders(),e.LyricsDashes.push(u),u.PositionAndShape.Parent=e.PositionAndShape;var l=new h.PointF2D(n,i);return u.PositionAndShape.RelativePosition=l,u.PositionAndShape.RelativePosition.x-a.PositionAndShape.RelativePosition.x}},{key:"calculateDynamicExpressions",value:function(){for(var e=Math.min(this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length-1,this.rules.MaxMeasureToDrawIndex),t=Math.min(this.rules.MinMeasureToDrawIndex,this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length);t<=e;t++){var n=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[t];this.dynamicExpressionMap.clear();for(var i=0;i<n.StaffLinkedExpressions.length;i++)if(this.graphicalMusicSheet.MeasureList[t]&&this.graphicalMusicSheet.MeasureList[t][i]&&this.graphicalMusicSheet.MeasureList[t][i].ParentStaff.ParentInstrument.Visible)for(var r=0;r<n.StaffLinkedExpressions[i].length;r++)(void 0!==n.StaffLinkedExpressions[i][r].InstantaneousDynamic||void 0!==n.StaffLinkedExpressions[i][r].StartingContinuousDynamic&&n.StaffLinkedExpressions[i][r].StartingContinuousDynamic.StartMultiExpression===n.StaffLinkedExpressions[i][r]&&0===n.StaffLinkedExpressions[i][r].UnknownList.length)&&this.calculateDynamicExpressionsForMultiExpression(n.StaffLinkedExpressions[i][r],t,i)}this.dynamicExpressionMap.clear()}},{key:"calculateOctaveShifts",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++)for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0;n<t.StaffLinkedExpressions.length;n++)if(this.graphicalMusicSheet.MeasureList[e]&&this.graphicalMusicSheet.MeasureList[e][n]&&this.graphicalMusicSheet.MeasureList[e][n].ParentStaff.ParentInstrument.Visible)for(var i=0;i<t.StaffLinkedExpressions[n].length;i++)t.StaffLinkedExpressions[n][i].OctaveShiftStart&&this.calculateSingleOctaveShift(t,t.StaffLinkedExpressions[n][i],e,n)}},{key:"calculatePedals",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++)for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0;n<t.StaffLinkedExpressions.length;n++)if(this.graphicalMusicSheet.MeasureList[e]&&this.graphicalMusicSheet.MeasureList[e][n]&&this.graphicalMusicSheet.MeasureList[e][n].ParentStaff.ParentInstrument.Visible)for(var i=0;i<t.StaffLinkedExpressions[n].length;i++)t.StaffLinkedExpressions[n][i].PedalStart&&this.calculateSinglePedal(t,t.StaffLinkedExpressions[n][i],e,n)}},{key:"calculateWavyLines",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++)for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0;n<t.StaffLinkedExpressions.length;n++)if(this.graphicalMusicSheet.MeasureList[e]&&this.graphicalMusicSheet.MeasureList[e][n]&&this.graphicalMusicSheet.MeasureList[e][n].ParentStaff.ParentInstrument.Visible)for(var i=0;i<t.StaffLinkedExpressions[n].length;i++)t.StaffLinkedExpressions[n][i].WavyLineStart&&this.calculateSingleWavyLine(t,t.StaffLinkedExpressions[n][i],e,n)}},{key:"getFirstLeftNotNullStaffEntryFromContainer",value:function(e,t,n){if(this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[e].StaffEntries[t])return this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[e].StaffEntries[t];for(var i=e-1;i>=0;i--)if(this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[i].StaffEntries[t])return this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[i].StaffEntries[t]}},{key:"getFirstRightNotNullStaffEntryFromContainer",value:function(e,t,n){if(this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[e].StaffEntries[t])return this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[e].StaffEntries[t];for(var i=e+1;i<this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers.length;i++)if(this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[i].StaffEntries[t])return this.graphicalMusicSheet.VerticalGraphicalStaffEntryContainers[i].StaffEntries[t]}},{key:"calculateWordRepetitionInstructions",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++){for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0,i=t.FirstRepetitionInstructions.length;n<i;++n){var r=t.FirstRepetitionInstructions[n];this.calculateWordRepetitionInstruction(r,e)}for(var a=0,s=t.LastRepetitionInstructions.length;a<s;++a){var o=t.LastRepetitionInstructions[a];this.calculateWordRepetitionInstruction(o,e)}}}},{key:"calculateRepetitionEndings",value:function(){for(var e=this.graphicalMusicSheet.ParentMusicSheet,t=0,n=e.Repetitions.length;t<n;++t){var i=e.Repetitions[t];this.calcGraphicalRepetitionEndingsRecursively(i)}}},{key:"calculateTempoExpressions",value:function(){for(var e=Math.min(this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length-1,this.rules.MaxMeasureToDrawIndex),t=this.rules.MinMeasureToDrawIndex;t<=e;t++)for(var n=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[t],i=0;i<n.TempoExpressions.length;i++)this.calculateTempoExpressionsForMultiTempoExpression(n,n.TempoExpressions[i],t)}},{key:"calculateRehearsalMarks",value:function(){if(this.rules.RenderRehearsalMarks){var e,t=b(this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.calculateRehearsalMark(n)}}catch(i){t.e(i)}finally{t.f()}}}},{key:"calculateRehearsalMark",value:function(e){throw new Error(this.abstractNotImplementedErrorMessage)}},{key:"calculateMoodAndUnknownExpressions",value:function(){for(var e=0;e<this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length;e++)for(var t=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[e],n=0;n<t.StaffLinkedExpressions.length;n++)if(this.graphicalMusicSheet.MeasureList[e]&&this.graphicalMusicSheet.MeasureList[e][n]&&this.graphicalMusicSheet.MeasureList[e][n].ParentStaff.ParentInstrument.Visible)for(var i=0;i<t.StaffLinkedExpressions[n].length;i++)(t.StaffLinkedExpressions[n][i].MoodList.length>0||t.StaffLinkedExpressions[n][i].UnknownList.length>0)&&this.calculateMoodAndUnknownExpression(t.StaffLinkedExpressions[n][i],e,n)}},{key:"calculateStemDirectionFromVoices",value:function(e){if(void 0!==e.ParentSourceStaffEntry.Link)return e===e.ParentSourceStaffEntry.VoiceEntries[0]?void(e.WantedStemDirection=l.StemDirectionType.Up):void(e.WantedStemDirection=l.StemDirectionType.Down);e.ParentVoice instanceof v.LinkedVoice?e.WantedStemDirection=l.StemDirectionType.Down:e.ParentSourceStaffEntry.VoiceEntries.length>1&&(e.WantedStemDirection=l.StemDirectionType.Up)}},{key:"setBeamNotesWantedStemDirections",value:function(e){if(e.Notes.length>0){var t=e.Notes[0].NoteBeam;if(t){var n,i=b(t.Notes);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.ParentVoiceEntry.WantedStemDirection!==l.StemDirectionType.Undefined&&r.ParentVoiceEntry.ParentSourceStaffEntry.ParentStaff.Id===e.ParentSourceStaffEntry.ParentStaff.Id){e.WantedStemDirection=r.ParentVoiceEntry.WantedStemDirection;break}}}catch(a){i.e(a)}finally{i.f()}}}}}],[{key:"TextMeasurer",get:function(){return e.textMeasurer},set:function(t){e.textMeasurer=t}},{key:"setMeasuresMinStaffEntriesWidth",value:function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n];r&&(r.minimumStaffEntriesWidth=t)}}}]),e}();t.MusicSheetCalculator=j},1494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSheetDrawer=t.LabelRenderSpecs=void 0;var i=n(8911),r=n(8155),a=n(6729),s=n(3278),o=n(9086),u=n(9946),l=n(2255),c=n(1274),h=n(1703),d=n(158),f=n(5074),p=function e(){g(this,e)};t.LabelRenderSpecs=p,t.MusicSheetDrawer=function(){function e(t,n){g(this,e),this.drawableBoundingBoxElement="None",this.skyLineVisible=!1,this.bottomLineVisible=!1,this.phonicScoreMode=f.PhonicScoreModes.Manual,this.textMeasurer=t,this.splitScreenLineColor=-1,this.drawingParameters=n,this.rules=n.Rules}return y(e,[{key:"Mode",set:function(e){this.phonicScoreMode=e}},{key:"drawSheet",value:function(e){if(this.graphicalMusicSheet=e,this.rules=e.ParentMusicSheet.Rules,this.drawSplitScreenLine(),this.drawingParameters.drawCursors){var t,n=b(e.Cursors);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a){var s=new i.BoundingBox(a);s.AbsolutePosition=a.Start,s.BorderBottom=a.End.y-a.Start.y,s.BorderRight=a.Width/2,s.BorderLeft=-a.Width/2,this.isVisible(s)&&this.drawLineAsVerticalRectangle(a,r.GraphicalLayers.Cursor)}}}catch(c){n.e(c)}finally{n.f()}}this.drawingParameters.drawScrollIndicator&&this.drawScrollIndicator();for(var o=Math.min(this.graphicalMusicSheet.MusicPages.length,this.rules.MaxPageToDrawNumber),u=0;u<o;u++){var l=this.graphicalMusicSheet.MusicPages[u];this.drawPage(l)}}},{key:"drawLineAsHorizontalRectangle",value:function(e,t){var n=new s.RectangleF2D(e.Start.x,e.End.y-e.Width/2,e.End.x-e.Start.x,e.Width);n=this.applyScreenTransformationForRect(n),this.renderRectangle(n,t,e.styleId,e.colorHex)}},{key:"drawLineAsVerticalRectangle",value:function(e,t){var n=e.Start,i=e.Width,r=new s.RectangleF2D(n.x-i/2,n.y,i,e.End.y-n.y);r=this.applyScreenTransformationForRect(r),this.renderRectangle(r,t,e.styleId)}},{key:"drawLineAsHorizontalRectangleWithOffset",value:function(e,t,n){var i=new o.PointF2D(e.Start.x+t.x,e.Start.y+t.y),r=new o.PointF2D(e.End.x+t.x,e.End.y+t.y),a=e.Width,u=new s.RectangleF2D(i.x,r.y-a/2,r.x-i.x,a);u=this.applyScreenTransformationForRect(u),this.renderRectangle(u,n,e.styleId)}},{key:"drawLineAsVerticalRectangleWithOffset",value:function(e,t,n){var i=new o.PointF2D(e.Start.x+t.x,e.Start.y+t.y),r=new o.PointF2D(e.End.x+t.x,e.End.y+t.y),a=e.Width,u=new s.RectangleF2D(i.x,i.y,a,r.y-i.y);u=this.applyScreenTransformationForRect(u),this.renderRectangle(u,n,e.styleId)}},{key:"drawRectangle",value:function(e,t){var n=e.PositionAndShape,i=new s.RectangleF2D(n.AbsolutePosition.x,n.AbsolutePosition.y,n.BorderRight,n.BorderBottom);i=this.applyScreenTransformationForRect(i),this.renderRectangle(i,t,e.style)}},{key:"drawLabel",value:function(e,t){if(this.isVisible(e.PositionAndShape)&&""!==e.Label.text.trim()){var n=this.calculateLabel(e);this.renderLabel(e,t,n)}}},{key:"calculateLabel",value:function(e){var t=new p,n=e.Label;t.ScreenPosition=this.applyScreenTransformation(e.PositionAndShape.AbsolutePosition),t.FontHeightInPixel=this.calculatePixelDistance(n.fontHeight);var i=this.calculatePixelDistance(e.PositionAndShape.Size.width);switch(t.BitmapWidth=Math.ceil(i),t.BitmapHeight=Math.ceil(t.FontHeightInPixel*(.2+e.TextLines.length)),n.textAlignment){case c.TextAlignmentEnum.LeftTop:break;case c.TextAlignmentEnum.LeftCenter:t.ScreenPosition.y-=t.BitmapHeight/2;break;case c.TextAlignmentEnum.LeftBottom:t.ScreenPosition.y-=t.BitmapHeight;break;case c.TextAlignmentEnum.CenterTop:t.ScreenPosition.x-=t.BitmapWidth/2;break;case c.TextAlignmentEnum.CenterCenter:t.ScreenPosition.x-=t.BitmapWidth/2,t.ScreenPosition.y-=t.BitmapHeight/2;break;case c.TextAlignmentEnum.CenterBottom:t.ScreenPosition.x-=t.BitmapWidth/2,t.ScreenPosition.y-=t.BitmapHeight;break;case c.TextAlignmentEnum.RightTop:t.ScreenPosition.x-=t.BitmapWidth;break;case c.TextAlignmentEnum.RightCenter:t.ScreenPosition.x-=t.BitmapWidth,t.ScreenPosition.y-=t.BitmapHeight/2;break;case c.TextAlignmentEnum.RightBottom:t.ScreenPosition.x-=t.BitmapWidth,t.ScreenPosition.y-=t.BitmapHeight;break;default:throw new h.ArgumentOutOfRangeException("")}return t}},{key:"applyScreenTransformations",value:function(e){var t,n=[],i=b(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n.push(this.applyScreenTransformation(r))}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"drawSplitScreenLine",value:function(){}},{key:"renderRectangle",value:function(e,t,n,i){throw new Error("not implemented")}},{key:"drawScrollIndicator",value:function(){}},{key:"drawSelectionStartSymbol",value:function(e){}},{key:"drawSelectionEndSymbol",value:function(e){}},{key:"renderLabel",value:function(e,t,n){throw new Error("not implemented")}},{key:"renderSystemToScreen",value:function(e,t,n){}},{key:"drawSkyLine",value:function(e){}},{key:"drawBottomLine",value:function(e){}},{key:"drawInstrumentBrace",value:function(e,t){}},{key:"drawGroupBracket",value:function(e,t){}},{key:"isVisible",value:function(e){return!0}},{key:"drawMusicSystem",value:function(e){var t=this.getSystemAbsBoundingRect(e),n=this.getSytemBoundingBoxInPixels(t);this.drawMusicSystemComponents(e,n,t)}},{key:"getSytemBoundingBoxInPixels",value:function(e){var t=this.applyScreenTransformationForRect(e);return t.x=Math.round(t.x),t.y=Math.round(t.y),t}},{key:"getSystemAbsBoundingRect",value:function(e){var t=e.PositionAndShape.BoundingRectangle;return new s.RectangleF2D(e.PositionAndShape.AbsolutePosition.x+e.PositionAndShape.BorderLeft-1,e.PositionAndShape.AbsolutePosition.y+e.PositionAndShape.BorderTop-1,t.width+6,t.height+2)}},{key:"drawMusicSystemComponents",value:function(e,t,n){var i=this.graphicalMusicSheet.SelectionStartSymbol,a=this.graphicalMusicSheet.SelectionEndSymbol;this.drawingParameters.drawSelectionStartSymbol&&void 0!==i&&this.isVisible(i.PositionAndShape)&&this.drawSelectionStartSymbol(i),this.drawingParameters.drawSelectionEndSymbol&&void 0!==a&&this.isVisible(a.PositionAndShape)&&this.drawSelectionEndSymbol(a);var s,o=b(e.StaffLines);try{for(o.s();!(s=o.n()).done;){var u=s.value;this.drawStaffLine(u),this.rules.RenderLyrics&&(u.LyricsDashes.length>0&&this.drawDashes(u.LyricsDashes),u.LyricLines.length>0&&this.drawLyricLines(u.LyricLines,u))}}catch(L){o.e(L)}finally{o.f()}var l,c=b(e.SystemLines);try{for(c.s();!(l=c.n()).done;){var h=l.value;this.drawSystemLineObject(h)}}catch(L){c.e(L)}finally{c.f()}if(e.Parent===e.Parent.Parent.MusicPages[0]){var d,f=b(e.Labels);try{for(f.s();!(d=f.n()).done;){var p=d.value;p.SVGNode=this.drawLabel(p,r.GraphicalLayers.Notes)}}catch(L){f.e(L)}finally{f.f()}}var m,v=this.graphicalMusicSheet.ParentMusicSheet.Instruments,g=v.filter((function(e){return e.Visible})).length,y=b(e.InstrumentBrackets);try{for(y.s();!(m=y.n()).done;){var S=m.value;this.drawInstrumentBrace(S,e)}}catch(L){y.e(L)}finally{y.f()}if(v.length>0)if(g>1){var x,_=b(e.GroupBrackets);try{for(_.s();!(x=_.n()).done;){var E=x.value;this.drawGroupBracket(E,e)}}catch(L){_.e(L)}finally{_.f()}}else{var k,M=b(e.GroupBrackets);try{for(M.s();!(k=M.n()).done;)k.value.Visible=!1}catch(L){M.e(L)}finally{M.f()}}if(!this.leadSheet){var w,P=b(e.MeasureNumberLabels);try{for(P.s();!(w=P.n()).done;){var T=w.value;T.SVGNode=this.drawLabel(T,r.GraphicalLayers.Notes)}}catch(L){P.e(L)}finally{P.f()}}var C,I=b(e.StaffLines);try{for(I.s();!(C=I.n()).done;){var A=C.value;this.drawStaffLineSymbols(A)}}catch(L){I.e(L)}finally{I.f()}this.drawingParameters.drawMarkedAreas&&this.drawMarkedAreas(e)}},{key:"activateSystemRendering",value:function(e,t,n,i){return!0}},{key:"drawSystemLineObject",value:function(e){}},{key:"drawStaffLine",value:function(e){var t,n=b(e.Measures);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.drawMeasure(i),i.parentSourceMeasure&&(i.parentSourceMeasure.WasRendered=!0)}}catch(r){n.e(r)}finally{n.f()}this.rules.RenderLyrics&&e.LyricsDashes.length>0&&this.drawDashes(e.LyricsDashes),this.drawOctaveShifts(e),this.drawPedals(e),this.drawWavyLines(e),this.drawExpressions(e),this.skyLineVisible&&this.drawSkyLine(e),this.bottomLineVisible&&this.drawBottomLine(e)}},{key:"drawLyricLines",value:function(e,t){var n=this;t.LyricLines.forEach((function(e){e.Start.y+=t.PositionAndShape.AbsolutePosition.y,e.End.y+=t.PositionAndShape.AbsolutePosition.y,e.Start.x+=t.PositionAndShape.AbsolutePosition.x,e.End.x+=t.PositionAndShape.AbsolutePosition.x,n.drawGraphicalLine(e,n.rules.LyricUnderscoreLineWidth,e.colorHex)}))}},{key:"drawExpressions",value:function(e){}},{key:"drawGraphicalLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black";return this.drawLine(e.Start,e.End,n,t)}},{key:"drawLine",value:function(e,t){}},{key:"drawDashes",value:function(e){var t=this;e.forEach((function(e){return e.SVGNode=t.drawLabel(e,r.GraphicalLayers.Notes)}))}},{key:"drawOctaveShifts",value:function(e){}},{key:"drawStaffLines",value:function(e){if(e.StaffLines)for(var t=e.PositionAndShape.AbsolutePosition,n=0;n<5;n++)this.drawLineAsHorizontalRectangleWithOffset(e.StaffLines[n],t,r.GraphicalLayers.Notes)}},{key:"drawSymbol",value:function(e,t,n){arguments.length>4&&void 0!==arguments[4]||r.GraphicalLayers.Notes}},{key:"leadSheet",get:function(){return this.graphicalMusicSheet.LeadSheet},set:function(e){this.graphicalMusicSheet.LeadSheet=e}},{key:"drawPage",value:function(e){if(this.isVisible(e.PositionAndShape)){var t,n=b(e.MusicSystems);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.isVisible(i.PositionAndShape)&&this.drawMusicSystem(i)}}catch(u){n.e(u)}finally{n.f()}if(e===e.Parent.MusicPages[0]){var a,s=b(e.Labels);try{for(s.s();!(a=s.n()).done;){var o=a.value;o.SVGNode=this.drawLabel(o,r.GraphicalLayers.Notes)}}catch(u){s.e(u)}finally{s.f()}}this.drawableBoundingBoxElement&&this.drawBoundingBoxes(e.PositionAndShape,0,this.drawableBoundingBoxElement)}}},{key:"drawBoundingBoxes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=e.DataObject.constructor.name,a=!1;"all"===i&&(a=!0),(a||r===i)&&this.drawBoundingBox(e,void 0,!0,r,n),n++,e.ChildElements.forEach((function(e){return t.drawBoundingBoxes(e,n,i)}))}},{key:"drawBoundingBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,d=new s.RectangleF2D(e.AbsolutePosition.x+e.BorderMarginLeft,e.AbsolutePosition.y+e.BorderMarginTop,e.BorderMarginRight-e.BorderMarginLeft,e.BorderMarginBottom-e.BorderMarginTop);n&&(this.drawLineAsHorizontalRectangle(new a.GraphicalLine(new o.PointF2D(e.AbsolutePosition.x-1,e.AbsolutePosition.y),new o.PointF2D(e.AbsolutePosition.x+1,e.AbsolutePosition.y),.1,r.OutlineAndFillStyleEnum.BaseWritingColor,t),h-1),this.drawLineAsVerticalRectangle(new a.GraphicalLine(new o.PointF2D(e.AbsolutePosition.x,e.AbsolutePosition.y-1),new o.PointF2D(e.AbsolutePosition.x,e.AbsolutePosition.y+1),.1,r.OutlineAndFillStyleEnum.BaseWritingColor,t),h-1)),d=this.applyScreenTransformationForRect(d);var f=this.renderRectangle(d,r.GraphicalLayers.Background,h,t,.5);if(i){var m=new l.Label(i),v=new p;v.BitmapWidth=d.width,v.BitmapHeight=d.height,v.FontHeightInPixel=d.height,v.ScreenPosition=new o.PointF2D(d.x,d.y+12),this.renderLabel(new u.GraphicalLabel(m,.8,c.TextAlignmentEnum.CenterCenter,this.rules),h,v)}return f}},{key:"drawMarkedAreas",value:function(e){var t,n=b(e.GraphicalMarkedAreas);try{for(n.s();!(t=n.n()).done;){var i=t.value;i&&(i.systemRectangle&&this.drawRectangle(i.systemRectangle,r.GraphicalLayers.Background),i.settings&&(i.settings.SVGNode=this.drawLabel(i.settings,r.GraphicalLayers.Comment)),i.labelRectangle&&this.drawRectangle(i.labelRectangle,r.GraphicalLayers.Background),i.label&&(i.label.SVGNode=this.drawLabel(i.label,r.GraphicalLayers.Comment)))}}catch(a){n.e(a)}finally{n.f()}}},{key:"drawStaffLineSymbols",value:function(e){var t=e.ParentStaff.ParentInstrument,n=e.PositionAndShape.AbsolutePosition.x,i=e.PositionAndShape.AbsolutePosition.y+2,s=e.PositionAndShape.BorderRight;t.highlight&&this.drawingParameters.drawHighlights&&this.drawLineAsHorizontalRectangle(new a.GraphicalLine(new o.PointF2D(n,i),new o.PointF2D(n+s,i),4,r.OutlineAndFillStyleEnum.Highlighted),r.GraphicalLayers.Highlight);var u=f.MusicSymbolDrawingStyle.Disabled,l=d.MusicSymbol.PLAY,c=this.drawingParameters.drawActivitySymbols;switch(this.phonicScoreMode){case f.PhonicScoreModes.Midi:l=d.MusicSymbol.PLAY,this.midiPlaybackAvailable&&e.ParentStaff.audible&&(u=f.MusicSymbolDrawingStyle.PlaybackSymbols);break;case f.PhonicScoreModes.Following:l=d.MusicSymbol.MIC,e.ParentStaff.following&&(u=f.MusicSymbolDrawingStyle.FollowSymbols);break;default:c=!1}if(c){var h=new o.PointF2D(n+s+2,i);this.drawSymbol(l,u,h)}if(this.drawingParameters.drawErrors){var p,m=b(e.Measures);try{for(m.s();!(p=m.n()).done;){var v=p.value,g=v.PositionAndShape,y=g.AbsolutePosition.x,S=g.AbsolutePosition.y+2;v.hasError&&this.graphicalMusicSheet.ParentMusicSheet.DrawErroneousMeasures&&this.drawLineAsHorizontalRectangle(new a.GraphicalLine(new o.PointF2D(y,S),new o.PointF2D(y+g.BorderRight,S),4,r.OutlineAndFillStyleEnum.ErrorUnderlay),r.GraphicalLayers.MeasureError)}}catch(x){m.e(x)}finally{m.f()}}}}]),e}()},158:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSymbol=void 0,(n=t.MusicSymbol||(t.MusicSymbol={}))[n.Unused_first_Symbol=0]="Unused_first_Symbol",n[n.BLACK_HEAD=1]="BLACK_HEAD",n[n.UPWARDS_TAIL=2]="UPWARDS_TAIL",n[n.DOWNWARDS_TAIL=3]="DOWNWARDS_TAIL",n[n.UPWARDS_DOUBLE_TAIL=4]="UPWARDS_DOUBLE_TAIL",n[n.DOWNWARDS_DOUBLE_TAIL=5]="DOWNWARDS_DOUBLE_TAIL",n[n.UPWARDS_TRIPLE_TAIL=6]="UPWARDS_TRIPLE_TAIL",n[n.DOWNWARDS_TRIPLE_TAIL=7]="DOWNWARDS_TRIPLE_TAIL",n[n.UPWARDS_QUAD_TAIL=8]="UPWARDS_QUAD_TAIL",n[n.DOWNWARDS_QUAD_TAIL=9]="DOWNWARDS_QUAD_TAIL",n[n.ROUND_HEAD=10]="ROUND_HEAD",n[n.WHITE_HEAD=11]="WHITE_HEAD",n[n.G_CLEF=12]="G_CLEF",n[n.F_CLEF=13]="F_CLEF",n[n.C_CLEF=14]="C_CLEF",n[n.BREVE=15]="BREVE",n[n.BREVE_REST=16]="BREVE_REST",n[n.COMMON_TIME=17]="COMMON_TIME",n[n.CUT_TIME=18]="CUT_TIME",n[n.WHOLE_REST=19]="WHOLE_REST",n[n.HALF_REST=20]="HALF_REST",n[n.QUARTER_REST=21]="QUARTER_REST",n[n.EIGHTH_REST=22]="EIGHTH_REST",n[n.SIXTEENTH_REST=23]="SIXTEENTH_REST",n[n.THIRTYSECOND_REST=24]="THIRTYSECOND_REST",n[n.SIXTYFOURTH_REST=25]="SIXTYFOURTH_REST",n[n.FLAT=26]="FLAT",n[n.SHARP=27]="SHARP",n[n.NATURAL=28]="NATURAL",n[n.DOUBLE_FLAT=29]="DOUBLE_FLAT",n[n.DOUBLE_SHARP=30]="DOUBLE_SHARP",n[n.ZERO=31]="ZERO",n[n.ONE=32]="ONE",n[n.TWO=33]="TWO",n[n.THREE=34]="THREE",n[n.FOUR=35]="FOUR",n[n.FIVE=36]="FIVE",n[n.SIX=37]="SIX",n[n.SEVEN=38]="SEVEN",n[n.EIGHT=39]="EIGHT",n[n.NINE=40]="NINE",n[n.DOT=41]="DOT",n[n.FERMATA=42]="FERMATA",n[n.INVERTED_FERMATA=43]="INVERTED_FERMATA",n[n.SPICCATO=44]="SPICCATO",n[n.TENUTO=45]="TENUTO",n[n.MARCATO=46]="MARCATO",n[n.MARCATISSIMO=47]="MARCATISSIMO",n[n.INVERTED_MARCATISSIMO=48]="INVERTED_MARCATISSIMO",n[n.P=49]="P",n[n.F=50]="F",n[n.S=51]="S",n[n.Z=52]="Z",n[n.M=53]="M",n[n.R=54]="R",n[n.SEGNO=55]="SEGNO",n[n.CODA=56]="CODA",n[n.DRUM_CLEF=57]="DRUM_CLEF",n[n.G_CLEF_SUB8=58]="G_CLEF_SUB8",n[n.G_CLEF_SUPER8=59]="G_CLEF_SUPER8",n[n.G_CLEF_SUB15=60]="G_CLEF_SUB15",n[n.G_CLEF_SUPER15=61]="G_CLEF_SUPER15",n[n.F_CLEF_SUB8=62]="F_CLEF_SUB8",n[n.F_CLEF_SUPER8=63]="F_CLEF_SUPER8",n[n.F_CLEF_SUB15=64]="F_CLEF_SUB15",n[n.F_CLEF_SUPER15=65]="F_CLEF_SUPER15",n[n.DOWN_BOW=66]="DOWN_BOW",n[n.MORDENT=67]="MORDENT",n[n.INVERTED_MORDENT=68]="INVERTED_MORDENT",n[n.TURN=69]="TURN",n[n.INVERTED_TURN=70]="INVERTED_TURN",n[n.LEFTHAND_PIZZICATO=71]="LEFTHAND_PIZZICATO",n[n.RELEASE_PED=72]="RELEASE_PED",n[n.ENGAGE_PED=73]="ENGAGE_PED",n[n.VA8=74]="VA8",n[n.VB8=75]="VB8",n[n.TRILL=76]="TRILL",n[n.MA15=77]="MA15",n[n.MB15=78]="MB15",n[n.HIGH=79]="HIGH",n[n.PLAY=80]="PLAY",n[n.MIC=81]="MIC",n[n.SNAP_PIZZICATO=82]="SNAP_PIZZICATO",n[n.NATURAL_HARMONIC=83]="NATURAL_HARMONIC",n[n.EditPen=84]="EditPen",n[n.PEDAL_BRACKET=85]="PEDAL_BRACKET",n[n.PEDAL_MIXED=86]="PEDAL_MIXED",n[n.PEDAL_SYMBOL=87]="PEDAL_SYMBOL"},7142:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSystem=void 0;var r=n(6842),a=n(8911),s=n(1797),o=n(1274),u=n(9946),l=n(4785),f=n(9086),p=n(6894),m=i(n(8805)),v=n(1225),S=n(2255),x=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).needsToBeRedrawn=!0,i.staffLines=[],i.graphicalMeasures=[],i.labels=new m.default,i.measureNumberLabels=[],i.objectsToRedraw=[],i.instrumentBrackets=[],i.groupBrackets=[],i.graphicalMarkedAreas=[],i.systemLines=[],i.breaksPage=!1,i.id=e,i.boundingBox=new a.BoundingBox(c(i)),i.maxLabelLength=0,i}return y(n,[{key:"Parent",get:function(){return this.parent},set:function(e){if(this.parent){var t=this.parent.MusicSystems.indexOf(this,0);t>-1&&this.parent.MusicSystems.splice(t,1)}this.parent=e,this.boundingBox.Parent=e.PositionAndShape}},{key:"NextSystem",get:function(){var e=this.Parent.MusicSystems.indexOf(this);return e!==this.Parent.MusicSystems.length?this.Parent.MusicSystems[e+1]:void 0}},{key:"StaffLines",get:function(){return this.staffLines}},{key:"GraphicalMeasures",get:function(){return this.graphicalMeasures}},{key:"MeasureNumberLabels",get:function(){return this.measureNumberLabels}},{key:"Labels",get:function(){return this.labels.values()}},{key:"ObjectsToRedraw",get:function(){return this.objectsToRedraw}},{key:"InstrumentBrackets",get:function(){return this.instrumentBrackets}},{key:"GroupBrackets",get:function(){return this.groupBrackets}},{key:"GraphicalMarkedAreas",get:function(){return this.graphicalMarkedAreas}},{key:"SystemLines",get:function(){return this.systemLines}},{key:"Id",get:function(){return this.id}},{key:"createSystemLeftLine",value:function(e,t,n){var i=-e/2;n&&(i=this.maxLabelLength+t-e/2);var r,a=this.staffLines[0].Measures[0];this.staffLines.length>1&&(r=this.staffLines[this.staffLines.length-1].Measures[0]);var s=this.createSystemLine(i,e,p.SystemLinesEnum.SingleThin,v.SystemLinePosition.MeasureBegin,this,a,r);this.SystemLines.push(s),s.PositionAndShape.RelativePosition=new f.PointF2D(i,0),s.PositionAndShape.BorderLeft=0,s.PositionAndShape.BorderRight=e,s.PositionAndShape.BorderTop=s.PositionAndShape.Parent.BorderTop,s.PositionAndShape.BorderBottom=s.PositionAndShape.Parent.BorderBottom,this.createLinesForSystemLine(s)}},{key:"createVerticalLineForMeasure",value:function(e,t,n,i,r,a){var s=a.ParentStaffLine,o=new f.PointF2D(s.PositionAndShape.RelativePosition.x,s.PositionAndShape.RelativePosition.y),u=s.ParentStaff.ParentInstrument.Staves;if(s.ParentStaff===u[0]){var l;u.length>1&&(l=this.getBottomStaffLine(s).Measures[r]);var c=this.createSystemLine(e,t,n,i,this,a,l),h=o.x+e;c.PositionAndShape.RelativePosition=new f.PointF2D(h,0),c.PositionAndShape.BorderLeft=0,c.PositionAndShape.BorderRight=t,this.SystemLines.push(c)}}},{key:"setYPositionsToVerticalLineObjectsAndCreateLines",value:function(e){}},{key:"calculateBorders",value:function(e){}},{key:"alignBeginInstructions",value:function(){}},{key:"GetLeftBorderAbsoluteXPosition",value:function(){return this.StaffLines[0].PositionAndShape.AbsolutePosition.x+this.StaffLines[0].Measures[0].beginInstructionsWidth}},{key:"GetRightBorderAbsoluteXPosition",value:function(){return this.StaffLines[0].PositionAndShape.AbsolutePosition.x+this.StaffLines[0].StaffLines[0].End.x}},{key:"AddGraphicalMeasures",value:function(e){for(var t=0,n=e.length;t<n;++t)e[t].ParentMusicSystem=this;this.graphicalMeasures.push(e)}},{key:"GetSystemsFirstTimeStamp",value:function(){return this.graphicalMeasures[0][0].parentSourceMeasure.AbsoluteTimestamp}},{key:"GetSystemsLastTimeStamp",value:function(){var e=this.graphicalMeasures[this.graphicalMeasures.length-1][0].parentSourceMeasure;return s.Fraction.plus(e.AbsoluteTimestamp,e.Duration)}},{key:"createInstrumentBrackets",value:function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n];if(r.Staves.length>1){for(var a=void 0,s=void 0,o=0,u=this.staffLines.length;o<u;++o){var l=this.staffLines[o];l.ParentStaff===r.Staves[0]&&(a=l),l.ParentStaff===r.Staves[r.Staves.length-1]&&(s=l)}a&&s&&this.createInstrumentBracket(a,s)}}}},{key:"createGroupBrackets",value:function(e,t,n){for(var i=0,r=e.length;i<r;++i){var a=e[i];if(!(a.InstrumentalGroups.length<1)){var s=this.findFirstVisibleInstrumentInInstrumentalGroup(a),o=this.findLastVisibleInstrumentInInstrumentalGroup(a);if(s&&o){for(var u=void 0,l=void 0,c=0,h=this.staffLines.length;c<h;++c){var d=this.staffLines[c];d.ParentStaff===s.Staves[0]&&(u=d),d.ParentStaff===o.Staves[0]&&(l=d)}u&&l&&this.createGroupBracket(u,l,n),a.InstrumentalGroups.length<1||this.createGroupBrackets(a.InstrumentalGroups,t,n+1)}}}}},{key:"createMusicSystemLabel",value:function(e,t,n){for(var i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t,s=0,l=this.staffLines.length;s<l;++s){var c=this.staffLines[s].ParentStaff.ParentInstrument,h=void 0;if(r)h=c.NameLabel,this.rules.RenderPartNames&&(null==h?void 0:h.print)||(h=new S.Label("",c.NameLabel.textAlignment,c.NameLabel.font),t=0);else{if(!this.rules.RenderPartAbbreviations||!this.rules.RenderPartNames||1===this.staffLines.length||!c.PartAbbreviation||""===c.PartAbbreviation)return;var d=c.PartAbbreviation;h=new S.Label(d,c.NameLabel.textAlignment,c.NameLabel.font)}if(null===(i=null==c?void 0:c.NameLabel)||void 0===i?void 0:i.print){var f=new u.GraphicalLabel(h,e,o.TextAlignmentEnum.LeftCenter,this.rules,this.boundingBox);f.setLabelPositionAndShapeBorders(),this.labels.setValue(c,f)}else t=0}this.maxLabelLength=0;for(var p=this.labels.values(),m=0,v=p.length;m<v;++m){var g=p[m];g.Label.print&&g.PositionAndShape.Size.width>this.maxLabelLength&&(this.maxLabelLength=g.PositionAndShape.Size.width,t=a)}this.updateMusicSystemStaffLineXPosition(t)}},{key:"setMusicSystemLabelsYPosition",value:function(){var e=this;this.labels.forEach((function(t,n){for(var i=0,r=0,a=0;a<e.staffLines.length;a++)if(e.staffLines[a].ParentStaff.ParentInstrument===t){for(var s=a;s<e.staffLines.length;s++){var o=e.staffLines[s];if(o.ParentStaff.ParentInstrument!==t)break;i+=o.PositionAndShape.RelativePosition.y,r++}break}r>0&&(n.PositionAndShape.RelativePosition=new f.PointF2D(0,i/r+2))}))}},{key:"checkStaffEntriesForStaffEntryLink",value:function(){for(var e=!1,t=!1,n=0;n<this.staffLines.length-1;n++){for(var i=0,r=this.staffLines[n].Measures.length;i<r;++i)for(var a=this.staffLines[n].Measures[i],s=0,o=a.staffEntries.length;s<o;++s)a.staffEntries[s].sourceStaffEntry.Link&&(e=!0);for(var u=0,l=this.staffLines[n+1].Measures.length;u<l;++u)for(var c=this.staffLines[n+1].Measures[u],h=0,d=c.staffEntries.length;h<d;++h)c.staffEntries[h].sourceStaffEntry.Link&&(t=!0)}return!(!e||!t)}},{key:"getBottomStaffLine",value:function(e){var t,n=e.ParentStaff.ParentInstrument.Staves,i=n[n.length-1],r=b(e.ParentMusicSystem.staffLines);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.ParentStaff===i)return a}}catch(s){r.e(s)}finally{r.f()}}},{key:"createSystemLine",value:function(e,t,n,i,r,a,s){throw new Error("not implemented")}},{key:"createLinesForSystemLine",value:function(e){}},{key:"calcBracketsWidth",value:function(){for(var e=0,t=0,n=this.GroupBrackets.length;t<n;++t){var i=this.GroupBrackets[t];e=Math.max(e,i.PositionAndShape.Size.width)}for(var r=0,a=this.InstrumentBrackets.length;r<a;++r){var s=this.InstrumentBrackets[r];e=Math.max(e,s.PositionAndShape.Size.width)}return e}},{key:"createInstrumentBracket",value:function(e,t){}},{key:"createGroupBracket",value:function(e,t,n){}},{key:"findFirstVisibleInstrumentInInstrumentalGroup",value:function(e){for(var t=0,n=e.InstrumentalGroups.length;t<n;++t){var i=e.InstrumentalGroups[t];if(!(i instanceof r.Instrument))return this.findFirstVisibleInstrumentInInstrumentalGroup(i);if(!0===i.Visible)return i}}},{key:"findLastVisibleInstrumentInInstrumentalGroup",value:function(e){for(var t,n=e.InstrumentalGroups.length-1;n>=0;n--){if(!((t=e.InstrumentalGroups[n])instanceof r.Instrument))return this.findLastVisibleInstrumentInInstrumentalGroup(t);if(!0===t.Visible)return t}}},{key:"updateMusicSystemStaffLineXPosition",value:function(e){for(var t=0,n=this.StaffLines.length;t<n;++t){var i=this.StaffLines[t],r=i.PositionAndShape.RelativePosition;r.x=this.maxLabelLength+e,i.PositionAndShape.RelativePosition=r,i.PositionAndShape.BorderRight=this.boundingBox.Size.width-this.maxLabelLength-e;for(var a=0;a<i.StaffLines.length;a++){var s=new f.PointF2D(i.PositionAndShape.Size.width,i.StaffLines[a].End.y);i.StaffLines[a].End=s}}}}]),n}(l.GraphicalObject);t.MusicSystem=x},5623:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeasureBuildParameters=t.SystemBuildParameters=t.MusicSystemBuilder=void 0;var i=n(599),r=n(3331),a=n(5198),s=n(289),o=n(9086),u=n(6729),l=n(6894),c=n(4040),h=n(289),d=n(2337),f=n(1225);t.MusicSystemBuilder=function(){function e(){g(this,e),this.musicSystems=[],this.globalSystemIndex=0,this.leadSheet=!1}return y(e,[{key:"initialize",value:function(e,t,n){this.leadSheet=e.LeadSheet,this.graphicalMusicSheet=e,this.rules=this.graphicalMusicSheet.ParentMusicSheet.Rules,this.measureList=t,this.numberOfVisibleStaffLines=n,this.activeRhythm=new Array(this.numberOfVisibleStaffLines),this.activeKeys=new Array(this.numberOfVisibleStaffLines),this.activeClefs=new Array(this.numberOfVisibleStaffLines),this.initializeActiveInstructions(this.measureList[0])}},{key:"buildMusicSystems",value:function(){var e,t,n,i=this.getFullPageSystemWidth(),r=!1;for(this.measureListIndex=0,this.currentSystemParams=new p,this.currentSystemParams.currentSystem=this.initMusicSystem();this.measureListIndex<this.measureList.length;){var a=this.measureList[this.measureListIndex];if(a&&a[0]){for(var s=0,o=a.length;s<o;++s)a[s].resetLayout();var u=a[0].parentSourceMeasure,l=u.HasEndLine,c=l&&this.rules.NewPartAndSystemAfterFinalBarline,h=this.currentSystemParams.IsSystemStartMeasure();u.IsSystemStartMeasure=h;var d=u===this.graphicalMusicSheet.ParentMusicSheet.getFirstSourceMeasure(),f=this.rules.MeasureLeftMargin,m=0,v=this.getMeasureStartLine();if(f+=this.getLineWidth(a[0],v,h),!this.leadSheet){var g=!1;r&&this.rules.ShowRhythmAgainAfterPartEndOrFinalBarline&&(g=!0),f+=this.addBeginInstructions(a,h,d||g),m+=this.addEndInstructions(a)}for(var y=0,b=0;b<this.numberOfVisibleStaffLines;b++)y=Math.max(y,a[b].minimumStaffEntriesWidth);var S=this.getMeasureEndLine();m+=this.getLineWidth(a[0],S,h);var x=void 0,_=this.rules.MeasureLeftMargin;if(this.measureListIndex+1<this.measureList.length){var E=this.measureList[this.measureListIndex+1];(null==(x=null===(e=E[0])||void 0===e?void 0:e.parentSourceMeasure)?void 0:x.hasBeginInstructions())&&(_+=this.addBeginInstructions(E,!1,!1))}var k=f+m+y;(null===(n=null===(t=a[0])||void 0===t?void 0:t.parentSourceMeasure)||void 0===n?void 0:n.multipleRestMeasures)&&(k=this.rules.MultipleRestMeasureDefaultWidth);var M=this.currentSystemParams.currentWidth+k+_<i,w=this.rules.NewPageAtXMLNewPageAttribute&&u.printNewPageXml,P=w||this.rules.NewSystemAtXMLNewSystemAttribute&&u.printNewSystemXml;if(h||M&&!P){if(this.addMeasureToSystem(a,v,S,k,f,y,m),this.updateActiveClefs(u,a),this.measureListIndex++,c){if(this.rules.MaxSystemToDrawNumber===this.musicSystems.length)return this.finalizeCurrentSystem(a,!this.rules.StretchLastSystemLine,!1),this.musicSystems;this.finalizeCurrentAndCreateNewSystem(a,!this.rules.StretchLastSystemLine,!1)}r=l}else{if(this.rules.MaxSystemToDrawNumber===this.musicSystems.length)return this.finalizeCurrentSystem(a,!1,!0,w),this.musicSystems;this.finalizeCurrentAndCreateNewSystem(a,!1,!0,w)}}else this.measureListIndex++}if(this.currentSystemParams.systemMeasures.length>0){if(this.rules.MaxSystemToDrawNumber===this.musicSystems.length)return this.finalizeCurrentSystem(this.measureList[this.measureList.length-1],!this.rules.StretchLastSystemLine,!1),this.musicSystems;this.finalizeCurrentAndCreateNewSystem(this.measureList[this.measureList.length-1],!this.rules.StretchLastSystemLine,!1)}return this.musicSystems}},{key:"calculateSystemYLayout",value:function(){var e,t=b(this.musicSystems);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.optimizeDistanceBetweenStaffLines(n)}}catch(i){t.e(i)}finally{t.f()}this.calculateMusicSystemsRelativePositions()}},{key:"setMeasureWidth",value:function(e,t,n,i){for(var r=0,a=e.length;r<a;++r){var s=e[r];s.setWidth(t),n>0&&(s.beginInstructionsWidth=n),i>0&&(s.endInstructionsWidth=i)}}},{key:"finalizeCurrentAndCreateNewSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.finalizeCurrentSystem(e,t,n,i),this.currentSystemParams=new p,void 0!==e&&this.measureListIndex<this.measureList.length&&(this.currentSystemParams.currentSystem=this.initMusicSystem())}},{key:"finalizeCurrentSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.currentSystemParams.currentSystem.breaksPage=i,this.adaptRepetitionLineWithIfNeeded(),void 0!==e&&n&&this.checkAndCreateExtraInstructionMeasure(e),this.stretchMusicSystem(t)}},{key:"adaptRepetitionLineWithIfNeeded",value:function(){var e=this.currentSystemParams.systemMeasures;if(e.length>=1){var t=this.currentSystemParams.currentSystem.GraphicalMeasures[this.currentSystemParams.currentSystem.GraphicalMeasures.length-1],n=0,i=e[e.length-1];i.endLine===l.SystemLinesEnum.DotsBoldBoldDots&&(i.endLine=l.SystemLinesEnum.DotsThinBold,n=t[0].getLineWidth(l.SystemLinesEnum.DotsBoldBoldDots)/2-t[0].getLineWidth(l.SystemLinesEnum.DotsThinBold)),this.currentSystemParams.currentSystemFixWidth-=n;for(var r=0,a=t.length;r<a;++r)t[r].endInstructionsWidth-=n}}},{key:"addMeasureToSystem",value:function(e,t,n,i,r,a,s){this.currentSystemParams.systemMeasures.push({beginLine:t,endLine:n}),this.setMeasureWidth(e,i,r,s),this.addStaveMeasuresToSystem(e),this.currentSystemParams.currentWidth+=i,this.currentSystemParams.currentSystemFixWidth+=r+s,this.currentSystemParams.currentSystemVarWidth+=a,this.currentSystemParams.systemMeasureIndex++}},{key:"initMusicSystem",value:function(){var e=c.MusicSheetCalculator.symbolFactory.createMusicSystem(this.globalSystemIndex++,this.rules);return this.musicSystems.push(e),this.layoutSystemStaves(e),e.createMusicSystemLabel(this.rules.InstrumentLabelTextHeight,this.rules.SystemLabelsRightMargin,this.rules.LabelMarginBorderFactor,1===this.musicSystems.length),e}},{key:"getFullPageSystemWidth",value:function(){return this.graphicalMusicSheet.ParentMusicSheet.pageWidth-this.rules.PageLeftMargin-this.rules.PageRightMargin-this.rules.SystemLeftMargin-this.rules.SystemRightMargin}},{key:"layoutSystemStaves",value:function(e){var t=this.getFullPageSystemWidth(),n=e.PositionAndShape;n.BorderLeft=0,n.BorderRight=t,n.BorderTop=0;for(var i=[],r=this.graphicalMusicSheet.ParentMusicSheet.Instruments,a=0,s=r.length;a<s;++a){var o=r[a];if(o.Visible&&0!==o.Voices.length)for(var u=0,l=o.Staves.length;u<l;++u){var c=o.Staves[u];i.push(c)}}var h=!1;if(this.leadSheet)for(var d=0,f=i.length;d<f;++d)if(i[d].ParentInstrument.LyricVersesNumbers.length>1){h=!0;break}for(var p=0,m=0;m<i.length;m++)this.addStaffLineToMusicSystem(e,p,i[m]),p+=this.rules.StaffHeight,m+1<i.length&&(p+=this.leadSheet&&!h?2.5:i[m].ParentInstrument===i[m+1].ParentInstrument?this.rules.BetweenStaffDistance:this.rules.StaffDistance);n.BorderBottom=p}},{key:"addStaffLineToMusicSystem",value:function(e,t,n){if(e){var i=c.MusicSheetCalculator.symbolFactory.createStaffLine(e,n);e.StaffLines.push(i);var r=i.PositionAndShape,a=new o.PointF2D;a.x=0,r.BorderRight=e.PositionAndShape.Size.width,a.y=t,r.RelativePosition=a,r.BorderLeft=0,r.BorderTop=0,r.BorderBottom=this.rules.StaffHeight;for(var s=0;s<5;s++){var l=new o.PointF2D;l.x=0,l.y=s*this.rules.StaffHeight/4;var h=new o.PointF2D;h.x=i.PositionAndShape.Size.width,h.y=s*this.rules.StaffHeight/4,this.leadSheet&&(l.y=h.y=0),i.StaffLines[s]=new u.GraphicalLine(l,h,this.rules.StaffLineWidth)}}}},{key:"initializeActiveInstructions",value:function(e){var t=this.graphicalMusicSheet.ParentMusicSheet.getFirstSourceMeasure();if(t){this.visibleStaffIndices=this.graphicalMusicSheet.getVisibleStavesIndicesFromSourceMeasure(e);for(var n=0,i=this.visibleStaffIndices.length;n<i;n++){var r=this.visibleStaffIndices[n],s=this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(t,r);this.activeClefs[n]=t.FirstInstructionsStaffEntries[r].Instructions[0];var o=t.FirstInstructionsStaffEntries[r].Instructions[1];if(o){var u=a.KeyInstruction.copy(o);u=this.transposeKeyInstruction(u,s),this.activeKeys[n]=u}var l=t.FirstInstructionsStaffEntries[r].Instructions[2];this.activeRhythm[n]=l}}}},{key:"transposeKeyInstruction",value:function(e,t){var n=t.getTransposedHalftones();return n!==e.isTransposedBy&&t.ParentStaff.ParentInstrument.MidiInstrumentId!==h.MidiInstrument.Percussion&&void 0!==c.MusicSheetCalculator.transposeCalculator&&c.MusicSheetCalculator.transposeCalculator.transposeKey(e,n),e}},{key:"addBeginInstructions",value:function(e,t,n){var i=e.length;if(0===i)return 0;for(var r=0,a=e[0].parentSourceMeasure,s=0;s<i;++s){var o=e[s],u=this.visibleStaffIndices[s],l=a.FirstInstructionsStaffEntries[u],c=this.AddInstructionsAtMeasureBegin(l,o,s,n,t);r=Math.max(r,c)}return r}},{key:"addEndInstructions",value:function(e){var t=e.length;if(0===t)return 0;for(var n=.5,i=e[0].parentSourceMeasure,r=0;r<t;r++){var a=e[r],s=this.visibleStaffIndices[r],o=i.LastInstructionsStaffEntries[s],u=this.addInstructionsAtMeasureEnd(o,a,e);n=Math.max(n,u)}return n}},{key:"AddInstructionsAtMeasureBegin",value:function(e,t,n,i,o){var u,l,c,h,d=0;if(e)for(var f=0,p=e.Instructions.length;f<p;++f){var m=e.Instructions[f];m instanceof s.ClefInstruction?l=m:m instanceof a.KeyInstruction?c=m:m instanceof r.RhythmInstruction&&(h=m)}o&&(l||(l=this.activeClefs[n]),c||(c=a.KeyInstruction.copy(this.activeKeys[n])),i&&!h&&(h=this.activeRhythm[n]));var v=!1,g=!1,y=!1;if(l?(t.addClefAtBegin(l),v=!0):l=this.activeClefs[n],c){c=this.transposeKeyInstruction(c,t);var b=o?void 0:this.activeKeys[n];t.addKeyAtBegin(c,b,l),g=!0}if(void 0!==h&&h.PrintObject&&this.rules.RenderTimeSignatures){var S=!0,x=t.MeasureNumber-1-this.rules.MinMeasureToDrawIndex;if(t.MeasureNumber-1>=0&&this.measureList[x]){var _=null===(u=this.measureList[x][0])||void 0===u?void 0:u.parentSourceMeasure;(null==_?void 0:_.ImplicitMeasure)&&(null==_?void 0:_.RhythmPrinted)&&(S=!1)}S&&(t.addRhythmAtBegin(h),t.parentSourceMeasure.RhythmPrinted=h,y=!0)}return(v||g||y)&&(d+=t.beginInstructionsWidth,y&&(d+=this.rules.RhythmRightMargin)),d}},{key:"addInstructionsAtMeasureEnd",value:function(e,t,n){if(!e||!e.Instructions||0===e.Instructions.length)return 0;for(var i=0,r=e.Instructions.length;i<r;++i){var a=e.Instructions[i];if(a instanceof s.ClefInstruction){var o=a;t.addClefAtEnd(o);var u,l=b(n);try{for(l.s();!(u=l.n()).done;){var c=u.value;c!==t&&c.addClefAtEnd(o,!1)}}catch(h){l.e(h)}finally{l.f()}}}return this.rules.MeasureRightMargin+t.endInstructionsWidth}},{key:"updateActiveClefs",value:function(e,t){for(var n=0,i=t.length;n<i;n++){var o=this.visibleStaffIndices[n],u=e.FirstInstructionsStaffEntries[o];if(u)for(var l=0,c=u.Instructions.length;l<c;++l){var h=u.Instructions[l];h instanceof s.ClefInstruction?this.activeClefs[n]=h:h instanceof a.KeyInstruction?this.activeKeys[n]=h:h instanceof r.RhythmInstruction&&(this.activeRhythm[n]=h)}for(var d=e.getEntriesPerStaff(o),f=0,p=d.length;f<p;++f){var m=d[f];if(m.Instructions)for(var v=0,g=m.Instructions.length;v<g;++v){var y=m.Instructions[v];y instanceof s.ClefInstruction&&(this.activeClefs[n]=y)}}var b=e.LastInstructionsStaffEntries[o];if(b)for(var S=b.Instructions,x=0,_=S.length;x<_;++x){var E=S[x];E instanceof s.ClefInstruction&&(this.activeClefs[n]=E)}}}},{key:"checkAndCreateExtraInstructionMeasure",value:function(e){for(var t=e[0].parentSourceMeasure.FirstInstructionsStaffEntries,n=[],i=0,s=e.length;i<s;++i){var o=e[i];n.push(t[o.ParentStaff.idInMusicSheet])}for(var u=0,c=0,h=n.length;c<h;++c){var d=n[c];if(d){for(var f=d.Instructions,p=void 0,m=void 0,v=0,g=f.length;v<g;++v){var y=f[v];y instanceof a.KeyInstruction&&y.Key!==this.activeKeys[c].Key&&(p=y),y instanceof r.RhythmInstruction&&y!==this.activeRhythm[c]&&(m=y)}if(void 0!==p||m){var b=this.addExtraInstructionMeasure(c,p,m);u=Math.max(u,b)}}}u>0&&(this.currentSystemParams.systemMeasures.push({beginLine:l.SystemLinesEnum.None,endLine:l.SystemLinesEnum.None}),this.currentSystemParams.currentWidth+=u,this.currentSystemParams.currentSystemFixWidth+=u)}},{key:"addExtraInstructionMeasure",value:function(e,t,n){var i=this.currentSystemParams.currentSystem,r=c.MusicSheetCalculator.symbolFactory.createExtraGraphicalMeasure(i.StaffLines[e]);[].push(r),t&&r.addKeyAtBegin(t,this.activeKeys[e],this.activeClefs[e]),void 0!==n&&n.PrintObject&&r.addRhythmAtBegin(n),r.PositionAndShape.BorderLeft=0,r.PositionAndShape.BorderTop=0,r.PositionAndShape.BorderBottom=this.rules.StaffHeight;var a=this.rules.MeasureLeftMargin+r.beginInstructionsWidth+this.rules.MeasureRightMargin;return r.PositionAndShape.BorderRight=a,i.StaffLines[e].Measures.push(r),a}},{key:"addStaveMeasuresToSystem",value:function(e){if(e[0]){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);for(var i=this.currentSystemParams.currentSystem,r=0;r<this.numberOfVisibleStaffLines;r++){var a=t[r];i.StaffLines[r].Measures.push(a),a.ParentStaffLine=i.StaffLines[r]}i.AddGraphicalMeasures(t)}}},{key:"getMeasureStartLine",value:function(){if(this.thisMeasureBeginsLineRepetition()){var e=this.currentSystemParams.IsSystemStartMeasure(),t=0===this.measureListIndex;if(this.previousMeasureEndsLineRepetition()&&!e)return l.SystemLinesEnum.DotsBoldBoldDots;if(!t)return l.SystemLinesEnum.BoldThinDots}return l.SystemLinesEnum.None}},{key:"getMeasureEndLine",value:function(){var e;try{if(e=this.measureList[this.measureListIndex][0].parentSourceMeasure,this.rules.RenderMultipleRestMeasures&&e.multipleRestMeasures>1){var t=Math.min(this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length-1,e.measureListIndex+e.multipleRestMeasures-1);e=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures[t]}}finally{}return this.nextMeasureBeginsLineRepetition()&&this.thisMeasureEndsLineRepetition()?l.SystemLinesEnum.DotsBoldBoldDots:this.thisMeasureEndsLineRepetition()?l.SystemLinesEnum.DotsThinBold:this.nextMeasureHasKeyInstructionChange()||this.thisMeasureEndsWordRepetition()||this.nextMeasureBeginsWordRepetition()?l.SystemLinesEnum.DoubleThin:e&&void 0!==e.endingBarStyleEnum?e.endingBarStyleEnum:l.SystemLinesEnum.SingleThin}},{key:"getLineWidth",value:function(e,t,n){var i=e.getLineWidth(t);return t===l.SystemLinesEnum.DotsBoldBoldDots&&(i/=2),n&&t===l.SystemLinesEnum.BoldThinDots&&(i+=this.rules.DistanceBetweenLastInstructionAndRepetitionBarline),i}},{key:"previousMeasureEndsLineRepetition",value:function(){if(0===this.measureListIndex)return!1;for(var e=0,t=this.measureList[this.measureListIndex-1].length;e<t;++e)if(this.measureList[this.measureListIndex-1][e].endsWithLineRepetition())return!0;return!1}},{key:"thisMeasureBeginsLineRepetition",value:function(){for(var e=0,t=this.measureList[this.measureListIndex].length;e<t;++e)if(this.measureList[this.measureListIndex][e].beginsWithLineRepetition())return!0;return!1}},{key:"nextMeasureBeginsLineRepetition",value:function(){var e=this.measureListIndex+1;if(e>=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length||!this.measureList[e])return!1;for(var t=0,n=this.measureList[e].length;t<n;++t)if(this.measureList[e][t].beginsWithLineRepetition())return!0;return!1}},{key:"thisMeasureEndsLineRepetition",value:function(){for(var e=0,t=this.measureList[this.measureListIndex].length;e<t;++e)if(this.measureList[this.measureListIndex][e].endsWithLineRepetition())return!0;return!1}},{key:"nextMeasureBeginsWordRepetition",value:function(){var e=this.measureListIndex+1;if(e>=this.graphicalMusicSheet.ParentMusicSheet.SourceMeasures.length||e>this.measureList.length-1)return!1;for(var t=0,n=this.measureList[e].length;t<n;++t)if(this.measureList[e][t].beginsWithWordRepetition())return!0;return!1}},{key:"thisMeasureEndsWordRepetition",value:function(){for(var e=0,t=this.measureList[this.measureListIndex].length;e<t;++e)if(this.measureList[this.measureListIndex][e].endsWithWordRepetition())return!0;return!1}},{key:"nextMeasureHasKeyInstructionChange",value:function(){return void 0!==this.getNextMeasureKeyInstruction()}},{key:"getNextMeasureKeyInstruction",value:function(){var e;if(this.measureListIndex<this.measureList.length-1)for(var t=0;t<this.measureList[this.measureListIndex].length;t++){var n=null===(e=this.measureList[this.measureListIndex+1][t])||void 0===e?void 0:e.parentSourceMeasure;if(!n)return;return n.getKeyInstruction(this.visibleStaffIndices[t])}}},{key:"calculateXScalingFactor",value:function(e,t){return Math.abs(t-0)<1e-5||Math.abs(e-0)<1e-5?1:(this.currentSystemParams.currentSystem.StaffLines[0].PositionAndShape.Size.width-e)/t}},{key:"stretchMusicSystem",value:function(e){var t=this.calculateXScalingFactor(this.currentSystemParams.currentSystemFixWidth,this.currentSystemParams.currentSystemVarWidth);e&&(t=Math.min(t,this.rules.LastSystemMaxScalingFactor));for(var n=this.currentSystemParams.currentSystem,i=0,r=n.StaffLines.length;i<r;++i)for(var a=n.StaffLines[i],s=0,o=0;o<a.Measures.length;o++){var u=a.Measures[o];u.setPositionInStaffline(s);var c=u.beginInstructionsWidth;if(u.setWidth(c+u.minimumStaffEntriesWidth*t+u.endInstructionsWidth),o<this.currentSystemParams.systemMeasures.length){var h=this.currentSystemParams.systemMeasures[o].beginLine,d=u.getLineWidth(l.SystemLinesEnum.BoldThinDots);if(h===l.SystemLinesEnum.BoldThinDots){var p=s;0===o&&(p=s+u.beginInstructionsWidth-d),n.createVerticalLineForMeasure(p,d,h,f.SystemLinePosition.MeasureBegin,o,u)}}if(u.staffEntriesScaleFactor=t,u.layoutSymbols(),!(o+1<this.currentSystemParams.systemMeasures.length&&this.currentSystemParams.systemMeasures[o+1].beginLine===l.SystemLinesEnum.BoldThinDots)){var m=l.SystemLinesEnum.SingleThin;o<this.currentSystemParams.systemMeasures.length&&(m=this.currentSystemParams.systemMeasures[o].endLine);var v=u.getLineWidth(m),g=u.PositionAndShape.RelativePosition.x+u.PositionAndShape.BorderRight-v;m===l.SystemLinesEnum.DotsBoldBoldDots&&(g-=v/2),n.createVerticalLineForMeasure(g,v,m,f.SystemLinePosition.MeasureEnd,o,u)}s=u.PositionAndShape.RelativePosition.x+u.PositionAndShape.BorderRight}e&&this.decreaseMusicSystemBorders()}},{key:"decreaseMusicSystemBorders",value:function(){for(var e=this.currentSystemParams.currentSystem,t=d.CollectionUtil.last(e.StaffLines[0].Measures).PositionAndShape,n=t.RelativePosition.x+t.Size.width,i=0,r=e.StaffLines.length;i<r;++i){var a=e.StaffLines[i];a.PositionAndShape.BorderRight=n;for(var s=0,u=a.StaffLines.length;s<u;++s){var l=a.StaffLines[s];l.End=new o.PointF2D(n,l.End.y)}}e.PositionAndShape.BorderRight=n+this.currentSystemParams.maxLabelLength+this.rules.SystemLabelsRightMargin}},{key:"updateStaffLinesRelativePosition",value:function(e,t,n){for(var i=t;i<e.StaffLines.length;i++)e.StaffLines[i].PositionAndShape.RelativePosition.y=n;e.PositionAndShape.BorderBottom+=n}},{key:"createMusicPage",value:function(){var e=new i.GraphicalMusicPage(this.graphicalMusicSheet);return this.graphicalMusicSheet.MusicPages.push(e),e.PageNumber=this.graphicalMusicSheet.MusicPages.length,e.PositionAndShape.BorderLeft=0,e.PositionAndShape.BorderRight=this.graphicalMusicSheet.ParentMusicSheet.pageWidth,e.PositionAndShape.BorderTop=0,e.PositionAndShape.BorderBottom=this.rules.PageHeight,e.PositionAndShape.RelativePosition=new o.PointF2D(0,0),e}},{key:"addSystemToPage",value:function(e,t){e.MusicSystems.push(t),t.Parent=e}},{key:"optimizeDistanceBetweenStaffLines",value:function(e){if(!e.checkStaffEntriesForStaffEntryLink())for(var t=0;t<e.StaffLines.length-1;t++){for(var n=e.StaffLines[t].BottomLine,i=e.StaffLines[t+1].SkyLine,r=0,a=0;a<n.length;a++){for(var s=n[a],o=Math.max(0,a-6),u=Math.min(i.length-1,a+6),l=0,c=o;c<=u;c++)l=Math.min(l,i[c]);var h=s-l;r=Math.max(h,r)}r+=this.rules.MinSkyBottomDistBetweenStaves;var d=(r=Math.max(r,this.rules.StaffHeight+this.rules.MinimumStaffLineDistance))+e.StaffLines[t].PositionAndShape.RelativePosition.y;this.updateStaffLinesRelativePosition(e,t+1,d)}var f=e.StaffLines[0];e.PositionAndShape.BorderTop=f.PositionAndShape.RelativePosition.y+f.PositionAndShape.BorderTop;var p=e.StaffLines[e.StaffLines.length-1];e.PositionAndShape.BorderBottom=p.PositionAndShape.RelativePosition.y+p.PositionAndShape.BorderBottom}},{key:"calculateMusicSystemsRelativePositions",value:function(){for(var e=this.createMusicPage(),t=0,n=this.musicSystems[0],i=0,r=0;r<this.musicSystems.length;r++)if(n=this.musicSystems[r],0===e.MusicSystems.length){this.addSystemToPage(e,n),t=this.rules.CompactMode?this.rules.PageTopMarginNarrow:this.rules.PageTopMargin,1===this.graphicalMusicSheet.MusicPages.length&&this.rules.RenderTitle&&(t+=this.rules.TitleTopDistance+this.rules.SheetTitleHeight+this.rules.TitleBottomDistance);var a=new o.PointF2D(this.rules.PageLeftMargin+this.rules.SystemLeftMargin,t);n.PositionAndShape.RelativePosition=a,t+n.PositionAndShape.BorderBottom>this.rules.PageHeight-this.rules.PageBottomMargin&&++i<=4&&console.log("warning: could not fit a single system on page ".concat(e.PageNumber," and measure number ").concat(n.GraphicalMeasures[0][0].MeasureNumber,'.\n                            The PageFormat may be too small for this sheet."\n                            Will not give further warnings for all pages, only total.'))}else{var s=this.musicSystems[r-1],u=s.StaffLines[s.StaffLines.length-1],l=u.PositionAndShape,c=this.findRequiredDistanceWithSkyBottomLine(s,n);c+=this.rules.MinSkyBottomDistBetweenSystems,c=Math.max(c,this.rules.MinimumDistanceBetweenSystems+u.StaffHeight);var h=t+l.RelativePosition.y+c,d=h+n.PositionAndShape.BorderMarginBottom;if(this.rules.NewPageAtXMLNewPageAttribute&&s.breaksPage||!(d<this.rules.PageHeight-this.rules.PageBottomMargin)){e=this.createMusicPage(),r-=1;continue}this.addSystemToPage(e,n),t=h;var f=new o.PointF2D(this.rules.PageLeftMargin+this.rules.SystemLeftMargin,t);n.PositionAndShape.RelativePosition=f}i>0&&console.log("total amount of pages that couldn't fit a single music system: ".concat(i," of ").concat(e.PageNumber))}},{key:"findRequiredDistanceWithSkyBottomLine",value:function(e,t){for(var n=e.StaffLines[e.StaffLines.length-1],i=t.StaffLines[0],r=n.BottomLine,a=i.SkyLine,s=n.PositionAndShape,o=i.PositionAndShape,u=1/this.rules.SamplingUnit,l=0,c=0;c<r.length;c++){var h=r[c],d=c+Math.round((s.RelativePosition.x-o.RelativePosition.x)*u);if(!(d<0)){if(d>=a.length)break;for(var f=Math.max(0,d-6),p=Math.min(a.length-1,d+6),m=0,v=f;v<=p;v++)m=Math.min(m,a[v]);var g=h-m;l=Math.max(g,l)}}return 0===l&&(l=s.BorderBottom-o.BorderTop),l}}]),e}();var p=function(){function e(){g(this,e),this.systemMeasures=[],this.systemMeasureIndex=0,this.currentWidth=0,this.currentSystemFixWidth=0,this.currentSystemVarWidth=0,this.maxLabelLength=0}return y(e,[{key:"IsSystemStartMeasure",value:function(){return 0===this.systemMeasureIndex}}]),e}();t.SystemBuildParameters=p,t.MeasureBuildParameters=function(){function e(){g(this,e)}return e}()},4574:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OctaveShiftParams=void 0,t.OctaveShiftParams=function(){function e(t,n,i){g(this,e),this.getOpenOctaveShift=t,this.getAbsoluteStartTimestamp=n,this.getAbsoluteEndTimestamp=i}return e}()},9059:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlainSkyBottomLineBatchCalculatorBackend=void 0;var i=n(1378),r=function(e){h(n,e);var t=d(n);function n(e,i){return g(this,n),t.call(this,e,i)}return y(n,[{key:"getPreferredRenderingConfiguration",value:function(e,t){return{elementWidth:Math.ceil(e),numColumns:6,numRows:6}}},{key:"onInitialize",value:function(e){}},{key:"calculateFromCanvas",value:function(e,t,n,r,a){for(var s=e.width,o=t.getImageData(0,0,e.width,e.height),u=a.elementWidth,l=a.elementHeight,c=a.numColumns,h=[],d=0;d<n.length;++d){for(var f=n[d],p=Math.floor(f.getVFStave().getWidth()),m=Math.max(Math.ceil(f.PositionAndShape.Size.width*r),1),v=d%c*u,g=v+p,y=Math.floor(d/c)*l,b=y+l,x=new Array(Math.max(m,p)).fill(0),_=new Array(Math.max(m,p)).fill(0),E=v;E<g;++E){x[E-v]=0;for(var k=y;k<b;++k){var M=k*s*4+4*E;if(o.data[M+3]>0){x[E-v]=k-y;break}}_[E-v]=l;for(var w=b-1;w>=y;w--){var P=w*s*4+4*E;if(o.data[P+3]>0){_[E-v]=w-y;break}}}for(var T=Math.max.apply(Math,S(x)),C=Math.min.apply(Math,S(_)),I=0;I<p;++I)x[I]=0===x[I]?T:x[I],_[I]=_[I]===l?C:_[I];h.push(new i.SkyBottomLineCalculationResult(x,_))}return h}}]),n}(n(9531).SkyBottomLineBatchCalculatorBackend);t.PlainSkyBottomLineBatchCalculatorBackend=r},9067:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionEndSymbol=void 0;var i=n(4785),r=n(8155),a=n(9086),s=n(8911),o=n(6729),u=n(2337),l=function(e){h(n,e);var t=d(n);function n(e,i){var l;g(this,n),l=t.call(this);var h=i,d=e.PositionAndShape.AbsolutePosition.y,f=u.CollectionUtil.last(e.StaffLines).PositionAndShape.RelativePosition.y+4;l.verticalLine=new o.GraphicalLine(new a.PointF2D(h,d),new a.PointF2D(h,d+f),.4,r.OutlineAndFillStyleEnum.SelectionSymbol);for(var p=0,m=e.StaffLines.length;p<m;++p){var v=e.StaffLines[p],y=new a.PointF2D(h,d+v.PositionAndShape.RelativePosition.y),b=new Array(3);y.y-=.2,b[0].x=y.x-3,b[0].y=y.y+1.2,b[1].x=y.x-2,b[1].y=y.y+.4,b[2].x=y.x-2,b[2].y=y.y+2,l.arrows.push(b);var S=new Array(8),x=.8;y.x-=.1,y.y+=.3;var _=.2;S[0].x=y.x-2,S[0].y=y.y+1.5-_,S[1].x=y.x-1,S[1].y=y.y+1.5-_,S[2].x=y.x-1,S[2].y=y.y+2.5,S[3].x=y.x-2,S[3].y=y.y+2.5,S[4].x=S[0].x,S[4].y=S[0].y-x,S[5].x=S[4].x+x+1,S[5].y=S[4].y,S[6].x=S[5].x,S[6].y=S[3].y+x,S[7].x=S[3].x,S[7].y=S[6].y,l.arrowlines.push(S)}return l.boundingBox=new s.BoundingBox(c(l)),l.boundingBox.AbsolutePosition=new a.PointF2D(h,d),l.boundingBox.BorderLeft=-.4,l.boundingBox.BorderRight=4,l.boundingBox.BorderBottom=f,l}return n}(i.GraphicalObject);t.SelectionEndSymbol=l},3501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionStartSymbol=void 0;var i=n(9086),r=n(8155),a=n(6729),s=n(4785),o=n(8911),u=n(2337),l=function(e){h(n,e);var t=d(n);function n(e,s){var l;g(this,n),l=t.call(this);var h=s,d=e.PositionAndShape.AbsolutePosition.y,f=u.CollectionUtil.last(e.StaffLines).PositionAndShape.RelativePosition.y+4;l.verticalLine=new a.GraphicalLine(new i.PointF2D(h,d),new i.PointF2D(h,d+f),.4,r.OutlineAndFillStyleEnum.SelectionSymbol);for(var p=0,m=e.StaffLines.length;p<m;++p){var v=e.StaffLines[p],y=new i.PointF2D(h,d+v.PositionAndShape.RelativePosition.y),b=new Array(7);b[0].x=y.x+4,b[0].y=y.y+2,b[1].x=y.x+2.5,b[1].y=y.y+.5,b[2].x=y.x+2.5,b[2].y=y.y+1.3,b[3].x=y.x+1,b[3].y=y.y+1.3,b[4].x=y.x+1,b[4].y=y.y+2.7,b[5].x=y.x+2.5,b[5].y=y.y+2.7,b[6].x=y.x+2.5,b[6].y=y.y+3.5,l.arrows.push(b)}return l.boundingBox=new o.BoundingBox(c(l)),l.boundingBox.AbsolutePosition=new i.PointF2D(h,d),l.boundingBox.BorderLeft=-.4,l.boundingBox.BorderRight=4,l.boundingBox.BorderBottom=f,l}return n}(s.GraphicalObject);t.SelectionStartSymbol=l},1659:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBottomLineBatchCalculator=void 0;var r=n(2861),a=n(9059),s=n(7636),o=i(n(2043));t.SkyBottomLineBatchCalculator=function(){function e(t,n){var i=this;g(this,e);var u,l=new Map,c=b(t);try{var h=function(){var e=u.value,t=e.ParentMusicSystem.rules;(function(){if(l.has(t))return l.get(t);var e=[];return l.set(t,e),e})().push({skyBottomLineCalculator:e.SkyBottomLineCalculator,measures:e.Measures})};for(c.s();!(u=c.n()).done;)h()}catch(m){c.e(m)}finally{c.f()}this.batches=new Map;var d,f=b(l.entries());try{var p=function(){var e=x(d.value,2),t=e[0],u=e[1],l=u.map((function(e){return e.measures})).flat(),c=function(){if(n===r.SkyBottomLineBatchCalculatorBackendType.Plain)return new a.PlainSkyBottomLineBatchCalculatorBackend(t,l).initialize();try{return new s.WebGLSkyBottomLineBatchCalculatorBackend(t,l).initialize()}catch(n){return o.default.info("Couldn't create WebGLBackend for Skyline. Using fallback."),new a.PlainSkyBottomLineBatchCalculatorBackend(t,l).initialize()}}();c.initialize(),i.batches.set(t,{backend:c,entries:u})};for(f.s();!(d=f.n()).done;)p()}catch(m){f.e(m)}finally{f.f()}}return y(e,[{key:"calculateLines",value:function(){var e,t=b(this.batches);try{for(t.s();!(e=t.n()).done;){var n,i=x(e.value,2)[1],r=i.backend,a=i.entries,s=r.calculateLines(),o=0,u=b(a);try{for(u.s();!(n=u.n()).done;){var l=n.value,c=l.skyBottomLineCalculator,h=o+l.measures.length;c.updateLines(s.slice(o,h)),o=h}}catch(d){u.e(d)}finally{u.f()}}}catch(d){t.e(d)}finally{t.f()}}}]),e}()},9531:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBottomLineBatchCalculatorBackend=void 0;var r=n(4028),a=i(n(2043));t.SkyBottomLineBatchCalculatorBackend=function(){function e(t,n){g(this,e),this.elementHeight=300,this.canvas=new r.CanvasVexFlowBackend(t),this.measures=n,this.maxWidth=Math.max.apply(Math,S(this.measures.map((function(e){var t=e.getVFStave().getWidth();return t>0||e.IsExtraGraphicalMeasure||(a.default.warn("SkyBottomLineBatchCalculatorBackend: width not > 0 in measure "+e.MeasureNumber),t=50),t})))),this.samplingUnit=t.SamplingUnit}return y(e,[{key:"initialize",value:function(){if(this.tableConfiguration=Object.assign(Object.assign({},this.getPreferredRenderingConfiguration(this.maxWidth,this.elementHeight)),{elementHeight:this.elementHeight}),this.tableConfiguration.numRows<1||this.tableConfiguration.numColumns<1)throw a.default.warn("SkyBottomLineBatchCalculatorBackend: numRows or numColumns in tableConfiguration is 0"),new Error("numRows or numColumns in tableConfiguration is 0");this.tableConfiguration.elementWidth<this.maxWidth&&a.default.warn("SkyBottomLineBatchCalculatorBackend: elementWidth in tableConfiguration is less than the width of widest measure");var e=this.tableConfiguration.elementWidth*this.tableConfiguration.numColumns,t=this.elementHeight*this.tableConfiguration.numRows;return this.canvas.initializeHeadless(e,t),this.onInitialize(this.tableConfiguration),this}},{key:"calculateLines",value:function(){for(var e=this.tableConfiguration,t=e.numColumns,n=e.numRows,i=e.elementWidth,r=this.elementHeight,s=t*n,o=this.canvas.getContext(),u=o,l=this.canvas.getCanvas(),c=[],h=0;h<this.measures.length;h+=s){o.clear();for(var d=this.measures.slice(h,h+s),f=0;f<d.length;++f){var p=d[f],m=p.getVFStave(),v=f%t,g=Math.floor(f/t),y=m.getWidth();y>0||p.IsExtraGraphicalMeasure||(y=50),y=Math.floor(y),p.PositionAndShape.calculateAbsolutePositionsRecursive(0,0);var b=0;m.setX(b);var x=m.y+100;m.setY(x);var _=m.getWidth();m.setWidth(y),p.format(),m.setWidth(_);try{u.translate(v*i,g*r),p.draw(o),u.translate(-v*i,-g*r)}catch(t){a.default.warn("SkyBottomLineBatchCalculatorBackend.calculateLines.draw",t)}}var E=this.calculateFromCanvas(l,o,d,this.samplingUnit,this.tableConfiguration);c.push.apply(c,S(E))}return c}}]),e}()},1378:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBottomLineCalculationResult=void 0,t.SkyBottomLineCalculationResult=function(){function e(t,n){g(this,e),this.skyLine=t,this.bottomLine=n}return e}()},6040:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBottomLineCalculator=void 0,n(9086);var r=n(5820),a=i(n(2043)),s=n(1378),o=n(4028);t.SkyBottomLineCalculator=function(){function e(t){g(this,e),this.mStaffLineParent=t,this.mRules=t.ParentMusicSystem.rules}return y(e,[{key:"updateLines",value:function(e){var t=this,n=this.StaffLineParent.Measures;if(e.length!==n.length)if(a.default.warn("SkyBottomLineCalculator: lengths of calculation result array and measure array do not match"),e.length<n.length)for(;e.length<n.length;)e.push(new s.SkyBottomLineCalculationResult([],[]));else e=e.slice(0,n.length);var i=Math.max(Math.ceil(this.StaffLineParent.PositionAndShape.Size.width*this.SamplingUnit),1);this.mSkyLine=[],this.mBottomLine=[];var o,u=b(e);try{for(u.s();!(o=u.n()).done;){var l,c,h=o.value,d=h.skyLine,f=h.bottomLine;(l=this.mSkyLine).push.apply(l,S(d)),(c=this.mBottomLine).push.apply(c,S(f))}}catch(k){u.e(k)}finally{u.f()}for(var p=this.mSkyLine.length/i,m=[],v=[],g=0;g<this.mSkyLine.length&&m.length!==i;g+=p){var y=Math.min(this.mSkyLine.length,g+p),x=this.mSkyLine.slice(g,y+1);m.push(Math.min.apply(Math,S(x))),x=this.mBottomLine.slice(g,y+1),v.push(Math.max.apply(Math,S(x)))}this.mSkyLine=m,this.mBottomLine=v,this.mSkyLine.length!==i&&a.default.debug("SkyLine calculation was not correct (".concat(this.mSkyLine.length," instead of ").concat(i,")"));var _=Math.max.apply(Math,S(this.mSkyLine));this.mSkyLine=this.mSkyLine.map((function(e){return(e-_)/r.unitInPixels+t.StaffLineParent.TopLineOffset}));var E=Math.min.apply(Math,S(this.mBottomLine));this.mBottomLine=this.mBottomLine.map((function(e){return(e-E)/r.unitInPixels+t.StaffLineParent.BottomLineOffset}))}},{key:"calculateLines",value:function(){var e,t=this.mRules.SamplingUnit,n=[],i=new o.CanvasVexFlowBackend(this.mRules),r=b(this.StaffLineParent.Measures);try{for(r.s();!(e=r.n()).done;){var u=e.value;u.PositionAndShape.calculateAbsolutePositionsRecursive(0,0);var l=u.getVFStave(),c=l.getWidth();c>0||u.IsExtraGraphicalMeasure||(a.default.warn("SkyBottomLineCalculator: width not > 0 in measure "+u.MeasureNumber),c=50),i.initializeHeadless(c);var h=i.getContext(),d=i.getCanvas();c=d.width;var f=d.height;l.setY(l.y+100);var p=l.getWidth();l.setWidth(c),u.format(),l.setWidth(p);try{u.draw(h)}catch(t){a.default.warn("SkyBottomLineCalculator.calculateLines.draw",t)}for(var m=h.getImageData(0,0,c,f),v=4,g=Math.max(Math.ceil(u.PositionAndShape.Size.width*t),1),y=new Array(g),S=new Array(g),x=0;x<c;x++){for(var _=0;_<f;_++){var E=_*c*v+x*v;if(m.data[E+3]>0){y[x]=_;break}}for(var k=f;k>0;k--){var M=k*c*v+x*v;if(m.data[M+3]>0){S[x]=k;break}}}for(var w=0;w<y.length;w++)void 0===y[w]&&(y[w]=Math.max(this.findPreviousValidNumber(w,y),this.findNextValidNumber(w,y)));for(var P=0;P<S.length;P++)void 0===S[P]&&(S[P]=Math.max(this.findPreviousValidNumber(P,S),this.findNextValidNumber(P,S)));n.push(new s.SkyBottomLineCalculationResult(y,S)),i.clear()}}catch(T){r.e(T)}finally{r.f()}this.updateLines(n)}},{key:"updateSkyLineWithLine",value:function(e,t,n){for(var i=Math.floor(e.x*this.SamplingUnit),r=Math.ceil(t.x*this.SamplingUnit),a=i+1;a<Math.min(r,this.SkyLine.length);a++)this.SkyLine[a]=n}},{key:"updateSkyLineWithWedge",value:function(e,t){var n=Math.floor(e.x*this.SamplingUnit),i=Math.ceil(t.x*this.SamplingUnit),r=(t.y-e.y)/(t.x-e.x);i-n<=1&&(i++,r=0),n<0&&(n=0),n>=this.BottomLine.length&&(n=this.BottomLine.length-1),i<0&&(i=0),i>=this.BottomLine.length&&(i=this.BottomLine.length),this.SkyLine[n]=e.y;for(var a=n+1;a<Math.min(i,this.SkyLine.length);a++)this.SkyLine[a]=this.SkyLine[a-1]+r/this.SamplingUnit}},{key:"updateBottomLineWithWedge",value:function(e,t){var n=Math.floor(e.x*this.SamplingUnit),i=Math.ceil(t.x*this.SamplingUnit),r=(t.y-e.y)/(t.x-e.x);i-n<=1&&(i++,r=0),n<0&&(n=0),n>=this.BottomLine.length&&(n=this.BottomLine.length-1),i<0&&(i=0),i>=this.BottomLine.length&&(i=this.BottomLine.length),this.BottomLine[n]=e.y;for(var a=n+1;a<i;a++)this.BottomLine[a]=this.BottomLine[a-1]+r/this.SamplingUnit}},{key:"updateSkyLineInRange",value:function(e,t,n){this.updateInRange(this.mSkyLine,e,t,n)}},{key:"updateBottomLineInRange",value:function(e,t,n){this.updateInRange(this.BottomLine,e,t,n)}},{key:"resetSkyLineInRange",value:function(e,t){this.updateInRange(this.SkyLine,e,t)}},{key:"resetBottomLineInRange",value:function(e,t){this.setInRange(this.BottomLine,e,t)}},{key:"setSkyLineWithValue",value:function(e){this.SkyLine.forEach((function(t){return e}))}},{key:"setBottomLineWithValue",value:function(e){this.BottomLine.forEach((function(t){return e}))}},{key:"getLeftIndexForPointX",value:function(e,t){var n=Math.floor(e*this.SamplingUnit);return n<0?0:n>=t?t-1:n}},{key:"getRightIndexForPointX",value:function(e,t){var n=Math.ceil(e*this.SamplingUnit);return n<0?0:n>=t?t-1:n}},{key:"updateStaffLineBorders",value:function(){this.mStaffLineParent.PositionAndShape.BorderTop=this.getSkyLineMin(),this.mStaffLineParent.PositionAndShape.BorderMarginTop=this.getSkyLineMin(),this.mStaffLineParent.PositionAndShape.BorderBottom=this.getBottomLineMax(),this.mStaffLineParent.PositionAndShape.BorderMarginBottom=this.getBottomLineMax()}},{key:"getSkyLineMin",value:function(){return Math.min.apply(Math,S(this.SkyLine.filter((function(e){return!isNaN(e)}))))}},{key:"getSkyLineMinAtPoint",value:function(e){var t=Math.round(e*this.SamplingUnit);return this.mSkyLine[t]}},{key:"getSkyLineMinInRange",value:function(e,t){return this.getMinInRange(this.SkyLine,e,t)}},{key:"getBottomLineMax",value:function(){return Math.max.apply(Math,S(this.BottomLine.filter((function(e){return!isNaN(e)}))))}},{key:"getBottomLineMaxAtPoint",value:function(e){var t=Math.round(e*this.SamplingUnit);return this.mBottomLine[t]}},{key:"getBottomLineMaxInRange",value:function(e,t){return this.getMaxInRange(this.BottomLine,e,t)}},{key:"getBottomLineMaxInBoundingBox",value:function(e){var t=Math.floor(e.AbsolutePosition.x+e.BorderLeft),n=Math.ceil(e.AbsolutePosition.x+e.BorderRight);return this.getMaxInRange(this.mBottomLine,t,n)}},{key:"updateWithBoundingBoxRecursively",value:function(e){if(e.ChildElements&&e.ChildElements.length>0){var t,n=b(e.ChildElements);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.updateWithBoundingBoxRecursively(i)}}catch(c){n.e(c)}finally{n.f()}}else{var r=e.BorderTop+e.AbsolutePosition.y,a=e.BorderBottom+e.AbsolutePosition.y;if(r<0){var s=Math.floor(e.AbsolutePosition.x+e.BorderLeft),o=Math.ceil(e.AbsolutePosition.x+e.BorderRight);this.updateInRange(this.mSkyLine,s,o,r)}else if(a>this.StaffLineParent.StaffHeight){var u=Math.floor(e.AbsolutePosition.x+e.BorderLeft),l=Math.ceil(e.AbsolutePosition.x+e.BorderRight);this.updateInRange(this.mBottomLine,u,l,a)}}}},{key:"findPreviousValidNumber",value:function(e,t){for(var n=e;n>=0;n--)if(!isNaN(t[n]))return t[n];return 0}},{key:"findNextValidNumber",value:function(e,t){if(e>=t.length)return t[e-1];for(var n=e;n<t.length;n++)if(!isNaN(t[n]))return t[n];return 0}},{key:"drawPixel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FF0000FF",i=t.getContext(),r=i.fillStyle;i.fillStyle=n,i.fillRect(e.x,e.y,2,2),i.fillStyle=r}},{key:"updateInRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t=Math.floor(t*this.SamplingUnit),(n=Math.ceil(n*this.SamplingUnit))<t)throw new Error("start index of line is greater than the end index");t<0&&(t=0),n>e.length&&(n=e.length);for(var r=t;r<n;r++)e[r]=Math.abs(i)>Math.abs(e[r])?i:e[r]}},{key:"setInRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t=Math.floor(t*this.SamplingUnit),(n=Math.ceil(n*this.SamplingUnit))<t)throw new Error("start index of line is greater then the end index");t<0&&(t=0),n>e.length&&(n=e.length);for(var r=t;r<n;r++)e[r]=i}},{key:"getMinInRange",value:function(e,t,n){return t=Math.floor(t*this.SamplingUnit),n=Math.ceil(n*this.SamplingUnit),e?(t<0&&(t=0),t>=e.length&&(t=e.length-1),n<0&&(n=0),n>=e.length&&(n=e.length),t>=0&&n<=e.length?Math.min.apply(Math,S(e.slice(t,n+1))):void 0):Number.MAX_VALUE}},{key:"getMaxInRange",value:function(e,t,n){return t=Math.floor(t*this.SamplingUnit),n=Math.ceil(n*this.SamplingUnit),e?(t<0&&(t=0),t>=e.length&&(t=e.length-1),n<0&&(n=0),n>=e.length&&(n=e.length),t>=0&&n<=e.length?Math.max.apply(Math,S(e.slice(t,n+1))):void 0):Number.MIN_VALUE}},{key:"SamplingUnit",get:function(){return this.mRules.SamplingUnit}},{key:"StaffLineParent",get:function(){return this.mStaffLineParent}},{key:"SkyLine",get:function(){return this.mSkyLine}},{key:"BottomLine",get:function(){return this.mBottomLine}}]),e}()},8965:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBottomLineCalculatorSVG=void 0;var r=n(6040),a=i(n(8011)),s=n(5820),o=n(9505),u=function(e){h(n,e);var t=d(n);function n(){return g(this,n),t.apply(this,arguments)}return y(n,[{key:"recursiveUpdate",value:function(e,t,n,i){var r=e.getBBox(),o=r.y/s.unitInPixels,u=r.height/s.unitInPixels+o,l=x(i,2),c=l[0],h=l[1];if(o<t.top||u>t.bottom)switch(e.tagName.toLowerCase()){case"g":var d,f=b(e.children);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.recursiveUpdate(p,t,n,i)}}catch(k){f.e(k)}finally{f.f()}break;case"circle":case"rect":case"line":case"path":var m=Math.floor((r.x-n.x)/s.unitInPixels*this.mRules.SamplingUnit),v=m+Math.ceil(r.width/s.unitInPixels*this.mRules.SamplingUnit);if(e.parentElement.classList.contains("vf-beams")&&e.hasAttribute("d")){var g=(0,a.default)(e.getAttribute("d"));if(5===g.length)for(var y=g[0],S=g[3],_=(S.end.y-y.end.y)/(S.end.x-y.end.x),E=y.end.y/s.unitInPixels;m<=v;m++)E<c[m]&&(c[m]=E),E>h[m]&&(h[m]=E),E+=_/this.mRules.SamplingUnit}else for(;m<=v;m++)o<c[m]&&(c[m]=o),u>h[m]&&(h[m]=u)}}},{key:"calculateLinesForMeasure",value:function(e,t){var n,i,r,a,o=t.getBBox(),u=Math.max(Math.round(e.PositionAndShape.Size.width*this.mRules.SamplingUnit),1),l=o.height/s.unitInPixels,c=t.getElementsByClassName("vf-stave")[0].getBBox(),h=(null==c?void 0:c.height)/s.unitInPixels,d=(null==c?void 0:c.y)/s.unitInPixels,f=e.getVFStave(),p=((null===(n=f.options)||void 0===n?void 0:n.num_lines)?f.options.num_lines:5)-1,m=-1,v=0,g=[p],y=b(null===(i=f.options)||void 0===i?void 0:i.line_config);try{for(y.s();!(a=y.n()).done;)a.value.visible?(-1===m&&(m=v),g.push(v)):p--,v++}catch(C){y.e(C)}finally{y.f()}-1===m&&(m=0),p=g.pop()-m;var S=null===(r=f.options)||void 0===r?void 0:r.spacing_between_lines_px,x=p*S/s.unitInPixels;h-x>.2&&(h=x,d=m*S/s.unitInPixels);var _=d+h,E=new Array(u).fill(d),k=new Array(u).fill(_),M=[E,k];if(l>h){var w,P=b(t.children);try{for(P.s();!(w=P.n()).done;){var T=w.value;this.recursiveUpdate(T,{top:d,bottom:_},o,[E,k])}}catch(C){P.e(C)}finally{P.f()}}return M}},{key:"calculateLines",value:function(){this.mSkyLine=[],this.mBottomLine=[];var e=document.createElement("div");document.body.append(e);var t=new o.SvgVexFlowBackend(this.mRules);t.initialize(e,1,"0");var n=t.getContext(),i=n.openGroup();i.classList.add("staffline");var r,a=b(this.StaffLineParent.Measures);try{for(a.s();!(r=a.n()).done;){var u,l,c=r.value;c.PositionAndShape.calculateAbsolutePositionsRecursive(0,0),c.setAbsoluteCoordinates(c.PositionAndShape.AbsolutePosition.x*s.unitInPixels,c.PositionAndShape.AbsolutePosition.y*s.unitInPixels);var h=c.draw(n),d=this.calculateLinesForMeasure(c,h),f=x(d,2),p=f[0],m=f[1];(u=this.mSkyLine).push.apply(u,S(p)),(l=this.mBottomLine).push.apply(l,S(m))}}catch(I){a.e(I)}finally{a.f()}n.closeGroup();var v,g=b(i.getElementsByClassName("vf-ties"));try{for(g.s();!(v=g.n()).done;){var y,_=v.value,E=b(_.childNodes);try{for(E.s();!(y=E.n()).done;){var k=y.value;if("path"===k.nodeName.toLowerCase())for(var M=k.getBBox(),w=Math.floor(M.x/s.unitInPixels*this.mRules.SamplingUnit),P=w+Math.ceil(M.width/s.unitInPixels*this.mRules.SamplingUnit),T=M.y/s.unitInPixels,C=M.height/s.unitInPixels+T;w<=P;w++)T<this.mSkyLine[w]&&(this.mSkyLine[w]=T),C>this.mBottomLine[w]&&(this.mBottomLine[w]=C)}}catch(I){E.e(I)}finally{E.f()}}}catch(I){g.e(I)}finally{g.f()}t.clear(),e.remove()}}]),n}(r.SkyBottomLineCalculator);t.SkyBottomLineCalculatorSVG=u},9953:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaffLine=void 0;var i=n(8911),r=n(4785),a=n(4196),s=n(9086),o=n(4040),u=function(e){h(n,e);var t=d(n);function n(e,r){var a;return g(this,n),(a=t.call(this)).measures=[],a.staffLines=new Array(5),a.octaveShifts=[],a.lyricLines=[],a.lyricsDashes=[],a.abstractExpressions=[],a.graphicalSlurs=[],a.Pedals=[],a.WavyLines=[],a.parentMusicSystem=e,a.parentStaff=r,a.boundingBox=new i.BoundingBox(c(a),e.PositionAndShape),a.skyBottomLine=o.MusicSheetCalculator.symbolFactory.createSkyBottomLineCalculator(c(a)),a.staffHeight=a.parentMusicSystem.rules.StaffHeight,a.topLineOffset=0,a.bottomLineOffset=4,a.calculateStaffLineOffsets(),a}return y(n,[{key:"calculateStaffLineOffsets",value:function(){if(this.ParentStaff.isTab)5===this.ParentStaff.StafflineCount?this.staffHeight=this.bottomLineOffset=6*this.ParentStaff.ParentInstrument.GetMusicSheet.Rules.TabStaffInterlineHeight:this.staffHeight=this.bottomLineOffset=this.ParentStaff.ParentInstrument.GetMusicSheet.Rules.TabStaffInterlineHeight*this.ParentStaff.StafflineCount;else switch(this.ParentStaff.StafflineCount){case 4:this.bottomLineOffset=1;break;case 3:this.topLineOffset=1,this.bottomLineOffset=1;break;case 2:this.topLineOffset=2,this.bottomLineOffset=1;break;case 1:this.topLineOffset=2,this.bottomLineOffset=2}}},{key:"Measures",get:function(){return this.measures},set:function(e){this.measures=e}},{key:"StaffLines",get:function(){return this.staffLines},set:function(e){this.staffLines=e}},{key:"Index",get:function(){return this.parentMusicSystem.StaffLines.indexOf(this)}},{key:"NextStaffLine",get:function(){var e=this.Index;return e!==this.parentMusicSystem.StaffLines.length?this.parentMusicSystem.StaffLines[e+1]:void 0}},{key:"LyricLines",get:function(){return this.lyricLines},set:function(e){this.lyricLines=e}},{key:"AbstractExpressions",get:function(){return this.abstractExpressions},set:function(e){this.abstractExpressions=e}},{key:"LyricsDashes",get:function(){return this.lyricsDashes},set:function(e){this.lyricsDashes=e}},{key:"ParentMusicSystem",get:function(){return this.parentMusicSystem},set:function(e){this.parentMusicSystem=e}},{key:"ParentStaff",get:function(){return this.parentStaff},set:function(e){this.parentStaff=e}},{key:"SkyBottomLineCalculator",get:function(){return this.skyBottomLine}},{key:"SkyLine",get:function(){return this.skyBottomLine.SkyLine}},{key:"BottomLine",get:function(){return this.skyBottomLine.BottomLine}},{key:"OctaveShifts",get:function(){return this.octaveShifts},set:function(e){this.octaveShifts=e}},{key:"StaffHeight",get:function(){return this.staffHeight}},{key:"TopLineOffset",get:function(){return this.topLineOffset}},{key:"BottomLineOffset",get:function(){return this.bottomLineOffset}},{key:"GraphicalSlurs",get:function(){return this.graphicalSlurs}},{key:"addSlurToStaffline",value:function(e){this.graphicalSlurs.push(e)}},{key:"addActivitySymbolClickArea",value:function(){var e=new a.StaffLineActivitySymbol(this),t=this.PositionAndShape;e.PositionAndShape.RelativePosition=new s.PointF2D(t.RelativePosition.x+t.BorderRight+.5,t.RelativePosition.y+.5),e.PositionAndShape.Parent=this.parentMusicSystem.PositionAndShape}},{key:"isPartOfMultiStaffInstrument",value:function(){return this.parentStaff.ParentInstrument.Staves.length>1}},{key:"findClosestStaffEntry",value:function(e){for(var t,n=0,i=this.Measures.length;n<i;++n)for(var r=this.Measures[n],a=0,s=r.staffEntries.length;a<s;++a){var o=r.staffEntries[a];Math.abs(o.PositionAndShape.RelativePosition.x-e+r.PositionAndShape.RelativePosition.x)<10&&(t=o)}return t}}]),n}(r.GraphicalObject);t.StaffLine=u},4196:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaffLineActivitySymbol=void 0;var i=n(4785),r=n(8911),a=function(e){h(n,e);var t=d(n);function n(e){var i;g(this,n),(i=t.call(this)).parentStaffLine=e;var a=e.PositionAndShape;return i.boundingBox=new r.BoundingBox(c(i),a),i.boundingBox.BorderRight=6,i.boundingBox.BorderBottom=4.5,i.boundingBox.BorderLeft=-1.5,i.boundingBox.BorderTop=-1.5,i}return n}(i.GraphicalObject);t.StaffLineActivitySymbol=a},7771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemLine=void 0;var i=n(6894),r=n(8911),a=function(e){h(n,e);var t=d(n);function n(e,i,a,s,o){var u;return g(this,n),(u=t.call(this)).lineType=e,u.linePosition=i,u.parentMusicSystem=a,u.topMeasure=s,u.bottomMeasure=o,u.parentTopStaffLine=null==s?void 0:s.ParentStaffLine,u.boundingBox=new r.BoundingBox(c(u),a.PositionAndShape),u}return y(n,null,[{key:"getObjectWidthForLineType",value:function(e,t){switch(t){case i.SystemLinesEnum.SingleThin:return e.SystemThinLineWidth;case i.SystemLinesEnum.DoubleThin:return 2*e.SystemThinLineWidth+e.DistanceBetweenVerticalSystemLines;case i.SystemLinesEnum.ThinBold:return e.SystemThinLineWidth+e.SystemBoldLineWidth+e.DistanceBetweenVerticalSystemLines;case i.SystemLinesEnum.BoldThinDots:case i.SystemLinesEnum.DotsThinBold:return e.SystemThinLineWidth+e.SystemBoldLineWidth+e.DistanceBetweenVerticalSystemLines+e.SystemDotWidth+e.DistanceBetweenDotAndLine;case i.SystemLinesEnum.DotsBoldBoldDots:return 2*e.SystemBoldLineWidth+2*e.SystemDotWidth+2*e.DistanceBetweenDotAndLine+e.DistanceBetweenVerticalSystemLines;default:return 0}}}]),n}(n(4785).GraphicalObject);t.SystemLine=a},1225:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SystemLinePosition=void 0,(n=t.SystemLinePosition||(t.SystemLinePosition={}))[n.MeasureBegin=0]="MeasureBegin",n[n.MeasureEnd=1]="MeasureEnd"},6894:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SystemLinesEnumHelper=t.SystemLinesEnum=void 0,function(e){e[e.SingleThin=0]="SingleThin",e[e.DoubleThin=1]="DoubleThin",e[e.ThinBold=2]="ThinBold",e[e.BoldThinDots=3]="BoldThinDots",e[e.DotsThinBold=4]="DotsThinBold",e[e.DotsBoldBoldDots=5]="DotsBoldBoldDots",e[e.None=6]="None",e[e.Dotted=7]="Dotted",e[e.Dashed=8]="Dashed",e[e.Bold=9]="Bold",e[e.BoldThin=10]="BoldThin",e[e.DoubleBold=11]="DoubleBold",e[e.Tick=12]="Tick",e[e.Short=13]="Short"}(n=t.SystemLinesEnum||(t.SystemLinesEnum={})),t.SystemLinesEnumHelper=function(){function e(){g(this,e)}return y(e,null,[{key:"xmlBarlineStyleToSystemLinesEnum",value:function(e){return"regular"===e?n.SingleThin:"dotted"===e?n.Dotted:"dashed"===e?n.Dashed:"heavy"===e?n.Bold:"light-light"===e?n.DoubleThin:"light-heavy"===e?n.ThinBold:"heavy-light"===e?n.BoldThin:"heavy-heavy"===e?n.DoubleBold:"tick"===e?n.Tick:"short"===e?n.Short:"none"===e?n.None:n.SingleThin}}]),e}()},525:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalGraphicalStaffEntryContainer=void 0,t.VerticalGraphicalStaffEntryContainer=function(){function e(t,n){g(this,e),this.staffEntries=[],this.absoluteTimestamp=n,this.staffEntries=new Array(t)}return y(e,[{key:"Index",get:function(){return this.index},set:function(e){this.index=e}},{key:"AbsoluteTimestamp",get:function(){return this.absoluteTimestamp}},{key:"StaffEntries",get:function(){return this.staffEntries},set:function(e){this.staffEntries=e}},{key:"getFirstNonNullStaffEntry",value:function(){for(var e=0,t=this.staffEntries.length;e<t;++e){var n=this.staffEntries[e];if(n)return n}}}],[{key:"compareByTimestamp",value:function(e,t){var n=e.absoluteTimestamp.RealValue,i=t.absoluteTimestamp.RealValue;return n<i?-1:n>i?1:0}}]),e}()},449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlignmentManager=void 0;var i=n(9344),r=n(9086);t.AlignmentManager=function(){function e(t){g(this,e),this.parentStaffline=t,this.rules=this.parentStaffline.ParentMusicSystem.rules}return y(e,[{key:"alignDynamicExpressions",value:function(){for(var e,t,n=[],r=new Array,a=0;a<this.parentStaffline.AbstractExpressions.length-1;a++){var s=this.parentStaffline.AbstractExpressions[a],o=this.parentStaffline.AbstractExpressions[a+1];if((null===(e=null==s?void 0:s.SourceExpression)||void 0===e?void 0:e.Placement)===(null===(t=null==o?void 0:o.SourceExpression)||void 0===t?void 0:t.Placement)){var u=this.getDistance(s.PositionAndShape,o.PositionAndShape);Math.abs(u.x)<this.rules.DynamicExpressionMaxDistance?(-1===r.indexOf(s)&&r.push(s),r.push(o)):(n.push(r),r=new Array)}}n.push(r);for(var l=0,c=n;l<c.length;l++){var h=c[l];if(h.length>0)for(var d=h.map((function(e){return e.PositionAndShape.Center.y})),f=Math.max.apply(Math,S(d)),p=0;p<h.length;p++){var m=h[p],v=d[p]-f;if(m instanceof i.VexFlowContinuousDynamicExpression?(m.shiftYPosition(-v),m.calcPsi()):(m.PositionAndShape.RelativePosition.y-=.8*v,m.PositionAndShape.calculateBoundingBox()),m.squeeze){var g=p<h.length-1?h[p+1]:void 0,y=p>0?h[p-1]:void 0;if(g){var b=this.getOverlap(m.PositionAndShape,g.PositionAndShape);m.squeeze(-(b.x+this.rules.DynamicExpressionSpacer))}if(y){var x=this.getOverlap(y.PositionAndShape,m.PositionAndShape);m.squeeze(x.x+this.rules.DynamicExpressionSpacer)}}}}}},{key:"getDistance",value:function(e,t){var n=e.RelativePosition.x+e.BorderMarginRight,i=t.RelativePosition.x+t.BorderMarginLeft,a=e.RelativePosition.y+e.BorderMarginBottom,s=t.RelativePosition.y+t.BorderMarginTop;return new r.PointF2D(i-n,s-a)}},{key:"getOverlap",value:function(e,t){return new r.PointF2D(e.RelativePosition.x+e.BorderMarginRight-(t.RelativePosition.x+t.BorderMarginLeft),e.RelativePosition.y+e.BorderMarginBottom-(t.RelativePosition.y+t.BorderMarginTop))}}]),e}()},4028:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasVexFlowBackend=void 0;var r=i(n(6368)).default.Flow,a=n(709),s=n(8129),o=n(41),u=n(599),l=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).rules=e,i}return y(n,[{key:"getVexflowBackendType",value:function(){return r.Renderer.Backends.CANVAS}},{key:"getOSMDBackendType",value:function(){return o.BackendType.Canvas}},{key:"getCanvasSize",value:function(){var e;return null===(e=document.getElementById("osmdCanvasPage"+this.graphicalMusicPage.PageNumber))||void 0===e?void 0:e.offsetHeight}},{key:"initialize",value:function(e,t){this.zoom=t,this.canvas=document.createElement("canvas"),this.graphicalMusicPage||(this.graphicalMusicPage=new u.GraphicalMusicPage(void 0),this.graphicalMusicPage.PageNumber=1),this.canvas.id="osmdCanvasVexFlowBackendCanvas"+this.graphicalMusicPage.PageNumber,this.inner=document.createElement("div"),this.inner.id="osmdCanvasPage"+this.graphicalMusicPage.PageNumber,this.inner.style.position="relative",this.canvas.style.zIndex="0",this.inner.appendChild(this.canvas),e.appendChild(this.inner),this.renderer=new r.Renderer(this.canvas,this.getVexflowBackendType()),this.ctx=this.renderer.getContext()}},{key:"initializeHeadless",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;this.graphicalMusicPage||(this.graphicalMusicPage=new u.GraphicalMusicPage(void 0),this.graphicalMusicPage.PageNumber=1),this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=t,this.renderer=new r.Renderer(this.canvas,this.getVexflowBackendType()),this.ctx=this.renderer.getContext()}},{key:"getContext",value:function(){return this.ctx}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.rules.PageBackgroundColor&&(this.ctx.save(),this.ctx.setFillStyle(this.rules.PageBackgroundColor),this.zoom=1,this.ctx.fillRect(0,0,this.canvas.width/this.zoom,this.canvas.height/this.zoom),this.ctx.restore())}},{key:"scale",value:function(e){this.ctx.scale(e,e)}},{key:"translate",value:function(e,t){this.CanvasRenderingCtx.translate(e,t)}},{key:"renderText",value:function(e,t,n,i,r,a,o,u){var l=this.CanvasRenderingCtx.font;this.CanvasRenderingCtx.save(),this.CanvasRenderingCtx.font=s.VexFlowConverter.font(e,t,n,this.rules,u),this.CanvasRenderingCtx.fillStyle=o,this.CanvasRenderingCtx.strokeStyle=o,this.CanvasRenderingCtx.fillText(i,a.x,a.y+r),this.CanvasRenderingCtx.restore(),this.CanvasRenderingCtx.font=l}},{key:"renderRectangle",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this.CanvasRenderingCtx.fillStyle;this.CanvasRenderingCtx.fillStyle=n||s.VexFlowConverter.style(t),this.CanvasRenderingCtx.globalAlpha=i,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.CanvasRenderingCtx.fillStyle=r,this.CanvasRenderingCtx.globalAlpha=1}},{key:"renderLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FF0000FF",i=this.CanvasRenderingCtx.strokeStyle;this.CanvasRenderingCtx.strokeStyle=n,this.CanvasRenderingCtx.beginPath(),this.CanvasRenderingCtx.moveTo(e.x,e.y),this.CanvasRenderingCtx.lineTo(t.x,t.y),this.CanvasRenderingCtx.stroke(),this.CanvasRenderingCtx.strokeStyle=i}},{key:"renderCurve",value:function(e){this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y),this.ctx.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y),this.ctx.lineTo(e[7].x,e[7].y),this.ctx.bezierCurveTo(e[6].x,e[6].y,e[5].x,e[5].y,e[4].x,e[4].y),this.ctx.lineTo(e[0].x,e[0].y),this.ctx.closePath(),this.ctx.fill()}},{key:"CanvasRenderingCtx",get:function(){return this.ctx.vexFlowCanvasContext}}]),n}(a.VexFlowBackend);t.CanvasVexFlowBackend=l},9505:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SvgVexFlowBackend=void 0;var r=i(n(6368)),a=r.default.Flow,s=n(709),o=n(8129),u=n(2562),l=n(41),c=i(n(2043)),f=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).rules=e,i}return y(n,[{key:"getVexflowBackendType",value:function(){return a.Renderer.Backends.SVG}},{key:"getOSMDBackendType",value:function(){return l.BackendType.SVG}},{key:"getCanvasSize",value:function(){var e;return null===(e=document.getElementById("osmdCanvasPage"+this.graphicalMusicPage.PageNumber))||void 0===e?void 0:e.offsetHeight}},{key:"initialize",value:function(e,t,n){this.zoom=t,this.canvas=document.createElement("div"),n||(n=this.graphicalMusicPage?this.graphicalMusicPage.PageNumber.toString():"1"),this.canvas.id="osmdCanvasPage"+n,this.inner=this.canvas,this.inner.style.position="relative",this.canvas.style.zIndex="0",e.appendChild(this.inner),this.renderer=new r.default.Flow.Renderer(this.canvas,this.getVexflowBackendType()),this.ctx=this.renderer.getContext(),this.ctx.svg.id="osmdSvgPage"+n}},{key:"getContext",value:function(){return this.ctx}},{key:"getSvgElement",value:function(){return this.ctx.svg}},{key:"removeNode",value:function(e){var t,n=null===(t=this.ctx)||void 0===t?void 0:t.svg;if(!n)return!1;try{n.removeChild(e)}catch(e){return c.default.error(e),!1}return!0}},{key:"clear",value:function(){if(this.ctx){for(var e=this.ctx.svg;e.lastChild;)e.removeChild(e.lastChild);this.rules.PageBackgroundColor&&(this.ctx.svg.style["background-color"]=this.rules.PageBackgroundColor)}}},{key:"scale",value:function(e){this.ctx.scale(e,e)}},{key:"translate",value:function(e,t){}},{key:"renderText",value:function(e,t,n,i,r,a,s,l){this.ctx.save();var c=this.ctx.openGroup("text");s&&(this.ctx.attributes.fill=s,this.ctx.attributes.stroke=s);var h=l;l&&"default"!==l||(h=this.rules.DefaultFontFamily),this.ctx.setFont(h,e,o.VexFlowConverter.fontStyle(t)),this.ctx.attributes["font-size"]="".concat(e,"px"),this.ctx.state["font-size"]="".concat(e,"px");var d="normal",f="normal";switch(t){case u.FontStyles.Bold:d="bold";break;case u.FontStyles.Italic:f="italic";break;case u.FontStyles.BoldItalic:d="bold",f="italic";break;default:d="normal"}return this.ctx.attributes["font-weight"]=d,this.ctx.state["font-weight"]=d,this.ctx.attributes["font-style"]=f,this.ctx.state["font-style"]=f,this.ctx.fillText(i,a.x,a.y+r),this.ctx.closeGroup(),this.ctx.restore(),c}},{key:"renderRectangle",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.ctx.save();var r=this.ctx.openGroup("rect");return this.ctx.attributes.fill=n||o.VexFlowConverter.style(t),this.ctx.attributes["fill-opacity"]=i,this.ctx.fillRect(e.x,e.y,e.width,e.height),this.ctx.restore(),this.ctx.attributes["fill-opacity"]=1,this.ctx.closeGroup(),r}},{key:"renderLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#FF0000FF",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;this.ctx.save();var r=this.ctx.openGroup("line");return this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.attributes.stroke=n,this.ctx.lineWidth=i,this.ctx.stroke(),this.ctx.closeGroup(),this.ctx.restore(),r}},{key:"renderCurve",value:function(e){var t=this.ctx.openGroup("curve");return this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y),this.ctx.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y),this.ctx.lineTo(e[7].x,e[7].y),this.ctx.bezierCurveTo(e[6].x,e[6].y,e[5].x,e[5].y,e[4].x,e[4].y),this.ctx.lineTo(e[0].x,e[0].y),this.ctx.closePath(),this.ctx.fill(),this.ctx.closeGroup(),t}},{key:"export",value:function(){var e=this.ctx.svg.cloneNode(!0),t=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),n=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",t);n.replaceChild(e,n.documentElement);var i=(new XMLSerializer).serializeToString(n),r=document.createElement("a");r.href="data:image/svg+xml; charset=utf8, "+encodeURIComponent(i.replace(/></g,">\n\r<")),r.download="opensheetmusicdisplay_download.svg",r.innerHTML=window.location.href+"/download",document.body.appendChild(r)}}]),n}(s.VexFlowBackend);t.SvgVexFlowBackend=f},709:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowBackend=t.VexFlowBackends=void 0;var r=i(n(6368)).default.Flow;t.VexFlowBackends=function(){function e(){g(this,e)}return e}(),t.VexFlowBackend=function(){function e(){g(this,e)}return y(e,[{key:"getInnerElement",value:function(){return this.inner}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getRenderElement",value:function(){var e=this.canvas;return this.getVexflowBackendType()===r.Renderer.Backends.CANVAS&&(e=this.inner),e}},{key:"getRenderer",value:function(){return this.renderer}},{key:"removeAllChildrenFromContainer",value:function(e){for(;0!==e.children.length;)e.removeChild(e.children.item(0))}},{key:"removeFromContainer",value:function(e){for(var t=this.getRenderElement(),n=0;n<e.children.length;n++)if(e.children.item(n)===t){e.removeChild(t);break}}},{key:"resize",value:function(e,t){this.renderer.resize(e,t),this.width=e,this.height=t}}]),e}()},9344:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowContinuousDynamicExpression=void 0;var i=n(374),r=n(9946),a=n(2255),o=n(1274),u=n(2562),l=function(e){h(n,e);var t=d(n);function n(e,i,l,c){var h;if(g(this,n),(h=t.call(this,e,i,l)).IsVerbal){var d=new a.Label(e.Label);h.label=new r.GraphicalLabel(d,c||h.rules.ContinuousDynamicTextHeight,o.TextAlignmentEnum.LeftCenter,h.rules,h.PositionAndShape),h.label.Label.fontStyle=u.FontStyles.Italic,h.label.setLabelPositionAndShapeBorders(),h.PositionAndShape.calculateBoundingBox()}return s(h)}return n}(i.GraphicalContinuousDynamicExpression);t.VexFlowContinuousDynamicExpression=l},8129:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowConverter=void 0;var r=i(n(6368)).default.Flow,a=n(289),s=n(8640),o=n(1797),u=n(3331),l=n(5198),c=n(8640),h=n(8640),d=n(6894),f=n(2562),p=n(96),m=n(8155),v=i(n(2043)),S=n(908),x=n(1225),_=n(5922),E=n(766),k=n(5820),M=n(3029),w=n(3748),P=function(){function e(){g(this,e)}return y(e,null,[{key:"durations",value:function(e,t){for(var n=[],i=e.clone();i.RealValue>0;){var r=i.RealValue;if(r>=2)n.push("1/2"),i.Sub(new o.Fraction(2,1));else if(r>=1)n.push("w"),i.Sub(new o.Fraction(1,1));else if(r<1&&r>=.5){if(t&&r>.5)return["w"];n.push("h"),i.Sub(new o.Fraction(1,2))}else if(r<.5&&r>=.25){if(t&&r>.25)return["h"];n.push("q"),i.Sub(new o.Fraction(1,4))}else if(r<.25&&r>=.125){if(t&&r>.125)return["q"];n.push("8"),i.Sub(new o.Fraction(1,8))}else if(r<.125&&r>=.0625){if(t&&r>.0625)return["8"];n.push("16"),i.Sub(new o.Fraction(1,16))}else if(r<.0625&&r>=.03125){if(t&&r>.03125)return["16"];n.push("32"),i.Sub(new o.Fraction(1,32))}else if(r<.03125&&r>=.015625){if(t&&r>.015625)return["32"];n.push("64"),i.Sub(new o.Fraction(1,64))}else{if(t)return["64"];n.push("128"),i.Sub(new o.Fraction(1,128))}}return n}},{key:"pitch",value:function(e,t,n,i,r){var o=r;void 0===r&&(o=3),t&&void 0===r&&(o=0,n.ClefType===a.ClefEnum.F&&(o=2),n.ClefType===a.ClefEnum.C&&(o=2));var u=h.NoteEnum[e.FundamentalNote].toLowerCase(),l=s.Pitch.accidentalVexflow(e.Accidental),c=e.Octave-n.OctaveOffset+o,d="";return i&&(d=this.NoteHeadCode(i)),[u+"n/"+c+d,l,n]}},{key:"restToNotePitch",value:function(e,t){var n=e.Octave;switch(t){case a.ClefEnum.C:case a.ClefEnum.F:n+=2;case a.ClefEnum.G:}return new s.Pitch(e.FundamentalNote,n,c.AccidentalEnum.NONE)}},{key:"NoteHeadCode",value:function(e){var t=e.Filled?"2":"1";switch(e.Shape){case E.NoteHeadShape.NORMAL:return"";case E.NoteHeadShape.DIAMOND:return"/D"+t;case E.NoteHeadShape.TRIANGLE:return"/T"+t;case E.NoteHeadShape.X:return"/X"+t;case E.NoteHeadShape.CIRCLEX:return"/X3";case E.NoteHeadShape.RECTANGLE:return"/R"+t;case E.NoteHeadShape.SQUARE:return"/S"+t;case E.NoteHeadShape.SLASH:default:return""}}},{key:"GhostNotes",value:function(t){var n,i=[],a=e.durations(t,!1),s=b(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;i.push(new r.GhostNote({duration:o}))}}catch(u){s.e(u)}finally{s.f()}return i}},{key:"StaveNote",value:function(t){var n,i,o,u,l,c,h,d,f,p;t.sortForVexflow();var m,v=t.notes,g=t.parentStaffEntry.parentMeasure.parentSourceMeasure.Rules,y=v[0],x=[],_=[],M=y.graphicalNoteLength,w=void 0!==y.sourceNote.NoteTuplet,P=e.durations(M,w)[0];void 0!==y.sourceNote.TypeLength&&y.sourceNote.TypeLength!==M&&0!==y.sourceNote.TypeLength.RealValue&&(P=e.durations(y.sourceNote.TypeLength,w)[0],y.numberOfDots=y.sourceNote.DotsXml);var T,C,I,A=y.numberOfDots,L=!1,O=0,R=!1,N=b(v);try{for(N.s();!(I=N.n()).done;){var B=I.value;if(A<B.numberOfDots&&(A=B.numberOfDots),B.sourceNote.isRest()){if(R=!0,B.sourceNote.Pitch){x=[B.vfpitch[0]];break}x=["b/4"];var D=null===(n=B.parentVoiceEntry)||void 0===n?void 0:n.parentVoiceEntry;if(D){for(var F=null===(i=B.parentVoiceEntry)||void 0===i?void 0:i.parentStaffEntry.parentMeasure.staffEntries,j=void 0,V=void 0,G=-1,W=0;W<F.length;W++)if((null===(o=F[W])||void 0===o?void 0:o.graphicalVoiceEntries[0].parentVoiceEntry)===D){G=W;break}if(G>=1&&F.length-1>=G+1&&(j=null===(l=null===(u=F[G-1])||void 0===u?void 0:u.graphicalVoiceEntries[0])||void 0===l?void 0:l.parentVoiceEntry,V=null===(h=null===(c=F[G+1])||void 0===c?void 0:c.graphicalVoiceEntries[0])||void 0===h?void 0:h.parentVoiceEntry,j&&V)){var U=j.Notes[0],z=V.Notes[0];if(null===(d=U.NoteBeam)||void 0===d?void 0:d.Notes.includes(z)){var H=j.Notes.last().Pitch,X=B.Clef();x=[e.pitch(e.restToNotePitch(H.getTransposedPitch(-2),X.ClefType),!1,X)[0]]}}}if(M.RealValue===B.sourceNote.SourceMeasure.ActiveTimeSignature.RealValue&&(x=["d/5"],P="w",A=0,L=!0,O=g.WholeRestXShiftVexflow*k.unitInPixels),B.sourceNote.ParentStaff.Voices.length>1){var Y,K=B.parentVoiceEntry.parentStaffEntry.graphicalVoiceEntries,q=B.parentVoiceEntry.parentVoiceEntry.ParentVoice.VoiceId,Z=void 0,J=void 0,Q=b(K);try{for(Q.s();!(Y=Q.n()).done;){var $,ee=Y.value,te=b(ee.notes);try{for(te.s();!($=te.n()).done;){var ne=$.value;if(ne!==B&&!ne.sourceNote.isRest()&&ne.sourceNote.PrintObject){var ie=ne.parentVoiceEntry.parentVoiceEntry.WantedStemDirection,re=1===q||5===q,ae=re?1:-1,se=ne.sourceNote.Pitch.getHalfTone();(!Z||1===ae&&se>Z||-1===ae&&se<Z)&&(Z=se,J=0,re&&ie===S.StemDirectionType.Up?J+=7:re||ie!==S.StemDirectionType.Down?J+=re?1:2:J+=7,P.includes("8")||ie===S.StemDirectionType.Up&&-1===ae&&(J+=1),ne.sourceNote.NoteBeam&&(J+=1),P.includes("w")&&(J/=2),J+=.5*Math.ceil(g.RestCollisionYPadding),J*=ae,B.lineShift=J)}}}catch(Pe){te.e(Pe)}finally{te.f()}}}catch(Pe){Q.e(Pe)}finally{Q.f()}if(Z>0){var oe=3,ue=B.Clef();switch(ue.ClefType){case a.ClefEnum.F:oe=5;break;case a.ClefEnum.C:oe=4}T=s.Pitch.fromHalftone(Z),x=[e.pitch(T,!0,ue,void 0,oe)[0]]}}break}var le=B.vfpitch;x.push(le[0]),_.push(le[1]),m||(m=e.Clef(le[2]).type)}}catch(Pe){N.e(Pe)}finally{N.f()}for(var ce=0,he=A;ce<he;++ce)P+="d";1===v.length&&(null===(f=v[0].sourceNote.Notehead)||void 0===f?void 0:f.Shape)===E.NoteHeadShape.SLASH&&(P+="s"),R&&(P+="r");var de={align_center:L,auto_stem:!0,clef:m,duration:P,keys:x,slash:t.GraceSlash},fe=t.notes[0].sourceNote;fe.IsCueNote&&(de.glyph_font_scale=r.DEFAULT_NOTATION_FONT_SCALE*r.GraceNote.SCALE,de.stroke_px=r.GraceNote.LEDGER_LINE_OFFSET),t.parentVoiceEntry.IsGrace||t.notes[0].sourceNote.IsCueNote?C=new r.GraceNote(de):(C=new r.StaveNote(de)).stagger_same_whole_notes=g.StaggerSameWholeNotes;var pe=t.notes[0].lineShift;if(0!==pe&&(C.getKeyProps()[0].line+=pe),v.length>1)for(var me=0;me<v.length;me++)(null===(p=v[me].sourceNote.Notehead)||void 0===p?void 0:p.Shape)===E.NoteHeadShape.SLASH&&(C.note_heads[me].note_type="s");if(C.getKeyProps().forEach((function(e,n){var i=e.line;return t.notes[n].staffLine=i})),(g.LedgerLineWidth||g.LedgerLineStrokeStyle)&&(C.ledgerLineStyle||(C.ledgerLineStyle={}),g.LedgerLineWidth&&(C.ledgerLineStyle.lineWidth=g.LedgerLineWidth),g.LedgerLineStrokeStyle&&(C.ledgerLineStyle.strokeStyle=g.LedgerLineStrokeStyle)),g.ColoringEnabled){var ve=g.DefaultColorStem,ge=t.parentVoiceEntry.StemColor;!ge&&ve&&(ge=ve);var ye={fillStyle:ge,strokeStyle:ge};ge&&(C.setStemStyle(ye),C.flag&&g.ColorFlags&&C.setFlagStyle(ye))}if(C.x_shift=O,t.parentVoiceEntry.IsGrace&&t.notes[0].sourceNote.NoteBeam&&(t.parentVoiceEntry.WantedStemDirection=t.notes[0].sourceNote.NoteBeam.Notes[0].ParentVoiceEntry.WantedStemDirection),t.parentVoiceEntry)switch(t.parentVoiceEntry.WantedStemDirection){case S.StemDirectionType.Up:C.setStemDirection(r.Stem.UP),t.parentVoiceEntry.StemDirection=S.StemDirectionType.Up;break;case S.StemDirectionType.Down:C.setStemDirection(r.Stem.DOWN),t.parentVoiceEntry.StemDirection=S.StemDirectionType.Down}for(var be=0,Se=v.length;be<Se;be+=1){if(v[be].setIndex(C,be),_[be]){if("###"===_[be]){C.addAccidental(be,new r.Accidental("##")),C.addAccidental(be,new r.Accidental("#"));continue}if("bbs"===_[be]){C.addAccidental(be,new r.Accidental("bb")),C.addAccidental(be,new r.Accidental("b"));continue}C.addAccidental(be,new r.Accidental(_[be]))}var xe=v[be].sourceNote.TremoloStrokes;if(xe>0){var _e=new r.Tremolo(xe);_e.extra_stroke_scale=g.TremoloStrokeScale,_e.y_spacing_scale=g.TremoloYSpacingScale,C.addModifier(be,_e)}}if(.25===fe.Length.RealValue&&fe.Notehead&&!1===fe.Notehead.Filled)for(var Ee=C.getKeyProps(),ke=0;ke<Ee.length;ke++)Ee[ke].code="v81";for(var Me=0,we=A;Me<we;++Me)C.addDotToAll();return C}},{key:"generateArticulations",value:function(e,t,n){if(e&&"GhostNote"!==e.getAttribute("type")){var i,a=b(t.sourceNote.ParentVoiceEntry.Articulations);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=void 0,u=r.Modifier.Position.ABOVE;e.getStemDirection()===r.Stem.UP&&(u=r.Modifier.Position.BELOW);var l=s.articulationEnum;switch(n.ArticulationPlacementFromXML&&(s.placement===w.PlacementEnum.Above?u=r.Modifier.Position.ABOVE:s.placement===w.PlacementEnum.Below&&(u=r.Modifier.Position.BELOW)),l){case S.ArticulationEnum.accent:o=new r.Articulation("a>");var c,h=t.sourceNote.NoteSlurs,d=b(h);try{for(d.s();!(c=d.n()).done;){var f=c.value;f.StartNote===t.sourceNote&&(f.PlacementXml===w.PlacementEnum.Above?o.setYShift(10*-n.SlurStartArticulationYOffsetOfArticulation):f.PlacementXml===w.PlacementEnum.Below&&o.setYShift(10*n.SlurStartArticulationYOffsetOfArticulation))}}catch(p){d.e(p)}finally{d.f()}break;case S.ArticulationEnum.downbow:o=new r.Articulation("am"),void 0===s.placement&&(u=r.Modifier.Position.ABOVE,s.placement=w.PlacementEnum.Above);break;case S.ArticulationEnum.fermata:o=new r.Articulation("a@a"),u=r.Modifier.Position.ABOVE,s.placement=w.PlacementEnum.Above;break;case S.ArticulationEnum.marcatodown:o=new r.Articulation("a|");break;case S.ArticulationEnum.marcatoup:o=new r.Articulation("a^"),u=r.Modifier.Position.ABOVE;break;case S.ArticulationEnum.invertedfermata:o=new r.Articulation("a@u"),u=r.Modifier.Position.BELOW,s.placement=w.PlacementEnum.Below;break;case S.ArticulationEnum.lefthandpizzicato:o=new r.Articulation("a+");break;case S.ArticulationEnum.naturalharmonic:o=new r.Articulation("ah");break;case S.ArticulationEnum.snappizzicato:o=new r.Articulation("ao");break;case S.ArticulationEnum.staccatissimo:o=new r.Articulation("av");break;case S.ArticulationEnum.staccato:o=new r.Articulation("a.");break;case S.ArticulationEnum.tenuto:o=new r.Articulation("a-");break;case S.ArticulationEnum.upbow:o=new r.Articulation("a|"),void 0===s.placement&&(u=r.Modifier.Position.ABOVE,s.placement=w.PlacementEnum.Above);break;case S.ArticulationEnum.strongaccent:o=new r.Articulation("a^")}o&&(o.setPosition(u),e.addModifier(0,o))}}catch(p){a.e(p)}finally{a.f()}}}},{key:"generateOrnaments",value:function(e,t){var n,i=r.Modifier.Position.ABOVE;switch(t.placement===w.PlacementEnum.Below&&(i=r.Modifier.Position.BELOW),t.GetOrnament){case _.OrnamentEnum.DelayedInvertedTurn:(n=new r.Ornament("turn_inverted")).setDelayed(!0);break;case _.OrnamentEnum.DelayedTurn:(n=new r.Ornament("turn")).setDelayed(!0);break;case _.OrnamentEnum.InvertedMordent:(n=new r.Ornament("mordent")).setDelayed(!1);break;case _.OrnamentEnum.InvertedTurn:(n=new r.Ornament("turn_inverted")).setDelayed(!1);break;case _.OrnamentEnum.Mordent:(n=new r.Ornament("mordent_inverted")).setDelayed(!1);break;case _.OrnamentEnum.Trill:(n=new r.Ornament("tr")).setDelayed(!1);break;case _.OrnamentEnum.Turn:(n=new r.Ornament("turn")).setDelayed(!1);break;default:return void v.default.warn("unhandled OrnamentEnum type: "+t.GetOrnament)}n&&(t.AccidentalBelow!==c.AccidentalEnum.NONE&&n.setLowerAccidental(s.Pitch.accidentalVexflow(t.AccidentalBelow)),t.AccidentalAbove!==c.AccidentalEnum.NONE&&n.setUpperAccidental(s.Pitch.accidentalVexflow(t.AccidentalAbove)),n.setPosition(i),e.addModifier(0,n))}},{key:"StrokeTypeFromArpeggioType",value:function(e){switch(e){case M.ArpeggioType.ARPEGGIO_DIRECTIONLESS:return r.Stroke.Type.ARPEGGIO_DIRECTIONLESS;case M.ArpeggioType.BRUSH_DOWN:return r.Stroke.Type.BRUSH_UP;case M.ArpeggioType.BRUSH_UP:return r.Stroke.Type.BRUSH_DOWN;case M.ArpeggioType.RASQUEDO_DOWN:return r.Stroke.Type.RASQUEDO_UP;case M.ArpeggioType.RASQUEDO_UP:return r.Stroke.Type.RASQUEDO_DOWN;case M.ArpeggioType.ROLL_DOWN:return r.Stroke.Type.ROLL_UP;case M.ArpeggioType.ROLL_UP:return r.Stroke.Type.ROLL_DOWN;default:return r.Stroke.Type.ARPEGGIO_DIRECTIONLESS}}},{key:"CreateTabNote",value:function(t){var n,i=[],a=t.notes.reverse(),s=[],o=t.notes[0].graphicalNoteLength,u=void 0!==t.notes[0].sourceNote.NoteTuplet,l=e.durations(o,u)[0],c=0,h=b(t.notes);try{var d=function(){var e=n.value,t=e.sourceNote,a={str:t.StringNumberTab,fret:t.FretNumber};i.push(a),t.BendArray&&t.BendArray.forEach((function(e){var t,n=e.bendalter-a.fret;t=n>1?"Full":1===n?"1/2":"1/4","up"===e.direction?s.push({type:r.Bend.UP,text:t,width:10}):s.push({type:r.Bend.DOWN,text:t,width:10})})),c<e.numberOfDots&&(c=e.numberOfDots)};for(h.s();!(n=h.n()).done;)d()}catch(y){h.e(y)}finally{h.f()}for(var f=0,p=c;f<p;++f)l+="d";for(var m=new r.TabNote({duration:l,positions:i}),v=0,g=a.length;v<g;v+=1)a[v].setIndex(m,v);return s.forEach((function(e){e.type===r.Bend.UP?m.addModifier(new r.Bend(e.text,!1)):m.addModifier(new r.Bend(e.text,!0))})),m}},{key:"Clef",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";switch("default"!==i&&"small"!==i&&(v.default.warn('Invalid VexFlow clef size "'.concat(i,'" specified. Using "default".')),i="default"),e.ClefType){case a.ClefEnum.G:switch(e.Line){case 1:t="french";break;case 2:t="treble";break;default:t="treble",v.default.error("Clef ".concat(a.ClefEnum[e.ClefType]," on line ").concat(e.Line,' not supported by VexFlow. Using default value "').concat(t,'".'))}break;case a.ClefEnum.F:switch(e.Line){case 4:t="bass";break;case 3:t="baritone-f";break;case 5:t="subbass";break;default:t="bass",v.default.error("Clef ".concat(a.ClefEnum[e.ClefType]," on line ").concat(e.Line,' not supported by VexFlow. Using default value "').concat(t,'".'))}break;case a.ClefEnum.C:switch(e.Line){case 3:t="alto";break;case 4:t="tenor";break;case 1:t="soprano";break;case 2:t="mezzo-soprano";break;default:t="alto",v.default.error("Clef ".concat(a.ClefEnum[e.ClefType]," on line ").concat(e.Line,' not supported by VexFlow. Using default value "').concat(t,'".'))}break;case a.ClefEnum.percussion:t="percussion";break;case a.ClefEnum.TAB:t="treble";break;default:v.default.info("bad clef type: "+e.ClefType),t="treble"}return 1===e.OctaveOffset&&"bass"!==t?n="8va":-1===e.OctaveOffset&&(n="8vb"),{type:t,size:i,annotation:n}}},{key:"TimeSignature",value:function(e){var t;switch(e.SymbolEnum){case u.RhythmSymbolEnum.NONE:t=e.Rhythm.Numerator+"/"+e.Rhythm.Denominator;break;case u.RhythmSymbolEnum.COMMON:t="C";break;case u.RhythmSymbolEnum.CUT:t="C|"}return new r.TimeSignature(t)}},{key:"keySignature",value:function(t){if(t){var n;switch(t.Mode){case l.KeyEnum.minor:n=e.minorMap[t.Key]+"m";break;case l.KeyEnum.major:case l.KeyEnum.none:n=e.majorMap[t.Key];break;default:n="C"}return n}}},{key:"line",value:function(e,t){switch(e){case d.SystemLinesEnum.SingleThin:return t===x.SystemLinePosition.MeasureBegin?r.StaveConnector.type.SINGLE:r.StaveConnector.type.SINGLE_RIGHT;case d.SystemLinesEnum.DoubleThin:return r.StaveConnector.type.THIN_DOUBLE;case d.SystemLinesEnum.ThinBold:return r.StaveConnector.type.BOLD_DOUBLE_RIGHT;case d.SystemLinesEnum.BoldThinDots:return r.StaveConnector.type.BOLD_DOUBLE_LEFT;case d.SystemLinesEnum.DotsThinBold:case d.SystemLinesEnum.DotsBoldBoldDots:return r.StaveConnector.type.BOLD_DOUBLE_RIGHT;case d.SystemLinesEnum.None:return r.StaveConnector.type.NONE}}},{key:"font",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.FontStyles.Regular,n=(arguments.length>2&&void 0!==arguments[2]||p.Fonts.TimesNewRoman,arguments.length>4?arguments[4]:void 0),i="normal",r="normal",a="'".concat((arguments.length>3?arguments[3]:void 0).DefaultFontFamily,"'");switch(t){case f.FontStyles.Bold:r="bold";break;case f.FontStyles.Italic:i="italic";break;case f.FontStyles.BoldItalic:i="italic",r="bold";case f.FontStyles.Underlined:}return p.Fonts.Kokila,n&&"default"!==n&&(a="'".concat(n,"'")),i+" "+r+" "+Math.floor(e)+"px "+a}},{key:"fontStyle",value:function(e){switch(e){case f.FontStyles.Bold:return"bold";case f.FontStyles.Italic:return"italic";case f.FontStyles.BoldItalic:return"italic bold";default:return"normal"}}},{key:"style",value:function(e){return m.OUTLINE_AND_FILL_STYLE_DICT.getValue(e)}}]),e}();t.VexFlowConverter=P,P.majorMap={"-1":"F","-2":"Bb","-3":"Eb","-4":"Ab","-5":"Db","-6":"Gb","-7":"Cb","-8":"Fb",0:"C",1:"G",2:"D",3:"A",4:"E",5:"B",6:"F#",7:"C#",8:"G#"},P.minorMap={"-1":"D","-2":"G","-3":"C","-4":"F","-5":"Bb","-6":"Eb","-7":"Ab","-8":"Db",0:"A",1:"E",2:"B",3:"F#",4:"C#",5:"G#",6:"D#",7:"A#",8:"E#"}},4679:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowGraphicalNote=void 0;var i=n(3486),r=n(8129),a=n(5853),l=function(e){h(n,e);var t=d(n);function n(e,i,o){var u,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.OctaveEnum.NONE,c=arguments.length>4?arguments[4]:void 0,h=arguments.length>5?arguments[5]:void 0;if(g(this,n),(u=t.call(this,e,i,c,h)).clef=o,u.octaveShift=l,e.Pitch){var d=e.isRest()?e.Pitch:a.OctaveShift.getPitchFromOctaveShift(e.Pitch,l);u.vfpitch=r.VexFlowConverter.pitch(d,e.isRest(),u.clef,u.sourceNote.Notehead),u.vfpitch[1]=void 0}return s(u)}return y(n,[{key:"setAccidental",value:function(e){var t=this.drawPitch(e);this.vfpitch=r.VexFlowConverter.pitch(t,this.sourceNote.isRest(),this.clef,this.sourceNote.Notehead),this.DrawnAccidental=t.Accidental}},{key:"drawPitch",value:function(e){return a.OctaveShift.getPitchFromOctaveShift(e,this.octaveShift)}},{key:"Transpose",value:function(e,t,i,s){var l=o(u(n.prototype),"Transpose",this).call(this,e,t,i,s),c=a.OctaveShift.getPitchFromOctaveShift(l,this.octaveShift);return this.vfpitch=r.VexFlowConverter.pitch(c,this.sourceNote.isRest(),this.clef,this.sourceNote.Notehead),this.vfpitch[1]=void 0,c}},{key:"setIndex",value:function(e,t){this.vfnote=[e,t],this.vfnoteIndex=t}},{key:"notehead",value:function(e){var t=e;t||(t=this.vfnote[0]);var n=t.note_heads;return n&&n.length>this.vfnoteIndex&&n[this.vfnoteIndex]?t.note_heads[this.vfnoteIndex]:{line:0}}},{key:"Clef",value:function(){return this.clef}},{key:"getSVGId",value:function(){if(this.vfnote)return this.vfnote[0].getAttribute("id")}},{key:"getSVGGElement",value:function(){if(this.vfnote)return this.vfnote[0].getAttribute("el")}},{key:"getStemSVG",value:function(){return document.getElementById("vf-"+this.getSVGId()+"-stem")}},{key:"getBeamSVGs",value:function(){for(var e=[],t=0;;t++){var n=document.getElementById("vf-".concat(this.getSVGId(),"-beam").concat(t));if(!n)break;e.push(n)}return e}}]),n}(i.GraphicalNote);t.VexFlowGraphicalNote=l},8144:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowGraphicalSymbolFactory=void 0;var r=i(n(6368)).default.Flow,a=n(8494),s=n(7330),o=n(9252),u=n(5853),l=n(4679),c=n(4146),h=n(5460),d=n(8129),f=n(8790),p=n(4828),m=n(4405),v=n(6040),S=n(8965);t.VexFlowGraphicalSymbolFactory=function(){function e(){g(this,e),this.hasBBox=!1,void 0!==document.createElementNS("http://www.w3.org/2000/svg","g").getBBox&&(this.hasBBox=!0)}return y(e,[{key:"createMusicSystem",value:function(e,t){return new a.VexFlowMusicSystem(e,t)}},{key:"createStaffLine",value:function(e,t){return new p.VexFlowStaffLine(e,t)}},{key:"createSkyBottomLineCalculator",value:function(e){return e.ParentMusicSystem.rules.PerformanceMode&&this.hasBBox?new S.SkyBottomLineCalculatorSVG(e):new v.SkyBottomLineCalculator(e)}},{key:"createGraphicalMeasure",value:function(e,t){return new s.VexFlowMeasure(t,e,void 0)}},{key:"createMultiRestMeasure",value:function(e,t,n){return new m.VexFlowMultiRestMeasure(t,e,n)}},{key:"createTabStaffMeasure",value:function(e,t){return new f.VexFlowTabMeasure(t,e)}},{key:"createExtraGraphicalMeasure",value:function(e){var t=new s.VexFlowMeasure(e.ParentStaff,void 0,e);return t.IsExtraGraphicalMeasure=!0,t.ExtraGraphicalMeasurePreviousMeasure=e.Measures.last(),t}},{key:"createStaffEntry",value:function(e,t){return new o.VexFlowStaffEntry(t,e,void 0)}},{key:"createVoiceEntry",value:function(e,t){return new h.VexFlowVoiceEntry(e,t)}},{key:"createNote",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.OctaveEnum.NONE,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return new l.VexFlowGraphicalNote(e,t,n,i,r,a)}},{key:"createGraceNote",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u.OctaveEnum.NONE;return new l.VexFlowGraphicalNote(e,t,n,r,i)}},{key:"addGraphicalAccidental",value:function(e,t){e.setAccidental(t)}},{key:"addFermataAtTiedEndNote",value:function(e,t){}},{key:"createInStaffClef",value:function(e,t){var n=e,i=d.VexFlowConverter.Clef(t,"small");n.vfClefBefore=new r.ClefNote(i.type,i.size,i.annotation)}},{key:"createChordSymbols",value:function(e,t,n,i){var r,a=t.parentMeasure.parentSourceMeasure.Rules,s=0,o=a.ChordSymbolXSpacing,u=b(e.ChordContainers);try{for(u.s();!(r=u.n()).done;){var l=r.value,h=new c.GraphicalChordSymbolContainer(l,t.PositionAndShape,a.ChordSymbolTextHeight,n,i,t.parentMeasure.parentSourceMeasure.Rules),d=h.GraphicalLabel;d.PositionAndShape.RelativePosition.y-=a.ChordSymbolYOffset,d.PositionAndShape.RelativePosition.x+=s,d.setLabelPositionAndShapeBorders(),h.PositionAndShape.calculateBoundingBox(),t.graphicalChordContainers.push(h),s+=d.PositionAndShape.Size.width+o}}catch(f){u.e(f)}finally{u.f()}}},{key:"createGraphicalTechnicalInstruction",value:function(e,t){}}]),e}()},6351:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowInstantaneousDynamicExpression=void 0;var i=n(9428),r=n(9793),a=n(9946),s=n(2255),o=n(1274),u=n(2562),l=function(e){h(n,e);var t=d(n);function n(e,i,r){var l;g(this,n),l=t.call(this,e,i,r);var c=new s.Label(l.Expression);return l.label=new a.GraphicalLabel(c,l.rules.ContinuousDynamicTextHeight,o.TextAlignmentEnum.CenterCenter,l.rules,l.PositionAndShape),l.label.Label.fontStyle=u.FontStyles.BoldItalic,l.label.setLabelPositionAndShapeBorders(),l.PositionAndShape.calculateBoundingBox(),l}return y(n,[{key:"InstantaneousDynamic",get:function(){return this.mInstantaneousDynamicExpression}},{key:"Expression",get:function(){return r.DynamicEnum[this.mInstantaneousDynamicExpression.DynEnum]}}]),n}(i.GraphicalInstantaneousDynamicExpression);t.VexFlowInstantaneousDynamicExpression=l},8939:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowInstrumentBrace=void 0;var r=i(n(6368)).default.Flow,a=function(e){h(n,e);var t=d(n);function n(e,i){var a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return g(this,n),(a=t.call(this,e,i,s)).vexflowConnector.setType(r.StaveConnector.type.BRACE),a}return n}(n(5575).VexFlowInstrumentBracket);t.VexFlowInstrumentBrace=a},5575:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowInstrumentBracket=void 0;var r=i(n(6368)).default.Flow,a=n(4785),s=n(8911),o=n(5820),u=function(e){h(n,e);var t=d(n);function n(e,i){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;g(this,n),(a=t.call(this)).Visible=!0,a.PositionAndShape=new s.BoundingBox(c(a),e.ParentMusicSystem.PositionAndShape);var u=e.Measures[0],l=i.Measures[0];return a.addConnector(u.getVFStave(),l.getVFStave(),r.StaveConnector.type.BRACKET,o),a}return y(n,[{key:"draw",value:function(e){this.Visible&&this.vexflowConnector.setContext(e).draw();var t=this.vexflowConnector,n=t.top_stave.getYForLine(0),i=t.bottom_stave.getYForLine(t.bottom_stave.getNumLines()-1)+t.thickness;this.PositionAndShape.AbsolutePosition.x=(t.top_stave.getX()-2+t.x_shift)/o.unitInPixels,this.PositionAndShape.AbsolutePosition.y=n/o.unitInPixels,this.PositionAndShape.Size.height=(i-n)/o.unitInPixels,this.PositionAndShape.Size.width=12/o.unitInPixels}},{key:"addConnector",value:function(e,t,n,i){this.vexflowConnector=new r.StaveConnector(e,t).setType(n).setXShift(-5*i)}}]),n}(a.GraphicalObject);t.VexFlowInstrumentBracket=u},7330:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StavePositionEnum=t.VexFlowMeasure=void 0;var r,a=i(n(6368)).default.Flow,s=n(1513),l=n(6894),c=n(289),f=n(8129),p=a.NoteSubGroup,m=i(n(2043)),v=n(5820),x=n(6189),_=n(1225),E=n(908),k=n(5460),M=n(1797),w=n(1405),P=n(3748),T=n(2478),C=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,e,i,r)).isTabMeasure=!1,a.octaveOffset=3,a.vfVoices={},a.vfTies=[],a.vfRepetitionWords=[],a.connectors=[],a.beams={},a.autoVfBeams=[],a.autoTupletVfBeams=[],a.vfbeams={},a.tuplets={},a.vftuplets={},a.minimumStaffEntriesWidth=-1,a.rules=r?r.ParentMusicSystem.rules:i?i.Rules:new w.EngravingRules,a.resetLayout(),a}return y(n,[{key:"setAbsoluteCoordinates",value:function(e,t){this.stave.setX(e).setY(t)}},{key:"resetLayout",value:function(){this.stave=new a.Stave(0,0,0,{fill_style:this.rules.StaffLineColor,space_above_staff_ln:0,space_below_staff_ln:0}),this.stave.MeasureNumber=this.MeasureNumber,this.ParentStaff&&this.setLineNumber(this.ParentStaff.StafflineCount),this.stave.setBegBarType(a.Barline.type.NONE),this.parentSourceMeasure&&this.parentSourceMeasure.endingBarStyleEnum===l.SystemLinesEnum.None&&this.stave.setEndBarType(a.Barline.type.NONE),this.updateInstructionWidth()}},{key:"clean",value:function(){this.vfTies.length=0,this.connectors=[],this.resetLayout()}},{key:"getLineWidth",value:function(e){switch(e){case l.SystemLinesEnum.BoldThinDots:case l.SystemLinesEnum.DotsThinBold:return 10/v.unitInPixels;case l.SystemLinesEnum.DotsBoldBoldDots:return 10/v.unitInPixels+this.rules.RepeatEndStartPadding;default:return 0}}},{key:"addClefAtBegin",value:function(e){if(this.rules.RenderClefsAtBeginningOfStaffline){if(this.octaveOffset=e.OctaveOffset,e.ClefType===c.ClefEnum.TAB)this.stave.addClef("tab",void 0,void 0,void 0);else{var t=f.VexFlowConverter.Clef(e,"default");this.stave.addClef(t.type,t.size,t.annotation,a.StaveModifier.Position.BEGIN)}this.updateInstructionWidth()}}},{key:"setLineNumber",value:function(e){5!==e&&(0===e?(this.stave.setNumLines(0),this.stave.getBottomLineY=function(){return this.getYForLine(this.options.num_lines)}):1===e?(this.stave.options.line_config=[{visible:!1},{visible:!1},{visible:!0},{visible:!1},{visible:!1}],this.stave.getBottomLineY=function(){return this.getYForLine(2)}):2===e?(this.stave.options.line_config=[{visible:!1},{visible:!1},{visible:!0},{visible:!0},{visible:!1}],this.stave.getBottomLineY=function(){return this.getYForLine(3)}):3===e?(this.stave.options.line_config=[{visible:!1},{visible:!0},{visible:!0},{visible:!0},{visible:!1}],this.stave.getBottomLineY=function(){return this.getYForLine(2)}):(this.stave.setNumLines(e),this.stave.getBottomLineY=function(){return this.getYForLine(this.options.num_lines)}))}},{key:"addKeyAtBegin",value:function(e,t,n){this.rules.RenderKeySignatures&&(this.stave.setKeySignature(f.VexFlowConverter.keySignature(e),f.VexFlowConverter.keySignature(t),void 0),this.updateInstructionWidth())}},{key:"addRhythmAtBegin",value:function(e){var t=f.VexFlowConverter.TimeSignature(e);this.stave.addModifier(t,a.StaveModifier.Position.BEGIN),this.ShowTimeSignature||t.setStyle({fillStyle:"#00000000"}),this.updateInstructionWidth()}},{key:"addClefAtEnd",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=f.VexFlowConverter.Clef(e,"small");if(t||!this.stave.endClef){this.stave.setEndClef(n.type,n.size,n.annotation);var i,r=b(this.stave.getModifiers());try{for(r.s();!(i=r.n()).done;){var s=i.value;if(t){var o=s.originalStrokeStyle,u=s.originalFillStyle;s.getStyle()&&(o&&u?(s.getStyle().strokeStyle=o,s.getStyle().fillStyle=u):(s.getStyle().strokeStyle=null,s.getStyle().fillStyle=null))}else if("clefs"===s.getCategory()&&s.getPosition()===a.StaveModifier.Position.END&&s.type===n.type){var l="#12345600",c=s.getStyle();c&&(s.originalStrokeStyle=c.strokeStyle,s.originalFillStyle=c.fillStyle),s.setStyle({strokeStyle:l,fillStyle:l})}}}catch(h){r.e(h)}finally{r.f()}return this.parentSourceMeasure.hasEndClef=!0,this.updateInstructionWidth()}}},{key:"addMeasureLine",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(t){case _.SystemLinePosition.MeasureBegin:e===l.SystemLinesEnum.BoldThinDots&&(n||(this.stave.modifiers[0].draw=function(e){switch(e.checkContext(),this.setRendered(),this.type){case a.Barline.type.SINGLE:this.drawVerticalBar(e,this.x,!1);break;case a.Barline.type.DOUBLE:this.drawVerticalBar(e,this.x,!0);break;case a.Barline.type.END:this.drawVerticalEndBar(e,this.x);break;case a.Barline.type.REPEAT_BEGIN:this.drawRepeatBar(e,this.x,!0);break;case a.Barline.type.REPEAT_END:this.drawRepeatBar(e,this.x,!1);break;case a.Barline.type.REPEAT_BOTH:this.drawRepeatBar(e,this.x,!1),this.drawRepeatBar(e,this.x,!0)}}),this.stave.setBegBarType(a.Barline.type.REPEAT_BEGIN));break;case _.SystemLinePosition.MeasureEnd:switch(e){case l.SystemLinesEnum.DotsBoldBoldDots:this.stave.setEndBarType(a.Barline.type.REPEAT_BOTH);break;case l.SystemLinesEnum.DotsThinBold:this.stave.setEndBarType(a.Barline.type.REPEAT_END);break;case l.SystemLinesEnum.DoubleThin:this.stave.setEndBarType(a.Barline.type.DOUBLE);break;case l.SystemLinesEnum.ThinBold:this.stave.setEndBarType(a.Barline.type.END);break;case l.SystemLinesEnum.None:this.stave.setEndBarType(a.Barline.type.NONE)}}}},{key:"addMeasureNumber",value:function(){var e=this.MeasureNumber.toString(),t=r.ABOVE;this.stave.setText(e,t,{justification:1,shift_x:0,shift_y:0})}},{key:"addWordRepetition",value:function(e){var t,n=a.StaveModifier.Position.END,i=this.beginInstructionsWidth;switch(e.type){case x.RepetitionInstructionEnum.Segno:t=a.Repetition.type.SEGNO_LEFT,n=a.StaveModifier.Position.LEFT;break;case x.RepetitionInstructionEnum.Coda:t=a.Repetition.type.CODA_LEFT,n=a.StaveModifier.Position.LEFT;break;case x.RepetitionInstructionEnum.DaCapo:t=a.Repetition.type.DC;break;case x.RepetitionInstructionEnum.DalSegno:t=a.Repetition.type.DS;break;case x.RepetitionInstructionEnum.Fine:t=a.Repetition.type.FINE;break;case x.RepetitionInstructionEnum.ToCoda:t=a.Repetition.type.TO_CODA;break;case x.RepetitionInstructionEnum.DaCapoAlFine:t=a.Repetition.type.DC_AL_FINE;break;case x.RepetitionInstructionEnum.DaCapoAlCoda:t=a.Repetition.type.DC_AL_CODA;break;case x.RepetitionInstructionEnum.DalSegnoAlFine:t=a.Repetition.type.DS_AL_FINE;break;case x.RepetitionInstructionEnum.DalSegnoAlCoda:t=a.Repetition.type.DS_AL_CODA}if(t){var r=new a.Repetition(t,i,-this.rules.RepetitionSymbolsYOffset);this.stave.addModifier(r,n)}else this.addVolta(e)}},{key:"addVolta",value:function(e){var t,i=a.Volta.type.BEGIN;if(e.type===x.RepetitionInstructionEnum.Ending){switch(e.alignment){case x.AlignmentType.Begin:i=this.parentSourceMeasure.endsRepetitionEnding()?a.Volta.type.BEGIN_END:a.Volta.type.BEGIN;break;case x.AlignmentType.End:if(this.parentSourceMeasure.beginsRepetitionEnding())return;i=a.Volta.type.END}var r,s=this.ParentStaffLine.SkyBottomLineCalculator,o=this.PositionAndShape.AbsolutePosition.x+this.PositionAndShape.BorderMarginLeft+.4,u=Math.max(this.PositionAndShape.AbsolutePosition.x+this.PositionAndShape.BorderMarginRight,o+.4),l=s.getSkyLineMinInRange(o,u)-2,c=-6.1+this.rules.VoltaOffset,h=this.rules.VoltaOffset;l<c&&(h+=l-c,c=l);for(var d=this.parentSourceMeasure.MeasureNumber,f=0;f<this.ParentStaffLine.Measures.length;f++){var p=this.ParentStaffLine.Measures[f];p instanceof n&&(p.MeasureNumber!==d-1&&p.MeasureNumber+(null===(t=p.parentSourceMeasure)||void 0===t?void 0:t.multipleRestMeasures)!==d||(r=p))}if(r)for(var m=r.stave.getModifiers(),g=0;g<m.length;g++){var y=m[g];if(y.hasOwnProperty("volta")){var b=r.ParentStaffLine.SkyBottomLineCalculator,S=r.PositionAndShape.AbsolutePosition.x+r.PositionAndShape.BorderMarginLeft+.4,_=Math.max(r.PositionAndShape.AbsolutePosition.x+r.PositionAndShape.BorderMarginRight,S+.4),E=b.getSkyLineMinInRange(S,_);E<=c?(h+=E-c,c=E):(y.y_shift=h*v.unitInPixels,r.ParentStaffLine.SkyBottomLineCalculator.updateSkyLineInRange(S,_,c))}}h*=10,this.stave.setVoltaType(i,e.endingIndices[0],h),s.updateSkyLineInRange(o,u,c)}}},{key:"setWidth",value:function(e){o(u(n.prototype),"setWidth",this).call(this,e),this.stave.setWidth(e*v.unitInPixels)}},{key:"layoutSymbols",value:function(){}},{key:"draw",value:function(e){var t,n,i,r,a,s=e.openGroup();null===(t=null==s?void 0:s.classList)||void 0===t||t.add("vf-measure");var o=e.openGroup();null===(n=null==o?void 0:o.classList)||void 0===n||n.add("vf-stave"),this.stave.setContext(e).draw(),e.closeGroup();var u=e.openGroup();for(var l in null===(i=null==u?void 0:u.classList)||void 0===i||i.add("vf-voices"),this.vfVoices)this.vfVoices.hasOwnProperty(l)&&(e.save(),this.vfVoices[l].draw(e,this.stave),e.restore());e.closeGroup();var c=e.openGroup();for(var h in null===(r=null==c?void 0:c.classList)||void 0===r||r.add("vf-beams"),this.vfbeams)if(this.vfbeams.hasOwnProperty(h)){var d,f=b(this.vfbeams[h]);try{for(f.s();!(d=f.n()).done;)d.value.setContext(e).draw()}catch(T){f.e(T)}finally{f.f()}}if(this.autoVfBeams){var p,m=b(this.autoVfBeams);try{for(m.s();!(p=m.n()).done;)p.value.setContext(e).draw()}catch(T){m.e(T)}finally{m.f()}}if(!this.isTabMeasure||this.rules.TupletNumbersInTabs){if(this.autoTupletVfBeams){var v,g=b(this.autoTupletVfBeams);try{for(g.s();!(v=g.n()).done;)v.value.setContext(e).draw()}catch(T){g.e(T)}finally{g.f()}}for(var y in this.vftuplets)if(this.vftuplets.hasOwnProperty(y))for(var S=0;S<this.tuplets[y].length;S++){var x=this.tuplets[y][S][0],_=this.vftuplets[y][S];x.RenderTupletNumber?_.RenderTupletNumber=!0:_.RenderTupletNumber=!1,_.setContext(e).draw()}}e.closeGroup(),e.closeGroup();var E=e.openGroup();null===(a=null==E?void 0:E.classList)||void 0===a||a.add("vf-ties");var k,M=b(this.vfTies);try{for(M.s();!(k=M.n()).done;)k.value.setContext(e).draw()}catch(T){M.e(T)}finally{M.f()}e.closeGroup();var w,P=b(this.connectors);try{for(P.s();!(w=P.n()).done;)w.value.setContext(e).draw()}catch(T){P.e(T)}finally{P.f()}return this.correctNotePositions(),s}},{key:"format",value:function(){this.formatVoices&&this.formatVoices((this.PositionAndShape.Size.width-this.beginInstructionsWidth-this.endInstructionsWidth)*v.unitInPixels,this)}},{key:"correctNotePositions",value:function(){if(!this.isTabMeasure){var e,t=b(this.getVoicesWithinMeasure());try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.VoiceEntries);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=b(s.Notes);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=this.rules.GNote(u);if(!(null==l?void 0:l.vfnote))return;var c=l.vfnote[0],h=0;l.parentVoiceEntry.parentVoiceEntry.StemDirection===E.StemDirectionType.Up&&"w"!==l.vfnote[0].getDuration()?h+=3.5:h+=.5,h+=-l.notehead(c).line+l.parentVoiceEntry.notes.last().notehead().line,l.PositionAndShape.RelativePosition.y=h}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}}}catch(d){t.e(d)}finally{t.f()}}}},{key:"getVoicesWithinMeasure",value:function(){var e,t=[],n=b(this.staffEntries);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,a=b(r.graphicalVoiceEntries);try{for(a.s();!(i=a.n()).done;){var s=i.value;-1===t.indexOf(s.parentVoiceEntry.ParentVoice)&&t.push(s.parentVoiceEntry.ParentVoice)}}catch(o){a.e(o)}finally{a.f()}}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"getGraphicalVoiceEntriesPerVoice",value:function(e){var t,n=[],i=b(this.staffEntries);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,s=b(a.graphicalVoiceEntries);try{for(s.s();!(r=s.n()).done;){var o=r.value;o.parentVoiceEntry.ParentVoice===e&&n.push(o)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getRestFilledVexFlowStaveNotesPerVoice",value:function(e){for(var t,n=this.getGraphicalVoiceEntriesPerVoice(e),i=0;i<n.length;i++){var r,a=n[i],s=a.notes[0].sourceNote.getAbsoluteTimestamp(),o=new M.Fraction,u=b(a.notes);try{for(u.s();!(r=u.n()).done;){var l=r.value,c=M.Fraction.plus(l.sourceNote.getAbsoluteTimestamp(),l.sourceNote.Length);o.lt(c)&&(o=c)}}catch(E){u.e(E)}finally{u.f()}if(t){var h=M.Fraction.minus(s,t);if(h.RealValue>0){var d;m.default.trace("Ghost Found in between (measure ".concat(this.MeasureNumber,")"));var f=this.createGhostGves(h);(d=n).splice.apply(d,[i,0].concat(S(f))),i+=f.length}}else{var p=M.Fraction.minus(s,this.parentSourceMeasure.AbsoluteTimestamp);if(p.RealValue>0){var v;m.default.trace("Ghost Found at start (measure ".concat(this.MeasureNumber,")"));var g=this.createGhostGves(p);(v=n).splice.apply(v,[0,0].concat(S(g))),i+=g.length}}t=o}var y=M.Fraction.plus(this.parentSourceMeasure.AbsoluteTimestamp,this.parentSourceMeasure.Duration),x=M.Fraction.minus(y,t);if(x.RealValue>0){m.default.trace("Ghost Found at end (measure ".concat(this.MeasureNumber,")"));var _=this.createGhostGves(x);n=n.concat(_)}return n}},{key:"createGhostGves",value:function(e){var t,n=f.VexFlowConverter.GhostNotes(e),i=[],r=b(n);try{for(r.s();!(t=r.n()).done;){var a=t.value,s=new k.VexFlowVoiceEntry(void 0,void 0,this.rules);s.vfStaveNote=a,i.push(s)}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"handleBeam",value:function(e,t){var n,i=e.sourceNote.ParentVoiceEntry.ParentVoice.VoiceId,r=this.beams[i];r||(r=this.beams[i]=[]);var a,s=b(r);try{for(s.s();!(a=s.n()).done;){var o=a.value;o[0]===t&&(n=o)}}catch(l){s.e(l)}finally{s.f()}n||(n=[t,[]],r.push(n));var u=e.parentVoiceEntry;n[1].indexOf(u)<0&&n[1].push(u)}},{key:"handleTuplet",value:function(e,t){var n=e.sourceNote.ParentVoiceEntry.ParentVoice.VoiceId;t=e.sourceNote.NoteTuplet;var i,r=this.tuplets[n];r||(r=this.tuplets[n]=[]);var a,s=b(r);try{for(s.s();!(a=s.n()).done;){var o=a.value;o[0]===t&&(i=o)}}catch(l){s.e(l)}finally{s.f()}i||(i=[t,[]],r.push(i));var u=e.parentVoiceEntry;i[1].indexOf(u)<0&&i[1].push(u)}},{key:"finalizeBeams",value:function(){this.vfbeams={};var e=[];for(var t in this.beams)if(this.beams.hasOwnProperty(t)){var n=this.vfbeams[t];n||(n=this.vfbeams[t]=[]);var i,r=b(this.beams[t]);try{for(r.s();!(i=r.n()).done;){var s,o=i.value,u=!1,l=b(o[0].Notes);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c.Length.RealValue>=new M.Fraction(1,4).RealValue&&(!c.TypeLength||c.TypeLength.RealValue>.125)){u=!0;break}}}catch(L){l.e(L)}finally{l.f()}if(u)m.default.debug("Beam between note >= quarter, likely tremolo, currently unsupported. continuing.");else{var h,d=[],f=o[0],p=o[1],v=!0,g=b(p);try{for(g.s();!(h=g.n()).done;){var y=h.value;y.parentVoiceEntry.ParentVoice===f.Notes[0].ParentVoiceEntry.ParentVoice&&(v=y.parentVoiceEntry.WantedStemDirection===E.StemDirectionType.Undefined)}}catch(L){g.e(L)}finally{g.f()}var S,x=void 0,_=!1,k=[],w=b(p);try{for(w.s();!(S=w.n()).done;){var P=S.value,T=P.vfStaveNote;T&&(d.push(T),e.push(T)),P.parentVoiceEntry.IsGrace&&(_=!0),P.parentVoiceEntry.StemColor&&this.rules.ColoringEnabled&&k.push(P.parentVoiceEntry.StemColor)}}catch(L){w.e(L)}finally{w.f()}if(d.length>1){var C=new a.Beam(d,v);if(_&&(C.render_options.beam_width=3,C.render_options.partial_beam_length=4),k.length>=2&&this.rules.ColorBeams){x=k[0];var I,A=b(k);try{for(A.s();!(I=A.n()).done;)if(I.value!==x){x=void 0;break}}catch(L){A.e(L)}finally{A.f()}C.setStyle({fillStyle:x,strokeStyle:x})}this.rules.FlatBeams&&(C.render_options.flat_beams=!0,C.render_options.flat_beam_offset=this.rules.FlatBeamOffset,C.render_options.flat_beam_offset_per_beam=this.rules.FlatBeamOffsetPerBeam),n.push(C)}else m.default.debug("Warning! Beam with no notes!")}}}catch(L){r.e(L)}finally{r.f()}}this.rules.AutoBeamNotes&&this.autoBeamNotes(e)}},{key:"autoBeamNotes",value:function(e){if(this.rules.AutoBeamTabs||!this.isTabMeasure){var t,n=[],i=[],r=[];this.autoTupletVfBeams=[];var s=[];this.autoVfBeams=[];var o=this.parentSourceMeasure.ActiveTimeSignature;o||(o=this.parentSourceMeasure.Duration);var u,l=b(this.staffEntries);try{for(l.s();!(u=l.n()).done;){var c,h=u.value,d=b(h.graphicalVoiceEntries);try{for(d.s();!(c=d.n()).done;){var f=c.value,p=f.vfStaveNote,m=f.notes[0],v=h.relInMeasureTimestamp.isOnBeat(o),g=i.length>=2,y=m.sourceNote.Length.RealValue-new M.Fraction(1,4).RealValue>-M.Fraction.FloatInaccuracyTolerance,S=f.parentVoiceEntry.IsGrace||y||e.contains(p);if(S||v){if(g){var x,_=b(i);try{for(_.s();!(x=_.n()).done;){var E=x.value;n.push(E)}}catch(Q){_.e(Q)}finally{_.f()}s.push(n.slice()),n=[]}if(i=[],S)continue}var k=f.notes[0].sourceNote.NoteTuplet;if(k){var w,P=!1,C=b(k.Notes);try{for(C.s();!(w=C.n()).done;){var I,A=w.value,L=b(A);try{for(L.s();!(I=L.n()).done;){var O=I.value;if(O.NoteTypeXml>=T.NoteType.QUARTER||O.ParentVoiceEntry.IsGrace||O.isRest()&&!this.rules.AutoBeamOptions.beam_rests){P=!0;break}}}catch(Q){L.e(Q)}finally{L.f()}if(P)break}}catch(Q){C.e(Q)}finally{C.f()}if(t){if(t!==k){if(r.length>1){var R=new a.Beam(r,!0);this.rules.FlatBeams&&(R.render_options.flat_beams=!0,R.render_options.flat_beam_offset=this.rules.FlatBeamOffset,R.render_options.flat_beam_offset_per_beam=this.rules.FlatBeamOffsetPerBeam),this.autoTupletVfBeams.push(R)}r=[],t=k}}else t=k;P||r.push(p)}else t=void 0,i.push(p)}}catch(Q){d.e(Q)}finally{d.f()}}}catch(Q){l.e(Q)}finally{l.f()}if(r.length>=2){var N=new a.Beam(r,!0);this.rules.FlatBeams&&(N.render_options.flat_beams=!0,N.render_options.flat_beam_offset=this.rules.FlatBeamOffset,N.render_options.flat_beam_offset_per_beam=this.rules.FlatBeamOffsetPerBeam),this.autoTupletVfBeams.push(N)}if(i.length>=2){var B,D=b(i);try{for(D.s();!(B=D.n()).done;){var F=B.value;n.push(F)}}catch(Q){D.e(Q)}finally{D.f()}s.push(n)}var j=this.rules.AutoBeamOptions,V={beam_middle_only:j.beam_middle_rests_only,beam_rests:j.beam_rests,maintain_stem_directions:j.maintain_stem_directions};if(j.groups&&j.groups.length){var G,W=[],U=b(j.groups);try{for(U.s();!(G=U.n()).done;){var z=G.value;W.push(new a.Fraction(z[0],z[1]))}}catch(Q){U.e(Q)}finally{U.f()}V.groups=W}for(var H=0,X=s;H<X.length;H++){var Y,K=X[H],q=a.Beam.generateBeams(K,V),Z=b(q);try{for(Z.s();!(Y=Z.n()).done;){var J=Y.value;this.rules.FlatBeams&&(J.render_options.flat_beams=!0,J.render_options.flat_beam_offset=this.rules.FlatBeamOffset,J.render_options.flat_beam_offset_per_beam=this.rules.FlatBeamOffsetPerBeam),this.autoVfBeams.push(J)}}catch(Q){Z.e(Q)}finally{Z.f()}}}}},{key:"finalizeTuplets",value:function(){for(var e in this.vftuplets={},this.tuplets)if(this.tuplets.hasOwnProperty(e)){var t=this.vftuplets[e];t||(t=this.vftuplets[e]=[]);var n,i=b(this.tuplets[e]);try{for(i.s();!(n=i.n()).done;){var r,s=n.value,o=[],u=s[1],l=b(u);try{for(l.s();!(r=l.n()).done;){var c=r.value;o.push(c.vfStaveNote)}}catch(g){l.e(g)}finally{l.f()}if(o.length>1){var h=s[0],d=h.Notes[0][0].NormalNotes,f=h.Bracket||3===h.TupletLabelNumber&&this.rules.TripletsBracketed||3!==h.TupletLabelNumber&&this.rules.TupletsBracketed,p=a.Tuplet.LOCATION_TOP;h.tupletLabelNumberPlacement===P.PlacementEnum.Below&&(p=a.Tuplet.LOCATION_BOTTOM);var v=new a.Tuplet(o,{bracketed:f,location:p,notes_occupied:d,num_notes:h.TupletLabelNumber,ratioed:this.rules.TupletsRatioed});t.push(v)}else m.default.debug("Warning! Tuplet with no notes! Trying to ignore, but this is a serious problem.")}}catch(g){i.e(g)}finally{i.f()}}}},{key:"layoutStaffEntry",value:function(e){}},{key:"graphicalMeasureCreatedCalculations",value:function(){var e,t,n=[],i=[],r=b(this.staffEntries);try{for(r.s();!(t=r.n()).done;){var s=t.value;e=!1,n=[];var o,u=b(s.graphicalVoiceEntries);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(l.parentVoiceEntry.IsGrace)n.push(l),i.push(l),e||(e=l.parentVoiceEntry.GraceSlur);else if(l.vfStaveNote=f.VexFlowConverter.StaveNote(l),n.length>0){for(var c=[],h=0;h<n.length;h++){var d=n[h];d.GraceSlash=d.parentVoiceEntry.GraceNoteSlash,h>0&&(d.GraceSlash=!1);var m=f.VexFlowConverter.StaveNote(d);d.vfStaveNote=m,c.push(m)}var v=new a.GraceNoteGroup(c,e);v.spacing=10*this.rules.GraceNoteGroupXMargin,l.vfStaveNote.addModifier(0,v),n=[]}}}catch(F){u.e(F)}finally{u.f()}}}catch(F){r.e(F)}finally{r.f()}if(n.length>0){var g,y=b(n);try{for(y.s();!(g=y.n()).done;){var S=g.value;S.vfStaveNote=f.VexFlowConverter.StaveNote(S),S.parentVoiceEntry.GraceAfterMainNote=!0}}catch(F){y.e(F)}finally{y.f()}}this.finalizeBeams(),this.finalizeTuplets();var x=this.getVoicesWithinMeasure();if(this.rules.RenderFingerings){var _,E=b(this.staffEntries);try{for(E.s();!(_=E.n()).done;)_.value.setModifierXOffsets()}catch(F){E.e(F)}finally{E.f()}}var k,M=b(x);try{for(M.s();!(k=M.n()).done;){var w=k.value;if(w){this.vfVoices[w.VoiceId]=new a.Voice({beat_value:this.parentSourceMeasure.ActiveTimeSignature.Denominator,num_beats:this.parentSourceMeasure.ActiveTimeSignature.Numerator,resolution:a.RESOLUTION}).setMode(a.Voice.Mode.SOFT);var T,C=this.getRestFilledVexFlowStaveNotesPerVoice(w),I=b(C);try{for(I.s();!(T=I.n()).done;){var A=T.value;if(!A.parentVoiceEntry||!A.parentVoiceEntry.IsGrace||A.parentVoiceEntry.GraceAfterMainNote){var L=A;if(0!==L.vfStaveNote.getTicks().denominator)if(0!==A.notes.length&&A.notes[0]&&A.notes[0].sourceNote.PrintObject){var O=L.parentStaffEntry;if(O&&O.vfClefBefore){var R=new p([O.vfClefBefore]);L.vfStaveNote.getCategory&&"stavenotes"===L.vfStaveNote.getCategory()&&L.vfStaveNote.addModifier(0,R)}A.parentVoiceEntry&&this.rules.RenderFingerings&&(this.rules.FingeringPosition!==P.PlacementEnum.Left&&this.rules.FingeringPosition!==P.PlacementEnum.Right||this.createFingerings(A),this.createStringNumber(A)),this.createArpeggio(A),this.vfVoices[w.VoiceId].addTickable(L.vfStaveNote)}else this.vfVoices[w.VoiceId].addTickable(L.vfStaveNote)}}}catch(F){I.e(F)}finally{I.f()}}}}catch(F){M.e(F)}finally{M.f()}this.setStemDirectionFromVexFlow();for(var N=0,B=i;N<B.length;N++){var D=B[N];this.createFingerings(D),this.createStringNumber(D),this.createArpeggio(D)}this.createArticulations(),this.createOrnaments()}},{key:"createArpeggio",value:function(e){if(e.parentVoiceEntry&&e.parentVoiceEntry.Arpeggio){var t=e.parentVoiceEntry.Arpeggio;if(e.notes&&e.notes.length>1){var n=f.VexFlowConverter.StrokeTypeFromArpeggioType(t.type),i=new a.Stroke(n,{all_voices:this.rules.ArpeggiosGoAcrossVoices});this.rules.RenderArpeggios&&e.vfStaveNote.addStroke(0,i)}else m.default.debug("[OSMD] arpeggio in measure ".concat(this.MeasureNumber," could not be drawn.\n                voice entry had less than two notes, arpeggio is likely between voice entries, not currently supported in Vexflow."))}}},{key:"setStemDirectionFromVexFlow",value:function(){var e,t=b(this.staffEntries);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.graphicalVoiceEntries);try{for(r.s();!(n=r.n()).done;){var s,o=n.value,u=b(o.notes);try{for(u.s();!(s=u.n()).done;){var l=s.value.vfnote;if(l&&l[0])switch(l[0].getStemDirection()){case a.Stem.UP:o.parentVoiceEntry.StemDirection=E.StemDirectionType.Up;break;case a.Stem.DOWN:o.parentVoiceEntry.StemDirection=E.StemDirectionType.Down}}}catch(c){u.e(c)}finally{u.f()}}}catch(c){r.e(c)}finally{r.f()}}}catch(c){t.e(c)}finally{t.f()}}},{key:"createArticulations",value:function(){for(var e=0,t=this.staffEntries.length;e<t;++e){var n,i=this.staffEntries[e].graphicalVoiceEntries,r=b(i);try{for(r.s();!(n=r.n()).done;){var a=n.value,s=a.vfStaveNote;f.VexFlowConverter.generateArticulations(s,a.notes[0],this.rules)}}catch(o){r.e(o)}finally{r.f()}}}},{key:"createOrnaments",value:function(){for(var e=0,t=this.staffEntries.length;e<t;++e){var n=this.staffEntries[e].graphicalVoiceEntries;for(var i in n)if(n.hasOwnProperty(i)){var r=n[i].vfStaveNote,a=n[i].notes[0].sourceNote.ParentVoiceEntry.OrnamentContainer;a&&f.VexFlowConverter.generateOrnaments(r,a)}}}},{key:"createFingerings",value:function(e){var t,n=e,i=0,r=b(e.notes);try{for(r.s();!(t=r.n()).done;)t.value.sourceNote.Fingering&&i++}catch(E){r.e(E)}finally{r.f()}var s,o=-1,u=b(e.notes);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=l.sourceNote.Fingering;if(c){o++;var h=this.rules.FingeringPosition;this.rules.FingeringPositionGrace===P.PlacementEnum.AboveOrBelow&&(this.isUpperStaffOfInstrument()?h=P.PlacementEnum.Above:this.isLowerStaffOfInstrument()&&(h=P.PlacementEnum.Below)),c.placement!==P.PlacementEnum.NotYetDefined&&(h=c.placement);var d=void 0,f=this.rules.FingeringOffsetX;switch(h){default:case P.PlacementEnum.Left:d=a.StaveModifier.Position.LEFT,f-=l.baseFingeringXOffset*v.unitInPixels;break;case P.PlacementEnum.Right:d=a.StaveModifier.Position.RIGHT,f+=l.baseFingeringXOffset*v.unitInPixels;break;case P.PlacementEnum.Above:d=a.StaveModifier.Position.ABOVE;break;case P.PlacementEnum.Below:d=a.StaveModifier.Position.BELOW;break;case P.PlacementEnum.NotYetDefined:var p=e.parentStaffEntry.sourceStaffEntry.ParentStaff;e.notes.length>1||e.parentStaffEntry.graphicalVoiceEntries.length>1?d=a.StaveModifier.Position.LEFT:0===p.idInMusicSheet?(d=a.StaveModifier.Position.ABOVE,h=P.PlacementEnum.Above):(d=a.StaveModifier.Position.BELOW,h=P.PlacementEnum.Below)}var m=new a.FretHandFinger(c.value);if(m.setPosition(d),m.setOffsetX(f),h===P.PlacementEnum.Above||h===P.PlacementEnum.Below){var g=h===P.PlacementEnum.Above?-1:1,y=h===P.PlacementEnum.Above?o:i-1-o;if(this.rules.FingeringInsideStafflines&&i>1){var S=m.getWidth()/2,x=2.5*i;m.setOffsetY(g*(y+x)*S)}else if(!this.rules.FingeringInsideStafflines){var _=new a.StringNumber(c.value);_.radius=0,_.setPosition(d),_.setOffsetY(g*y*_.getWidth()*2/3),n.vfStaveNote.addModifier(o,_);continue}}n.vfStaveNote.addModifier(o,m)}else o++}}catch(E){u.e(E)}finally{u.f()}}},{key:"createStringNumber",value:function(e){var t=this;if(this.rules.RenderStringNumbersClassical){var n=e;e.notes.forEach((function(i,r){var s=i.sourceNote.StringInstruction;if(s){var o=s.value;switch(o){case"1":o="I";break;case"2":o="II";break;case"3":o="III";break;case"4":o="IV";break;case"5":o="V";break;case"6":o="VI"}var u=new a.StringNumber(o);u.radius=0;var l=-t.rules.StringNumberOffsetY;e.notes.length>1||e.parentStaffEntry.graphicalVoiceEntries.length>1?(u.setOffsetX(13*i.baseStringNumberXOffset),u.setPosition(a.Modifier.Position.RIGHT)):u.setPosition(a.Modifier.Position.ABOVE),u.setOffsetY(l),n.vfStaveNote.addModifier(r,u)}}))}}},{key:"lineTo",value:function(e,t){var n=new a.StaveConnector(e.getVFStave(),this.stave);n.setType(t),this.connectors.push(n)}},{key:"getVFStave",value:function(){return this.stave}},{key:"updateInstructionWidth",value:function(){var e,t=0,n=0,i=this.stave.getModifiers(),a=b(i);try{for(a.s();!(e=a.n()).done;){var s=e.value;s.getPosition()===r.BEGIN?t+=s.getWidth()+s.getPadding(void 0):s.getPosition()===r.END&&(n+=s.getWidth()+s.getPadding(void 0))}}catch(o){a.e(o)}finally{a.f()}this.beginInstructionsWidth=(null!=t?t:0)/v.unitInPixels,this.endInstructionsWidth=(null!=n?n:0)/v.unitInPixels}},{key:"addStaveTie",value:function(e,t){this.vfTies.push(e),t.vfTie=e,t.Tie.TieDirection===P.PlacementEnum.Below&&e.setDirection(1)}}]),n}(s.GraphicalMeasure);t.VexFlowMeasure=C,function(e){e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.ABOVE=3]="ABOVE",e[e.BELOW=4]="BELOW",e[e.BEGIN=5]="BEGIN",e[e.END=6]="END"}(r=t.StavePositionEnum||(t.StavePositionEnum={}))},4405:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowMultiRestMeasure=void 0;var r=i(n(6368)).default.Flow,a=function(e){h(n,e);var t=d(n);function n(e,i,a){var s;return g(this,n),(s=t.call(this,e,i,a)).minimumStaffEntriesWidth=-1,a?s.rules=a.ParentMusicSystem.rules:i&&(s.rules=i.Rules),s.resetLayout(),s.multiRestElement=new r.MultiMeasureRest(i.multipleRestMeasures,{}),s}return y(n,[{key:"draw",value:function(e){var t,n,i,r=e.openGroup();null===(t=null==r?void 0:r.classList)||void 0===t||t.add("vf-measure");var a=e.openGroup();null===(n=null==a?void 0:a.classList)||void 0===n||n.add("vf-stave"),this.stave.setContext(e).draw(),e.closeGroup();var s=e.openGroup();null===(i=null==s?void 0:s.classList)||void 0===i||i.add("vf-voices"),this.multiRestElement.setStave(this.stave),this.multiRestElement.setContext(e),this.multiRestElement.draw(),e.closeGroup();var o,u=b(this.connectors);try{for(u.s();!(o=u.n()).done;)o.value.setContext(e).draw()}catch(l){u.e(l)}finally{u.f()}return e.closeGroup(),r}},{key:"format",value:function(){}},{key:"getVoicesWithinMeasure",value:function(){return[]}},{key:"getGraphicalVoiceEntriesPerVoice",value:function(e){return[]}},{key:"getRestFilledVexFlowStaveNotesPerVoice",value:function(e){return[]}},{key:"handleBeam",value:function(e,t){}},{key:"handleTuplet",value:function(e,t){}},{key:"finalizeBeams",value:function(){}},{key:"finalizeTuplets",value:function(){}},{key:"layoutStaffEntry",value:function(e){}},{key:"graphicalMeasureCreatedCalculations",value:function(){}},{key:"createArticulations",value:function(){}},{key:"createOrnaments",value:function(){}},{key:"createFingerings",value:function(e){}},{key:"getVFStave",value:function(){return this.stave}}]),n}(n(7330).VexFlowMeasure);t.VexFlowMultiRestMeasure=a},8738:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowMusicSheetCalculator=void 0;var r=n(4040),a=n(8144),s=n(1659),l=n(5309),c=n(5922),f=n(2942),p=i(n(6368)),m=p.default.Flow,v=i(n(2043)),S=n(5820),x=n(5091),_=n(8720),E=n(9520),k=n(6351),M=n(1274),w=n(9876),P=n(9344),T=n(9667),C=n(41),I=n(7781),A=n(2478),L=n(8129),O=n(2343),R=n(6894),N=n(3010),B=n(158),D=n(448),F=function(t){h(i,t);var n=d(i);function i(e){var t,s,o,u,l,c,h,d,m;return g(this,i),(t=n.call(this)).beamsNeedUpdate=!1,t.rules=e,r.MusicSheetCalculator.symbolFactory=new a.VexFlowGraphicalSymbolFactory,r.MusicSheetCalculator.TextMeasurer=new f.VexFlowTextMeasurer(t.rules),r.MusicSheetCalculator.stafflineNoteCalculator=new I.VexflowStafflineNoteCalculator(t.rules),"gonville"===(null===(s=t.rules.DefaultVexFlowNoteFont)||void 0===s?void 0:s.toLowerCase())?p.default.Flow.DEFAULT_FONT_STACK=[null===(o=p.default.Flow.Fonts)||void 0===o?void 0:o.Gonville,null===(u=p.default.Flow.Fonts)||void 0===u?void 0:u.Bravura,null===(l=p.default.Flow.Fonts)||void 0===l?void 0:l.Custom]:"petaluma"===(null===(c=t.rules.DefaultVexFlowNoteFont)||void 0===c?void 0:c.toLowerCase())&&(p.default.Flow.DEFAULT_FONT_STACK=[null===(h=p.default.Flow.Fonts)||void 0===h?void 0:h.Petaluma,null===(d=p.default.Flow.Fonts)||void 0===d?void 0:d.Gonville,null===(m=p.default.Flow.Fonts)||void 0===m?void 0:m.Bravura]),t}return y(i,[{key:"clearRecreatedObjects",value:function(){o(u(i.prototype),"clearRecreatedObjects",this).call(this),r.MusicSheetCalculator.stafflineNoteCalculator=new I.VexflowStafflineNoteCalculator(this.rules);var e,t=b(this.graphicalMusicSheet.MeasureList);try{for(t.s();!(e=t.n()).done;){var n,a=e.value,s=b(a);try{for(s.s();!(n=s.n()).done;){var l=n.value;null==l||l.clean()}}catch(c){s.e(c)}finally{s.f()}}}catch(c){t.e(c)}finally{t.f()}}},{key:"formatMeasures",value:function(){var e,t=b(this.graphicalMusicSheet.MeasureList);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n&&n[0]){n.find((function(e){return null==e?void 0:e.isVisible()})).format();var i,r=b(n);try{for(r.s();!(i=r.n()).done;){var a,s=i.value,o=b(s.staffEntries);try{for(o.s();!(a=o.n()).done;)a.value.calculateXPosition()}catch(u){o.e(u)}finally{o.f()}s.finalizeBeams()}}catch(u){r.e(u)}finally{r.f()}}}}catch(u){t.e(u)}finally{t.f()}this.beamsNeedUpdate=!1}},{key:"calculateMeasureXLayout",value:function(e){var t,n=[],i=b(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;a&&n.push(a)}}catch(se){i.e(se)}finally{i.f()}if(0===n.length)return 0;e=n;var s,o=[],u=new m.Formatter({softmaxFactor:this.rules.SoftmaxFactorVexFlow}),l=e[0].staffEntries.length,c=1,h=b(e);try{for(h.s();!(s=h.n()).done;){var d=s.value;if(d){var f,p=0,g=b(d.staffEntries);try{for(g.s();!(f=g.n()).done;)p+=f.value.setMaxAccidentals()}catch(se){g.e(se)}finally{g.f()}d.parentSourceMeasure.ImplicitMeasure&&(l=Math.max(d.staffEntries.length,l),c=Math.max(d.staffEntries.length+p,c));var y=d.vfVoices,x=[];for(var _ in y)if(y.hasOwnProperty(_)){var E=y[_];d.hasOnlyRests&&!E.ticksUsed.equals(E.totalTicks)&&(E.ticksUsed=E.totalTicks),x.push(E),o.push(E)}0!==x.length?u.joinVoices(x):v.default.debug("Found a measure with no voices. Continuing anyway.",y)}}}catch(se){h.e(se)}finally{h.f()}var k=12,M=e[0].parentSourceMeasure;if(o.length>0){if(k=u.preCalculateMinTotalWidth(o)/S.unitInPixels*this.rules.VoiceSpacingMultiplierVexflow+this.rules.VoiceSpacingAddendVexflow+.3*l,null==M?void 0:M.ImplicitMeasure){k=M.Duration.RealValue/M.ActiveTimeSignature.RealValue*k;var w=0,P=M.measureListIndex;if(P>1){var T,I=b(this.graphicalMusicSheet.MeasureList[P-1]);try{for(I.s();!(T=I.n()).done;){var A=T.value,L=null==A?void 0:A.parentSourceMeasure.endingBarStyleEnum;if(L===R.SystemLinesEnum.ThinBold||L===R.SystemLinesEnum.DotsThinBold){w=this.rules.PickupMeasureRepetitionSpacing;break}}}catch(se){I.e(se)}finally{I.f()}}k+=w,l>1&&(k+=.3*c*1.5),k*=this.rules.PickupMeasureWidthMultiplier}r.MusicSheetCalculator.setMeasuresMinStaffEntriesWidth(e,k);var O,N=function(e,t){u.formatToStave(o,t.getVFStave())},B=function(e,t){u.formatToStave(o,t.getVFStave(),{align_rests:!0,context:void 0})},D=b(e);try{for(D.s();!(O=D.n()).done;){var F=O.value;if(this.rules.AlignRests===C.AlignRestOption.Never)F.formatVoices=N;else if(this.rules.AlignRests===C.AlignRestOption.Always)F.formatVoices=B;else if(this.rules.AlignRests===C.AlignRestOption.Auto){var j,V=!1,G=b(F.staffEntries);try{for(G.s();!(j=G.n()).done;){var W,U=j.value,z=0,H=0,X=b(U.graphicalVoiceEntries);try{for(X.s();!(W=X.n()).done;){var Y=W.value;if(Y.parentVoiceEntry.IsGrace||Y&&Y.notes&&Y.notes[0]&&Y.notes[0].sourceNote&&Y.notes[0].sourceNote.PrintObject&&z++,Y&&Y.notes&&Y.notes[0]&&Y.notes[0].sourceNote&&Y.notes[0].sourceNote.isRest()&&Y.notes[0].sourceNote.PrintObject&&H++,z>1&&H>=1){V=!0;break}}}catch(se){X.e(se)}finally{X.f()}if(V)break}}catch(se){G.e(se)}finally{G.f()}F.formatVoices=V?B:N}if(F===e[0]){var K=F;K.formatVoices(k*S.unitInPixels,K)}}}catch(se){D.e(se)}finally{D.f()}}var q,Z=b(e);try{for(Z.s();!(q=Z.n()).done;){var J=q.value;if(J){var Q,$=b(J.staffEntries);try{for($.s();!(Q=$.n()).done;)Q.value.calculateXPosition()}catch(se){$.e(se)}finally{$.f()}}}}catch(se){Z.e(se)}finally{Z.f()}var ee,te=b(e);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;if(ne){var ie=ne.vfVoices,re=[];for(var ae in ie)ie.hasOwnProperty(ae)&&re.push(ie[ae]);0!==re.length?u.joinVoices(re):v.default.debug("Found a measure with no voices. Continuing anyway.",ie)}}}catch(se){te.e(se)}finally{te.f()}return k}},{key:"calculateElongationFactor",value:function(e,t,n,i,r,a,s,o){var u,l=r,c=0,h=b(e);try{for(h.s();!(u=h.n()).done;){var d=u.value,f=d.GraphicalLabel.Label.textAlignment,p=s,m=o;if(d instanceof x.GraphicalLyricEntry&&d.ParentLyricWord){d.LyricsEntry.SyllableIndex>0&&(p=this.rules.BetweenSyllableMinimumDistance,M.TextAlignment.IsCenterAligned(f)&&(p+=1));var v=d.ParentLyricWord.GetLyricWord.Syllables;v.length>1&&d.LyricsEntry.SyllableIndex<v.length-1&&(void 0===this.dashSpace&&(this.dashSpace=1.5),m-=this.dashSpace)}var g=d instanceof x.GraphicalLyricEntry?d.GraphicalLabel.PositionAndShape:d.PositionAndShape,y=g.Size.width,S=t.PositionAndShape.RelativePosition.x+g.BorderMarginLeft,_=void 0,E=void 0,k=void 0,w=void 0;void 0!==n[c]&&n[c].extend,n[c]&&(E=S-n[c].xPosition);var P=i*r;M.TextAlignment.IsCenterAligned(f)?(k=P-S,w=y/2-(m/=4),n[c]&&(_=n[c].labelWidth/2+y/2+p)):M.TextAlignment.IsLeft(f)&&(k=P-S,w=y-m,n[c]&&(_=n[c].labelWidth+p));var T=1,C=w/k,I=1;if(d instanceof x.GraphicalLyricEntry&&d.LyricsEntry){if(n[c]){var A=n[c].sourceNoteDuration;I=_/E,A.Denominator>4&&(I*=1.1)}}else n[c]&&(I=_/E);T=Math.max(C,I),l=Math.max(l,T);var L=Math.max(_-E||0,0);n[c]&&(L+=n[c].cumulativeOverlap),n[c]={cumulativeOverlap:L,extend:d instanceof x.GraphicalLyricEntry&&d.LyricsEntry.extend,labelWidth:y,measureNumber:a,sourceNoteDuration:d instanceof x.GraphicalLyricEntry&&d.LyricsEntry&&d.LyricsEntry.Parent.Notes[0].Length,text:d instanceof x.GraphicalLyricEntry?d.LyricsEntry.Text:d.GraphicalLabel.Label.text,xPosition:S},c++}}catch(O){h.e(O)}finally{h.f()}return l}},{key:"calculateElongationFactorFromStaffEntries",value:function(e,t,n,i){var r,a=n,s={},o={},u=b(e);try{for(u.s();!(r=u.n()).done;){var l=r.value;l.LyricsEntries.length>0&&(a=this.calculateElongationFactor(l.LyricsEntries,l,s,t,a,i,this.rules.HorizontalBetweenLyricsDistance,this.rules.LyricOverlapAllowedIntoNextMeasure)),l.graphicalChordContainers.length>0&&(a=this.calculateElongationFactor(l.graphicalChordContainers,l,o,t,a,i,this.rules.ChordSymbolXSpacing,this.rules.ChordOverlapAllowedIntoNextMeasure))}}catch(c){u.e(c)}finally{u.f()}return a}},{key:"calculateMeasureWidthFromStaffEntries",value:function(e,t){var n,i=1,r=b(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;a&&0!==a.staffEntries.length&&(i=this.calculateElongationFactorFromStaffEntries(a.staffEntries,t,i,a.MeasureNumber))}}catch(s){r.e(s)}finally{r.f()}return t*(i=Math.min(i,this.rules.MaximumLyricsElongationFactor))}},{key:"createGraphicalTie",value:function(e,t,n,i,r){return new l.GraphicalTie(e,i,r)}},{key:"updateStaffLineBorders",value:function(e){e.SkyBottomLineCalculator.updateStaffLineBorders()}},{key:"graphicalMeasureCreatedCalculations",value:function(e){e.rules=this.rules,e.graphicalMeasureCreatedCalculations()}},{key:"layoutVoiceEntry",value:function(e,t,n,i){for(var a=0;a<t.length;a++)t[a]=r.MusicSheetCalculator.stafflineNoteCalculator.positionNote(t[a])}},{key:"layoutStaffEntry",value:function(e){e.parentMeasure.layoutStaffEntry(e)}},{key:"initGraphicalMeasuresCreation",value:function(){}},{key:"layoutArticulationMarks",value:function(e,t,n){}},{key:"layoutGraphicalTie",value:function(e,t,n){var i,r,a=e.StartNote,s=e.EndNote,o=0;a&&a.vfnote&&a.vfnote.length>=2&&(i=a.vfnote[0],o=a.vfnote[1]);var u=0;if(s&&s.vfnote&&s.vfnote.length>=2&&(r=s.vfnote[0],u=s.vfnote[1]),t){if(i){var l=new m.StaveTie({first_indices:[o],first_note:i});a.parentVoiceEntry.parentStaffEntry.parentMeasure.addStaveTie(l,e)}if(r){var c=new m.StaveTie({last_indices:[u],last_note:r});s.parentVoiceEntry.parentStaffEntry.parentMeasure.addStaveTie(c,e)}}else if(i||r){var h;if(n)if("S"===e.Tie.Type){var d=e.StartNote.sourceNote,f=e.EndNote.sourceNote,p=1;d.FretNumber>f.FretNumber&&(p=-1),h=new m.TabSlide({first_indices:[o],first_note:i,last_indices:[u],last_note:r},p)}else h=new m.TabTie({first_indices:[o],first_note:i,last_indices:[u],last_note:r},e.Tie.Type);else{h=new m.StaveTie({first_indices:[o],first_note:i,last_indices:[u],last_note:r});var v=e.Tie.getTieDirection(a.sourceNote);v===O.PlacementEnum.Below?h.setDirection(1):v===O.PlacementEnum.Above&&h.setDirection(-1)}s.parentVoiceEntry.parentStaffEntry.parentMeasure.addStaveTie(h,e)}}},{key:"calculateDynamicExpressionsForMultiExpression",value:function(e,t,n){if(!(t<this.rules.MinMeasureToDrawIndex||t>this.rules.MaxMeasureToDrawIndex)){var i=e.AbsoluteTimestamp,r=this.graphicalMusicSheet.MeasureList[t],a=r[n].ParentStaffLine,s=r[n];if(a){var o=this.getRelativePositionInStaffLineFromTimestamp(i,n,a,null==a?void 0:a.isPartOfMultiStaffInstrument());if(o.x<=0&&(o.x=s.beginInstructionsWidth+this.rules.RhythmRightMargin),e.InstantaneousDynamic){var u=new k.VexFlowInstantaneousDynamicExpression(e.InstantaneousDynamic,a,s);this.calculateGraphicalInstantaneousDynamicExpression(u,o,i),this.dynamicExpressionMap.set(i.RealValue,u.PositionAndShape)}if(e.StartingContinuousDynamic){var l=e.StartingContinuousDynamic,c=new P.VexFlowContinuousDynamicExpression(e.StartingContinuousDynamic,a,s.parentSourceMeasure);if(c.StartMeasure=s,c.IsSoftAccent=e.StartingContinuousDynamic.IsStartOfSoftAccent,!c.IsVerbal&&l.EndMultiExpression)try{this.calculateGraphicalContinuousDynamic(c,o),c.updateSkyBottomLine()}catch(e){}else c.IsVerbal?this.calculateGraphicalVerbalContinuousDynamic(c,o):v.default.warn("This continuous dynamic is not covered. measure"+e.SourceMeasureParent.MeasureNumber)}}}}},{key:"createMetronomeMark",value:function(e){var t,n,i=Math.max(e.ParentMultiTempoExpression.SourceMeasureParent.MeasureNumber-1,0),r=Math.max(e.StaffNumber-1,0),a=0===i&&0===r,s=this.graphicalMusicSheet.MeasureList[i][r].getVFStave(),o="q";if(e.beatUnit){var u=A.NoteTypeHandler.getNoteDurationFromType(e.beatUnit);o=L.VexFlowConverter.durations(u,!1)[0]}var l,c=this.rules.MetronomeMarkYShift,h=!1,d=b(e.parentMeasure.TempoExpressions);try{for(d.s();!(l=d.n()).done;){var f=l.value,p=(null===(t=f.InstantaneousTempo)||void 0===t?void 0:t.Enum)===T.TempoEnum.metronomeMark;if(f.getPlacementOfFirstEntry()===O.PlacementEnum.Above&&!p){h=!0;break}}}catch(g){d.e(g)}finally{d.f()}h&&(c-=1.4);var m=null===(n=this.graphicalMusicSheet.MeasureList[0][0].ParentStaffLine)||void 0===n?void 0:n.SkyLine;s.setTempo({bpm:e.TempoInBpm,dots:e.dotted,duration:o},c*S.unitInPixels);var v=a?this.rules.MetronomeMarkXShift*S.unitInPixels:0;s.getModifiers()[s.getModifiers().length-1].setShiftX(v),m&&(m[0]=Math.min(m[0],-4.5+c))}},{key:"calculateRehearsalMark",value:function(e){var t,n=e.rehearsalExpression;if(n){var i=this.graphicalMusicSheet.MeasureList[0][0].MeasureNumber,r=Math.max(e.MeasureNumber-i,0),a=null===(t=this.graphicalMusicSheet.MeasureList[r][0])||void 0===t?void 0:t.getVFStave();if(a){var s=-this.rules.RehearsalMarkYOffsetDefault-this.rules.RehearsalMarkYOffset,o=this.rules.RehearsalMarkXOffsetDefault+this.rules.RehearsalMarkXOffset;e.IsSystemStartMeasure&&(o+=this.rules.RehearsalMarkXOffsetSystemStartMeasure);var u=this.rules.RehearsalMarkFontSize;a.setSection(n.label,s,o,u)}}}},{key:"calculateSingleOctaveShift",value:function(e,t,n,i){var r,a,s,o=t.OctaveShiftStart,u=o.ParentStartMultiExpression.Timestamp,l=null===(r=o.ParentEndMultiExpression)||void 0===r?void 0:r.Timestamp,c=this.rules.MinMeasureToDrawIndex,h=this.rules.MaxMeasureToDrawIndex,d=this.graphicalMusicSheet.MeasureList[n][i].ParentStaffLine;if(d||(d=this.graphicalMusicSheet.MeasureList[c][i].ParentStaffLine),(a=o.ParentEndMultiExpression?this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentEndMultiExpression.SourceMeasureParent,i):this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)).MeasureNumber>h+1&&(a=this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)),(s=o.ParentEndMultiExpression?this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentStartMultiExpression.SourceMeasureParent,i):this.graphicalMusicSheet.MeasureList[c][i]).MeasureNumber<c+1&&(s=this.graphicalMusicSheet.MeasureList[c][i]),!(s.parentSourceMeasure.measureListIndex<c||s.parentSourceMeasure.measureListIndex>h||a.parentSourceMeasure.measureListIndex<c||a.parentSourceMeasure.measureListIndex>h)){var f=a.ParentStaffLine;if(f||(f=d),a&&d&&f){var p=new E.VexFlowOctaveShift(o,d.PositionAndShape);if(!p.startNote){var m,g,y=b(s.staffEntries);try{for(y.s();!(g=y.n()).done;){var S=g.value;if(S){m=S;break}}}catch(F){y.e(F)}finally{y.f()}if(!m)return;if(p.setStartNote(m),!p.startNote)return}if(!p.endNote){for(var x,_=a.staffEntries.length-1;_>=0;_++)if(a.staffEntries[_]){x=a.staffEntries[_];break}if(p.setEndNote(x),!p.endNote)return}var k=s.findGraphicalStaffEntryFromTimestamp(u);k||(k=s.staffEntries[0]);var M=a.findGraphicalStaffEntryFromTimestamp(l);if(M||(M=a.staffEntries[a.staffEntries.length-1]),p.setStartNote(k),f!==d){p.endsOnDifferentStaffLine=!0;var w=d.Measures[d.Measures.length-1];void 0===w&&(w=a);var P=w.staffEntries[w.staffEntries.length-1];p.setEndNote(P);var T=f.ParentMusicSystem.Id-d.ParentMusicSystem.Id;if(T>0)for(var C=d.ParentMusicSystem.Id;C<f.ParentMusicSystem.Id;C++){var I=C+1,A=this.musicSystems[I].StaffLines[i],L=A.Measures[0],O=new E.VexFlowOctaveShift(o,L.PositionAndShape);C<T&&(O.endsOnDifferentStaffLine=!0);var R=A.Measures[A.Measures.length-1];R.IsExtraGraphicalMeasure&&(R=A.Measures[A.Measures.length-2]);var N=L.staffEntries[0],B=R.staffEntries[R.staffEntries.length-1];a.ParentStaffLine===A&&(R=a,B=M);var D="VexFlowMusicSheetCalculator.calculateSingleOctaveShift: ";N||v.default.warn(D+"no firstNote found"),B||v.default.warn(D+"no lastNote found"),O.setStartNote(N),O.setEndNote(B),A.OctaveShifts.push(O),this.calculateOctaveShiftSkyBottomLine(N,B,O,A)}this.calculateOctaveShiftSkyBottomLine(k,P,p,d)}else p.setEndNote(M),this.calculateOctaveShiftSkyBottomLine(k,M,p,d);d.OctaveShifts.push(p)}else v.default.warn("End measure or staffLines for octave shift are undefined! This should not happen!")}}},{key:"calculateSinglePedal",value:function(e,t,n,i){var r,a,s,o=t.PedalStart,u=o.ParentStartMultiExpression.Timestamp,l=null===(r=o.ParentEndMultiExpression)||void 0===r?void 0:r.Timestamp,c=this.rules.MinMeasureToDrawIndex,h=this.rules.MaxMeasureToDrawIndex,d=this.graphicalMusicSheet.MeasureList[n][i].ParentStaffLine;if(d||(d=this.graphicalMusicSheet.MeasureList[c][i].ParentStaffLine),(a=o.ParentEndMultiExpression?this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentEndMultiExpression.SourceMeasureParent,i):this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)).MeasureNumber>h+1&&(a=this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)),o.ParentEndMultiExpression?s=this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentStartMultiExpression.SourceMeasureParent,i):(s=this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentStartMultiExpression.SourceMeasureParent,i))||(s=this.graphicalMusicSheet.MeasureList[c][i]),s.MeasureNumber<c+1&&(s=this.graphicalMusicSheet.MeasureList[c][i]),!(s.parentSourceMeasure.measureListIndex<c||s.parentSourceMeasure.measureListIndex>h||a.parentSourceMeasure.measureListIndex<c||a.parentSourceMeasure.measureListIndex>h)){var f=a.ParentStaffLine;if(f||(f=d),a&&d&&f){var p=!1;d!==f&&(p=!0);var m=new N.VexFlowPedal(o,d.PositionAndShape,!1,p),g=s.findGraphicalStaffEntryFromTimestamp(u);g||(g=s.staffEntries[0]);var y=a.findGraphicalStaffEntryFromTimestamp(l);if(y||(y=a.staffEntries[a.staffEntries.length-1]),!m.setStartNote(g))return;if(f!==d)if(m.pedalSymbol===B.MusicSymbol.PEDAL_SYMBOL){m.setEndNote(y),m.setEndMeasure(a),m.ReleaseText=" ",m.CalculateBoundingBox(),this.calculatePedalSkyBottomLine(m.startVfVoiceEntry,m.endVfVoiceEntry,m,d);var b=f.Measures[0],S=new N.VexFlowPedal(o,b.PositionAndShape),x=b.staffEntries[0];if(!S.setStartNote(x))return;S.setEndNote(y),m.setEndMeasure(a),f.Pedals.push(S),S.CalculateBoundingBox(),S.DepressText=" ",this.calculatePedalSkyBottomLine(S.startVfVoiceEntry,S.endVfVoiceEntry,S,f)}else{var _=d.Measures[d.Measures.length-1];void 0===_&&(_=a);var E=_.staffEntries[_.staffEntries.length-1];m.setEndNote(E),m.setEndMeasure(a),m.ChangeEnd=!1;var k=f.ParentMusicSystem.Id-d.ParentMusicSystem.Id;if(k>0)for(var M=1,w=d.ParentMusicSystem.Id;w<f.ParentMusicSystem.Id;w++){var P=this.musicSystems[w+1].StaffLines[i],T=P.Measures[0],C=!1,I=!1;M<k?C=!0:I=!0,M++;var A=new N.VexFlowPedal(o,T.PositionAndShape,!0,C);A.ChangeBegin=!1,A.ChangeEnd=!!I&&o.ChangeEnd;var L=P.Measures[P.Measures.length-1],O=T.staffEntries[0],R=L.staffEntries[L.staffEntries.length-1];if(a.ParentStaffLine===P&&(L=a,R=y),!A.setStartNote(O))break;A.setEndNote(R),m.setEndMeasure(a),P.Pedals.push(A),A.CalculateBoundingBox(),this.calculatePedalSkyBottomLine(A.startVfVoiceEntry,A.endVfVoiceEntry,A,P)}m.CalculateBoundingBox(),this.calculatePedalSkyBottomLine(m.startVfVoiceEntry,m.endVfVoiceEntry,m,d)}else m.setEndNote(y),m.setEndMeasure(a),m.CalculateBoundingBox(),this.calculatePedalSkyBottomLine(m.startVfVoiceEntry,m.endVfVoiceEntry,m,d);d.Pedals.push(m)}else v.default.warn("End measure or staffLines for pedal are undefined! This should not happen!")}}},{key:"calculateSingleWavyLine",value:function(e,t,n,i){var r,a,s,o=t.WavyLineStart,u=o.ParentStartMultiExpression.Timestamp,l=null===(r=o.ParentEndMultiExpression)||void 0===r?void 0:r.Timestamp,c=this.rules.MinMeasureToDrawIndex,h=this.rules.MaxMeasureToDrawIndex,d=this.graphicalMusicSheet.MeasureList[n][i].ParentStaffLine;if(d||(d=this.graphicalMusicSheet.MeasureList[c][i].ParentStaffLine),(a=o.ParentEndMultiExpression?this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentEndMultiExpression.SourceMeasureParent,i):this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)).MeasureNumber>h+1&&(a=this.graphicalMusicSheet.getLastGraphicalMeasureFromIndex(i,!0)),(s=o.ParentEndMultiExpression?this.graphicalMusicSheet.getGraphicalMeasureFromSourceMeasureAndIndex(o.ParentStartMultiExpression.SourceMeasureParent,i):this.graphicalMusicSheet.MeasureList[c][i]).MeasureNumber<c+1&&(s=this.graphicalMusicSheet.MeasureList[c][i]),!(s.parentSourceMeasure.measureListIndex<c||s.parentSourceMeasure.measureListIndex>h||a.parentSourceMeasure.measureListIndex<c||a.parentSourceMeasure.measureListIndex>h)){var f=a.ParentStaffLine;if(f||(f=d),a&&d&&f){var p=new D.VexflowVibratoBracket(o,d.PositionAndShape,s.ParentStaff.isTab),m=s.findGraphicalStaffEntryFromTimestamp(u);m||(m=s.staffEntries[0]);var g=a.findGraphicalStaffEntryFromTimestamp(l);if(g||(g=a.staffEntries[a.staffEntries.length-1]),p.setStartNote(m),f!==d){var y=d.Measures[d.Measures.length-1];void 0===y&&(y=a);var b=y.staffEntries[y.staffEntries.length-1];if(p.setEndNote(b),f.ParentMusicSystem.Id-d.ParentMusicSystem.Id>0)for(var S=d.ParentMusicSystem.Id;S<f.ParentMusicSystem.Id;S++){var x=this.musicSystems[S+1].StaffLines[i],_=x.Measures[0],E=new D.VexflowVibratoBracket(o,_.PositionAndShape,x.ParentStaff.isTab),k=x.Measures[x.Measures.length-1],M=_.staffEntries[0],w=k.staffEntries[k.staffEntries.length-1];a.ParentStaffLine===x&&(k=a,w=g),E.setStartNote(M),E.setEndNote(w),x.WavyLines.push(E),E.CalculateBoundingBox(),this.calculateWavyLineSkyBottomLine(E.startVfVoiceEntry,E.endVfVoiceEntry,E,x)}p.CalculateBoundingBox(),this.calculateWavyLineSkyBottomLine(p.startVfVoiceEntry,p.endVfVoiceEntry,p,d)}else p.setEndNote(g),p.CalculateBoundingBox(),this.calculateWavyLineSkyBottomLine(p.startVfVoiceEntry,p.endVfVoiceEntry,p,d);d.WavyLines.push(p)}else v.default.warn("End measure or staffLines for wavy line are undefined! This should not happen!")}}},{key:"calculateWavyLineSkyBottomLine",value:function(e,t,n,i){var r,a,s=n.startNote.getStave(),o=n.endNote.getStave(),u=Math.max(s.options.top_text_position,o.options.top_text_position);s.options.top_text_position=u,o.options.top_text_position=u;var l,h=-u,d=0,f=0,p=1/0,m=1/0,v=e.PositionAndShape.AbsolutePosition.x+e.PositionAndShape.BorderLeft;if((null===(a=null===(r=e.parentVoiceEntry)||void 0===r?void 0:r.OrnamentContainer)||void 0===a?void 0:a.GetOrnament)===c.OrnamentEnum.Trill&&(d=v,f=v+=2,m=(p=i.SkyBottomLineCalculator.getSkyLineMinInRange(d,f))+1.85),n.ToEndOfStopStave)l=t.parentStaffEntry.parentMeasure.PositionAndShape.AbsolutePosition.x+t.parentStaffEntry.parentMeasure.PositionAndShape.BorderRight-1;else{l=t.PositionAndShape.AbsolutePosition.x+t.PositionAndShape.BorderRight;var g=t.parentStaffEntry.vfClefBefore;g&&(l+=g.getWidth()/10)}(h=i.SkyBottomLineCalculator.getSkyLineMinInRange(v,l))!==1/0&&(h<p?(s.options.top_text_position=-h,o.options.top_text_position=-h,i.SkyBottomLineCalculator.updateSkyLineInRange(d,f,h-1.85)):(n.line=-m,h=m),h-=n.PositionAndShape.Size.height,i.SkyBottomLineCalculator.updateSkyLineInRange(v,l,h))}},{key:"calculatePedalSkyBottomLine",value:function(e,t,n,i){var r,a,s,o,u=null==t?void 0:t.PositionAndShape;u||(u=n.endMeasure.PositionAndShape);var l,c=p.default.Flow.PedalMarking.Styles,h=n.getPedalMarking(),d=h.line+3+(i.StaffLines.length-1),f=h.render_options.text_margin_right/10,m=e.PositionAndShape.AbsolutePosition.x-f;h.style!==c.MIXED&&h.style!==c.MIXED_OPEN_END&&h.style!==c.TEXT||(m-=1);var v,g=i.StaffLines.length-1,y=b(i.Pedals);try{for(y.s();!(v=y.n()).done;){var S=v.value.getPedalMarking().line+3+(i.StaffLines.length-1);g=Math.max(S,g)}}catch(W){y.e(W)}finally{y.f()}if(n.EndSymbolPositionAndShape){var x=h.render_options.glyph_point_size/20;l=m+3.4;var _=u.AbsolutePosition.x-f,E=_+1.5;g=Math.max(i.SkyBottomLineCalculator.getBottomLineMaxInRange(m,l),g),g=Math.max(d+2*x,g);var k=i.SkyBottomLineCalculator.getBottomLineMaxInRange(_,E);n.DepressText||(g=Math.max(g,k)),n.setLine(g-3-(i.StaffLines.length-1)),i.SkyBottomLineCalculator.updateBottomLineInRange(m,l,g+x),i.SkyBottomLineCalculator.updateBottomLineInRange(_,E,g+x)}else{var M=h.render_options.bracket_height/10;if(h.EndsStave)l=t?t.parentStaffEntry.parentMeasure.PositionAndShape.AbsolutePosition.x+t.parentStaffEntry.parentMeasure.PositionAndShape.Size.width-f:u.AbsolutePosition.x+u.Size.width;else switch(h.style){case c.BRACKET_OPEN_END:case c.BRACKET_OPEN_BOTH:case c.MIXED_OPEN_END:l=u.AbsolutePosition.x+u.BorderRight-f;break;default:l=u.AbsolutePosition.x+u.BorderLeft-f}var w=null===(r=null==t?void 0:t.parentStaffEntry)||void 0===r?void 0:r.vfClefBefore;if(w&&(l+=w.getWidth()/10),(g=Math.max(i.SkyBottomLineCalculator.getBottomLineMaxInRange(m,l),g))===1/0)return;if(g=Math.max(g,d+M),n.setLine(g-3-(i.StaffLines.length-1)),m>l){var P=l;l=m,m=P}i.SkyBottomLineCalculator.updateBottomLineInRange(m,l,g+M)}var T,C=b(i.Pedals);try{for(C.s();!(T=C.n()).done;){var I=T.value,A=I.getPedalMarking();if(g>A.line+3+(i.StaffLines.length-1)){var L=A.render_options.text_margin_right/10,O=void 0,R=I.startVfVoiceEntry.PositionAndShape.AbsolutePosition.x-L;I.setLine(g-3-(i.StaffLines.length-1));var N=null===(a=I.endVfVoiceEntry)||void 0===a?void 0:a.PositionAndShape;if(N||(N=I.endMeasure.PositionAndShape),I.EndSymbolPositionAndShape){var B=h.render_options.glyph_point_size/20;O=R+3.4;var D=N.AbsolutePosition.x-L,F=D+1.5;i.SkyBottomLineCalculator.updateBottomLineInRange(R,O,g+B),i.SkyBottomLineCalculator.updateBottomLineInRange(D,F,g+B)}else{var j=A.render_options.bracket_height/10;if(A.EndsStave)O=N.AbsolutePosition.x+N.Size.width-L;else switch(h.style){case c.BRACKET_OPEN_END:case c.BRACKET_OPEN_BOTH:case c.MIXED_OPEN_END:O=N.AbsolutePosition.x+N.BorderRight-L;break;default:O=N.AbsolutePosition.x+N.BorderLeft-L}var V=null===(o=null===(s=I.endVfVoiceEntry)||void 0===s?void 0:s.parentStaffEntry)||void 0===o?void 0:o.vfClefBefore;if(V&&(O+=V.getWidth()/10),R>O){var G=R;R=O,O=G}i.SkyBottomLineCalculator.updateBottomLineInRange(R,O,g+j)}}}}catch(W){C.e(W)}finally{C.f()}}},{key:"calculateOctaveShiftSkyBottomLine",value:function(e,t,n,i){if(t){var r=e.PositionAndShape.Size.width,a=t.PositionAndShape.Size.width;e.hasOnlyRests()?r=-r:r/=2,t.hasOnlyRests()?a*=2:a/=2,e===t&&(a*=2);var s=e.PositionAndShape.AbsolutePosition.x-r,o=t.PositionAndShape.AbsolutePosition.x+a;n.PositionAndShape.Size.width=s-o;var u=n.getTextBracket(),l=u.font.size/10;if(u.position===m.TextBracket.Positions.TOP){var c=Math.ceil(i.SkyBottomLineCalculator.getSkyLineMinInRange(s,o));if(c===1/0)return;u.start.getStave().options.top_text_position=Math.abs(c),i.SkyBottomLineCalculator.updateSkyLineInRange(s,o,c-2*l)}else{var h=i.SkyBottomLineCalculator.getBottomLineMaxInRange(s,o);if(h===1/0)return;u.start.getStave().options.bottom_text_position=h,e.parentMeasure!==t.parentMeasure&&(u.stop.getStave().options.bottom_text_position=h),i.SkyBottomLineCalculator.updateBottomLineInRange(s,o,h+1.5*l)}}else v.default.warn("octaveshift: no endStaffEntry")}},{key:"calculateWordRepetitionInstruction",value:function(e,t){for(var n,i=this.graphicalMusicSheet.MeasureList[t],r=0,a=i.length;r<a;++r){var s=i[r];if(s&&s.ParentStaffLine&&s.ParentStaff.ParentInstrument.Visible){n=s;break}}n&&n.addWordRepetition(e)}},{key:"calculateSkyBottomLines",value:function(){var e,t=this.musicSystems.map((function(e){return e.StaffLines})).flat(),n=0,i=b(t);try{for(i.s();!(e=i.n()).done;){var r,a=e.value,o=b(a.Measures);try{for(o.s();!(r=o.n()).done;)r.value&&n++}catch(c){o.e(c)}finally{o.f()}}}catch(c){i.e(c)}finally{i.f()}if(this.rules.AlwaysSetPreferredSkyBottomLineBackendAutomatically&&this.rules.setPreferredSkyBottomLineBackendAutomatically(n),n>=this.rules.SkyBottomLineBatchMinMeasures)new s.SkyBottomLineBatchCalculator(t,this.rules.PreferredSkyBottomLineBatchCalculatorBackend).calculateLines();else{var u,l=b(t);try{for(l.s();!(u=l.n()).done;)u.value.SkyBottomLineCalculator.calculateLines()}catch(c){l.e(c)}finally{l.f()}}}},{key:"calculateExpressionAlignements",value:function(){var t,n=b(this.musicSystems);try{for(n.s();!(t=n.n()).done;){var i,r=t.value,a=b(r.StaffLines);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{s.AlignmentManager.alignDynamicExpressions(),s.AbstractExpressions.forEach((function(e){e.updateSkyBottomLine()}))}catch(e){}}}catch(o){a.e(o)}finally{a.f()}}}catch(o){n.e(o)}finally{n.f()}}},{key:"handleTiedGraphicalNote",value:function(e,t,n,i,r,a,s,o){}},{key:"handleBeam",value:function(e,t,n){e.parentVoiceEntry.parentStaffEntry.parentMeasure.handleBeam(e,t)}},{key:"handleVoiceEntryLyrics",value:function(e,t,n){var i=this;e.LyricsEntries.forEach((function(e,r){var a=new x.GraphicalLyricEntry(r,t,i.rules.LyricsHeight,i.rules.StaffHeight);if(t.LyricsEntries.push(a),a.GraphicalLabel.setLabelPositionAndShapeBorders(),r.Word){var s=r.Word.Syllables.indexOf(r),o=n.indexOf(r.Word);if(-1===o&&(n.push(r.Word),o=n.indexOf(r.Word)),0===i.graphicalLyricWords.length||o>i.graphicalLyricWords.length-1){var u=new _.GraphicalLyricWord(r.Word);a.ParentLyricWord=u,u.GraphicalLyricsEntries[s]=a,i.graphicalLyricWords.push(u)}else{var l=i.graphicalLyricWords[o];a.ParentLyricWord=l,l.GraphicalLyricsEntries[s]=a,l.isFilled()&&(n.splice(o,1),i.graphicalLyricWords.splice(i.graphicalLyricWords.indexOf(l),1))}}}))}},{key:"handleVoiceEntryOrnaments",value:function(e,t,n){}},{key:"handleVoiceEntryArticulations",value:function(e,t,n){}},{key:"handleVoiceEntryTechnicalInstructions",value:function(e,t,n){}},{key:"handleTuplet",value:function(e,t,n){e.parentVoiceEntry.parentStaffEntry.parentMeasure.handleTuplet(e,t)}},{key:"findIndexGraphicalSlurFromSlur",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].slur===t)return n;return-1}},{key:"calculateSlurs",value:function(){var e,t={},n=b(this.graphicalMusicSheet.MeasureList[0]);try{for(n.s();!(e=n.n()).done;)t[e.value.ParentStaff.idInMusicSheet]=[]}catch(H){n.e(H)}finally{n.f()}var i,r=b(this.musicSystems);try{for(r.s();!(i=r.n()).done;){var a,s=i.value,o=b(s.StaffLines);try{for(o.s();!(a=o.n()).done;){for(var u=a.value,l=t[u.ParentStaff.idInMusicSheet],c=0;c<l.length;c++){var h=l[c],d=new w.GraphicalSlur(h.slur,this.rules);u.addSlurToStaffline(d),l[c]=d}var f,p=b(u.Measures);try{for(p.s();!(f=p.n()).done;){var m,v=f.value,g=b(v.staffEntries);try{for(g.s();!(m=g.n()).done;){var y,S=m.value,x=b(S.graphicalVoiceEntries);try{for(x.s();!(y=x.n()).done;){var _,E=y.value,k=b(E.notes);try{for(k.s();!(_=k.n()).done;){var M,P=_.value,T=b(P.sourceNote.NoteSlurs);try{for(T.s();!(M=T.n()).done;){var C=M.value;if(C.EndNote&&C.StartNote){if(C.StartNote===P.sourceNote){var I=new w.GraphicalSlur(C,this.rules);l.push(I),u.addSlurToStaffline(I)}if(C.EndNote===P.sourceNote){var A=this.findIndexGraphicalSlurFromSlur(l,C);if(A>=0){var L=l[A];-1===L.staffEntries.indexOf(S)&&L.staffEntries.push(S),l.splice(A,1)}}}}}catch(H){T.e(H)}finally{T.f()}}}catch(H){k.e(H)}finally{k.f()}}}catch(H){x.e(H)}finally{x.f()}var O,R=b(l);try{for(R.s();!(O=R.n()).done;){var N=O.value;-1===N.staffEntries.indexOf(S)&&N.staffEntries.push(S)}}catch(H){R.e(H)}finally{R.f()}}}catch(H){g.e(H)}finally{g.f()}}}catch(H){p.e(H)}finally{p.f()}}}catch(H){o.e(H)}finally{o.f()}}}catch(H){r.e(H)}finally{r.f()}var B,D=b(this.musicSystems);try{for(D.s();!(B=D.n()).done;){var F,j=B.value,V=b(j.StaffLines);try{for(V.s();!(F=V.n()).done;){var G,W=F.value.GraphicalSlurs.sort(w.GraphicalSlur.Compare),U=b(W);try{for(U.s();!(G=U.n()).done;){var z=G.value;z.slur.isCrossed()||z.calculateCurve(this.rules)}}catch(H){U.e(H)}finally{U.f()}}}catch(H){V.e(H)}finally{V.f()}}}catch(H){D.e(H)}finally{D.f()}}}]),i}(r.MusicSheetCalculator);t.VexFlowMusicSheetCalculator=F},5820:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowMusicSheetDrawer=t.unitInPixels=void 0;var r=i(n(6368)),a=n(1494),s=n(3278),l=n(9086),c=n(2942),f=n(8155),p=n(3748),m=n(5277),v=n(9428),S=i(n(2043)),x=n(374),_=n(7459),E=n(4462);t.unitInPixels=10;var k=function(e){h(i,e);var n=d(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _.DrawingParameters;return g(this,i),(e=n.call(this,new c.VexFlowTextMeasurer(t.Rules),t)).backends=[],e.zoom=1,e.pageIdx=0,e}return y(i,[{key:"Zoom",get:function(){return this.zoom}},{key:"Backends",get:function(){return this.backends}},{key:"initializeBackendForPage",value:function(e){this.backend=this.backends[e.PageNumber-1]}},{key:"drawSheet",value:function(e){var n,a,s;"gonville"===this.rules.DefaultVexFlowNoteFont&&(r.default.Flow.DEFAULT_FONT_STACK=[null===(n=r.default.Flow.Fonts)||void 0===n?void 0:n.Gonville,null===(a=r.default.Flow.Fonts)||void 0===a?void 0:a.Bravura,null===(s=r.default.Flow.Fonts)||void 0===s?void 0:s.Custom]),r.default.Flow.STAVE_LINE_THICKNESS=this.rules.StaffLineWidth*t.unitInPixels,r.default.Flow.STEM_WIDTH=this.rules.StemWidth*t.unitInPixels,r.default.Flow.DEFAULT_NOTATION_FONT_SCALE=this.rules.VexFlowDefaultNotationFontScale,r.default.Flow.DEFAULT_TAB_FONT_SCALE=this.rules.VexFlowDefaultTabFontScale,this.pageIdx=0;var l,c=b(e.MusicPages);try{for(c.s();!(l=c.n()).done;){var h=l.value;if(h.PageNumber>this.rules.MaxPageToDrawNumber)break;var d=this.backends[this.pageIdx];d.graphicalMusicPage=h,d.scale(this.zoom),this.pageIdx+=1}}catch(f){c.e(f)}finally{c.f()}this.pageIdx=0,this.backend=this.backends[0],o(u(i.prototype),"drawSheet",this).call(this,e)}},{key:"drawPage",value:function(e){e&&(this.backend=this.backends[e.PageNumber-1],o(u(i.prototype),"drawPage",this).call(this,e),this.pageIdx+=1)}},{key:"clear",value:function(){var e,t=b(this.backends);try{for(t.s();!(e=t.n()).done;)e.value.clear()}catch(n){t.e(n)}finally{t.f()}}},{key:"setZoom",value:function(e){this.zoom=e}},{key:"calculatePixelDistance",value:function(e){return e*t.unitInPixels}},{key:"drawStaffLine",value:function(e){var t=this.backend.getContext().openGroup();t&&t.classList.add("staffline"),o(u(i.prototype),"drawStaffLine",this).call(this,e);var n=e.PositionAndShape.AbsolutePosition;this.rules.RenderSlurs&&this.drawSlurs(e,n),this.backend.getContext().closeGroup()}},{key:"drawSlurs",value:function(e,t){var n,i=b(e.GraphicalSlurs);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.slur.isCrossed()||this.drawSlur(r,t)}}catch(a){i.e(a)}finally{i.f()}}},{key:"drawSlur",value:function(e,t){var n=[],i=new l.PointF2D(e.bezierStartPt.x+t.x,e.bezierStartPt.y+t.y),r=new l.PointF2D(e.bezierStartControlPt.x+t.x,e.bezierStartControlPt.y+t.y),a=new l.PointF2D(e.bezierEndControlPt.x+t.x,e.bezierEndControlPt.y+t.y),s=new l.PointF2D(e.bezierEndPt.x+t.x,e.bezierEndPt.y+t.y);n.push(this.applyScreenTransformation(i)),n.push(this.applyScreenTransformation(r)),n.push(this.applyScreenTransformation(a)),n.push(this.applyScreenTransformation(s)),e.placement===p.PlacementEnum.Above?(i.y-=.05,r.y-=.3,a.y-=.3,s.y-=.05):(i.y+=.05,r.y+=.3,a.y+=.3,s.y+=.05),n.push(this.applyScreenTransformation(i)),n.push(this.applyScreenTransformation(r)),n.push(this.applyScreenTransformation(a)),n.push(this.applyScreenTransformation(s)),e.SVGElement=this.backend.renderCurve(n)}},{key:"drawMeasure",value:function(e){e.setAbsoluteCoordinates(e.PositionAndShape.AbsolutePosition.x*t.unitInPixels,e.PositionAndShape.AbsolutePosition.y*t.unitInPixels);var n=this.backend.getContext();try{e.draw(n)}catch(e){S.default.warn("VexFlowMusicSheetDrawer.drawMeasure",e)}var i,r=b(e.staffEntries);try{for(r.s();!(i=r.n()).done;){var a=i.value;this.drawStaffEntry(a)}}catch(s){r.e(s)}finally{r.f()}}},{key:"drawLine",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000FF",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.2;return e=this.applyScreenTransformation(e),n=this.applyScreenTransformation(n),this.backend.renderLine(e,n,i,r*t.unitInPixels)}},{key:"DrawOverlayLine",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#FF0000FF",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2;if(!(!i.PageNumber||i.PageNumber>this.backends.length||i.PageNumber<1)){var s=i.PageNumber-1,o=this.backends[s];return e=this.applyScreenTransformation(e),n=this.applyScreenTransformation(n),o.renderLine(e,n,r,a*t.unitInPixels)}console.log("VexFlowMusicSheetDrawer.drawOverlayLine: invalid page number / music page number doesn't correspond to an existing backend.")}},{key:"drawSkyLine",value:function(e){var t=e.PositionAndShape.AbsolutePosition,n=e.PositionAndShape.Size.width;this.drawSampledLine(e.SkyLine,t,n)}},{key:"drawBottomLine",value:function(e){var t=new l.PointF2D(e.PositionAndShape.AbsolutePosition.x,e.PositionAndShape.AbsolutePosition.y),n=e.PositionAndShape.Size.width;this.drawSampledLine(e.BottomLine,t,n,"#0000FFFF")}},{key:"drawSampledLine",value:function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#FF0000FF",r=[],a=0,s=0;s<e.length;s++)e[s]!==a&&(r.push(s),a=e[s]);var o=t;if(r.length>0){var u,c,h=this.rules.SamplingUnit,d=new l.PointF2D(o.x,o.y),f=new l.PointF2D(r[0]/h+o.x,o.y);this.drawLine(d,f,i),e[0]>=0&&(u=new l.PointF2D(r[0]/h+o.x,o.y),c=new l.PointF2D(r[0]/h+o.x,o.y+e[r[0]]),this.drawLine(u,c,i));for(var p=1;p<r.length;p++)d=new l.PointF2D(r[p-1]/h+o.x,o.y+e[r[p-1]]),f=new l.PointF2D(r[p]/h+o.x,o.y+e[r[p-1]]),this.drawLine(d,f,i),u=new l.PointF2D(r[p]/h+o.x,o.y+e[r[p-1]]),c=new l.PointF2D(r[p]/h+o.x,o.y+e[r[p]]),this.drawLine(u,c,i);r[r.length-1]<e.length?(d=new l.PointF2D(r[r.length-1]/h+o.x,o.y+e[r[r.length-1]]),f=new l.PointF2D(o.x+n,o.y+e[r[r.length-1]]),this.drawLine(d,f,i)):(d=new l.PointF2D(r[r.length-1]/h+o.x,o.y),f=new l.PointF2D(o.x+n,o.y),this.drawLine(d,f,i))}else{var m=new l.PointF2D(o.x,o.y),v=new l.PointF2D(o.x+n,o.y);this.drawLine(m,v,i)}}},{key:"drawStaffEntry",value:function(e){if(e.FingeringEntries.length>0){var t,n=b(e.FingeringEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.SVGNode=this.drawLabel(i,f.GraphicalLayers.Notes)}}catch(o){n.e(o)}finally{n.f()}}if(void 0!==e.graphicalChordContainers&&e.graphicalChordContainers.length>0){var r,a=b(e.graphicalChordContainers);try{for(a.s();!(r=a.n()).done;){var s=r.value.GraphicalLabel;s.SVGNode=this.drawLabel(s,f.GraphicalLayers.Notes)}}catch(o){a.e(o)}finally{a.f()}}this.rules.RenderLyrics&&e.LyricsEntries.length>0&&this.drawLyrics(e.LyricsEntries,f.GraphicalLayers.Notes)}},{key:"drawLyrics",value:function(e,t){var n=this;e.forEach((function(e){var i=e.GraphicalLabel;i.Label.colorDefault=n.rules.DefaultColorLyrics,i.SVGNode=n.drawLabel(i,t)}))}},{key:"drawInstrumentBrace",value:function(e,t){e.draw(this.backend.getContext())}},{key:"drawGroupBracket",value:function(e,t){e.draw(this.backend.getContext())}},{key:"drawOctaveShifts",value:function(e){var t,n=b(e.OctaveShifts);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i){var r=i,a=this.backend.getContext(),s=r.getTextBracket();this.rules.DefaultColorMusic&&(s.render_options.color=this.rules.DefaultColorMusic),s.setContext(a);try{s.draw()}catch(e){S.default.warn(e)}}}}catch(o){n.e(o)}finally{n.f()}}},{key:"drawPedals",value:function(e){var t,n=b(e.Pedals);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i){var r=i,a=this.backend.getContext(),s=r.getPedalMarking();s.render_options.color=this.rules.DefaultColorMusic,s.setContext(a),s.draw()}}}catch(o){n.e(o)}finally{n.f()}}},{key:"drawWavyLines",value:function(e){var t,n=b(e.WavyLines);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i){var r=i,a=this.backend.getContext(),s=r.getVibratoBracket();s.setContext(a),s.draw()}}}catch(o){n.e(o)}finally{n.f()}}},{key:"drawExpressions",value:function(e){var t,n=b(e.AbstractExpressions);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i instanceof v.GraphicalInstantaneousDynamicExpression)this.drawInstantaneousDynamic(i);else if(i instanceof m.GraphicalInstantaneousTempoExpression){var r=i.GraphicalLabel;r.SVGNode=this.drawLabel(r,f.GraphicalLayers.Notes)}else if(i instanceof x.GraphicalContinuousDynamicExpression)this.drawContinuousDynamic(i);else if(i instanceof E.GraphicalUnknownExpression){var a=i.Label;a.SVGNode=this.drawLabel(a,f.GraphicalLayers.Notes)}else S.default.warn("Unkown type of expression!")}}catch(s){n.e(s)}finally{n.f()}}},{key:"drawInstantaneousDynamic",value:function(e){var t=e.Label;t.SVGNode=this.drawLabel(t,f.GraphicalLayers.Notes)}},{key:"drawContinuousDynamic",value:function(e){var t;if(e.IsVerbal){var n=e.Label;n.SVGNode=this.drawLabel(n,f.GraphicalLayers.Notes)}else{var i,r=b(e.Lines);try{for(r.s();!(i=r.n()).done;){var a=i.value,s=new l.PointF2D(e.ParentStaffLine.PositionAndShape.AbsolutePosition.x+a.Start.x,e.ParentStaffLine.PositionAndShape.AbsolutePosition.y+a.Start.y),o=new l.PointF2D(e.ParentStaffLine.PositionAndShape.AbsolutePosition.x+a.End.x,e.ParentStaffLine.PositionAndShape.AbsolutePosition.y+a.End.y);this.drawLine(s,o,null!==(t=a.colorHex)&&void 0!==t?t:"#000000",a.Width)}}catch(u){r.e(u)}finally{r.f()}}}},{key:"renderLabel",value:function(e,t,n){return this._renderLabel(e,n)}},{key:"_renderLabel",value:function(e,n){var i;if(e.Label.print){var r,a=e.Label.fontHeight*t.unitInPixels,s=e.Label.font;this.rules.ColoringEnabled&&(r=e.Label.colorDefault,e.Label.color&&(r=e.Label.color.toString()),r||(r=this.rules.DefaultColorLabel));var o,u=e.Label,c=u.fontStyle,h=u.fontFamily;c||(c=this.rules.DefaultFontStyle),h||(h=this.rules.DefaultFontFamily);for(var d=0;d<(null===(i=e.TextLines)||void 0===i?void 0:i.length);d++){var f=e.TextLines[d],p=this.calculatePixelDistance(f.xOffset),m=new l.PointF2D(n.ScreenPosition.x+p,n.ScreenPosition.y),v=this.backend.renderText(a,c,s,f.text,n.FontHeightInPixel,m,r,e.Label.fontFamily);o?o.appendChild(v):o=v,n.ScreenPosition.y=n.ScreenPosition.y+n.FontHeightInPixel,e.TextLines.length>1&&(n.ScreenPosition.y+=this.rules.SpacingBetweenTextLines)}return o}}},{key:"renderRectangle",value:function(e,t,n,i,r){return this.backend.renderRectangle(e,n,i,r)}},{key:"applyScreenTransformation",value:function(e){return new l.PointF2D(e.x*t.unitInPixels,e.y*t.unitInPixels)}},{key:"applyScreenTransformationForRect",value:function(e){return new s.RectangleF2D(e.x*t.unitInPixels,e.y*t.unitInPixels,e.width*t.unitInPixels,e.height*t.unitInPixels)}}]),i}(a.MusicSheetDrawer);t.VexFlowMusicSheetDrawer=k},8494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowMusicSystem=void 0;var i=n(7142),r=n(6894),a=n(7771),s=n(8129),o=n(5575),u=n(8939),l=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this,e)).rules=i,r}return y(n,[{key:"calculateBorders",value:function(e){if(0!==this.staffLines.length){var t=this.calcBracketsWidth();this.boundingBox.BorderLeft=-t,this.boundingBox.BorderMarginLeft=-t,this.boundingBox.XBordersHaveBeenSet=!0;var n=this.staffLines[0].SkyBottomLineCalculator.getSkyLineMin();this.boundingBox.BorderTop=n,this.boundingBox.BorderMarginTop=n;var i=this.staffLines[this.staffLines.length-1],r=i.SkyBottomLineCalculator.getBottomLineMax()+i.PositionAndShape.RelativePosition.y;this.boundingBox.BorderBottom=r,this.boundingBox.BorderMarginBottom=r,this.boundingBox.XBordersHaveBeenSet=!0,this.boundingBox.YBordersHaveBeenSet=!0}}},{key:"createSystemLine",value:function(e,t,n,i,o,u,l){var c=u,h=!1;if(l&&(h=!0,l.lineTo(u,s.VexFlowConverter.line(n,i)),l.addMeasureLine(n,i),n===r.SystemLinesEnum.DotsBoldBoldDots)){var d=l.ParentStaffLine.Measures.indexOf(l)+1,f=l.ParentStaffLine.Measures[d],p=u.ParentStaffLine.Measures[d];f&&p&&(f.lineTo(p,s.VexFlowConverter.line(r.SystemLinesEnum.BoldThinDots,i)),f.addMeasureLine(r.SystemLinesEnum.BoldThinDots,i))}return c&&c.addMeasureLine(n,i,h),new a.SystemLine(n,i,this,u,l)}},{key:"createInstrumentBracket",value:function(e,t){var n=e,i=t,r=new u.VexFlowInstrumentBrace(n,i);this.InstrumentBrackets.push(r)}},{key:"createGroupBracket",value:function(e,t,n){var i=e,r=t;if(0===n){var a=new o.VexFlowInstrumentBracket(i,r,n);this.GroupBrackets.push(a)}else{var s=new u.VexFlowInstrumentBrace(i,r,n);this.GroupBrackets.push(s)}}}]),n}(i.MusicSystem);t.VexFlowMusicSystem=l},9520:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowOctaveShift=void 0;var r=i(n(6368)).default.Flow,a=n(873),s=n(5853),o=i(n(2043)),u=function(e){h(n,e);var t=d(n);function n(e,i){var a;switch(g(this,n),a=t.call(this,e,i),e.Type){case s.OctaveEnum.VA8:a.position=r.TextBracket.Positions.TOP,a.supscript="va",a.text="8";break;case s.OctaveEnum.MA15:a.position=r.TextBracket.Positions.TOP,a.supscript="ma",a.text="15";break;case s.OctaveEnum.VB8:a.position=r.TextBracket.Positions.BOTTOM,a.supscript="vb",a.text="8";break;case s.OctaveEnum.MB15:a.position=r.TextBracket.Positions.BOTTOM,a.supscript="mb",a.text="15";break;default:o.default.error("Unknown or NONE octaveshift. This should not be called!")}return a}return y(n,[{key:"setStartNote",value:function(e){var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote)return this.startNote=i.vfStaveNote,!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"setEndNote",value:function(e){var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote)return this.endNote=i.vfStaveNote,!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"getTextBracket",value:function(){return new r.TextBracket({position:this.position,start:this.startNote,stop:this.endNote,superscript:this.supscript,text:this.text})}}]),n}(a.GraphicalOctaveShift);t.VexFlowOctaveShift=u},3010:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowPedal=void 0;var r=i(n(6368)),a=n(8911),s=n(4082),o=n(158),u=function(e){h(n,e);var t=d(n);function n(e,i){var s,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];switch(g(this,n),(s=t.call(this,e,i)).vfStyle=r.default.Flow.PedalMarking.Styles.BRACKET,s.ChangeBegin=!1,s.ChangeEnd=!1,s.line=-3,s.EndSymbolPositionAndShape=void 0,s.ChangeBegin=e.ChangeBegin,s.ChangeEnd=e.ChangeEnd,s.pedalSymbol){case o.MusicSymbol.PEDAL_SYMBOL:s.vfStyle=r.default.Flow.PedalMarking.Styles.TEXT,s.EndSymbolPositionAndShape=new a.BoundingBox(c(s),i);break;case o.MusicSymbol.PEDAL_MIXED:s.vfStyle=u&&l?r.default.Flow.PedalMarking.Styles.BRACKET_OPEN_BOTH:u?r.default.Flow.PedalMarking.Styles.BRACKET_OPEN_BEGIN:l?r.default.Flow.PedalMarking.Styles.MIXED_OPEN_END:r.default.Flow.PedalMarking.Styles.MIXED;break;case o.MusicSymbol.PEDAL_BRACKET:default:s.vfStyle=u&&l?r.default.Flow.PedalMarking.Styles.BRACKET_OPEN_BOTH:u?r.default.Flow.PedalMarking.Styles.BRACKET_OPEN_BEGIN:l?r.default.Flow.PedalMarking.Styles.BRACKET_OPEN_END:r.default.Flow.PedalMarking.Styles.BRACKET}return s}return y(n,[{key:"setStartNote",value:function(e){if(!e)return!1;var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote)return this.startNote=i.vfStaveNote,this.startVfVoiceEntry=i,!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"setEndNote",value:function(e){if(!e)return!1;var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote)return this.endNote=i.vfStaveNote,this.endVfVoiceEntry=i,!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"setEndMeasure",value:function(e){this.endMeasure=e}},{key:"CalculateBoundingBox",value:function(){}},{key:"setLine",value:function(e){this.line=e}},{key:"getPedalMarking",value:function(){var e,t,n,i,a=new r.default.Flow.PedalMarking([this.startNote,this.endNote]);return this.endMeasure&&a.setEndStave(this.endMeasure.getVFStave()),a.setStyle(this.vfStyle),a.setLine(this.line),a.setCustomText(this.DepressText,this.ReleaseText),(null===(e=this.endVfVoiceEntry)||void 0===e?void 0:e.parentStaffEntry)!==(null===(i=null===(n=null===(t=this.endVfVoiceEntry)||void 0===t?void 0:t.parentStaffEntry)||void 0===n?void 0:n.parentMeasure)||void 0===i?void 0:i.staffEntries.last())&&this.endVfVoiceEntry||(a.EndsStave=!0),a.ChangeBegin=this.ChangeBegin,a.ChangeEnd=this.ChangeEnd,a}}]),n}(s.GraphicalPedal);t.VexFlowPedal=u},8041:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowSlur=t.CurvePositionEnum=void 0;var r,a=i(n(6368)).default.Flow;!function(e){e[e.NEAR_HEAD=1]="NEAR_HEAD",e[e.NEAR_TOP=2]="NEAR_TOP"}(r=t.CurvePositionEnum||(t.CurvePositionEnum={}));var s=function(){function e(t){g(this,e),this.vfStartNote=void 0,this.vfEndNote=void 0,this.parentSlur=t}return y(e,[{key:"vfSlur",get:function(){return this.parentSlur}},{key:"curve_Options",value:function(){return{cps:[{x:0,y:10},{x:0,y:10}],invert:!1,position:r.NEAR_TOP,position_end:r.NEAR_TOP,spacing:2,thickness:2,x_shift:0,y_shift:10}}},{key:"createVexFlowCurve",value:function(){this.vfCurve=new a.Curve(this.vfStartNote,this.vfEndNote,void 0)}}],[{key:"createFromVexflowSlur",value:function(t){return new e(t.parentSlur)}}]),e}();t.VexFlowSlur=s},9252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowStaffEntry=void 0;var i=n(3023),r=n(5820),a=n(8640),s=function(e){h(n,e);var t=d(n);function n(e,i,r){return g(this,n),t.call(this,e,i,r)}return y(n,[{key:"calculateXPosition",value:function(){var e,t=this.parentMeasure.getVFStave(),n=0,i=b(this.graphicalVoiceEntries);try{for(i.s();!(e=i.n()).done;){var a=e.value;if(a.vfStaveNote){if(a.vfStaveNote.setStave(t),!a.vfStaveNote.preFormatted)continue;a.applyBordersFromVexflow(),this.parentMeasure.ParentStaff.isTab?this.PositionAndShape.RelativePosition.x=(a.vfStaveNote.getAbsoluteX()+a.vfStaveNote.glyph.getWidth())/r.unitInPixels:this.PositionAndShape.RelativePosition.x=a.vfStaveNote.getBoundingBox().getX()/r.unitInPixels;var s=a.notes[0].sourceNote;s.isRest()&&s.Length.RealValue===this.parentMeasure.parentSourceMeasure.ActiveTimeSignature.RealValue&&(this.PositionAndShape.RelativePosition.x+=this.parentMeasure.parentSourceMeasure.Rules.WholeRestXShiftVexflow-.1,a.PositionAndShape.BorderLeft=-.7,a.PositionAndShape.BorderRight=.7),a.PositionAndShape.BorderLeft<n&&(n=a.PositionAndShape.BorderLeft)}}}catch(o){i.e(o)}finally{i.f()}this.PositionAndShape.RelativePosition.x-=n,this.PositionAndShape.calculateBoundingBox()}},{key:"setMaxAccidentals",value:function(){var e,t=b(this.graphicalVoiceEntries);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.notes);try{for(r.s();!(n=r.n()).done;)if(n.value.DrawnAccidental!==a.AccidentalEnum.NONE)return this.MaxAccidentals=1}catch(s){r.e(s)}finally{r.f()}}}catch(s){t.e(s)}finally{t.f()}return this.MaxAccidentals=0}},{key:"setModifierXOffsets",value:function(){var e,t=[],n=b(this.graphicalVoiceEntries);try{for(n.s();!(e=n.n()).done;){var i=e.value;t=t.concat(i.notes)}}catch(o){n.e(o)}finally{n.f()}var r=t.map((function(e){return e.staffLine})),a=this.calculateModifierXOffsets(r,1),s=this.calculateModifierXOffsets(r,.5);t.forEach((function(e,t){e.baseFingeringXOffset=s[t],e.baseStringNumberXOffset=a[t]}))}},{key:"calculateModifierXOffsets",value:function(e,t){for(var n=[],i=0;i<e.length;i++){for(var r=0,a=!0;a;)for(var s=i;s>=0;s--){if(Math.abs(e[i]-e[s])<=t&&r===n[s]){r++,a=!0;break}a=!1}n.push(r)}return n}}]),n}(i.GraphicalStaffEntry);t.VexFlowStaffEntry=s},4828:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowStaffLine=void 0;var i=n(9953),r=n(449),a=function(e){h(n,e);var t=d(n);function n(e,i){var a;return g(this,n),(a=t.call(this,e,i)).slursInVFStaffLine=[],a.alignmentManager=new r.AlignmentManager(c(a)),a}return y(n,[{key:"SlursInVFStaffLine",get:function(){return this.slursInVFStaffLine}},{key:"addVFSlurToVFStaffline",value:function(e){this.slursInVFStaffLine.push(e)}},{key:"AlignmentManager",get:function(){return this.alignmentManager}}]),n}(i.StaffLine);t.VexFlowStaffLine=a},8790:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowTabMeasure=void 0;var r=i(n(6368)).default.Flow,a=n(7330),s=n(8129),o=i(n(2043)),u=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,e,i,r)).isTabMeasure=!0,a}return y(n,[{key:"resetLayout",value:function(){var e,t=null!==(e=this.ParentStaff.StafflineCount)&&void 0!==e?e:6;this.stave=new r.TabStave(0,0,0,{space_above_staff_ln:0,space_below_staff_ln:0,num_lines:t}),this.updateInstructionWidth()}},{key:"graphicalMeasureCreatedCalculations",value:function(){for(var e=0,t=this.staffEntries.length;e<t;++e){var n,i=this.staffEntries[e],a=b(i.graphicalVoiceEntries);try{for(a.s();!(n=a.n()).done;){var u=n.value;u.notes[0].sourceNote.isRest()?u.vfStaveNote=s.VexFlowConverter.GhostNotes(u.notes[0].sourceNote.Length)[0]:u.vfStaveNote=s.VexFlowConverter.CreateTabNote(u)}}catch(_){a.e(_)}finally{a.f()}}this.rules.TupletNumbersInTabs&&this.finalizeTuplets();var l,c=this.getVoicesWithinMeasure(),h=b(c);try{for(h.s();!(l=h.n()).done;){var d=l.value;if(d){this.vfVoices[d.VoiceId]=new r.Voice({beat_value:this.parentSourceMeasure.Duration.Denominator,num_beats:this.parentSourceMeasure.Duration.Numerator,resolution:r.RESOLUTION}).setMode(r.Voice.Mode.SOFT);var f,p=this.getRestFilledVexFlowStaveNotesPerVoice(d),m=b(p);try{for(m.s();!(f=m.n()).done;){var v=f.value;if(!v.parentVoiceEntry||!v.parentVoiceEntry.IsGrace||v.parentVoiceEntry.GraceAfterMainNote){var g=v;if(0!==v.notes.length&&v.notes[0]&&v.notes[0].sourceNote.PrintObject){if(v.parentVoiceEntry&&v.parentVoiceEntry.Arpeggio){var y=v.parentVoiceEntry.Arpeggio;if(v.notes&&v.notes.length>1){var S=s.VexFlowConverter.StrokeTypeFromArpeggioType(y.type),x=new r.Stroke(S,{all_voices:this.rules.ArpeggiosGoAcrossVoices});this.rules.RenderArpeggios&&g.vfStaveNote.addStroke(0,x)}else o.default.debug("[OSMD] arpeggio in measure ".concat(this.MeasureNumber," could not be drawn.\n                        voice entry had less than two notes, arpeggio is likely between voice entries, not currently supported in Vexflow."))}this.vfVoices[d.VoiceId].addTickable(g.vfStaveNote)}else this.vfVoices[d.VoiceId].addTickable(g.vfStaveNote)}}}catch(_){m.e(_)}finally{m.f()}}}}catch(_){h.e(_)}finally{h.f()}}}]),n}(a.VexFlowMeasure);t.VexFlowTabMeasure=u},2942:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowTextMeasurer=void 0;var i=n(8129);t.VexFlowTextMeasurer=function(){function e(t){g(this,e),this.fontSize=20,this.fontSizeStandard=this.fontSize;var n=document.createElement("canvas");this.context=n.getContext("2d"),this.rules=t}return y(e,[{key:"computeTextWidthToHeightRatio",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.fontSize;return this.context.font=i.VexFlowConverter.font(a,n,t,this.rules,r),this.context.measureText(e).width/a}},{key:"setFontSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.fontSizeStandard;return this.fontSize=e,e}}]),e}()},5460:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexFlowVoiceEntry=void 0;var i=n(5974),r=n(5820),a=n(7459),s=function(e){h(n,e);var t=d(n);function n(e,i,r){return g(this,n),t.call(this,e,i,r)}return y(n,[{key:"applyBordersFromVexflow",value:function(){var e=this.vfStaveNote;if(e.getNoteHeadBeginX){var t=e.getBoundingBox(),n=e.getNoteHeadBeginX()-t.x;this.PositionAndShape.RelativePosition.y=t.y/r.unitInPixels,this.PositionAndShape.BorderTop=0,this.PositionAndShape.BorderBottom=t.h/r.unitInPixels,this.PositionAndShape.BorderLeft=-(n+e.width/2)/r.unitInPixels,this.PositionAndShape.BorderRight=(t.w-n)/r.unitInPixels}}},{key:"vfStaveNote",get:function(){return this.mVexFlowStaveNote},set:function(e){this.mVexFlowStaveNote=e}},{key:"color",value:function(){for(var e,t,n,i=this.rules.DefaultColorNotehead,r=this.rules.DefaultColorRest,s=this.rules.DefaultColorStem,o="#00000000",u=this.vfStaveNote,l=0;l<this.notes.length;l++){var c=this.notes[l];if(t=n=c.sourceNote.NoteheadColor,this.rules.ColoringMode===a.ColoringModes.AutoColoring||this.rules.ColoringMode===a.ColoringModes.CustomColorSet)if(c.sourceNote.isRest())t=this.rules.ColoringSetCurrent.getValue(-1);else{var h=c.sourceNote.Pitch.FundamentalNote;t=this.rules.ColoringSetCurrent.getValue(h)}if(c.sourceNote.PrintObject?t&&"#000000"!==t||(t=this.rules.DefaultColorNotehead):t=o,!n&&this.rules.ColoringMode===a.ColoringModes.XML&&c.sourceNote.PrintObject&&(!c.sourceNote.isRest()&&i?t=i:c.sourceNote.isRest()&&r&&(t=r)),t&&c.sourceNote.PrintObject)c.sourceNote.NoteheadColorCurrentlyRendered=t;else if(!t)continue;if(this.rules.ColoringEnabled&&c.sourceNote.NoteBeam&&this.rules.ColorBeams){for(var d=c.sourceNote.NoteBeam.Notes,f=!0,p=0;p<d.length;p++)d[p].NoteheadColorCurrentlyRendered!==t&&(f=!1);f&&(null===(e=null==u?void 0:u.beam)||void 0===e?void 0:e.setStyle)&&u.beam.setStyle({fillStyle:t,strokeStyle:t})}if(u){if(u.note_heads){var m=u.note_heads[l];m&&m.setStyle({fillStyle:t,strokeStyle:t})}u.setLedgerLineStyle&&(t===o?u.setLedgerLineStyle({fillStyle:t,strokeStyle:t,lineWidth:this.rules.LedgerLineWidth}):u.setLedgerLineStyle({fillStyle:this.rules.LedgerLineColorDefault,lineWidth:this.rules.LedgerLineWidth,strokeStyle:this.rules.LedgerLineColorDefault}))}}var v=s,g=!1;this.rules.ColoringEnabled&&((v=this.parentVoiceEntry.StemColor)&&"#000000"!==v||(v=s),this.rules.ColorStemsLikeNoteheads&&t&&(v=t,g=!0));var y,S=!0,x=b(this.parentVoiceEntry.Notes);try{for(x.s();!(y=x.n()).done;)if(y.value.PrintObject){S=!1;break}}catch(E){x.e(E)}finally{x.f()}S&&(v=o);var _={fillStyle:v,strokeStyle:v};u&&u.setStemStyle&&(!S&&g&&(this.parentVoiceEntry.StemColor=v),u.setStemStyle(_),u.flag&&u.setFlagStyle&&this.rules.ColorFlags&&u.setFlagStyle(_))}}]),n}(i.GraphicalVoiceEntry);t.VexFlowVoiceEntry=s},7781:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VexflowStafflineNoteCalculator=void 0;var i=n(8640),r=n(4679),a=n(1649),s=n(289),o=n(908),u=function(){function e(t){g(this,e),this.staffPitchListMapping=new a.Dictionary,this.baseLineNote=i.NoteEnum.B,this.baseLineOctave=1,this.rules=t}return y(e,[{key:"trackNote",value:function(t){if(t instanceof r.VexFlowGraphicalNote&&t.Clef().ClefType===s.ClefEnum.percussion&&!t.sourceNote.isRest()&&0!==this.rules.PercussionOneLineCutoff&&-1!==this.rules.PercussionForceVoicesOneLineCutoff){var n,i=t.parentVoiceEntry.parentStaffEntry.sourceStaffEntry.ParentStaff.idInMusicSheet;this.staffPitchListMapping.containsKey(i)||this.staffPitchListMapping.setValue(i,new Array),n=this.staffPitchListMapping.getValue(i);var a=t.sourceNote.Pitch;e.findOrInsert(n,a)}}},{key:"positionNote",value:function(t){var n=t.parentVoiceEntry.parentStaffEntry.sourceStaffEntry.ParentStaff.idInMusicSheet;if(!(t instanceof r.VexFlowGraphicalNote)||t.sourceNote.isRest()||!this.staffPitchListMapping.containsKey(n))return t;var a=this.staffPitchListMapping.getValue(n),s=this.rules.PercussionUseXMLDisplayStep&&void 0!==t.sourceNote.displayStepUnpitched;if(a.length>this.rules.PercussionOneLineCutoff&&!s)return t;var u=t,l=t.sourceNote.Pitch,c=this.baseLineNote,h=this.baseLineOctave;if(this.rules.PercussionUseXMLDisplayStep&&void 0!==t.sourceNote.displayStepUnpitched&&(c=t.sourceNote.displayStepUnpitched,h=t.sourceNote.displayOctaveUnpitched+this.rules.PercussionOneLineXMLDisplayStepOctaveOffset),a.length<=this.rules.PercussionForceVoicesOneLineCutoff)u.setAccidental(new i.Pitch(c,h,l.Accidental));else{var d=e.PitchIndexOf(a,l);if(d>-1){var f=Math.ceil(a.length/2);if(!this.rules.PercussionUseXMLDisplayStep)if(d>=f)switch(h=2,(d-f)%5){case 1:c=i.NoteEnum.E;break;case 2:c=i.NoteEnum.G;break;case 3:c=i.NoteEnum.B;break;case 4:c=i.NoteEnum.D,h=3;break;default:c=i.NoteEnum.C}else switch(d%5){case 1:c=i.NoteEnum.F;break;case 2:c=i.NoteEnum.D;break;case 3:c=i.NoteEnum.B,h=0;break;case 4:c=i.NoteEnum.G,h=0;break;default:c=i.NoteEnum.A}var p=new i.Pitch(c,h,l.Accidental);u.setAccidental(p);var m=u.parentVoiceEntry.parentVoiceEntry;!this.rules.SetWantedStemDirectionByXml&&m.Notes.length<2&&(p.Octave>this.baseLineOctave||p.FundamentalNote===this.baseLineNote&&p.Octave===this.baseLineOctave?u.parentVoiceEntry.parentVoiceEntry.WantedStemDirection=o.StemDirectionType.Up:u.parentVoiceEntry.parentVoiceEntry.WantedStemDirection=o.StemDirectionType.Down)}}return u}},{key:"getStafflineUniquePositionCount",value:function(e){return this.staffPitchListMapping.containsKey(e)?this.staffPitchListMapping.getValue(e).length:0}}],[{key:"PitchIndexOf",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n>e.length-1)return-1;for(var i=n;i<e.length;i++){var r=e[i];if(t.OperatorEquals(r))return i}return-1}},{key:"findOrInsert",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(t.OperatorEquals(i))return n;if(t.OperatorFundamentalLessThan(i))return e.splice(n,0,t),n}return e.push(t),e.length-1}}]),e}();t.VexflowStafflineNoteCalculator=u},448:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VexflowVibratoBracket=void 0;var r=n(8682),a=i(n(6368)),s=function(e){h(n,e);var t=d(n);function n(e,i){var r,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return g(this,n),(r=t.call(this,e,i)).line=1,r.isVibrato=!1,r.toEndOfStopStave=!1,r.isVibrato=a,r}return y(n,[{key:"ToEndOfStopStave",get:function(){return this.toEndOfStopStave}},{key:"setStartNote",value:function(e){var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote)return this.startNote=i.vfStaveNote,this.startVfVoiceEntry=i,!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"setEndNote",value:function(e){var t,n=b(e.graphicalVoiceEntries);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null==i?void 0:i.vfStaveNote){this.endNote=i.vfStaveNote,this.endVfVoiceEntry=i;var r=this.endVfVoiceEntry.parentStaffEntry.parentMeasure.staffEntries,a=r[r.length-1];return this.toEndOfStopStave=a===this.endVfVoiceEntry.parentStaffEntry,!0}}}catch(s){n.e(s)}finally{n.f()}return!1}},{key:"CalculateBoundingBox",value:function(){var e=this.getVibratoBracket();this.boundingBox.Size.height=.2*e.render_options.wave_height}},{key:"getVibratoBracket",value:function(){var e=new a.default.Flow.VibratoBracket({start:this.startNote,stop:this.endNote,toEndOfStopStave:this.toEndOfStopStave});return e.setLine(this.line),this.isVibrato?e.render_options.vibrato_width=20:e.render_options.wave_girth=4,e}}]),n}(r.GraphicalWavyLine);t.VexflowVibratoBracket=s},9839:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(449),t),r(n(4028),t),r(n(9505),t),r(n(709),t),r(n(9344),t),r(n(8129),t),r(n(4679),t),r(n(8144),t),r(n(6351),t),r(n(8939),t),r(n(5575),t),r(n(7330),t),r(n(4405),t),r(n(8738),t),r(n(5820),t),r(n(8494),t),r(n(9520),t),r(n(8041),t),r(n(9252),t),r(n(4828),t),r(n(7781),t),r(n(8790),t),r(n(2942),t),r(n(5460),t)},7636:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLSkyBottomLineBatchCalculatorBackend=void 0;var r=n(1378),a=n(9531),s=i(n(6357)),o=i(n(6150)),u=i(n(2043));function l(e,t,n){var i=e.createShader(t);if(!i)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: Could not create a WebGL shader"),new Error("Could not create a WebGL shader");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw u.default.warn("Shader compilation failed\n"+e.getShaderInfoLog(i)),e.deleteShader(i),new Error("WebGL shader compilation failed");return i}var c=function(e){h(n,e);var t=d(n);function n(e,i){return g(this,n),t.call(this,e,i)}return y(n,[{key:"getPreferredRenderingConfiguration",value:function(e,t){var n=Math.min(4096,function(){var e=document.createElement("canvas").getContext("webgl");return e.getParameter(e.MAX_TEXTURE_SIZE)}()),i=Math.ceil(e);return{elementWidth:i,numColumns:Math.min(5,Math.floor(n/i)),numRows:Math.min(5,Math.floor(n/t))}}},{key:"onInitialize",value:function(e){var t=e.elementWidth,n=e.elementHeight,i=e.numColumns,r=e.numRows,a=document.createElement("canvas");a.width=t*i,a.height=r;var c=a.getContext("webgl");if(!c)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: No WebGL support"),new Error("No WebGL support");this.gl=c;var h=function(e,t,n){var i=e.createProgram();if(!i)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: Could not create a WebGL program"),new Error("Could not create a WebGL program");if(e.attachShader(i,t),e.attachShader(i,n),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS))throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: WebGL program link failed\n"+e.getProgramInfoLog(i)),e.deleteProgram(i),new Error("WebGL program link failed");return i}(c,l(c,c.VERTEX_SHADER,s.default),l(c,c.FRAGMENT_SHADER,function(e,t){for(var n=e,i=0,r=Object.entries(t);i<r.length;i++){var a=x(r[i],2),s=a[0],o=a[1],u=new RegExp("#define ".concat(s," .*"));n=n.replace(u,"#define ".concat(s," ").concat(o))}return n}(o.default,{NUM_ROWS:r,ELEMENT_HEIGHT:n})));!function(e,t,n,i){var r=e.createBuffer();if(!r)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: WebGL buffer creation failed"),new Error("WebGL buffer creation failed");e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,new Float32Array([[-1,-1],[1,-1],[1,1],[-1,-1],[1,1],[-1,1]].flat()),e.STATIC_DRAW),e.useProgram(t);var a=e.getAttribLocation(t,"a_position");e.enableVertexAttribArray(a),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0)}(c,h),this.texture=function(e,t,n,i){var r=e.createTexture();if(!r)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: WebGL texture creation failed"),new Error("WebGL texture creation failed");e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);var a=e.getUniformLocation(t,"u_image");if(!a)throw u.default.warn("WebGLSkyBottomLineCalculatorBackend: WebGL invalid uniform name"),new Error("WebGL invalid uniform name");return e.uniform1i(a,0),r}(c,h)}},{key:"calculateFromCanvas",value:function(e,t,n,i,a){var s=this.gl,o=a.elementWidth,u=a.elementHeight,l=a.numColumns;s.viewport(0,0,s.canvas.width,s.canvas.height),s.bindTexture(s.TEXTURE_2D,this.texture),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e),s.drawArrays(s.TRIANGLES,0,6);var c=new Uint8Array(s.canvas.width*s.canvas.height*4);s.readPixels(0,0,s.canvas.width,s.canvas.height,s.RGBA,s.UNSIGNED_BYTE,c);for(var h=[],d=0;d<n.length;++d){for(var f=n[d],p=Math.floor(f.getVFStave().getWidth()),m=Math.max(Math.ceil(f.PositionAndShape.Size.width*i),1),v=d%l*o*4,g=Math.floor(d/l)*o*l*4,y=new Array(Math.max(m,p)).fill(0),b=new Array(Math.max(m,p)).fill(0),x=0;x<p;++x){var _=c[4*x+v+g],E=c[4*x+v+g+1],k=c[4*x+v+g+2],M=_+256*Math.floor(k/16),w=E+k%16*256;y[x]=M,b[x]=w}for(var P=Math.max.apply(Math,S(y)),T=Math.min.apply(Math,S(b)),C=0;C<p;++C)y[C]=0===y[C]?P:y[C],b[C]=b[C]===u?T:b[C];h.push(new r.SkyBottomLineCalculationResult(y,b))}return h}}]),n}(a.SkyBottomLineBatchCalculatorBackend);t.WebGLSkyBottomLineBatchCalculatorBackend=c},4759:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(6791),t),r(n(6055),t),r(n(1070),t),r(n(449),t),r(n(8911),t),r(n(4278),t),r(n(8155),t),r(n(5074),t),r(n(7459),t),r(n(1405),t),r(n(4146),t),r(n(374),t),r(n(5330),t),r(n(9428),t),r(n(5277),t),r(n(9946),t),r(n(6729),t),r(n(5091),t),r(n(8720),t),r(n(7963),t),r(n(1513),t),r(n(599),t),r(n(4324),t),r(n(3486),t),r(n(4785),t),r(n(873),t),r(n(3411),t),r(n(9876),t),r(n(3023),t),r(n(8898),t),r(n(5309),t),r(n(5974),t),r(n(8823),t),r(n(4040),t),r(n(1494),t),r(n(158),t),r(n(7142),t),r(n(5623),t),r(n(4574),t),r(n(9067),t),r(n(3501),t),r(n(6040),t),r(n(9953),t),r(n(4196),t),r(n(7771),t),r(n(1225),t),r(n(6894),t),r(n(525),t),r(n(9839),t)},6842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Instrument=void 0;var i=n(884),r=n(2255),a=n(0),s=function(e){h(n,e);var t=d(n);function n(e,i,a,s){var o;return g(this,n),(o=t.call(this,void 0,a,s)).Transpose=0,o.voices=[],o.staves=[],o.hasLyrics=!1,o.hasChordSymbols=!1,o.playbackTranspose=0,o.lyricVersesNumbers=[],o.subInstruments=[],o.id=e,o.idString=i,o.nameLabel=new r.Label(i),o}return y(n,[{key:"Voices",get:function(){return this.voices}},{key:"Staves",get:function(){return this.staves}},{key:"NameLabel",get:function(){return this.nameLabel}},{key:"HasLyrics",get:function(){return this.hasLyrics},set:function(e){this.hasLyrics=e}},{key:"HasChordSymbols",get:function(){return this.hasChordSymbols},set:function(e){this.hasChordSymbols=e}},{key:"LyricVersesNumbers",get:function(){return this.lyricVersesNumbers},set:function(e){this.lyricVersesNumbers=e}},{key:"Name",get:function(){return this.nameLabel.text},set:function(e){this.nameLabel.text=e}},{key:"IdString",get:function(){return this.idString}},{key:"Id",get:function(){return this.id}},{key:"MidiInstrumentId",get:function(){return this.subInstruments[0].midiInstrumentID},set:function(e){this.subInstruments[0].midiInstrumentID=e}},{key:"Volume",get:function(){return this.subInstruments[0].volume},set:function(e){for(var t=0,n=this.subInstruments.length;t<n;++t)this.subInstruments[t].volume=e}},{key:"PlaybackTranspose",get:function(){return this.playbackTranspose},set:function(e){this.playbackTranspose=e}},{key:"SubInstruments",get:function(){return this.subInstruments}},{key:"getSubInstrument",value:function(e){for(var t=0,n=this.subInstruments.length;t<n;++t){var i=this.subInstruments[t];if(i.idString===e)return i}}},{key:"PartAbbreviation",get:function(){return this.partAbbreviation},set:function(e){this.partAbbreviation=e}},{key:"Visible",get:function(){return this.voices.length>0&&this.Voices[0].Visible},set:function(e){for(var t=0,n=this.Voices.length;t<n;++t)this.Voices[t].Visible=e}},{key:"Audible",get:function(){for(var e=!1,t=0,n=this.Voices.length;t<n;++t){var i=this.Voices[t];e=e||i.Audible}return e},set:function(e){for(var t=0,n=this.Voices.length;t<n;++t)this.Voices[t].Audible=e;for(var i=0,r=this.staves.length;i<r;++i)this.staves[i].audible=e}},{key:"Solo",get:function(){for(var e=!1,t=0,n=this.Voices.length;t<n;++t){var i=this.Voices[t];e=e||i.Solo}return e},set:function(e){for(var t=0,n=this.Voices.length;t<n;++t)this.Voices[t].Solo=e;for(var i=0,r=this.Staves.length;i<r;++i)this.Staves[i].Solo=e}},{key:"Following",get:function(){for(var e=!1,t=0,n=this.Voices.length;t<n;++t){var i=this.Voices[t];e=e||i.Following}return e},set:function(e){for(var t=0,n=this.Voices.length;t<n;++t)this.Voices[t].Following=e;for(var i=0,r=this.staves.length;i<r;++i)this.staves[i].following=e}},{key:"SetVoiceAudible",value:function(e,t){for(var n=0,i=this.Voices.length;n<i;++n){var r=this.Voices[n];if(r.VoiceId===e){r.Audible=t;break}}}},{key:"SetVoiceFollowing",value:function(e,t){for(var n=0,i=this.Voices.length;n<i;++n){var r=this.Voices[n];if(r.VoiceId===e){r.Following=t;break}}}},{key:"SetStaffAudible",value:function(e,t){var n=this.staves[e-1];if(n.audible=t,t)for(var i=0,r=n.Voices.length;i<r;++i)n.Voices[i].Audible=!0;else for(var a=0,s=n.Voices.length;a<s;++a){for(var o=n.Voices[a],u=!1,l=0,c=this.Staves.length;l<c;++l){var h=this.Staves[l];if(h.Id!==e&&h.audible)for(var d=0,f=h.Voices.length;d<f;++d)h.Voices[d]===o&&(u=!0)}u||(o.Audible=!1)}}},{key:"SetStaffFollow",value:function(e,t){var n=this.staves[e-1];if(n.following=t,t)for(var i=0,r=n.Voices.length;i<r;++i)n.Voices[i].Following=!0;else for(var a=0,s=n.Voices.length;a<s;++a){for(var o=n.Voices[a],u=!1,l=0,c=this.Staves.length;l<c;++l){var h=this.Staves[l];if(h.Id!==e&&h.following)for(var d=0,f=h.Voices.length;d<f;++d)h.Voices[d]===o&&(u=!0)}u||(o.Following=!1)}}},{key:"areAllVoiceVisible",value:function(){var e,t=b(this.Voices);try{for(t.s();!(e=t.n()).done;)if(!e.value.Visible)return!1}catch(n){t.e(n)}finally{t.f()}return!0}},{key:"createStaves",value:function(e){for(var t=0;t<e;t++)this.staves.push(new a.Staff(this,t+1))}},{key:"toString",value:function(){return"".concat(this.Name," , id: ").concat(this.id,", idstring: ").concat(this.idString)}}]),n}(i.InstrumentalGroup);t.Instrument=s},884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstrumentalGroup=void 0,t.InstrumentalGroup=function(){function e(t,n,i){g(this,e),this.instrumentalGroups=[],this.name=t,this.musicSheet=n,this.parent=i}return y(e,[{key:"InstrumentalGroups",get:function(){return this.instrumentalGroups}},{key:"Parent",get:function(){return this.parent}},{key:"Name",get:function(){return this.name},set:function(e){this.name=e}},{key:"GetMusicSheet",get:function(){return this.musicSheet}}]),e}()},7181:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AUIController=void 0;var s=a(n(177));t.AUIController=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"beforeend";g(this,e),this.eventListeners=[],this.parentElement=t,this.insertLocation=i,this.isTouchDevice=n,this.initialize()}return y(e,[{key:"addListener",value:function(e){this.eventListeners.push(e)}},{key:"generateHtmlTemplate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.compile(e)(t)}},{key:"generateAndInsertHtmlTemplate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.insertLocation,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.parentElement,r=this.generateHtmlTemplate(e,t);i.insertAdjacentHTML(n,r)}},{key:"downEventName",get:function(){return this.isTouchDevice?"ontouchstart":"onmousedown"}},{key:"upEventName",get:function(){return this.isTouchDevice?"ontouchend":"onmouseup"}},{key:"moveEventName",get:function(){return this.isTouchDevice?"ontouchmove":"onmousemove"}}]),e}()},9603:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},7058:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6287:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4543:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4207:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6331:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITextTranslation=void 0,t.ITextTranslation=function(){function e(){g(this,e)}return y(e,null,[{key:"translateText",value:function(e,t){if(!this.defaultTextTranslation)return t}}]),e}()},9984:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4854:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4143:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(9603),t),r(n(7058),t),r(n(6287),t),r(n(4207),t),r(n(6331),t),r(n(9984),t),r(n(7181),t),r(n(4854),t),r(n(4543),t)},2255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;var i=n(1274),r=n(96);t.Label=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.TextAlignmentEnum.CenterBottom,r=arguments.length>2?arguments[2]:void 0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];g(this,e),this.IsCreditLabel=!1,this.text=t,this.print=a,this.textAlignment=n,this.font=r,this.fontFamily=void 0}return y(e,[{key:"font",get:function(){return this.fontEnumValue},set:function(e){this.fontEnumValue=e,this.fontFamily=r.FontStringNames[e]}},{key:"ToString",value:function(){return this.text}}]),e}()},5278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimestampTransform=t.MusicPartManager=void 0;var i=n(1797),r=n(301);t.MusicPartManager=function(){function e(t){g(this,e),this.musicSheet=t}return y(e,[{key:"reInit",value:function(){this.init()}},{key:"init",value:function(){this.parts=this.musicSheet.Repetitions.slice(),this.sheetStart=this.musicSheet.SelectionStart=new i.Fraction(0,1),this.sheetEnd=this.musicSheet.SelectionEnd=this.musicSheet.SheetEndTimestamp,this.calcMapping()}},{key:"getCurrentRepetitionTimestampTransform",value:function(e){for(var t,n=this.timestamps.length-1;n>=0;n--)if(t=this.timestamps[n],e.gte(t.from))return t;return this.timestamps[0]}},{key:"absoluteEnrolledToSheetTimestamp",value:function(e){if(0===this.timestamps.length)return e;var t=this.getCurrentRepetitionTimestampTransform(e);return i.Fraction.plus(e,i.Fraction.minus(t.to,t.from))}},{key:"Parts",get:function(){return this.parts}},{key:"MusicSheet",get:function(){return this.musicSheet}},{key:"getIterator",value:function(e){return e?new r.MusicPartManagerIterator(this.musicSheet,e,void 0):new r.MusicPartManagerIterator(this.musicSheet,this.musicSheet.SelectionStart,this.musicSheet.SelectionEnd)}},{key:"setSelectionStart",value:function(e){this.musicSheet.SelectionStart=e,this.musicSheet.SelectionEnd=void 0}},{key:"setSelectionRange",value:function(e,t){this.musicSheet.SelectionStart=null!=e?e:this.sheetStart,this.musicSheet.SelectionEnd=null!=t?t:this.sheetEnd}},{key:"calcMapping",value:function(){this.timestamps=[];var e=this.getIterator(),t=e.CurrentRepetition,n=new a(e.CurrentEnrolledTimestamp.clone(),e.CurrentSourceTimestamp.clone(),void 0,0);for(this.timestamps.push(n);!e.EndReached;){if(e.JumpOccurred||t!==e.CurrentRepetition){if(t=e.CurrentRepetition,e.backJumpOccurred){var i=e.JumpResponsibleRepetition;n.nextBackJump=e.CurrentEnrolledTimestamp,n.curRepetition=i,n.curRepetitionIteration=e.CurrentJumpResponsibleRepetitionIterationBeforeJump;for(var r=this.timestamps.length-2;r>=0&&!i.AbsoluteTimestamp.gt(this.timestamps[r].to)&&!this.timestamps[r].curRepetition;r--)this.timestamps[r].nextBackJump=n.nextBackJump,this.timestamps[r].curRepetition=i,this.timestamps[r].curRepetitionIteration=n.curRepetitionIteration}n=new a(e.CurrentEnrolledTimestamp.clone(),e.CurrentSourceTimestamp.clone(),void 0,0),this.timestamps.push(n)}e.moveToNext()}}}]),e}();var a=function e(t,n,i,r){g(this,e),this.from=t,this.to=n,this.curRepetition=i,this.curRepetitionIteration=r,this.nextBackJump=void 0,this.nextForwardJump=void 0};t.TimestampTransform=a},301:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MusicPartManagerIterator=void 0;var r=n(1797),a=n(5356),s=n(3331),o=n(7839),u=i(n(2043)),l=function(){function e(t,n,i){g(this,e),this.currentMeasureIndex=0,this.currentPartIndex=0,this.currentVoiceEntryIndex=-1,this.currentDynamicEntryIndex=0,this.currentTempoEntryIndex=0,this.currentDynamicChangingExpressions=[],this.repetitionIterationCountDictKeys=[],this.repetitionIterationCountDictValues=[],this.currentRepetition=void 0,this.endReached=!1,this.frontReached=!1,this.currentTimeStamp=new r.Fraction(0,1),this.currentEnrolledMeasureTimestamp=new r.Fraction(0,1),this.currentRelativeInMeasureTimestamp=new r.Fraction(0,1),this.currentVerticalContainerInMeasureTimestamp=new r.Fraction(0,1),this.jumpResponsibleRepetition=void 0,this.activeDynamicExpressions=[];try{this.frontReached=!0,this.musicSheet=t,this.currentBpm=t.userStartTempoInBPM,this.currentVoiceEntries=void 0,this.frontReached=!1;var s,l=b(this.musicSheet.Repetitions);try{for(l.s();!(s=l.n()).done;){var c=s.value;this.setRepetitionIterationCount(c,1)}}catch(m){l.e(m)}finally{l.f()}for(var h=0;h<t.getCompleteNumberOfStaves();h++)this.ActiveDynamicExpressions.push(void 0);this.currentMeasure=this.musicSheet.SourceMeasures[0],n||(n=new r.Fraction);do{this.moveToNext()}while((!this.currentVoiceEntries||this.currentTimeStamp.lt(n))&&!this.endReached);for(var d=0;d<this.activeDynamicExpressions.length;d++)if(this.activeDynamicExpressions[d])if(this.activeDynamicExpressions[d]instanceof o.ContinuousDynamicExpression){var f=this.activeDynamicExpressions[d];this.currentDynamicChangingExpressions.push(new a.DynamicsContainer(f,d))}else{var p=this.activeDynamicExpressions[d];this.currentDynamicChangingExpressions.push(new a.DynamicsContainer(p,d))}this.currentTempoChangingExpression=this.activeTempoExpression}catch(t){u.default.info("MusicPartManagerIterator: "+t)}}return y(e,[{key:"EndReached",get:function(){return this.endReached}},{key:"FrontReached",get:function(){return this.frontReached}},{key:"CurrentMeasure",get:function(){return this.currentMeasure}},{key:"CurrentRepetition",get:function(){return this.currentRepetition}},{key:"CurrentRepetitionIteration",get:function(){return this.CurrentRepetition?this.getRepetitionIterationCount(this.CurrentRepetition):0}},{key:"CurrentJumpResponsibleRepetitionIterationBeforeJump",get:function(){return this.jumpResponsibleRepetition?this.getRepetitionIterationCount(this.jumpResponsibleRepetition)-1:0}},{key:"CurrentBpm",get:function(){return this.currentBpm}},{key:"CurrentVoiceEntries",get:function(){return this.currentVoiceEntries}},{key:"CurrentMeasureIndex",get:function(){return this.currentMeasureIndex}},{key:"CurrentEnrolledTimestamp",get:function(){return r.Fraction.plus(this.currentEnrolledMeasureTimestamp,this.currentVerticalContainerInMeasureTimestamp)}},{key:"CurrentSourceTimestamp",get:function(){return this.currentTimeStamp}},{key:"CurrentRelativeInMeasureTimestamp",get:function(){return this.currentRelativeInMeasureTimestamp}},{key:"JumpOccurred",get:function(){return this.backJumpOccurred||this.forwardJumpOccurred}},{key:"ActiveTempoExpression",get:function(){return this.activeTempoExpression}},{key:"ActiveDynamicExpressions",get:function(){return this.activeDynamicExpressions}},{key:"CurrentTempoChangingExpression",get:function(){return this.currentTempoChangingExpression}},{key:"JumpResponsibleRepetition",get:function(){return this.jumpResponsibleRepetition}},{key:"clone",value:function(t,n){var i=new e(this.musicSheet,null!=t?t:this.currentTimeStamp,n);return i.currentVoiceEntryIndex=this.currentVoiceEntryIndex,i.currentMappingPart=this.currentMappingPart,i.currentPartIndex=this.currentPartIndex,i.currentVoiceEntries=this.currentVoiceEntries,i.endReached=this.endReached,i.frontReached=this.frontReached,i}},{key:"CurrentVisibleVoiceEntries",value:function(e){var t=[];if(!this.currentVoiceEntries)return t;if(e){var n,i=b(this.currentVoiceEntries);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.ParentVoice.Parent.IdString===e.IdString)return this.getVisibleEntries(r,t),t}}catch(u){i.e(u)}finally{i.f()}}else{var a,s=b(this.currentVoiceEntries);try{for(s.s();!(a=s.n()).done;){var o=a.value;this.getVisibleEntries(o,t)}}catch(u){s.e(u)}finally{s.f()}}return t}},{key:"CurrentAudibleVoiceEntries",value:function(e){var t=[];if(this.currentVoiceEntries)if(e){var n,i=b(this.currentVoiceEntries);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.ParentVoice.Parent.IdString===e.IdString)return this.getAudibleEntries(r,t),t}}catch(u){i.e(u)}finally{i.f()}}else{var a,s=b(this.currentVoiceEntries);try{for(s.s();!(a=s.n()).done;){var o=a.value;this.getAudibleEntries(o,t)}}catch(u){s.e(u)}finally{s.f()}}return t}},{key:"getCurrentDynamicChangingExpressions",value:function(){return this.currentDynamicChangingExpressions}},{key:"CurrentScoreFollowingVoiceEntries",value:function(e){var t=[];if(!this.currentVoiceEntries)return t;if(e){var n,i=b(this.currentVoiceEntries);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.ParentVoice.Parent.IdString===e.IdString)return this.getScoreFollowingEntries(r,t),t}}catch(u){i.e(u)}finally{i.f()}}else{var a,s=b(this.currentVoiceEntries);try{for(s.s();!(a=s.n()).done;){var o=a.value;this.getScoreFollowingEntries(o,t)}}catch(u){s.e(u)}finally{s.f()}}return t}},{key:"currentPlaybackSettings",value:function(){return this.musicSheet.SheetPlaybackSetting}},{key:"moveToNext",value:function(){this.forwardJumpOccurred=this.backJumpOccurred=!1,this.endReached||(this.currentVoiceEntries&&(this.currentVoiceEntries.length=0),this.recursiveMove(),this.currentMeasure||(this.currentTimeStamp=new r.Fraction(99999,1)),void 0!==this.CurrentTempoChangingExpression&&(void 0!==this.CurrentTempoChangingExpression.ContinuousTempo?this.currentBpm=this.CurrentTempoChangingExpression.ContinuousTempo.getInterpolatedTempo(this.CurrentSourceTimestamp):this.currentBpm=this.CurrentTempoChangingExpression.InstantaneousTempo.TempoInBpm))}},{key:"moveToNextVisibleVoiceEntry",value:function(e){for(;!this.endReached;)if(this.moveToNext(),this.checkEntries(e))return}},{key:"resetRepetitionIterationCount",value:function(e){return this.setRepetitionIterationCount(e,1),1}},{key:"incrementRepetitionIterationCount",value:function(e){return-1===this.repetitionIterationCountDictKeys.indexOf(e)?this.setRepetitionIterationCount(e,1):this.setRepetitionIterationCount(e,this.getRepetitionIterationCount(e)+1)}},{key:"setRepetitionIterationCount",value:function(e,t){var n=this.repetitionIterationCountDictKeys.indexOf(e);return-1===n?(this.repetitionIterationCountDictKeys.push(e),this.repetitionIterationCountDictValues.push(t)):this.repetitionIterationCountDictValues[n]=t,t}},{key:"getRepetitionIterationCount",value:function(e){var t=this.repetitionIterationCountDictKeys.indexOf(e);if(-1!==t)return this.repetitionIterationCountDictValues[t]}},{key:"handleRepetitionsAtMeasureBegin",value:function(){for(var e=0,t=this.currentMeasure.FirstRepetitionInstructions.length;e<t;++e){var n=this.currentMeasure.FirstRepetitionInstructions[e];if(n.parentRepetition){var i=n.parentRepetition;this.currentRepetition=i,i.StartIndex===this.currentMeasureIndex&&void 0!==this.JumpResponsibleRepetition&&i!==this.JumpResponsibleRepetition&&i.StartIndex>=this.JumpResponsibleRepetition.StartIndex&&i.EndIndex<=this.JumpResponsibleRepetition.EndIndex&&this.resetRepetitionIterationCount(i)}}}},{key:"handleRepetitionsAtMeasureEnd",value:function(){for(var e=0,t=this.currentMeasure.LastRepetitionInstructions.length;e<t;++e){var n=this.currentMeasure.LastRepetitionInstructions[e],i=n.parentRepetition;if(i){if(i.BackwardJumpInstructions.indexOf(n)>-1&&this.getRepetitionIterationCount(i)<i.UserNumberOfRepetitions)return void this.doBackJump(i);if(n===i.forwardJumpInstruction&&(void 0!==this.JumpResponsibleRepetition&&i!==this.JumpResponsibleRepetition&&i.StartIndex>=this.JumpResponsibleRepetition.StartIndex&&i.EndIndex<=this.JumpResponsibleRepetition.EndIndex&&this.resetRepetitionIterationCount(i),this.repetitionIterationCountDictKeys.contains(i))){var r=i.getForwardJumpTargetForIteration(this.getRepetitionIterationCount(i));if(r>=0)return this.currentMeasureIndex=r,this.currentMeasure=this.musicSheet.SourceMeasures[this.currentMeasureIndex],this.currentVoiceEntryIndex=-1,this.jumpResponsibleRepetition=i,void(this.forwardJumpOccurred=!0);-2===r&&(this.endReached=!0)}}}this.currentMeasureIndex++,void 0!==this.JumpResponsibleRepetition&&this.currentMeasureIndex>this.JumpResponsibleRepetition.EndIndex&&(this.jumpResponsibleRepetition=void 0)}},{key:"doBackJump",value:function(e){this.currentMeasureIndex=e.getBackwardJumpTarget(),this.currentMeasure=this.musicSheet.SourceMeasures[this.currentMeasureIndex],this.currentVoiceEntryIndex=-1,this.incrementRepetitionIterationCount(e),this.jumpResponsibleRepetition=e,this.backJumpOccurred=!0}},{key:"activateCurrentRhythmInstructions",value:function(){if(void 0!==this.currentMeasure&&this.currentMeasure.FirstInstructionsStaffEntries.length>0&&void 0!==this.currentMeasure.FirstInstructionsStaffEntries[0])for(var e=this.currentMeasure.FirstInstructionsStaffEntries[0].Instructions,t=0,n=e.length;t<n;++t){var i=e[t];i instanceof s.RhythmInstruction&&(this.musicSheet.SheetPlaybackSetting.rhythm=i.Rhythm)}}},{key:"activateCurrentDynamicOrTempoInstructions",value:function(){for(var e=this.musicSheet.TimestampSortedDynamicExpressionsList;this.currentDynamicEntryIndex>0&&(this.currentDynamicEntryIndex>=e.length||e[this.currentDynamicEntryIndex].parMultiExpression().AbsoluteTimestamp.gte(this.CurrentSourceTimestamp));)this.currentDynamicEntryIndex--;for(;this.currentDynamicEntryIndex<e.length&&e[this.currentDynamicEntryIndex].parMultiExpression().AbsoluteTimestamp.lt(this.CurrentSourceTimestamp);)this.currentDynamicEntryIndex++;for(;this.currentDynamicEntryIndex<e.length&&e[this.currentDynamicEntryIndex].parMultiExpression().AbsoluteTimestamp.Equals(this.CurrentSourceTimestamp);){var t=e[this.currentDynamicEntryIndex],n=t.staffNumber;this.CurrentSourceTimestamp.Equals(t.parMultiExpression().AbsoluteTimestamp)&&(t.continuousDynamicExpression?this.activeDynamicExpressions[n]=t.continuousDynamicExpression:t.instantaneousDynamicExpression&&(this.activeDynamicExpressions[n]=t.instantaneousDynamicExpression)),this.currentDynamicEntryIndex++}this.currentDynamicChangingExpressions.length=0;for(var i=0;i<this.activeDynamicExpressions.length;i++)if(this.activeDynamicExpressions[i]){var r=void 0,s=void 0;if(this.activeDynamicExpressions[i]instanceof o.ContinuousDynamicExpression){var u=this.activeDynamicExpressions[i];r=u.StartMultiExpression.AbsoluteTimestamp,s=u.EndMultiExpression.AbsoluteTimestamp,this.CurrentSourceTimestamp.gte(r)&&this.CurrentSourceTimestamp.lte(s)&&this.currentDynamicChangingExpressions.push(new a.DynamicsContainer(u,i))}else{var l=this.activeDynamicExpressions[i];this.CurrentSourceTimestamp.Equals(l.ParentMultiExpression.AbsoluteTimestamp)&&this.currentDynamicChangingExpressions.push(new a.DynamicsContainer(l,i))}}for(var c=this.musicSheet.TimestampSortedTempoExpressionsList;this.currentTempoEntryIndex>0&&(this.currentTempoEntryIndex>=c.length||c[this.currentTempoEntryIndex].AbsoluteTimestamp.gte(this.CurrentSourceTimestamp));)this.currentTempoEntryIndex--;for(;this.currentTempoEntryIndex<c.length&&c[this.currentTempoEntryIndex].AbsoluteTimestamp.lt(this.CurrentSourceTimestamp);)this.currentTempoEntryIndex++;for(;this.currentTempoEntryIndex<c.length&&c[this.currentTempoEntryIndex].AbsoluteTimestamp.Equals(this.CurrentSourceTimestamp);)this.activeTempoExpression=c[this.currentTempoEntryIndex],this.currentTempoEntryIndex++;if(this.currentTempoChangingExpression=void 0,this.activeTempoExpression){var h=this.activeTempoExpression.AbsoluteTimestamp;this.activeTempoExpression.ContinuousTempo&&(h=this.activeTempoExpression.ContinuousTempo.AbsoluteEndTimestamp),(this.CurrentSourceTimestamp.gte(this.activeTempoExpression.AbsoluteTimestamp)||this.CurrentSourceTimestamp.lte(h))&&(this.currentTempoChangingExpression=this.activeTempoExpression)}}},{key:"recursiveMove",value:function(){if(this.currentVoiceEntryIndex++,0===this.currentVoiceEntryIndex&&(this.handleRepetitionsAtMeasureBegin(),this.activateCurrentRhythmInstructions()),this.currentVoiceEntryIndex>=0&&this.currentVoiceEntryIndex<this.currentMeasure.VerticalSourceStaffEntryContainers.length){var e=this.currentMeasure.VerticalSourceStaffEntryContainers[this.currentVoiceEntryIndex];this.currentVoiceEntries=this.getVoiceEntries(e),this.currentVerticalContainerInMeasureTimestamp=e.Timestamp,this.currentTimeStamp=r.Fraction.plus(this.currentMeasure.AbsoluteTimestamp,this.currentVerticalContainerInMeasureTimestamp);var t=this.musicSheet.SelectionEnd;return t&&this.currentTimeStamp.gte(t)&&(this.endReached=!0),void this.activateCurrentDynamicOrTempoInstructions()}if(this.currentEnrolledMeasureTimestamp.Add(this.currentMeasure.Duration),this.handleRepetitionsAtMeasureEnd(),this.currentMeasureIndex>=0&&this.currentMeasureIndex<this.musicSheet.SourceMeasures.length)return this.currentMeasure=this.musicSheet.SourceMeasures[this.currentMeasureIndex],this.currentTimeStamp=r.Fraction.plus(this.currentMeasure.AbsoluteTimestamp,this.currentVerticalContainerInMeasureTimestamp),this.currentVoiceEntryIndex=-1,void this.recursiveMove();this.currentVerticalContainerInMeasureTimestamp=new r.Fraction,this.currentMeasure=void 0,this.currentVoiceEntries=void 0,this.endReached=!0}},{key:"checkEntries",value:function(e){var t=this.CurrentVisibleVoiceEntries();if(t.length>0){if(!e)return!0;for(var n=0,i=t.length;n<i;++n)if(t[n].Notes[0].Pitch)return!0}return!1}},{key:"getVisibleEntries",value:function(e,t){e.ParentVoice.Visible&&t.push(e)}},{key:"getAudibleEntries",value:function(e,t){if(e.hasTie()){var n=e.Notes[0];if(void 0!==n.NoteTie&&n.NoteTie.StartNote!==n)return}e.ParentVoice.Audible&&t.push(e)}},{key:"getScoreFollowingEntries",value:function(e,t){e.ParentVoice.Following&&e.ParentVoice.Parent.Following&&t.push(e)}},{key:"getVoiceEntries",value:function(e){var t,n=[],i=b(e.StaffEntries);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r){var a,s=b(r.VoiceEntries);try{for(s.s();!(a=s.n()).done;){var o=a.value;n.push(o)}}catch(u){s.e(u)}finally{s.f()}}}}catch(u){i.e(u)}finally{i.f()}return n}}]),e}();t.MusicPartManagerIterator=l},4257:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5278),t),r(n(301),t)},7514:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSheet=void 0;var r=n(1797),a=n(5278),s=n(1717),o=n(2255),u=n(3884),l=n(9651),c=n(1405),h=n(8155),d=i(n(2043)),f=n(1649),p=n(7359),m=function(){function t(){g(this,t),this.idString="uninitialized",this.sourceMeasures=[],this.repetitions=[],this.dynListStaves=[],this.timestampSortedDynamicExpressionsList=[],this.timestampSortedTempoExpressionsList=[],this.instrumentalGroups=[],this.instruments=[],this.musicPartManager=void 0,this.musicSheetErrors=new l.MusicSheetErrors,this.staves=[],this.playbackDataDict=new f.Dictionary,this.transpose=0,this.defaultStartTempoInBpm=0,this.drawErroneousMeasures=!1,this.hasBeenOpenedForTheFirstTime=!1,this.currentEnrolledPosition=new r.Fraction(0,1),this.userStartTempoInBPM=100,this.playbackSettings=new p.PlaybackSettings(new r.Fraction(4,4,0,!1),this.userStartTempoInBPM),this.pageWidth=120,this.MusicPartManager=new a.MusicPartManager(this),this.hasBPMInfo=!1}return y(t,[{key:"SourceMeasures",get:function(){return this.sourceMeasures},set:function(e){this.sourceMeasures=e}},{key:"Repetitions",get:function(){return this.repetitions},set:function(e){this.repetitions=e}},{key:"DynListStaves",get:function(){return this.dynListStaves}},{key:"TimestampSortedTempoExpressionsList",get:function(){return this.timestampSortedTempoExpressionsList}},{key:"TimestampSortedDynamicExpressionsList",get:function(){return this.timestampSortedDynamicExpressionsList}},{key:"InstrumentalGroups",get:function(){return this.instrumentalGroups}},{key:"Parts",get:function(){return this.instruments}},{key:"Instruments",get:function(){return this.instruments}},{key:"SheetPlaybackSetting",get:function(){return this.playbackSettings},set:function(e){this.playbackSettings=e}},{key:"DrawErroneousMeasures",get:function(){return this.drawErroneousMeasures},set:function(e){this.drawErroneousMeasures=e}},{key:"HasBeenOpenedForTheFirstTime",get:function(){return this.hasBeenOpenedForTheFirstTime},set:function(e){this.hasBeenOpenedForTheFirstTime=e}},{key:"InitializeStartTempoInBPM",value:function(e){this.playbackSettings.BeatsPerMinute=e,this.userStartTempoInBPM=e}},{key:"DefaultStartTempoInBpm",get:function(){return this.defaultStartTempoInBpm},set:function(e){this.defaultStartTempoInBpm=e,this.InitializeStartTempoInBPM(e)}},{key:"Path",get:function(){return this.path},set:function(e){this.path=e}},{key:"Staves",get:function(){return this.staves}},{key:"TitleString",get:function(){return this.title?this.title.text:""},set:function(e){this.Title=new o.Label(e)}},{key:"SubtitleString",get:function(){return this.subtitle?this.subtitle.text:""},set:function(e){this.Subtitle=new o.Label(e)}},{key:"ComposerString",get:function(){return this.composer?this.composer.text:""},set:function(e){this.Composer=new o.Label(e)}},{key:"LyricistString",get:function(){return this.lyricist?this.lyricist.text:""},set:function(e){this.Lyricist=new o.Label(e)}},{key:"Title",get:function(){return this.title},set:function(e){this.title=e}},{key:"Subtitle",get:function(){return this.subtitle},set:function(e){this.subtitle=e}},{key:"Composer",get:function(){return this.composer},set:function(e){this.composer=e}},{key:"Lyricist",get:function(){return this.lyricist},set:function(e){this.lyricist=e}},{key:"Rules",get:function(){return this.rules||(d.default.debug("warning: sheet.Rules was undefined. Creating new EngravingRules."),this.rules=new c.EngravingRules),this.rules},set:function(e){this.rules=e}},{key:"SheetErrors",get:function(){return this.musicSheetErrors}},{key:"PlaybackDataDict",get:function(){return this.playbackDataDict}},{key:"SelectionStart",get:function(){return this.selectionStart},set:function(e){this.selectionStart=e.clone(),this.currentEnrolledPosition=e.clone()}},{key:"SelectionEnd",get:function(){return this.selectionEnd},set:function(e){this.selectionEnd=e}},{key:"HasBPMInfo",get:function(){return this.hasBPMInfo},set:function(e){this.hasBPMInfo=e}},{key:"addMeasure",value:function(e){this.sourceMeasures.push(e),e.measureListIndex=this.sourceMeasures.length-1}},{key:"checkForInstrumentWithNoVoice",value:function(){for(var e=0,t=this.instruments.length;e<t;++e){var n=this.instruments[e];if(0===n.Voices.length){var i=new u.Voice(n,1);n.Voices.push(i)}}}},{key:"getStaffFromIndex",value:function(e){return this.staves[e]}},{key:"fillStaffList",value:function(){for(var e=0,t=0,n=this.instruments.length;t<n;++t)for(var i=this.instruments[t],r=0,a=i.Staves.length;r<a;++r){var s=i.Staves[r];s.idInMusicSheet=e,this.staves.push(s),e++}}},{key:"MusicPartManager",get:function(){return this.musicPartManager},set:function(e){this.musicPartManager=e}},{key:"getCompleteNumberOfStaves",value:function(){for(var e=0,t=0,n=this.instruments.length;t<n;++t)e+=this.instruments[t].Staves.length;return e}},{key:"getListOfMeasuresFromIndeces",value:function(e,t){for(var n=[],i=e;i<=t;i++)n.push(this.sourceMeasures[i]);return n}},{key:"getNextSourceMeasure",value:function(e){var t=this.sourceMeasures.indexOf(e);return t===this.sourceMeasures.length-1?e:this.sourceMeasures[t+1]}},{key:"getFirstSourceMeasure",value:function(){return this.sourceMeasures[0]}},{key:"getLastSourceMeasure",value:function(){return this.sourceMeasures[this.sourceMeasures.length-1]}},{key:"resetAllNoteStates",value:function(){for(var e=this.MusicPartManager.getIterator();!e.EndReached&&e.CurrentVoiceEntries;){for(var t=0,n=e.CurrentVoiceEntries.length;t<n;++t)for(var i=e.CurrentVoiceEntries[t],r=0,a=i.Notes.length;r<a;++r)i.Notes[r].state=h.NoteState.Normal;e.moveToNext()}}},{key:"getMusicSheetInstrumentIndex",value:function(e){return this.Instruments.indexOf(e)}},{key:"getGlobalStaffIndexOfFirstStaff",value:function(e){for(var t=this.getMusicSheetInstrumentIndex(e),n=0,i=0;i<t;i++)n+=this.Instruments[i].Staves.length;return n}},{key:"setRepetitionNewUserNumberOfRepetitions",value:function(e,t){for(var n=0,i=0;i<this.repetitions.length;i++)if(this.repetitions[i]instanceof s.Repetition){if(e===n){this.repetitions[i].UserNumberOfRepetitions=t;break}n++}}},{key:"getRepetitionByIndex",value:function(e){for(var t=0,n=0;n<this.repetitions.length;n++)if(this.repetitions[n]instanceof s.Repetition){if(e===t)return this.repetitions[n];t++}}},{key:"CompareTo",value:function(e){return this.Title.text.localeCompare(e.Title.text)}},{key:"getExpressionsStartTempoInBPM",value:function(){if(this.TimestampSortedTempoExpressionsList.length>0){var e=this.TimestampSortedTempoExpressionsList[0];if(e.InstantaneousTempo)return e.InstantaneousTempo.TempoInBpm;if(e.ContinuousTempo)return e.ContinuousTempo.StartTempo}return this.userStartTempoInBPM}},{key:"Errors",get:function(){return this.musicSheetErrors.measureErrors}},{key:"FirstMeasureNumber",get:function(){try{return this.getFirstSourceMeasure().MeasureNumber}catch(e){return d.default.info("MusicSheet.FirstMeasureNumber: ",e),0}}},{key:"LastMeasureNumber",get:function(){try{return this.getLastSourceMeasure().MeasureNumber}catch(e){return d.default.info("MusicSheet.LastMeasureNumber: ",e),0}}},{key:"CurrentEnrolledPosition",get:function(){return this.currentEnrolledPosition.clone()},set:function(e){this.currentEnrolledPosition=e.clone()}},{key:"Transpose",get:function(){return this.transpose},set:function(e){this.transpose=e}},{key:"FullNameString",get:function(){return this.ComposerString+" "+this.TitleString}},{key:"IdString",get:function(){return this.idString},set:function(e){this.idString=e}},{key:"getEnrolledSelectionStartTimeStampWorkaround",value:function(){var e=this.MusicPartManager.getIterator(this.SelectionStart);return r.Fraction.createFromFraction(e.CurrentEnrolledTimestamp)}},{key:"SheetEndTimestamp",get:function(){var e=this.getLastSourceMeasure();return r.Fraction.plus(e.AbsoluteTimestamp,e.Duration)}},{key:"getSourceMeasureFromTimeStamp",value:function(e){for(var t=0,n=this.sourceMeasures.length;t<n;++t)for(var i=this.sourceMeasures[t],r=0,a=i.VerticalSourceStaffEntryContainers.length;r<a;++r){var s=i.VerticalSourceStaffEntryContainers[r];if(e.Equals(s.getAbsoluteTimestamp()))return i}return this.findSourceMeasureFromTimeStamp(e)}},{key:"findSourceMeasureFromTimeStamp",value:function(e){var t,n=b(this.sourceMeasures);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.AbsoluteTimestamp.lte(e)&&e.lt(r.Fraction.plus(i.AbsoluteTimestamp,i.Duration)))return i}}catch(a){n.e(a)}finally{n.f()}}},{key:"getVisibleInstruments",value:function(){for(var e=[],t=0,n=this.Instruments.length;t<n;++t){var i=this.Instruments[t];i.Voices.length>0&&i.Voices[0].Visible&&e.push(i)}return e}}],[{key:"getIndexFromStaff",value:function(e){return e.idInMusicSheet}}]),t}();t.MusicSheet=m,m.defaultTitle="defaultTitle"},6656:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MappingSourceMusicPart=void 0,t.MappingSourceMusicPart=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];g(this,e),this.repetitionRun=-1,this.sourceMusicPart=t,this.parentPartListEntry=i,this.startTimestamp=n.clone(),this.repetitionRun=r,this.parentRepetition=i,this.isEnding=a}return y(e,[{key:"IsRepetition",get:function(){return void 0!==this.parentRepetition}},{key:"IsEnding",get:function(){return this.isEnding}},{key:"IsLastRepetitionRun",get:function(){return this.IsRepetition&&this.repetitionRun+1===this.parentRepetition.UserNumberOfRepetitions}},{key:"RepetitionRun",get:function(){return this.repetitionRun}},{key:"ParentPartListEntry",get:function(){return this.parentPartListEntry}},{key:"SourceMusicPart",get:function(){return this.sourceMusicPart}},{key:"StartTimestamp",get:function(){return this.startTimestamp}},{key:"CompareTo",value:function(e){return e?this.startTimestamp.CompareTo(e.startTimestamp):1}}]),e}()},3766:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartListEntry=void 0,t.PartListEntry=function(){function e(t){g(this,e),this.enrolledTimestamps=[],this.visible=!0,this.musicSheet=t}return y(e,[{key:"Visible",get:function(){return this.visible},set:function(e){this.visible=e}},{key:"getFirstSourceMeasure",value:function(){return this.musicSheet.SourceMeasures[this.startIndex]}},{key:"getLastSourceMeasure",value:function(){return this.musicSheet.SourceMeasures[this.endIndex]}}]),e}()},1717:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RepetitionEndingPart=t.Repetition=void 0;var r=n(8817),a=n(1797),s=n(3766),o=i(n(2043)),u=function(e){h(n,e);var t=d(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g(this,n),(i=t.call(this,e)).backwardJumpInstructions=[],i.endingParts=[],i.endingIndexDict={},i.userNumberOfRepetitions=0,i.visibles=[],i.fromWords=!1,i.repetitonIterationOrder=[],i.numberOfEndings=1,i.musicSheet2=e,i.virtualOverallRepetition=r,i}return y(n,[{key:"BackwardJumpInstructions",get:function(){return this.backwardJumpInstructions}},{key:"EndingIndexDict",get:function(){return this.endingIndexDict}},{key:"EndingParts",get:function(){return this.endingParts}},{key:"Visibles",get:function(){return this.visibles},set:function(e){this.visibles=e}},{key:"DefaultNumberOfRepetitions",get:function(){var e=2;return this.virtualOverallRepetition&&(e=1),Math.max(e,Object.keys(this.endingIndexDict).length,this.checkRepetitionForMultipleLyricVerses())}},{key:"UserNumberOfRepetitions",get:function(){return this.userNumberOfRepetitions},set:function(e){this.userNumberOfRepetitions=e,this.repetitonIterationOrder=[];for(var t=this.userNumberOfRepetitions-this.NumberOfEndings,n=1;n<=this.userNumberOfRepetitions;n++)n<=t?this.repetitonIterationOrder.push(1):this.repetitonIterationOrder.push(n-t)}},{key:"getForwardJumpTargetForIteration",value:function(e){var t=this.repetitonIterationOrder[e-1];return this.endingIndexDict[t]?this.endingIndexDict[t].part.StartIndex:-1}},{key:"getBackwardJumpTarget",value:function(){return this.startMarker.measureIndex}},{key:"setEndingsStartIndex",value:function(e,t){var n=new l(new r.SourceMusicPart(this.musicSheet2,t,t));this.endingParts.push(n);var i,a=b(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{this.endingIndexDict[s]=n,n.endingIndices.push(s),this.numberOfEndings<s&&(this.numberOfEndings=s)}catch(e){o.default.error("Repetition: Exception.",e)}}}catch(u){a.e(u)}finally{a.f()}}},{key:"setEndingStartIndex",value:function(e,t){var n=new l(new r.SourceMusicPart(this.musicSheet2,t,t));this.EndingIndexDict[e]=n,this.endingParts.push(n),n.endingIndices.push(e),this.numberOfEndings<e&&(this.numberOfEndings=e)}},{key:"setEndingEndIndex",value:function(e,t){this.endingIndexDict[e]&&this.endingIndexDict[e].part.setEndIndex(t)}},{key:"NumberOfEndings",get:function(){return this.numberOfEndings}},{key:"FromWords",get:function(){return this.fromWords},set:function(e){this.fromWords=e}},{key:"AbsoluteTimestamp",get:function(){return a.Fraction.createFromFraction(this.musicSheet2.SourceMeasures[this.startMarker.measureIndex].AbsoluteTimestamp)}},{key:"StartIndex",get:function(){return this.startMarker.measureIndex}},{key:"EndIndex",get:function(){if(0===this.BackwardJumpInstructions.length)return this.StartIndex;var e=this.backwardJumpInstructions[this.backwardJumpInstructions.length-1].measureIndex;return this.endingIndexDict[this.NumberOfEndings]&&(e=Math.max(this.endingIndexDict[this.NumberOfEndings].part.EndIndex,e)),e}},{key:"checkRepetitionForMultipleLyricVerses",value:function(){for(var e=0,t=this.StartIndex,n=this.EndIndex,i=t;i<=n;i++)for(var r=this.musicSheet2.SourceMeasures[i],a=0;a<r.CompleteNumberOfStaves;a++)if(r.VerticalSourceStaffEntryContainers[a]){var s,o=b(r.VerticalSourceStaffEntryContainers[a].StaffEntries);try{for(o.s();!(s=o.n()).done;){var u=s.value;if(u){var l,c=0,h=b(u.VoiceEntries);try{for(h.s();!(l=h.n()).done;)c+=l.value.LyricsEntries.keys.length}catch(d){h.e(d)}finally{h.f()}e=Math.max(e,c)}}}catch(d){o.e(d)}finally{o.f()}}return e}},{key:"FirstSourceMeasureNumber",get:function(){return this.getFirstSourceMeasure().MeasureNumber}},{key:"LastSourceMeasureNumber",get:function(){return this.getLastSourceMeasure().MeasureNumber}},{key:"coversIdenticalMeasures",value:function(e){return this.StartIndex===e.StartIndex&&this.EndIndex===e.EndIndex}},{key:"removeFromRepetitionInstructions",value:function(){void 0!==this.startMarker&&(this.startMarker.parentRepetition=void 0),void 0!==this.endMarker&&(this.endMarker.parentRepetition=void 0);var e,t=b(this.BackwardJumpInstructions);try{for(t.s();!(e=t.n()).done;)e.value.parentRepetition=void 0}catch(n){t.e(n)}finally{t.f()}}}]),n}(s.PartListEntry);t.Repetition=u;var l=function(){function e(t){g(this,e),this.endingIndices=[],this.part=t}return y(e,[{key:"ToString",value:function(){return this.endingIndices.join(", ")}}]),e}();t.RepetitionEndingPart=l},8817:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceMusicPart=void 0;var i=n(3766),r=n(1797),a=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,e)).musicSheet=e,a.startIndex=i,a.endIndex=r,a}return y(n,[{key:"MeasuresCount",get:function(){return this.endIndex-this.startIndex+1}},{key:"StartIndex",get:function(){return this.startIndex}},{key:"EndIndex",get:function(){return this.endIndex}},{key:"ParentRepetition",get:function(){return this.parentRepetition},set:function(e){this.parentRepetition=e}},{key:"AbsoluteTimestamp",get:function(){return r.Fraction.createFromFraction(this.musicSheet.SourceMeasures[this.startIndex].AbsoluteTimestamp)}},{key:"setStartIndex",value:function(e){this.startIndex=e}},{key:"setEndIndex",value:function(e){this.endIndex=e}}]),n}(i.PartListEntry);t.SourceMusicPart=a},4990:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(6656),t),r(n(3766),t),r(n(1717),t),r(n(8817),t)},4170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackEntry=void 0;var i=n(8918),r=n(6591);t.PlaybackEntry=function(){function e(t){g(this,e),this.notes=[],this.TimestampShift=new i.Fraction,this.parentVoiceEntry=t;var n,a=b(t.Notes);try{for(a.s();!(n=a.n()).done;){var s=n.value;this.Notes.push(new r.PlaybackNote(this,s))}}catch(o){a.e(o)}finally{a.f()}}return y(e,[{key:"ParentVoiceEntry",get:function(){return this.parentVoiceEntry}},{key:"Notes",get:function(){return this.notes}},{key:"Length",get:function(){if(this.Notes.length>0)return this.Notes[0].Length},set:function(e){var t,n=b(this.Notes);try{for(n.s();!(t=n.n()).done;)t.value.Length=e}catch(i){n.e(i)}finally{n.f()}}},{key:"HasNotes",get:function(){return this.Notes.length>0}}]),e}()},9822:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackIterator=void 0;var i=n(1649),r=n(1566);t.PlaybackIterator=function(){function e(t){g(this,e),this.voiceCursors=new i.Dictionary,this.musicSheet=t;var n,a=b(t.PlaybackDataDict.keys());try{for(a.s();!(n=a.n()).done;){var s=n.value,o=new r.VoicePlaybackData(s,t.PlaybackDataDict.getValue(s),t.Rules);this.voiceCursors.setValue(s,o)}}catch(u){a.e(u)}finally{a.f()}this.Reset()}return y(e,[{key:"NextEntryTimestamp",get:function(){return this.nextEntryTimestamp}},{key:"DueEntries",get:function(){return this.dueEntries}},{key:"Update",value:function(e){var t,n,i=[],r=b(this.voiceCursors.values());try{for(r.s();!(n=r.n()).done;){var a=n.value,s=a.update(e);i.push.apply(i,S(a.DueEntries)),void 0!==s&&(void 0===t||t.RealValue>s.RealValue)&&(t=s)}}catch(o){r.e(o)}finally{r.f()}return this.nextEntryTimestamp=t,this.dueEntries=i,this.DueEntries}},{key:"Reset",value:function(){this.nextEntryTimestamp=void 0;var e,t,n=[],i=b(this.voiceCursors.values());try{for(i.s();!(t=i.n()).done;){var r=t.value,a=r.reset(this.musicSheet.SelectionStart);n.push.apply(n,S(r.DueEntries)),void 0!==a&&(void 0===e||e.RealValue>a.RealValue)&&(e=a)}}catch(s){i.e(s)}finally{i.f()}return this.nextEntryTimestamp=e,this.dueEntries=n,this.nextEntryTimestamp}}]),e}()},6591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackNote=void 0;var i=n(6550),r=n(8918),a=function(){function e(t,n){if(g(this,e),this.parentEntry=t,this.parentNote=n,this.ParentNote.PlaybackNote=this,this.Length=this.ParentNote.Length,void 0!==n.Pitch){var r=this.ParentNote.ParentStaff.ParentInstrument.MidiInstrumentId===i.MidiInstrument.Percussion;this.MidiKey=r?e.noteToMidiDrumKey(n):n.Pitch.getHalfTone()+12}else this.MidiKey=0}return y(e,[{key:"setLength",value:function(){void 0!==this.ParentNote.NoteTie&&this.ParentNote.NoteTie.StartNote===this.ParentNote&&(this.Length=this.ParentNote.NoteTie.Duration)}},{key:"ParentEntry",get:function(){return this.parentEntry}},{key:"ParentNote",get:function(){return this.parentNote}}],[{key:"noteToMidiDrumKey",value:function(e){var t,n=e.Pitch.getHalfTone()-12,a=null===(t=e.Notehead)||void 0===t?void 0:t.Shape;switch(e.Pitch.Octave){case 1:switch(e.Pitch.FundamentalNote){case r.NoteEnum.D:return 44;case r.NoteEnum.E:return 35;case r.NoteEnum.F:return 36;case r.NoteEnum.G:return 41;case r.NoteEnum.A:return 43;case r.NoteEnum.B:return a===i.NoteHeadShape.TRIANGLE?54:47;default:return n}case 2:switch(e.Pitch.FundamentalNote){case r.NoteEnum.C:return a===i.NoteHeadShape.X?37:38;case r.NoteEnum.D:return a===i.NoteHeadShape.X?59:48;case r.NoteEnum.E:switch(a){case i.NoteHeadShape.X:return 42;case i.NoteHeadShape.CIRCLEX:return 46;case i.NoteHeadShape.TRIANGLE:return 56;default:return 50}case r.NoteEnum.F:return a===i.NoteHeadShape.DIAMOND?53:51;case r.NoteEnum.G:switch(a){case i.NoteHeadShape.CIRCLEX:case i.NoteHeadShape.DIAMOND:return 46;default:return 42}case r.NoteEnum.A:return 49;case r.NoteEnum.B:return 57;default:return n}case 3:return e.Pitch.FundamentalNote===r.NoteEnum.C?a===i.NoteHeadShape.CIRCLEX?52:55:n;default:return n}}}]),e}();t.PlaybackNote=a},1596:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackNoteGenerator=void 0;var i=n(4257),r=n(8918),a=function(){function e(){g(this,e)}return y(e,[{key:"calculate",value:function(e){for(var t=new i.MusicPartManagerIterator(e);!t.EndReached;){var n,r=t.CurrentEnrolledTimestamp,a=t.CurrentAudibleVoiceEntries(),s=b(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;this.handleVoiceEntry(e,o,r)}}catch(u){s.e(u)}finally{s.f()}t.moveToNext()}}},{key:"handleVoiceEntry",value:function(t,n,i){if(!n.IsGrace){var a,s=n.ParentVoice;t.PlaybackDataDict.containsKey(s)?a=t.PlaybackDataDict.getValue(s):(a=[],t.PlaybackDataDict.setValue(s,a));var o,u=b(n.PlaybackEntries);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(l.HasNotes){var c,h=b(l.Notes);try{for(h.s();!(c=h.n()).done;)c.value.setLength()}catch(f){h.e(f)}finally{h.f()}var d=r.Fraction.plus(i,l.TimestampShift);e.addEntrySorted(a,l,d)}}}catch(f){u.e(f)}finally{u.f()}}}}],[{key:"addEntrySorted",value:function(e,t,n){if(0===e.length)e.push({enrolledTimestamp:n,playbackEntry:t});else for(var i=e.length-1;i>=0;i--){var r=e[i];if(n.RealValue>r.enrolledTimestamp.RealValue){if(i===e.length-1){e.push({enrolledTimestamp:n,playbackEntry:t});break}e.splice(i+1,0,{enrolledTimestamp:n,playbackEntry:t});break}}}}]),e}();t.PlaybackNoteGenerator=a},1566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoicePlaybackData=void 0;var i=n(8918);t.VoicePlaybackData=function(){function e(t,n,i){g(this,e),this.playbackEntries=[],this.dueEntries=[],this.parentVoice=t,this.playbackEntries=n,this.rules=i}return y(e,[{key:"ParentVoice",get:function(){return this.parentVoice}},{key:"PlaybackEntries",get:function(){return this.playbackEntries}},{key:"DueEntries",get:function(){return this.dueEntries}},{key:"NextEntryTimestamp",get:function(){return this.nextEntryTimestamp}},{key:"isAudible",value:function(){return this.ParentVoice.Audible}},{key:"reset",value:function(e){if(this.playbackIndex=0,this.nextEntryTimestamp=void 0,this.dueEntries.clear(),this.ParentVoice.Audible){for(var t=!1,n=this.playbackIndex;n<this.playbackEntries.length;n++){var i=this.playbackEntries[n];if(i.playbackEntry.ParentVoiceEntry.ParentSourceStaffEntry.AbsoluteTimestamp.RealValue>e.RealValue){this.nextEntryTimestamp=i.enrolledTimestamp,this.playbackIndex=Math.max(0,n-1),t=!0;break}}return!t&&this.playbackEntries.length>0&&(this.playbackIndex=this.playbackEntries.length-1),this.nextEntryTimestamp}this.playbackIndex=0}},{key:"update",value:function(e){if(this.nextEntryTimestamp=void 0,this.dueEntries.clear(),this.ParentVoice.Audible){for(var t=this.playbackIndex;t<this.playbackEntries.length;t++){var n=this.playbackEntries[t];if(n.enrolledTimestamp.RealValue>e.RealValue){this.nextEntryTimestamp=n.enrolledTimestamp,this.playbackIndex=t;break}var r=n.enrolledTimestamp.clone();if(r.Add(n.playbackEntry.Notes[0].Length),n.enrolledTimestamp.lt(e)){if(!this.rules.PlayAlreadyStartedNotesFromCursorPosition){var a=this.rules.PlaybackSkipNotesSafetyInterval;if(Math.abs(n.enrolledTimestamp.RealValue-e.RealValue)>a)continue}if(r.lt(e))continue}this.dueEntries.push(n)}if(void 0===this.nextEntryTimestamp){if(this.playbackEntries.length>0){var s=this.playbackEntries.last(),o=i.Fraction.plus(s.enrolledTimestamp,s.playbackEntry.Length);o.RealValue>e.RealValue&&(this.nextEntryTimestamp=o)}this.playbackIndex=Number.MAX_SAFE_INTEGER}return this.nextEntryTimestamp}}}]),e}()},1295:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(1596),t)},2393:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstrumentReader=void 0;var r=n(8109),a=n(9050),s=n(289),o=n(5198),u=n(3331),l=n(1797),c=n(6331),h=n(1703),d=n(289),f=n(3331),p=n(5198),m=i(n(2043)),v=n(289),S=n(2905),x=n(4671),_=n(3755),E=n(908),k=n(2478),M=n(6894);t.InstrumentReader=function(){function e(t,n,i,r){g(this,e),this.voiceGeneratorsDict={},this.staffMainVoiceGeneratorDict={},this.divisions=0,this.currentClefNumber=1,this.currentXmlMeasureIndex=0,this.activeKeyHasBeenInitialized=!1,this.abstractInstructions=[],this.openChordSymbolContainers=[],this.repetitionInstructionReader=n,this.xmlMeasureList=i,this.musicSheet=r.GetMusicSheet,this.instrument=r,this.activeClefs=new Array(r.Staves.length),this.activeClefsHaveBeenInitialized=new Array(r.Staves.length);for(var a=0;a<r.Staves.length;a++)this.activeClefsHaveBeenInitialized[a]=!1;this.createExpressionGenerators(r.Staves.length),this.slurReader=new _.SlurReader(this.musicSheet),this.pluginManager=t}return y(e,[{key:"ActiveKey",get:function(){return this.activeKey}},{key:"MaxTieNoteFraction",get:function(){return this.maxTieNoteFraction}},{key:"ActiveRhythm",get:function(){return this.activeRhythm},set:function(e){this.activeRhythm=e}},{key:"readNextXmlMeasure",value:function(e,t,n){var i,r,a,s=this;if(this.currentXmlMeasureIndex>=this.xmlMeasureList.length)return!1;this.currentMeasure=e,this.followingMultirestMeasures=Math.max(this.followingMultirestMeasures-1,0),this.inSourceMeasureInstrumentIndex=this.musicSheet.getGlobalStaffIndexOfFirstStaff(this.instrument),this.repetitionInstructionReader&&this.repetitionInstructionReader.prepareReadingMeasure(e,this.currentXmlMeasureIndex);var o=new l.Fraction(0,1),u=new l.Fraction(0,1),d=!1;this.maxTieNoteFraction=new l.Fraction(0,1);var f=!1;try{var p,v=this.xmlMeasureList[this.currentXmlMeasureIndex],g=v.elements();if(e.Rules.UseXMLMeasureNumbers&&!Number.isInteger(e.MeasureNumberXML)){var y=parseInt(null===(i=v.attribute("number"))||void 0===i?void 0:i.value,10);Number.isInteger(y)&&(e.MeasureNumberXML=y)}for(var x=0;x<g.length;x++){var _=g[x];if(x>0&&(p=g[x-1]),"print"===_.name){var w=_.attribute("new-system");"yes"===(null==w?void 0:w.value)&&(e.printNewSystemXml=!0);var P=_.attribute("new-page");"yes"===(null==P?void 0:P.value)&&(e.printNewPageXml=!0)}else if("note"===_.name){var T=!0;"no"===(null===(r=_.attribute("print-object"))||void 0===r?void 0:r.value)&&(T=!1);var C=1;this.instrument.Staves.length>1&&_.element("staff")&&(C=parseInt(_.element("staff").value,10),isNaN(C)&&(m.default.debug("InstrumentReader.readNextXmlMeasure.get staff number"),C=1)),this.currentStaff=this.instrument.Staves[C-1];var I=void 0!==_.element("chord");if(_.element("voice")){var A=parseInt(_.element("voice").value,10);this.currentVoiceGenerator=this.getOrCreateVoiceGenerator(A,C-1)}else I&&this.currentVoiceGenerator||(this.currentVoiceGenerator=this.getOrCreateVoiceGenerator(1,C-1));var L=void 0,O=0,R=new l.Fraction(0,1),N=2,B=!1;if(_.element("duration")){if(O=parseInt(_.element("duration").value,10),isNaN(O)){var D=c.ITextTranslation.translateText("ReaderErrorMessages/NoteDurationError","Invalid Note Duration.");this.musicSheet.SheetErrors.pushMeasureError(D),m.default.debug("InstrumentReader.readNextXmlMeasure",D);continue}if(R=new l.Fraction(O,4*this.divisions),0===O?R=this.getNoteDurationFromTypeNode(_):L=this.getNoteDurationFromTypeNode(_),_.element("time-modification")){R=this.getNoteDurationForTuplet(_);var F=_.element("time-modification");(null==F?void 0:F.element("normal-notes"))&&(N=parseInt(F.element("normal-notes").value,10)),B=!0}}var j=void 0!==_.element("rest"),V=_.element("notations"),G=void 0!==_.element("grace")||0===O||I&&f,W=!1,U=!1;if(G){var z=_.element("grace");z&&z.attributes()&&z.attribute("slash")&&"yes"===z.attribute("slash").value&&(W=!0),R=this.getNoteDurationFromTypeNode(_);var H=_.element("notations");H&&H.element("slur")&&(U=!0)}var X=!1;_.element("cue")&&(X=!0);var Y=_.element("type"),K=k.NoteType.UNDEFINED;if(Y){var q=Y.attribute("size");"cue"===(null==q?void 0:q.value)&&(X=!0),K=k.NoteTypeHandler.StringToNoteType(Y.value)}var Z=void 0,J=E.StemDirectionType.Undefined,Q=_.element("stem");if(Q){switch(Q.value){case"down":J=E.StemDirectionType.Down;break;case"up":J=E.StemDirectionType.Up;break;case"double":J=E.StemDirectionType.Double;break;case"none":J=E.StemDirectionType.None;break;default:J=E.StemDirectionType.Undefined}var $=Q.attribute("color");$&&(Z=this.parseXmlColor($.value))}var ee=void 0,te=0;if(V){var ne=V.element("ornaments");if(ne){var ie=ne.element("tremolo");if(ie){var re=ie.attribute("type");if(re&&"single"===re.value){var ae=parseInt(ie.value,10);ae>0&&(te=ae)}}var se=ne.elements("wavy-line");if(void 0!==se){var oe,ue=b(se);try{for(ue.s();!(oe=ue.n()).done;){var le=oe.value,ce=this.expressionReaders[this.readExpressionStaffNumber(_)-1];ce&&(ce.readExpressionParameters(le,this.instrument,this.divisions,o,u,this.currentMeasure.MeasureNumber,!1),ce.addWavyLine(le,this.currentMeasure,o,u))}}catch(Ke){ue.e(Ke)}finally{ue.f()}}}}var he=_.element("notehead");if(he){var de=he.attribute("color");de&&(ee=this.parseXmlColor(de.value))}var fe=void 0,pe=_.attribute("color");pe&&(fe=this.parseXmlColor(pe.value),ee||(ee=fe),Z||(Z=fe));var me=o.clone();I&&(me=u.clone()),this.currentStaffEntry=this.currentMeasure.findOrCreateStaffEntry(me,this.inSourceMeasureInstrumentIndex+C-1,this.currentStaff).staffEntry,(!this.currentVoiceGenerator.hasVoiceEntry()||!I&&!G&&!f||G&&!f||G&&!I||!G&&f)&&this.currentVoiceGenerator.createVoiceEntry(me,this.currentStaffEntry,this.activeKey,this.ActiveRhythm,G,W,U),G||I||(u=o.clone(),o.Add(R)),I&&void 0!==this.currentStaffEntry&&this.currentStaffEntry.ParentStaff!==this.currentStaff&&(this.currentStaffEntry=this.currentVoiceGenerator.checkForStaffEntryLink(this.inSourceMeasureInstrumentIndex+C-1,this.currentStaff,this.currentStaffEntry,this.currentMeasure));var ve=void 0!==this.currentStaffEntry&&void 0!==this.currentStaffEntry.Timestamp&&this.currentStaffEntry.Timestamp.Equals(new l.Fraction(0,1))&&!this.currentStaffEntry.hasNotes();this.saveAbstractInstructionList(this.instrument.Staves.length,ve),0!==this.openChordSymbolContainers.length&&(this.currentStaffEntry.ChordContainers=this.openChordSymbolContainers,this.openChordSymbolContainers=[]),this.activeRhythm,B||G||(R=new l.Fraction(O,4*this.divisions));var ge=_.elements("dot").length;if(this.currentVoiceGenerator.read(_,R,L,K,N,j,this.currentStaffEntry,this.currentMeasure,t,this.maxTieNoteFraction,I,n,T,X,G,J,te,Z,ee,ge),void 0!==V&&V.element("dynamics")){var ye=this.expressionReaders[this.readExpressionStaffNumber(_)-1];ye&&(ye.readExpressionParameters(_,this.instrument,this.divisions,o,u,this.currentMeasure.MeasureNumber,!1),ye.read(_,this.currentMeasure,u))}f=G}else if("attributes"===_.name){var be=_.element("divisions");if(be&&(this.divisions=parseInt(be.value,10),isNaN(this.divisions))){var Se=c.ITextTranslation.translateText("ReaderErrorMessages/DivisionError","Invalid divisions value at Instrument: ");if(m.default.debug("InstrumentReader.readNextXmlMeasure",Se),this.divisions=this.readDivisionsFromNotes(),!(this.divisions>0))throw d=!0,new h.MusicSheetReadingException(Se+this.instrument.Name);this.musicSheet.SheetErrors.push(Se+this.instrument.Name)}if(!_.element("divisions")&&0===this.divisions&&0===this.currentXmlMeasureIndex){var xe=c.ITextTranslation.translateText("ReaderErrorMessages/DivisionError","Invalid divisions value at Instrument: ");if(this.divisions=this.readDivisionsFromNotes(),!(this.divisions>0))throw d=!0,new h.MusicSheetReadingException(xe+this.instrument.Name);this.musicSheet.SheetErrors.push(xe+this.instrument.Name)}this.addAbstractInstruction(_,n,p,o.clone()),o.Equals(new l.Fraction(0,1))&&this.isAttributesNodeAtBeginOfMeasure(this.xmlMeasureList[this.currentXmlMeasureIndex],_)&&this.saveAbstractInstructionList(this.instrument.Staves.length,!0),this.isAttributesNodeAtEndOfMeasure(this.xmlMeasureList[this.currentXmlMeasureIndex],_)&&this.saveClefInstructionAtEndOfMeasure();var _e,Ee=_.elements("staff-details"),ke=b(Ee);try{for(ke.s();!(_e=ke.n()).done;){var Me=_e.value,we=Me.element("staff-lines");if(we){var Pe=1,Te=Me.attribute("number");Te&&(Pe=parseInt(Te.value,10)),this.instrument.Staves[Pe-1].StafflineCount=parseInt(we.value,10)}}}catch(Ke){ke.e(Ke)}finally{ke.f()}var Ce=_.element("measure-style");if(Ce){var Ie=Ce.element("multiple-rest");if(Ie){var Ae=Ie.value,Le=0;try{Le=Number.parseInt(Ae,10),void 0!==e.multipleRestMeasures&&Le!==e.multipleRestMeasures?e.multipleRestMeasures=0:(e.multipleRestMeasures=Le,this.currentMultirestStartMeasure=e,this.followingMultirestMeasures=Le+1)}catch(e){console.log("multirest parse error: "+e)}}}}else if("forward"===_.name){var Oe=parseInt(_.element("duration").value,10);o.Add(new l.Fraction(Oe,4*this.divisions))}else if("backup"===_.name){var Re=parseInt(_.element("duration").value,10);o.Sub(new l.Fraction(Re,4*this.divisions)),o.IsNegative()&&(o=new l.Fraction(0,1)),u.Sub(new l.Fraction(Re,4*this.divisions)),u.IsNegative()&&(u=new l.Fraction(0,1))}else if("direction"===_.name){var Ne=_.element("direction-type"),Be=Math.min(1,o.RealValue);void 0!==this.activeRhythm&&this.activeRhythm.Rhythm&&(Be/=this.activeRhythm.Rhythm.RealValue);var De=!1;if(this.repetitionInstructionReader&&(De=this.repetitionInstructionReader.handleRepetitionInstructionsFromWordsOrSymbols(Ne,Be)),!De){var Fe=this.expressionReaders[0],je=this.readExpressionStaffNumber(_)-1;je<this.expressionReaders.length&&(Fe=this.expressionReaders[je]),Fe&&(Ne.element("octave-shift")&&(Fe.readExpressionParameters(_,this.instrument,this.divisions,o,u,this.currentMeasure.MeasureNumber,!0),Fe.addOctaveShift(_,this.currentMeasure,u.clone())),Ne.element("pedal")&&(Fe.readExpressionParameters(_,this.instrument,this.divisions,o,u,this.currentMeasure.MeasureNumber,!0),Fe.addPedalMarking(_,this.currentMeasure,u.clone())),Fe.readExpressionParameters(_,this.instrument,this.divisions,o,u,this.currentMeasure.MeasureNumber,!1),Fe.read(_,this.currentMeasure,o,u.clone()))}}else if("barline"===_.name){this.repetitionInstructionReader&&this.repetitionInstructionReader.handleLineRepetitionInstructions(_)&&(this.currentMeasure.HasEndLine=!0);var Ve=_.attribute("location");if(x===g.length-1||Ve&&"right"===Ve.value){var Ge=null===(a=_.element("bar-style"))||void 0===a?void 0:a.value;Ge&&(this.currentMeasure.endingBarStyleXml=Ge,this.currentMeasure.endingBarStyleEnum=M.SystemLinesEnumHelper.xmlBarlineStyleToSystemLinesEnum(Ge))}}else if("sound"===_.name)try{if(_.attribute("tempo")){var We=parseFloat(_.attribute("tempo").value);0===this.currentXmlMeasureIndex&&(this.musicSheet.DefaultStartTempoInBpm=We,this.musicSheet.HasBPMInfo=!0)}}catch(e){m.default.debug("InstrumentReader.readTempoInstruction",e)}else"harmony"===_.name&&this.openChordSymbolContainers.push(S.ChordSymbolReader.readChordSymbol(_,this.musicSheet,this.activeKey))}for(var Ue in this.voiceGeneratorsDict)this.voiceGeneratorsDict.hasOwnProperty(Ue)&&this.voiceGeneratorsDict[Ue].checkForOpenBeam();if(this.currentXmlMeasureIndex===this.xmlMeasureList.length-1){for(var ze=0;ze<this.instrument.Staves.length;ze++)this.activeClefsHaveBeenInitialized[ze]||this.createDefaultClefInstruction(this.musicSheet.getGlobalStaffIndexOfFirstStaff(this.instrument)+ze);this.activeKeyHasBeenInitialized||this.createDefaultKeyInstruction();for(var He=0;He<this.expressionReaders.length;He++){var Xe=this.expressionReaders[He];Xe&&Xe.closeOpenExpressions(this.currentMeasure,o)}}Object.keys(this.voiceGeneratorsDict).forEach((function(e){s.voiceGeneratorsDict[e].finalizeReadingMeasure()})),this.musicSheet.HasBPMInfo?0===e.TempoInBPM&&this.previousMeasure&&(this.currentMeasure.TempoInBPM=this.previousMeasure.TempoInBPM):this.currentMeasure.TempoInBPM=120}catch(e){if(d)throw new h.MusicSheetReadingException(e.Message);var Ye=c.ITextTranslation.translateText("ReaderErrorMessages/MeasureError","Error while reading Measure.");this.musicSheet.SheetErrors.pushMeasureError(Ye),m.default.debug("InstrumentReader.readNextXmlMeasure",Ye,e)}return this.previousMeasure=this.currentMeasure,this.currentXmlMeasureIndex+=1,!0}},{key:"parseXmlColor",value:function(e){if(e)return 7===e.length?e:9===e.length?"#"+e.substr(3):void 0}},{key:"doCalculationsAfterDurationHasBeenSet",value:function(){for(var e in this.voiceGeneratorsDict)this.voiceGeneratorsDict.hasOwnProperty(e)&&this.voiceGeneratorsDict[e].checkOpenTies()}},{key:"getOrCreateVoiceGenerator",value:function(e,t){var n=this.instrument.Staves[t],i=this.voiceGeneratorsDict[e];if(i)-1===n.Voices.indexOf(i.GetVoice)&&n.Voices.push(i.GetVoice);else{var a=this.staffMainVoiceGeneratorDict[t];a?(i=new r.VoiceGenerator(this.pluginManager,n,e,this.slurReader,a.GetVoice),n.Voices.push(i.GetVoice),this.voiceGeneratorsDict[e]=i):(i=new r.VoiceGenerator(this.pluginManager,n,e,this.slurReader),n.Voices.push(i.GetVoice),this.voiceGeneratorsDict[e]=i,this.staffMainVoiceGeneratorDict[t]=i)}return i}},{key:"createExpressionGenerators",value:function(e){this.expressionReaders=new Array(e);for(var t=0;t<e;t++)this.expressionReaders[t]=new x.ExpressionReader(this.musicSheet,this.instrument,t+1)}},{key:"createDefaultClefInstruction",value:function(e){var t;t=this.musicSheet.SourceMeasures.length>0?this.musicSheet.SourceMeasures[0]:this.currentMeasure;var n,i=new s.ClefInstruction(d.ClefEnum.G,0,2);t.FirstInstructionsStaffEntries[e]?(n=t.FirstInstructionsStaffEntries[e]).removeFirstInstructionOfTypeClefInstruction():(n=new a.SourceStaffEntry(void 0,void 0),t.FirstInstructionsStaffEntries[e]=n),i.Parent=n,n.Instructions.splice(0,0,i)}},{key:"createDefaultKeyInstruction",value:function(){var e;e=this.musicSheet.SourceMeasures.length>0?this.musicSheet.SourceMeasures[0]:this.currentMeasure;for(var t=new o.KeyInstruction(void 0,0,p.KeyEnum.major),n=this.inSourceMeasureInstrumentIndex;n<this.inSourceMeasureInstrumentIndex+this.instrument.Staves.length;n++)if(e.FirstInstructionsStaffEntries[n]){var i=e.FirstInstructionsStaffEntries[n];t.Parent=i,i.removeFirstInstructionOfTypeKeyInstruction(),i.Instructions[0]instanceof s.ClefInstruction?i.Instructions.splice(1,0,t):i.Instructions.splice(0,0,t)}else{var r=new a.SourceStaffEntry(void 0,void 0);e.FirstInstructionsStaffEntries[n]=r,t.Parent=r,r.Instructions.push(t)}}},{key:"isAttributesNodeAtBeginOfMeasure",value:function(e,t){var n=e.elements(),i=n.indexOf(t);if(i>0&&"backup"===n[i-1].name)return!0;for(var r=-1,a=0;a<n.length;a++)if("note"===n[a].name){r=a;break}return i<r&&r>0||r<0}},{key:"isAttributesNodeAtEndOfMeasure",value:function(e,t){for(var n=e.elements().slice(),i=0,r=0;r<n.length;r++)if(n[r]===t){i=r;break}for(var a=0,s=i;s<n.length;s++)if("note"===n[s].name){a=s;break}return i>a}},{key:"getNoteDurationFromTypeNode",value:function(e){var t=e.element("type");if(t){var n=t.value;return k.NoteTypeHandler.getNoteDurationFromType(n)}return new l.Fraction(0,4*this.divisions)}},{key:"addAbstractInstruction",value:function(e,t,n,i){if(!e.element("divisions")||1!==e.elements().length){var r=e.element("transpose");if(r){var a=r.element("chromatic");a&&(this.instrument.PlaybackTranspose=parseInt(a.value,10))}var h,g=e.elements("clef");if(g.length>0)for(var y=0,b=g.length;y<b;++y){var S=g[y],x=d.ClefEnum.G,_=2,E=1,k=0,M=S.element("line");if(M)try{_=parseInt(M.value,10)}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/ClefLineError","Invalid clef line. Using default."),this.musicSheet.SheetErrors.pushMeasureError(h),_=2,m.default.debug("InstrumentReader.addAbstractInstruction",h,e)}var w=S.element("sign");if(w)try{x=d.ClefEnum[w.value],s.ClefInstruction.isSupportedClef(x)||(h=c.ITextTranslation.translateText("ReaderErrorMessages/ClefError","Unsupported clef. Using default."),this.musicSheet.SheetErrors.pushMeasureError(h),x=d.ClefEnum.G,_=2),x===d.ClefEnum.TAB&&(k=-1)}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/ClefError","Invalid clef. Using default."),this.musicSheet.SheetErrors.pushMeasureError(h),x=d.ClefEnum.G,_=2,m.default.debug("InstrumentReader.addAbstractInstruction",h,e)}var P=S.element("clef-octave-change");if(P)try{k=parseInt(P.value,10)}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/ClefOctaveError","Invalid clef octave. Using default."),this.musicSheet.SheetErrors.pushMeasureError(h),k=0}if(S.hasAttributes&&S.attribute("number"))try{(E=parseInt(S.attribute("number").value,10))>this.currentClefNumber&&(E=this.currentClefNumber),this.currentClefNumber=E+1}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/ClefError","Invalid clef. Using default."),this.musicSheet.SheetErrors.pushMeasureError(h),E=1,this.currentClefNumber=E+1}var T=new s.ClefInstruction(x,k,_);this.abstractInstructions.push([E,T,i])}if(void 0!==e.element("key")&&this.instrument.MidiInstrumentId!==v.MidiInstrument.Percussion){var C=0,I=e.element("key").element("fifths");if(I)try{C=parseInt(I.value,10)}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/KeyError","Invalid key. Set to default."),this.musicSheet.SheetErrors.pushMeasureError(h),C=0,m.default.debug("InstrumentReader.addAbstractInstruction",h,e)}var A=p.KeyEnum.none,L=e.element("key");if(L&&(L=L.element("mode")),L)try{A=p.KeyEnum[L.value]}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/KeyError","Invalid key/mode. Set to default."),this.musicSheet.SheetErrors.pushMeasureError(h),A=p.KeyEnum.major,m.default.debug("InstrumentReader.addAbstractInstruction",h,e)}var O=new o.KeyInstruction(void 0,C,A);this.abstractInstructions.push([1,O,i])}if(e.element("time")){var R=e.element("time"),N=f.RhythmSymbolEnum.NONE,B=!0;if(void 0!==R&&R.hasAttributes){var D=R.attribute("symbol");D&&("common"===D.value?N=f.RhythmSymbolEnum.COMMON:"cut"===D.value&&(N=f.RhythmSymbolEnum.CUT));var F=R.attribute("print-object");F&&"no"===F.value&&(B=!1)}for(var j=0,V=0,G=R&&void 0!==R.element("senza-misura"),W=e.elements("time"),U=[],z=[],H=0,X=W.length;H<X;++H){var Y=W[H];U.push.apply(U,Y.elements("beats")),z.push.apply(z,Y.elements("beat-type"))}if(G)this.abstractInstructions.push([1,new u.RhythmInstruction(new l.Fraction(4,4,0,!1),f.RhythmSymbolEnum.NONE),i]);else{try{if(void 0!==U&&U.length>0&&void 0!==z&&U.length===z.length){for(var K=U.length,q=new Array(K),Z=0,J=0;J<K;J++){var Q=U[J].value,$=0,ee=0;if(-1!==Q.indexOf("+"))for(var te=Q.split("+"),ne=0,ie=te.length;ne<ie;++ne)$+=parseInt(te[ne],10);else $=parseInt(Q,10);ee=parseInt(z[J].value,10),Z=Math.max(Z,ee),q[J]=new l.Fraction($,ee,0,!1)}for(var re=0;re<K;re++)q[re].Denominator===Z?j+=q[re].Numerator:j+=Z/q[re].Denominator*q[re].Numerator;V=Z}else j=parseInt(e.element("time").element("beats").value,10),V=parseInt(e.element("time").element("beat-type").value,10)}catch(e){h=c.ITextTranslation.translateText("ReaderErrorMessages/RhythmError","Invalid rhythm. Set to default."),this.musicSheet.SheetErrors.pushMeasureError(h),j=4,V=4,m.default.debug("InstrumentReader.addAbstractInstruction",h,e)}var ae=new u.RhythmInstruction(new l.Fraction(j,V,0,!1),N);ae.PrintObject=B,this.abstractInstructions.push([1,ae,i])}}}}},{key:"saveAbstractInstructionList",value:function(e,t){for(var n=this.abstractInstructions.length-1;n>=0;n--){var i=this.abstractInstructions[n],r=i[0],l=i[1],c=i[2];if(l instanceof s.ClefInstruction){var h=l;if(0===this.currentXmlMeasureIndex||r<=this.activeClefs.length&&h!==this.activeClefs[r-1])if(t||void 0===this.currentStaffEntry||this.currentStaffEntry.hasNotes()||r-1!==this.instrument.Staves.indexOf(this.currentStaffEntry.ParentStaff))if(t){if(0!==c.RealValue)continue;var d=void 0;if(this.currentMeasure){var f=h,p=this.inSourceMeasureInstrumentIndex+r-1,m=this.currentMeasure.FirstInstructionsStaffEntries[p];if(0===this.currentXmlMeasureIndex)if(m)if(void 0===this.currentMeasure.FirstInstructionsStaffEntries[p]||m.Instructions[0]instanceof s.ClefInstruction){var v=new a.SourceStaffEntry(void 0,void 0);this.currentMeasure.LastInstructionsStaffEntries[p]=v,f.Parent=v,v.Instructions.push(f)}else d=m,f.Parent=d,d.removeFirstInstructionOfTypeClefInstruction(),d.Instructions.splice(0,0,f),this.activeClefsHaveBeenInitialized[r-1]=!0;else d=new a.SourceStaffEntry(void 0,void 0),this.currentMeasure.FirstInstructionsStaffEntries[p]=d,f.Parent=d,d.Instructions.push(f),this.activeClefsHaveBeenInitialized[r-1]=!0;else if(this.activeClefsHaveBeenInitialized[r-1]){var g=this.previousMeasure;this.followingMultirestMeasures>0&&this.currentMeasure.Rules.RenderMultipleRestMeasures&&(g=this.currentMultirestStartMeasure);var y=new a.SourceStaffEntry(void 0,void 0);g.LastInstructionsStaffEntries[p]=y,f.Parent=y,y.Instructions.push(f)}else{var b=this.musicSheet.SourceMeasures[0];b.FirstInstructionsStaffEntries[p]?(d=b.FirstInstructionsStaffEntries[p]).removeFirstInstructionOfTypeClefInstruction():d=new a.SourceStaffEntry(void 0,void 0),f.Parent=d,d.Instructions.splice(0,0,f),this.activeClefsHaveBeenInitialized[r-1]=!0}this.activeClefs[r-1]=h,this.abstractInstructions.splice(n,1)}}else{var S=void 0,x=this.activeRhythm.Rhythm;x.RealValue>0&&c.RealValue/x.RealValue>.9&&(this.currentMeasure.LastInstructionsStaffEntries[r-1]||(this.currentMeasure.LastInstructionsStaffEntries[r-1]=new a.SourceStaffEntry(void 0,this.instrument.Staves[r-1])),S=this.currentMeasure.LastInstructionsStaffEntries[r-1]),S&&(h.Parent=S,S.Instructions.push(h),this.activeClefs[r-1]=h,this.abstractInstructions.splice(n,1))}else{var _=h,E=this.currentStaffEntry;if(c&&Math.abs(c.RealValue-E.Timestamp.RealValue)>.01)continue;_.Parent=E,E.removeFirstInstructionOfTypeClefInstruction(),E.Instructions.push(_),this.activeClefs[r-1]=h,this.abstractInstructions.splice(n,1)}else r<=this.activeClefs.length&&h===this.activeClefs[r-1]&&this.abstractInstructions.splice(n,1)}if(l instanceof o.KeyInstruction){var k=l;if(this.activeKey&&this.activeKey.Key===k.Key)this.abstractInstructions.splice(n,1);else{var M=void 0;if(this.activeKey=k,this.abstractInstructions.splice(n,1),this.activeKeyHasBeenInitialized?M=this.currentMeasure:(this.activeKeyHasBeenInitialized=!0,M=this.currentXmlMeasureIndex>0?this.musicSheet.SourceMeasures[0]:this.currentMeasure),M)for(var w=this.inSourceMeasureInstrumentIndex;w<this.inSourceMeasureInstrumentIndex+e;w++){var P=k;if(M.FirstInstructionsStaffEntries[w]){var T=M.FirstInstructionsStaffEntries[w];P.Parent=T,T.removeFirstInstructionOfTypeKeyInstruction(),0===T.Instructions.length?T.Instructions.push(P):T.Instructions[0]instanceof s.ClefInstruction?T.Instructions.splice(1,0,P):T.Instructions.splice(0,0,P)}else{var C=new a.SourceStaffEntry(void 0,void 0);M.FirstInstructionsStaffEntries[w]=C,P.Parent=C,C.Instructions.push(P)}}}}if(l instanceof u.RhythmInstruction){var I=l;if(this.activeRhythm&&this.activeRhythm===I)this.abstractInstructions.splice(n,1);else if(this.activeRhythm=I,this.abstractInstructions.splice(n,1),this.currentMeasure)for(var A=this.inSourceMeasureInstrumentIndex;A<this.inSourceMeasureInstrumentIndex+e;A++){var L=I,O=void 0;this.currentMeasure.FirstInstructionsStaffEntries[A]?(O=this.currentMeasure.FirstInstructionsStaffEntries[A]).removeFirstInstructionOfTypeRhythmInstruction():(O=new a.SourceStaffEntry(void 0,void 0),this.currentMeasure.FirstInstructionsStaffEntries[A]=O),L.Parent=O,O.Instructions.push(L)}}}}},{key:"saveClefInstructionAtEndOfMeasure",value:function(){for(var e=this.abstractInstructions.length-1;e>=0;e--){var t=this.abstractInstructions[e][0],n=this.abstractInstructions[e][1];if(n instanceof s.ClefInstruction){var i=n;if(!this.activeClefs[t-1]||i.ClefType!==this.activeClefs[t-1].ClefType||i.ClefType===this.activeClefs[t-1].ClefType&&i.Line!==this.activeClefs[t-1].Line){var r=new a.SourceStaffEntry(void 0,void 0);this.currentMeasure.LastInstructionsStaffEntries[this.inSourceMeasureInstrumentIndex+t-1]=r;var o=i;o.Parent=r,r.Instructions.push(o),this.activeClefs[t-1]=i,this.abstractInstructions.splice(e,1)}}}}},{key:"getNoteDurationForTuplet",value:function(e){var t=new l.Fraction(0,1),n=this.getNoteDurationFromTypeNode(e);if(e.element("time-modification")){var i=e.element("time-modification");if(i&&void 0!==i.element("actual-notes")&&i.element("normal-notes")){var r=i.element("actual-notes"),a=i.element("normal-notes");if(void 0!==r&&a){var s=parseInt(r.value,10),o=parseInt(a.value,10);t=new l.Fraction(o*n.Numerator,s*n.Denominator)}}}return t}},{key:"readExpressionStaffNumber",value:function(e){var t=1;if(e.element("staff")){var n=e.element("staff");if(n)try{t=parseInt(n.value,10)}catch(e){var i=c.ITextTranslation.translateText("ReaderErrorMessages/ExpressionStaffError","Invalid Expression staff number. Set to default.");this.musicSheet.SheetErrors.pushMeasureError(i),t=1,m.default.debug("InstrumentReader.readExpressionStaffNumber",i,e)}}return t}},{key:"readDivisionsFromNotes",value:function(){for(var e=0,t=this.currentXmlMeasureIndex,n=!1;!n;){for(var i=this.xmlMeasureList[t].elements(),r=0,a=i.length;r<a;++r){var s=i[r];if("note"===s.name&&!s.element("time-modification")){var o=s.element("duration"),u=s.element("type");if(void 0!==o&&u){var l=u.value,d=0;try{d=parseInt(o.value,10)}catch(e){m.default.debug("InstrumentReader.readDivisionsFromNotes",e);continue}switch(l){case"1024th":e=d/4*1024;break;case"512th":e=d/4*512;break;case"256th":e=d/4*256;break;case"128th":e=d/4*128;break;case"64th":e=d/4*64;break;case"32nd":e=d/4*32;break;case"16th":e=d/4*16;break;case"eighth":e=d/4*8;break;case"quarter":e=d/4*4;break;case"half":e=d/4*2;break;case"whole":e=d/4;break;case"breve":e=d/4/2;break;case"long":e=d/4/4;break;case"maxima":e=d/4/8}}}if(e>0){n=!0;break}}if(0===e&&++t===this.xmlMeasureList.length){var f=c.ITextTranslation.translateText("ReaderErrorMEssages/DivisionsError","Invalid divisions value at Instrument: ");throw new h.MusicSheetReadingException(f+this.instrument.Name)}}return e}}]),e}()},1372:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSheetReader=void 0;var r=n(7514),a=n(5942),s=n(1797),o=n(2393),u=n(6842),l=n(6331),c=n(1703),h=i(n(2043)),d=n(3331),f=n(3331),p=n(9050),m=n(884),v=n(5142),S=n(289),x=n(2255),_=n(8736),E=n(1405),k=n(2458),M=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new E.EngravingRules;g(this,e),this.completeNumberOfStaves=0,this.pluginManager=new k.ReaderPluginManager,this.afterSheetReadingModules=t||[],this.repetitionInstructionReader=_.MusicSymbolModuleFactory.createRepetitionInstructionReader(),this.repetitionCalculator=_.MusicSymbolModuleFactory.createRepetitionCalculator(),this.rules=n}return y(e,[{key:"PluginManager",get:function(){return this.pluginManager}},{key:"CompleteNumberOfStaves",get:function(){return this.completeNumberOfStaves}},{key:"createMusicSheet",value:function(e,t){try{return this._createMusicSheet(e,t)}catch(e){return void h.default.error("MusicSheetReader.CreateMusicSheet",e)}}},{key:"_removeFromArray",value:function(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},{key:"trimString",value:function(e){return e.replace(/^\s+|\s+$/g,"")}},{key:"_lastElement",value:function(e){return e[e.length-1]}},{key:"_createMusicSheet",value:function(t,n){var i=[],o=0;if(this.musicSheet=new r.MusicSheet,this.musicSheet.Path=n,this.musicSheet.Rules=this.rules,!t)throw new c.MusicSheetReadingException("Undefined root element");this.pushSheetLabels(t,n);var u=t.element("part-list");if(!u)throw new c.MusicSheetReadingException("Undefined partListNode");var h=t.elements("part"),d=u.elements();this.initializeReading(d,h,i);var f=!0;this.currentFraction=new s.Fraction(0,1);var p=!1,m=t.element("identification");for(m&&(m=m.element("encoding")),m&&(m=m.element("software")),void 0!==m&&"Guitar Pro 5"===m.value&&(p=!0);f;){void 0!==this.currentMeasure&&this.currentMeasure.HasEndLine&&this.rules.NewPartAndSystemAfterFinalBarline&&(o=0),this.currentMeasure=new a.SourceMeasure(this.completeNumberOfStaves,this.musicSheet.Rules);var v,g=b(i);try{for(g.s();!(v=g.n()).done;){var y=v.value;try{f=f&&y.readNextXmlMeasure(this.currentMeasure,this.currentFraction,p)}catch(t){var S=l.ITextTranslation.translateText("ReaderErrorMessages/InstrumentError","Error while reading instruments.");throw new c.MusicSheetReadingException(S,t)}}}catch(E){g.e(E)}finally{g.f()}f&&(this.musicSheet.addMeasure(this.currentMeasure),this.checkIfRhythmInstructionsAreSetAndEqual(i),this.checkSourceMeasureForNullEntries(),o=this.setSourceMeasureDuration(i,o),e.doCalculationsAfterDurationHasBeenSet(i),this.currentMeasure.AbsoluteTimestamp=this.currentFraction.clone(),this.musicSheet.SheetErrors.finalizeMeasure(this.currentMeasure.MeasureNumber),this.currentFraction.Add(this.currentMeasure.Duration),this.previousMeasure=this.currentMeasure)}this.repetitionInstructionReader&&(this.repetitionInstructionReader.removeRedundantInstructions(),this.repetitionCalculator&&this.repetitionCalculator.calculateRepetitions(this.musicSheet,this.repetitionInstructionReader.repetitionInstructions)),0===this.musicSheet.DefaultStartTempoInBpm&&(this.musicSheet.DefaultStartTempoInBpm=100),this.musicSheet.checkForInstrumentWithNoVoice(),this.musicSheet.fillStaffList();for(var x=0,_=this.afterSheetReadingModules.length;x<_;++x)this.afterSheetReadingModules[x].calculate(this.musicSheet);return this.musicSheet.userStartTempoInBPM=this.musicSheet.userStartTempoInBPM||this.musicSheet.DefaultStartTempoInBpm,this.musicSheet.InitializeStartTempoInBPM(this.musicSheet.userStartTempoInBPM),this.musicSheet.MusicPartManager.init(),this.musicSheet}},{key:"initializeReading",value:function(e,t,n){var i=this.createInstrumentGroups(e);this.completeNumberOfStaves=this.getCompleteNumberOfStavesFromXml(t),0!==t.length&&(this.repetitionInstructionReader.MusicSheet=this.musicSheet,this.currentFraction=new s.Fraction(0,1),this.currentMeasure=void 0,this.previousMeasure=void 0);var r,a=0,u=b(t);try{for(u.s();!(r=u.n()).done;){var c=r.value,h=c.attribute("id");if(h){var d=i[h.value],f=c.elements("measure"),p=1;try{p=this.getInstrumentNumberOfStavesFromXml(c)}catch(e){var m=l.ITextTranslation.translateText("ReaderErrorMessages/InstrumentStavesNumberError","Invalid number of staves at instrument: ");this.musicSheet.SheetErrors.push(m+d.Name);continue}d.createStaves(p),n.push(new o.InstrumentReader(this.pluginManager,this.repetitionInstructionReader,f,d)),this.repetitionInstructionReader&&(this.repetitionInstructionReader.xmlMeasureList[a]=f),a++}}}catch(v){u.e(v)}finally{u.f()}}},{key:"checkIfRhythmInstructionsAreSetAndEqual",value:function(e){for(var t=[],n=0;n<this.completeNumberOfStaves;n++)if(this.currentMeasure.FirstInstructionsStaffEntries[n]){var i=this.currentMeasure.FirstInstructionsStaffEntries[n].Instructions[this.currentMeasure.FirstInstructionsStaffEntries[n].Instructions.length-1];i instanceof d.RhythmInstruction&&t.push(i)}for(var r=0,a=-1,o=0,u=t.length;o<u;++o){var l=t[o];if(l.Rhythm.RealValue>r){if(this.areRhythmInstructionsMixed(t)&&l.SymbolEnum!==f.RhythmSymbolEnum.NONE)continue;r=l.Rhythm.RealValue,a=t.indexOf(l)}}if(t.length>0&&t.length<this.completeNumberOfStaves){for(var c=t[a].clone(),h=0;h<this.completeNumberOfStaves;h++)void 0===this.currentMeasure.FirstInstructionsStaffEntries[h]||this._lastElement(this.currentMeasure.FirstInstructionsStaffEntries[h].Instructions)instanceof d.RhythmInstruction||(this.currentMeasure.FirstInstructionsStaffEntries[h].removeAllInstructionsOfTypeRhythmInstruction(),this.currentMeasure.FirstInstructionsStaffEntries[h].Instructions.push(c.clone())),this.currentMeasure.FirstInstructionsStaffEntries[h]||(this.currentMeasure.FirstInstructionsStaffEntries[h]=new p.SourceStaffEntry(void 0,void 0),this.currentMeasure.FirstInstructionsStaffEntries[h].Instructions.push(c.clone()));for(var m=0,v=e.length;m<v;++m)e[m].ActiveRhythm=c}if(0===t.length&&this.currentMeasure===this.musicSheet.SourceMeasures[0]){for(var g=new d.RhythmInstruction(new s.Fraction(4,4,0,!1),f.RhythmSymbolEnum.NONE),y=0;y<this.completeNumberOfStaves;y++)this.currentMeasure.FirstInstructionsStaffEntries[y]?this.currentMeasure.FirstInstructionsStaffEntries[y].removeAllInstructionsOfTypeRhythmInstruction():this.currentMeasure.FirstInstructionsStaffEntries[y]=new p.SourceStaffEntry(void 0,void 0),this.currentMeasure.FirstInstructionsStaffEntries[y].Instructions.push(g);for(var b=0,S=e.length;b<S;++b)e[b].ActiveRhythm=g}for(var x=0,_=t.length;x<_;++x){var E=t[x];if(E.Rhythm.RealValue<r&&this._lastElement(this.currentMeasure.FirstInstructionsStaffEntries[t.indexOf(E)].Instructions)instanceof d.RhythmInstruction){var k=this.currentMeasure.FirstInstructionsStaffEntries[t.indexOf(E)].Instructions;k[k.length-1]=t[a].clone()}Math.abs(E.Rhythm.RealValue-r)<1e-6&&E.SymbolEnum!==f.RhythmSymbolEnum.NONE&&this.areRhythmInstructionsMixed(t)&&(E.SymbolEnum=f.RhythmSymbolEnum.NONE)}}},{key:"areRhythmInstructionsMixed",value:function(e){for(var t=1;t<e.length;t++)if(Math.abs(e[t].Rhythm.RealValue-e[0].Rhythm.RealValue)<1e-6&&e[t].SymbolEnum!==e[0].SymbolEnum)return!0;return!1}},{key:"setSourceMeasureDuration",value:function(e,t){var n,i=new s.Fraction(0,1),r=[],a=b(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.push(o.MaxTieNoteFraction);var u=o.ActiveRhythm.Rhythm;i.lt(u)&&(i=new s.Fraction(u.Numerator,u.Denominator,0,!1))}}catch(x){a.e(x)}finally{a.f()}var c,h=this.currentMeasure.calculateInstrumentsDuration(this.musicSheet,r),d=new s.Fraction(0,1),f=b(h);try{for(f.s();!(c=f.n()).done;){var p=c.value;d.lt(p)&&(d=p)}}catch(x){f.e(x)}finally{f.f()}s.Fraction.Equal(d,i)?this.checkFractionsForEquivalence(d,i):d.lt(i)&&(d=this.currentMeasure.reverseCheck(this.musicSheet,d),this.checkFractionsForEquivalence(d,i)),this.currentMeasure.ImplicitMeasure=this.checkIfMeasureIsImplicit(d,i),this.currentMeasure.ImplicitMeasure||t++,this.currentMeasure.Duration=d,this.currentMeasure.ActiveTimeSignature=i,this.currentMeasure.MeasureNumber=t;for(var m=0;m<h.length;m++){var v=h[m];if(this.currentMeasure.ImplicitMeasure&&v!==d||!s.Fraction.Equal(v,i)&&!this.allInstrumentsHaveSameDuration(h,d))for(var g=this.musicSheet.getGlobalStaffIndexOfFirstStaff(this.musicSheet.Instruments[m]),y=0;y<this.musicSheet.Instruments[m].Staves.length;y++)if(!this.graphicalMeasureIsEmpty(g+y)){this.currentMeasure.setErrorInGraphicalMeasure(g+y,!0);var S=l.ITextTranslation.translateText("ReaderErrorMessages/MissingNotesError","Given Notes don't correspond to measure duration.");this.musicSheet.SheetErrors.pushMeasureError(S)}}return t}},{key:"checkFractionsForEquivalence",value:function(e,t){if(t.Denominator>e.Denominator){var n=t.Denominator/e.Denominator;e.expand(n)}}},{key:"checkIfMeasureIsImplicit",value:function(e,t){return!(this.previousMeasure||!e.lt(t))||!!this.previousMeasure&&s.Fraction.plus(this.previousMeasure.Duration,e).Equals(t)}},{key:"allInstrumentsHaveSameDuration",value:function(e,t){for(var n=0,i=0,r=e.length;i<r;++i)e[i].Equals(t)&&n++;return n===e.length&&t!==new s.Fraction(0,1)}},{key:"graphicalMeasureIsEmpty",value:function(e){for(var t=0,n=0;n<this.currentMeasure.VerticalSourceStaffEntryContainers.length;n++)this.currentMeasure.VerticalSourceStaffEntryContainers[n].StaffEntries[e]||t++;return t===this.currentMeasure.VerticalSourceStaffEntryContainers.length}},{key:"checkSourceMeasureForNullEntries",value:function(){for(var e=this.currentMeasure.VerticalSourceStaffEntryContainers.length-1;e>=0;e--)for(var t=this.currentMeasure.VerticalSourceStaffEntryContainers[e].StaffEntries.length-1;t>=0;t--){var n=this.currentMeasure.VerticalSourceStaffEntryContainers[e].StaffEntries[t];if(n)for(var i=n.VoiceEntries.length-1;i>=0;i--){var r=n.VoiceEntries[i];0===r.Notes.length&&(this._removeFromArray(r.ParentVoice.VoiceEntries,r),this._removeFromArray(n.VoiceEntries,r))}void 0!==n&&0===n.VoiceEntries.length&&(this.currentMeasure.VerticalSourceStaffEntryContainers[e].StaffEntries[t]=void 0)}for(var a=this.currentMeasure.VerticalSourceStaffEntryContainers.length-1;a>=0;a--){for(var s=0,o=0,u=this.currentMeasure.VerticalSourceStaffEntryContainers[a].StaffEntries.length;o<u;++o)this.currentMeasure.VerticalSourceStaffEntryContainers[a].StaffEntries[o]||s++;s===this.currentMeasure.VerticalSourceStaffEntryContainers[a].StaffEntries.length&&this._removeFromArray(this.currentMeasure.VerticalSourceStaffEntryContainers,this.currentMeasure.VerticalSourceStaffEntryContainers[a])}}},{key:"pushSheetLabels",value:function(e,t){this.readComposer(e),this.readTitle(e);try{this.musicSheet.Title&&this.musicSheet.Composer||this.readTitleAndComposerFromCredits(e)}catch(e){h.default.info("MusicSheetReader.pushSheetLabels","readTitleAndComposerFromCredits",e)}try{if(!this.musicSheet.Title){var n=Math.max(0,t.lastIndexOf("/"),t.lastIndexOf("\\")),i=t.substr(n).split(".",1);this.musicSheet.Title=new x.Label(i[0])}}catch(e){h.default.info("MusicSheetReader.pushSheetLabels","read title from file name",e)}}},{key:"presentAttrsWithValue",value:function(e,t){var n,i=b(e.attributes());try{for(i.s();!(n=i.n()).done;)if(n.value.value===t)return!0}catch(r){i.e(r)}finally{i.f()}return!1}},{key:"readComposer",value:function(e){var t=e.element("identification");if(t)for(var n=t.elements("creator"),i=0,r=n.length;i<r;++i){var a=n[i];if(a.hasAttributes){if(this.presentAttrsWithValue(a,"composer")){this.musicSheet.Composer=new x.Label(this.trimString(a.value));continue}(this.presentAttrsWithValue(a,"lyricist")||this.presentAttrsWithValue(a,"poet"))&&(this.musicSheet.Lyricist=new x.Label(this.trimString(a.value)))}}}},{key:"readTitleAndComposerFromCredits",value:function(e){var t,n,i,r=this.computeSystemYCoordinates(e);if(0!==r){for(var a,s,o,u=1,l=0,c=e.elements("credit"),h=0,d=c.length;h<d;++h){var f=c[h];if(!f.attribute("page"))return;if("1"===f.attribute("page").value){var p=void 0;if(f){if(!(p=f.element("credit-words")).attribute("justify"))break;var m=null===(t=p.attribute("justify"))||void 0===t?void 0:t.value,v=null===(n=p.attribute("default-y"))||void 0===n?void 0:n.value,g=null!=v,y=g?parseFloat(v):Number.MIN_VALUE;if(g&&y>r){if(!this.musicSheet.Title){var b=null===(i=p.attribute("font-size"))||void 0===i?void 0:i.value;if(b){var S=parseFloat(b);u<S&&(u=S,a=p.value)}}if(this.musicSheet.Subtitle||"right"!==m&&"left"!==m&&l<y&&(l=y,o?(s=o,o=p.value):o=p.value),void 0===this.musicSheet.Composer||!this.musicSheet.Lyricist)switch(m){case"right":this.musicSheet.Composer=new x.Label(this.trimString(p.value));break;case"left":this.musicSheet.Lyricist=new x.Label(this.trimString(p.value))}}}}}!this.musicSheet.Title&&a&&(this.musicSheet.Title=new x.Label(this.trimString(a))),!this.musicSheet.Subtitle&&s&&(this.musicSheet.Subtitle=new x.Label(this.trimString(s)))}}},{key:"computeSystemYCoordinates",value:function(e){if(!e.element("defaults"))return 0;var t=0,n=0;try{var i=e.element("defaults").element("page-layout").element("page-height").value;t=parseFloat(i)}catch(e){return h.default.info("MusicSheetReader.computeSystemYCoordinates(): couldn't find page height, not reading title/composer."),0}for(var r=!1,a=e.elements("part"),s=0,o=a.length;s<o;++s){for(var u=a[s].elements("measure"),l=0,c=u.length;l<c;++l){var d=u[l];if(d.element("print")){for(var f=d.element("print").elements("system-layout"),p=0,m=f.length;p<m;++p){var v=f[p];if(v.element("top-system-distance")){var g=v.element("top-system-distance").value;n=parseFloat(g),r=!0;break}}break}}if(r)break}if(e.element("defaults").element("system-layout")&&e.element("defaults").element("system-layout").element("top-system-distance")){var y=e.element("defaults").element("system-layout").element("top-system-distance").value;n=parseFloat(y)}return 0===n?0:t-n}},{key:"readTitle",value:function(e){var t,n=e.element("work");n&&(t=n.element("work-title"))&&t.value&&(this.musicSheet.Title=new x.Label(this.trimString(t.value)));var i=e.element("movement-title"),r="";if(i&&(this.musicSheet.Title?r=this.trimString(i.value):this.musicSheet.Title=new x.Label(this.trimString(i.value))),n){var a=n.element("work-number");if(a){var s=a.value;s&&(r=""===r?s:r+", "+s)}}r&&(this.musicSheet.Subtitle=new x.Label(r))}},{key:"createInstrumentGroups",value:function(e){var t,n=0,i={};try{for(var r=e,a=0,s=r.length;a<s;++a){var o=r[a];if("score-part"===o.name){var d=o.attribute("id").value,f=new u.Instrument(n,d,this.musicSheet,t);n++;for(var p=o.elements(),g=0,y=p.length;g<y;++g){var b=p[g];try{if("part-name"===b.name)f.Name=b.value,b.attribute("print-object")&&"no"===b.attribute("print-object").value&&(f.NameLabel.print=!1);else if("part-abbreviation"===b.name)f.PartAbbreviation=b.value;else if("score-instrument"===b.name){var x=new v.SubInstrument(f);x.idString=b.firstAttribute.value,f.SubInstruments.push(x);var _=b.element("instrument-name");_&&(x.name=_.value,x.setMidiInstrument(_.value))}else if("midi-instrument"===b.name){for(var E=f.getSubInstrument(b.firstAttribute.value),k=0,M=f.SubInstruments.length;k<M;++k){var w=f.SubInstruments[k];if(w.idString===b.value){E=w;break}}for(var P=b.elements(),T=0,C=P.length;T<C;++T){var I=P[T];try{if("midi-channel"===I.name)10===parseInt(I.value,10)&&(f.MidiInstrumentId=S.MidiInstrument.Percussion);else if("midi-program"===I.name)f.SubInstruments.length>0&&f.MidiInstrumentId!==S.MidiInstrument.Percussion&&(E.midiInstrumentID=Math.max(0,parseInt(I.value,10)-1));else if("midi-unpitched"===I.name)E.fixedKey=Math.max(0,parseInt(I.value,10));else if("volume"===I.name)try{var A=parseFloat(I.value);E.volume=A/127}catch(e){h.default.debug("ExpressionReader.readExpressionParameters","read volume",e)}else if("pan"===I.name)try{var L=parseFloat(I.value);E.pan=L/64}catch(e){h.default.debug("ExpressionReader.readExpressionParameters","read pan",e)}}catch(e){h.default.info("MusicSheetReader.createInstrumentGroups midi settings: ",e)}}}}catch(e){h.default.info("MusicSheetReader.createInstrumentGroups: ",e)}}if(0===f.SubInstruments.length){var O=new v.SubInstrument(f);f.SubInstruments.push(O)}i[d]=f,t?(t.InstrumentalGroups.push(f),this.musicSheet.Instruments.push(f)):(this.musicSheet.InstrumentalGroups.push(f),this.musicSheet.Instruments.push(f))}else if("part-group"===o.name&&"start"===o.attribute("type").value){var R=new m.InstrumentalGroup("group",this.musicSheet,t);t?t.InstrumentalGroups.push(R):this.musicSheet.InstrumentalGroups.push(R),t=R}else if("part-group"===o.name&&"stop"===o.attribute("type").value&&t){if(1===t.InstrumentalGroups.length){var N=t.InstrumentalGroups[0];t.Parent?(t.Parent.InstrumentalGroups.push(N),this._removeFromArray(t.Parent.InstrumentalGroups,t)):(this.musicSheet.InstrumentalGroups.push(N),this._removeFromArray(this.musicSheet.InstrumentalGroups,t))}t=t.Parent}}}catch(e){var B=l.ITextTranslation.translateText("ReaderErrorMessages/InstrumentError","Error while reading Instruments");throw new c.MusicSheetReadingException(B,e)}for(var D=0,F=this.musicSheet.Instruments.length;D<F;++D){var j=this.musicSheet.Instruments[D];j.Name||(j.Name="Instr. "+j.IdString)}return i}},{key:"getCompleteNumberOfStavesFromXml",value:function(e){var t,n=0,i=b(e);try{for(i.s();!(t=i.n()).done;){var r=t.value.elements("measure");if(r.length>0){var a=r[0];if(a){var s=a.element("attributes");s&&(s=s.element("staves")),s?n+=parseInt(s.value,10):n++}}}}catch(u){i.e(u)}finally{i.f()}if(isNaN(n)||n<=0){var o=l.ITextTranslation.translateText("ReaderErrorMessages/StaffError","Invalid number of staves.");throw new c.MusicSheetReadingException(o)}return n}},{key:"getInstrumentNumberOfStavesFromXml",value:function(e){var t=0,n=e.element("measure");if(n){var i,r=n.element("attributes");r&&(i=r.element("staves")),t=r&&i?parseInt(i.value,10):1}if(isNaN(t)||t<=0){var a=l.ITextTranslation.translateText("ReaderErrorMessages/StaffError","Invalid number of Staves.");throw new c.MusicSheetReadingException(a)}return t}}],[{key:"doCalculationsAfterDurationHasBeenSet",value:function(e){var t,n=b(e);try{for(n.s();!(t=n.n()).done;)t.value.doCalculationsAfterDurationHasBeenSet()}catch(i){n.e(i)}finally{n.f()}}}]),e}();t.MusicSheetReader=M},8736:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MusicSymbolModuleFactory=void 0;var i=n(9934),r=n(6789);t.MusicSymbolModuleFactory=function(){function e(){g(this,e)}return y(e,null,[{key:"createRepetitionInstructionReader",value:function(){return new i.RepetitionInstructionReader}},{key:"createRepetitionCalculator",value:function(){return new r.RepetitionCalculator}}]),e}()},7677:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ArticulationReader=void 0;var r=n(908),a=i(n(2043)),s=n(1357),o=n(5922),u=n(3748),l=n(8640),c=n(1662),h=n(6943),d=n(8084);t.ArticulationReader=function(){function e(t){g(this,e),this.rules=t}return y(e,[{key:"getAccEnumFromString",value:function(e){switch(e){case"sharp":return l.AccidentalEnum.SHARP;case"flat":return l.AccidentalEnum.FLAT;case"natural":return l.AccidentalEnum.NATURAL;case"double-sharp":case"sharp-sharp":return l.AccidentalEnum.DOUBLESHARP;case"double-flat":case"flat-flat":return l.AccidentalEnum.DOUBLEFLAT;case"triple-sharp":return l.AccidentalEnum.TRIPLESHARP;case"triple-flat":return l.AccidentalEnum.TRIPLEFLAT;case"quarter-sharp":return l.AccidentalEnum.QUARTERTONESHARP;case"quarter-flat":return l.AccidentalEnum.QUARTERTONEFLAT;case"three-quarters-sharp":return l.AccidentalEnum.THREEQUARTERSSHARP;case"three-quarters-flat":return l.AccidentalEnum.THREEQUARTERSFLAT;case"slash-quarter-sharp":return l.AccidentalEnum.SLASHQUARTERSHARP;case"slash-sharp":return l.AccidentalEnum.SLASHSHARP;case"double-slash-flat":return l.AccidentalEnum.DOUBLESLASHFLAT;case"sori":return l.AccidentalEnum.SORI;case"koron":return l.AccidentalEnum.KORON;default:return l.AccidentalEnum.NONE}}},{key:"addArticulationExpression",value:function(e,t){var n,i;if(void 0!==e&&e.elements().length>0)for(var s=e.elements(),o=0,l=s.length;o<l;++o){var f=s[o],p=f.name;try{p=p.replace("-","");var m=r.ArticulationEnum[p];if(r.VoiceEntry.isSupportedArticulation(m)){var v=u.PlacementEnum.NotYetDefined,g=null===(n=f.attribute("placement"))||void 0===n?void 0:n.value;"above"===g?v=u.PlacementEnum.Above:"below"===g&&(v=u.PlacementEnum.Below);var y=new c.Articulation(m,v);if("staccato"===p&&t.Articulations.length>0&&t.Articulations[0].articulationEnum!==r.ArticulationEnum.staccato&&t.Articulations.splice(0,0,y),"strongaccent"===p){var b=null===(i=null==f?void 0:f.attribute("type"))||void 0===i?void 0:i.value;"up"===b?y.articulationEnum=r.ArticulationEnum.marcatoup:"down"===b&&(y.articulationEnum=r.ArticulationEnum.marcatodown)}if(m===r.ArticulationEnum.softaccent){var S=t.ParentSourceStaffEntry.ParentStaff.Id-1;v===u.PlacementEnum.NotYetDefined&&(v=u.PlacementEnum.Above,S>0&&(v=u.PlacementEnum.Below));var x=t.ParentSourceStaffEntry.VerticalContainerParent.ParentMeasure,_=new h.MultiExpression(x,t.Timestamp);_.StartingContinuousDynamic=new d.ContinuousDynamicExpression(d.ContDynamicEnum.crescendo,v,S,x,null,-1),_.StartingContinuousDynamic.IsStartOfSoftAccent=!0,_.StartingContinuousDynamic.StartMultiExpression=_,_.StartingContinuousDynamic.EndMultiExpression=_,_.EndingContinuousDynamic=new d.ContinuousDynamicExpression(d.ContDynamicEnum.diminuendo,v,S,x,null,-1),_.EndingContinuousDynamic.StartMultiExpression=_,_.EndingContinuousDynamic.EndMultiExpression=_,x.StaffLinkedExpressions[S].push(_)}if(!t.hasArticulation(y))switch(t.Articulations.push(y),y.articulationEnum){case r.ArticulationEnum.staccato:case r.ArticulationEnum.staccatissimo:t.DurationModifier=y;break;case r.ArticulationEnum.accent:case r.ArticulationEnum.strongaccent:t.VolumeModifier=y}}}catch(e){var E="Invalid note articulation.";return void a.default.debug("addArticulationExpression",E,e)}}}},{key:"addFermata",value:function(e,t){var n,i=r.ArticulationEnum.fermata;e.attributes().length>0&&e.attribute("type")&&"inverted"===e.attribute("type").value&&(i=r.ArticulationEnum.invertedfermata);var a=u.PlacementEnum.Above;"below"===(null===(n=e.attribute("placement"))||void 0===n?void 0:n.value)&&(a=u.PlacementEnum.Below),t.Articulations.push(new c.Articulation(i,a))}},{key:"addTechnicalArticulations",value:function(e,t,n){var i,a,o={bend:r.ArticulationEnum.bend,"down-bow":r.ArticulationEnum.downbow,"open-string":r.ArticulationEnum.naturalharmonic,"snap-pizzicato":r.ArticulationEnum.snappizzicato,stopped:r.ArticulationEnum.lefthandpizzicato,"up-bow":r.ArticulationEnum.upbow};for(var l in o)if(o.hasOwnProperty(l)){var h=o[l],d=e.element(l);if(d){var f=void 0;"above"===(null===(i=d.attribute("placement"))||void 0===i?void 0:i.value)&&(f=u.PlacementEnum.Above),"below"===(null===(a=d.attribute("placement"))||void 0===a?void 0:a.value)&&(f=u.PlacementEnum.Below);var p=new c.Articulation(h,f);t.hasArticulation(p)||t.Articulations.push(p)}}var m=e.element("fingering");if(m){var v=this.createTechnicalInstruction(m,n);v.type=s.TechnicalInstructionType.Fingering,n.Fingering=v,t.TechnicalInstructions.push(v)}var g=e.element("string");if(g){var y=this.createTechnicalInstruction(g,n);y.type=s.TechnicalInstructionType.String,n.StringInstruction=y,t.TechnicalInstructions.push(y)}}},{key:"createTechnicalInstruction",value:function(e,t){var n=new s.TechnicalInstruction;n.sourceNote=t,n.value=e.value;var i=e.attribute("placement");return this.rules.FingeringPositionFromXML&&(n.placement=this.getPlacement(i)),n}},{key:"getPlacement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.PlacementEnum.NotYetDefined;if(t!==u.PlacementEnum.NotYetDefined)return t;if(!e)return u.PlacementEnum.NotYetDefined;switch(e.value){case"above":return u.PlacementEnum.Above;case"below":return u.PlacementEnum.Below;case"left":return u.PlacementEnum.Left;case"right":return u.PlacementEnum.Right;default:return u.PlacementEnum.NotYetDefined}}},{key:"addOrnament",value:function(e,t){if(e){var n,i={"delayed-inverted-turn":o.OrnamentEnum.DelayedInvertedTurn,"delayed-turn":o.OrnamentEnum.DelayedTurn,"inverted-mordent":o.OrnamentEnum.InvertedMordent,"inverted-turn":o.OrnamentEnum.InvertedTurn,mordent:o.OrnamentEnum.Mordent,"trill-mark":o.OrnamentEnum.Trill,turn:o.OrnamentEnum.Turn};for(var r in i)if(i.hasOwnProperty(r)){var a=e.element(r);if(a){n=new o.OrnamentContainer(i[r]);var s=a.attribute("placement");s&&"below"===s.value&&(n.placement=u.PlacementEnum.Below)}}if(n){var c=e.elements("accidental-mark");if(c)for(var h=u.PlacementEnum.Below,d=l.AccidentalEnum.NONE,f=c,p=0,m=f.length;p<m;++p){var v=f[p],g=v.value;d=this.getAccEnumFromString(g);var y=v.attribute("placement");v.hasAttributes&&y&&("above"===(g=y.value)?h=u.PlacementEnum.Above:"below"===g&&(h=u.PlacementEnum.Below)),h===u.PlacementEnum.Above?n.AccidentalAbove=d:h===u.PlacementEnum.Below&&(n.AccidentalBelow=d)}t.OrnamentContainer=n}}}}]),e}()},2905:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChordSymbolReader=void 0;var r=n(4123),a=n(8640),s=n(6331),o=i(n(2043));t.ChordSymbolReader=function(){function e(){g(this,e)}return y(e,null,[{key:"readChordSymbol",value:function(e,t,n){var i=e.element("root"),u=e.element("kind"),l=u.attribute("text");if(i&&u){var c=i.element("root-step"),h=i.element("root-alter");if(c){var d;try{d=a.NoteEnum[c.value.trim()]}catch(e){var f=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(f),void o.default.debug("InstrumentReader.readChordSymbol",f,e)}var p=a.AccidentalEnum.NONE;if(h)try{p=a.Pitch.AccidentalFromHalfTones(parseInt(h.value,10))}catch(e){var m=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");t.SheetErrors.pushMeasureError(m),o.default.debug("InstrumentReader.readChordSymbol",m,e)}var v,g,y=new a.Pitch(d,1,p),S=u.value.trim().replace("-","");if(l)switch(l.value){case"aug":S="augmented";break;case"dim":S="diminished"}try{v=r.ChordSymbolEnum[S]}catch(e){var x=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(x),void o.default.debug("InstrumentReader.readChordSymbol",x,e)}var _=e.element("bass");if(_){var E=_.element("bass-step"),k=_.element("bass-alter"),M=a.NoteEnum.C;if(E)try{M=a.NoteEnum[E.value.trim()]}catch(e){var w=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(w),void o.default.debug("InstrumentReader.readChordSymbol",w,e)}var P=a.AccidentalEnum.NONE;if(k)try{P=a.Pitch.AccidentalFromHalfTones(parseInt(k.value,10))}catch(e){var T=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");t.SheetErrors.pushMeasureError(T),o.default.debug("InstrumentReader.readChordSymbol",T,e)}g=new a.Pitch(M,1,P)}var C,I=[],A=e.elements("degree"),L=b(A);try{for(L.s();!(C=L.n()).done;){var O=C.value;if(O){var R=O.element("degree-value"),N=O.element("degree-alter"),B=O.element("degree-type");if(!R||!N||!B)return;var D=void 0,F=void 0,j=void 0;try{D=parseInt(R.value.trim(),10)}catch(e){var V=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(V),void o.default.debug("InstrumentReader.readChordSymbol",V,e)}try{F=a.Pitch.AccidentalFromHalfTones(parseInt(N.value,10))}catch(e){var G=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(G),void o.default.debug("InstrumentReader.readChordSymbol",G,e)}try{j=r.ChordDegreeText[B.value.trim().toLowerCase()]}catch(e){var W=s.ITextTranslation.translateText("ReaderErrorMessages/ChordSymbolError","Invalid chord symbol");return t.SheetErrors.pushMeasureError(W),void o.default.debug("InstrumentReader.readChordSymbol",W,e)}I.push(new r.Degree(D,F,j))}}}catch(U){L.e(U)}finally{L.f()}return new r.ChordSymbolContainer(y,v,g,I,t.Rules)}}}}]),e}()},8198:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicsCalculator=void 0;var i=n(5517),r=n(2343),a=function(){function e(){g(this,e)}return y(e,[{key:"calculate",value:function(t){e.fillDynamicExpressions(t)}}],[{key:"fillDynamicsList",value:function(e,t,n){for(var r=0;r<t.StaffLinkedExpressions.length;r++)for(var a=0,s=t.StaffLinkedExpressions[r].length;a<s;++a){var o=t.StaffLinkedExpressions[r][a];if(void 0!==o.InstantaneousDynamic||void 0!==o.StartingContinuousDynamic){if(o.StaffNumber=r,void 0!==o.StartingContinuousDynamic&&o.StartingContinuousDynamic.isWedge()&&void 0!==o.StartingContinuousDynamic.EndMultiExpression){var u=o.AbsoluteTimestamp,l=o.StartingContinuousDynamic.EndMultiExpression.AbsoluteTimestamp;if(u.Equals(l))continue}if(void 0!==o.InstantaneousDynamic){n[r].push(new i.DynamicsContainer(o.InstantaneousDynamic,o.StaffNumber));var c=this.getOtherStaffIndexIfLinkedStavesAreDetected(e,r,o.InstantaneousDynamic.Placement);c>=0&&n[c].push(new i.DynamicsContainer(o.InstantaneousDynamic,c))}if(void 0!==o.StartingContinuousDynamic){n[r].push(new i.DynamicsContainer(o.StartingContinuousDynamic,o.StaffNumber));var h=this.getOtherStaffIndexIfLinkedStavesAreDetected(e,r,o.StartingContinuousDynamic.Placement);h>=0&&n[h].push(new i.DynamicsContainer(o.StartingContinuousDynamic,h))}}}}},{key:"getOtherStaffIndexIfLinkedStavesAreDetected",value:function(e,t,n){var i=e.getStaffFromIndex(t),a=i.ParentInstrument.Staves.indexOf(i),s=i.ParentInstrument.Staves.length;return s>1&&0===a&&n===r.PlacementEnum.Below?t+1:s>1&&1===a&&n===r.PlacementEnum.Above?t-1:-1}},{key:"fillDynamicExpressions",value:function(t){for(var n=t.DynListStaves,a=t.getCompleteNumberOfStaves(),s=t.TimestampSortedDynamicExpressionsList,o=0;o<a;o++)n.push([]);for(var u=0,l=t.SourceMeasures.length;u<l;++u){var c=t.SourceMeasures[u];e.fillDynamicsList(t,c,n)}for(var h=0;h<n.length;h++)for(var d=0,f=n[h].length;d<f;++d){var p=n[h][d];(void 0===p.instantaneousDynamicExpression||r.InstantaneousDynamicExpression.dynamicToRelativeVolumeDict.containsKey(p.instantaneousDynamicExpression.DynEnum))&&s.push(p)}s.sort(i.DynamicsContainer.Compare)}}]),e}();t.DynamicsCalculator=a},4671:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionReader=void 0;var r=n(1797),a=n(6124),s=n(7839),o=n(280),u=n(9793),l=n(5853),c=n(6943),h=n(9667),d=n(7527),f=n(1614),p=n(3748),m=n(1274),v=n(6331),S=i(n(2043)),x=n(2562),_=n(7513),E=n(308),k=n(2163);t.ExpressionReader=function(){function e(t,n,i){g(this,e),this.openContinuousDynamicExpressions=[],this.musicSheet=t,this.staffNumber=i,this.globalStaffIndex=t.getGlobalStaffIndexOfFirstStaff(n)+(i-1),this.initialize()}return y(e,[{key:"readExpressionParameters",value:function(e,t,n,i,a,s,o){this.initialize();var u=e.element("offset");if(void 0!==u&&!o)try{this.offsetDivisions=parseInt(u.value,10)}catch(e){var l="ReaderErrorMessages/ExpressionOffsetError, Invalid expression offset -> set to default.";S.default.debug("ExpressionReader.readExpressionParameters",l,e),this.musicSheet.SheetErrors.pushMeasureError(l),this.offsetDivisions=0}this.directionTimestamp=r.Fraction.createFromFraction(i);var c,h=new r.Fraction(Math.abs(this.offsetDivisions),4*n);this.offsetDivisions>0?i.RealValue>0?(h=r.Fraction.multiply(r.Fraction.minus(i,a),h),this.directionTimestamp=r.Fraction.plus(h,i)):this.directionTimestamp=r.Fraction.createFromFraction(h):this.offsetDivisions<0&&(i.RealValue>0?(h=r.Fraction.multiply(r.Fraction.minus(i,a),h),this.directionTimestamp=r.Fraction.minus(i,h)):this.directionTimestamp=r.Fraction.createFromFraction(h));var d,f=e.element("direction-type");if(f&&(d=f.element("wedge"))){var m=d.attribute("default-y");m&&(c=this.readPosition(m))}this.WedgeYPosXml=c;var g=e.attribute("placement");if(g)try{var y=g.value;"below"===y?this.placement=p.PlacementEnum.Below:"above"===y&&(this.placement=p.PlacementEnum.Above)}catch(e){var b=v.ITextTranslation.translateText("ReaderErrorMessages/ExpressionPlacementError","Invalid expression placement -> set to default.");S.default.debug("ExpressionReader.readExpressionParameters",b,e),this.musicSheet.SheetErrors.pushMeasureError(b),this.placement=p.PlacementEnum.Below}if(this.placement===p.PlacementEnum.NotYetDefined)try{if(f){var x=f.element("dynamics");if(x){var _=x.attribute("default-y");_&&this.readExpressionPlacement(_,"read dynamics y pos")}if(d){var E=d.attribute("default-y");E&&this.readExpressionPlacement(E,"read wedge y pos")}var k=f.element("words");if(k){var M=k.attribute("default-y");M&&this.readExpressionPlacement(M,"read words y pos")}var w=f.element("rehearsal");if(w){var P=w.attribute("default-y");P&&this.readExpressionPlacement(P,"read rehearsal pos")}}}catch(e){var T=v.ITextTranslation.translateText("ReaderErrorMessages/ExpressionPlacementError","Invalid expression placement. Set to default.");S.default.debug("ExpressionReader.readExpressionParameters",T,e),this.musicSheet.SheetErrors.pushMeasureError(T),this.placement=p.PlacementEnum.Below}this.placement===p.PlacementEnum.NotYetDefined&&(t.Staves.length>1?this.placement=p.PlacementEnum.Below:t.HasLyrics?this.placement=p.PlacementEnum.Above:this.placement=p.PlacementEnum.Below)}},{key:"read",value:function(e,t,n,i){var a=!1,s=!1,o=e.element("sound");if(o){var u=o.attribute("tempo"),l=o.attribute("dynamics");if(u){var c=u.value.match(/^(\d+)(\.\d+)?$/);(null==c?void 0:c.length)>0?this.soundTempo=Math.round(Number.parseFloat(u.value)):(S.default.info("invalid xml tempo: "+u.value),this.soundTempo=100),t.TempoInBPM=this.soundTempo,0===this.musicSheet.DefaultStartTempoInBpm&&(this.musicSheet.DefaultStartTempoInBpm=this.soundTempo),this.musicSheet.HasBPMInfo=!0,a=!0}if(l){var d=l.value.match(/\d+/);this.soundDynamic=void 0!==d?parseInt(d[0],10):100,s=!0}}var f=e.element("direction-type");if(f){var p=f.element("metronome");if(p){var m=p.element("beat-unit"),v=void 0!==p.element("beat-unit-dot"),g=p.element("per-minute");if(void 0!==m&&g){p.hasAttributes&&void 0!==p.attribute("default-x")&&(this.directionTimestamp=r.Fraction.createFromFraction(n));var y=parseFloat(g.value);this.createNewTempoExpressionIfNeeded(t);var b=new h.InstantaneousTempoExpression(void 0,this.placement,this.staffNumber,y,this.currentMultiTempoExpression,!0);b.parentMeasure=t,this.soundTempo=y,"half"===m.value&&(this.soundTempo*=2),t.TempoInBPM=this.soundTempo*(v?1.5:1),0===this.musicSheet.DefaultStartTempoInBpm&&(this.musicSheet.DefaultStartTempoInBpm=this.soundTempo),this.musicSheet.HasBPMInfo=!0,b.dotted=v,b.beatUnit=m.value,this.currentMultiTempoExpression.addExpression(b,""),this.currentMultiTempoExpression.CombinedExpressionsText="test"}}else if(p=f.element("dynamics")){var x=void 0!==e.element("notations");this.interpretInstantaneousDynamics(p,t,n,x)}else if(p=f.element("words"))if(a){this.createNewTempoExpressionIfNeeded(t),this.currentMultiTempoExpression.CombinedExpressionsText=p.value;var _=new h.InstantaneousTempoExpression(p.value,this.placement,this.staffNumber,this.soundTempo,this.currentMultiTempoExpression);this.currentMultiTempoExpression.addExpression(_,"")}else s||this.interpretWords(p,t,n);else(p=f.element("wedge"))?this.interpretWedge(p,t,i,t.MeasureNumber):(p=f.element("rehearsal"))&&this.interpretRehearsalMark(p,t,n,t.MeasureNumber)}}},{key:"closeOpenExpressions",value:function(e,t){var n,i=b(this.openContinuousDynamicExpressions);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.createNewMultiExpressionIfNeeded(e,a.NumberXml,t),this.closeOpenContinuousDynamic(a,e,t)}}catch(s){i.e(s)}finally{i.f()}this.openContinuousTempoExpression&&this.closeOpenContinuousTempo(r.Fraction.plus(e.AbsoluteTimestamp,t))}},{key:"addOctaveShift",value:function(e,t,n){var i,r=1,a=e.element("staff");if(a)try{r=parseInt(a.value,10)}catch(e){var s=v.ITextTranslation.translateText("ReaderErrorMessages/OctaveShiftStaffError","Invalid octave shift staff number. Set to default");this.musicSheet.SheetErrors.pushMeasureError(s),r=1,S.default.debug("ExpressionReader.addOctaveShift",s,e)}var o=e.element("direction-type");if(o){var u=o.element("octave-shift"),c=this.readPlacement(e);if(void 0!==u&&u.hasAttributes)try{var h=this.readNumber(u);if(u.attribute("size")){var d=parseInt(u.attribute("size").value,10),f=0;8===d?f=1:15===d&&(f=2);var m=null===(i=u.attribute("type"))||void 0===i?void 0:i.value;if(m||(c===p.PlacementEnum.Above?m="down":c===p.PlacementEnum.Below&&(m="up")),"up"===m||"down"===m){var g=new l.OctaveShift(m,f);g.StaffNumber=r,this.getMultiExpression=this.createNewMultiExpressionIfNeeded(t,h),this.getMultiExpression.OctaveShiftStart=g,g.ParentStartMultiExpression=this.getMultiExpression,this.openOctaveShift=g}else"stop"===m?this.openOctaveShift&&(this.getMultiExpression=this.createNewMultiExpressionIfNeeded(t,this.openOctaveShift.numberXml,n),this.getMultiExpression.OctaveShiftEnd=this.openOctaveShift,this.openOctaveShift.ParentEndMultiExpression=this.getMultiExpression,this.openOctaveShift=void 0):m||S.default.debug("octave-shift missing type in xml")}}catch(e){var y=v.ITextTranslation.translateText("ReaderErrorMessages/OctaveShiftError","Error while reading octave shift.");this.musicSheet.SheetErrors.pushMeasureError(y),S.default.debug("ExpressionReader.addOctaveShift",y,e)}}}},{key:"addPedalMarking",value:function(e,t,n){var i,r,a,s=e.element("direction-type");if(s){var o=s.element("pedal");if(void 0!==o&&o.hasAttributes){var u=!1,l=!1;try{switch("yes"===(null===(i=o.attribute("line"))||void 0===i?void 0:i.value)?l=!0:"no"===(null===(r=o.attribute("line"))||void 0===r?void 0:r.value)?(l=!1,u=!0):"yes"===(null===(a=o.attribute("sign"))||void 0===a?void 0:a.value)?u=!0:(u=!1,l=!0),o.attribute("type").value){case"start":this.openPedal&&this.openPedal.IsLine&&this.endOpenPedal(t),this.createNewMultiExpressionIfNeeded(t,-1),this.openPedal=new E.Pedal(l,u),this.getMultiExpression.PedalStart=this.openPedal,this.openPedal.ParentStartMultiExpression=this.getMultiExpression;break;case"stop":this.openPedal&&this.endOpenPedal(t);break;case"change":this.openPedal&&this.openPedal.IsLine&&(this.openPedal.ChangeEnd=!0,this.createNewMultiExpressionIfNeeded(t,-1),this.getMultiExpression.PedalEnd=this.openPedal,this.openPedal.ParentEndMultiExpression=this.getMultiExpression,this.createNewMultiExpressionIfNeeded(t,-1),this.openPedal=new E.Pedal(l,u),this.openPedal.ChangeBegin=!0,this.getMultiExpression.PedalStart=this.openPedal,this.openPedal.ParentStartMultiExpression=this.getMultiExpression)}}catch(e){var c=v.ITextTranslation.translateText("ReaderErrorMessages/PedalError","Error while reading pedal.");this.musicSheet.SheetErrors.pushMeasureError(c),S.default.debug("ExpressionReader.addPedalMarking",c,e)}}}}},{key:"endOpenPedal",value:function(e){this.createNewMultiExpressionIfNeeded(e,-1),this.getMultiExpression.PedalEnd=this.openPedal,this.openPedal.ParentEndMultiExpression=this.getMultiExpression,this.openPedal=void 0}},{key:"addWavyLine",value:function(e,t,n,i){if(e&&e.hasAttributes)try{switch(e.attribute("type").value){case"start":this.createNewMultiExpressionIfNeeded(t,-1),this.openWavyLine=new k.WavyLine(this.placement),this.getMultiExpression.WavyLineStart=this.openWavyLine,this.openWavyLine.ParentStartMultiExpression=this.getMultiExpression;break;case"stop":this.openWavyLine&&(this.createNewMultiExpressionIfNeeded(t,-1,n),this.getMultiExpression.WavyLineEnd=this.openWavyLine,this.openWavyLine.ParentEndMultiExpression=this.getMultiExpression,this.openWavyLine=void 0)}}catch(e){var r=v.ITextTranslation.translateText("ReaderErrorMessages/WavyLineError","Error while reading wavy-line.");this.musicSheet.SheetErrors.pushMeasureError(r),S.default.debug("ExpressionReader.addWavyLine",r,e)}}},{key:"initialize",value:function(){this.placement=p.PlacementEnum.NotYetDefined,this.soundTempo=0,this.soundDynamic=0,this.offsetDivisions=0}},{key:"readPlacement",value:function(e){var t,n=null===(t=e.attribute("placement"))||void 0===t?void 0:t.value;return"above"===n?p.PlacementEnum.Above:"below"===n?p.PlacementEnum.Below:p.PlacementEnum.NotYetDefined}},{key:"readExpressionPlacement",value:function(e,t){try{var n=this.readPosition(e);n<0?this.placement=p.PlacementEnum.Below:n>0&&(this.placement=p.PlacementEnum.Above)}catch(e){S.default.debug("ExpressionReader.readExpressionParameters",t,e)}}},{key:"readPosition",value:function(e){try{var t=parseInt(e.value,10);return t<0?this.placement=p.PlacementEnum.Below:t>0&&(this.placement=p.PlacementEnum.Above),t}catch(e){S.default.debug("ExpressionReader.readExpressionParameters",e)}}},{key:"interpretInstantaneousDynamics",value:function(e,t,n,i){if(e.hasElements){e.hasAttributes&&e.attribute("default-x")&&(this.directionTimestamp=r.Fraction.createFromFraction(n));var a=this.readNumber(e),s=e.elements()[0].name;if("other-dynamics"===s&&(s=e.elements()[0].value),s){i?this.createNewMultiExpressionIfNeeded(t,a,r.Fraction.createFromFraction(n)):this.createNewMultiExpressionIfNeeded(t,a);var o=new u.InstantaneousDynamicExpression(s,this.soundDynamic,this.placement,this.staffNumber,t);o.InMeasureTimestamp=n.clone(),this.getMultiExpression.addExpression(o,""),this.initialize(),this.activeInstantaneousDynamic?this.activeInstantaneousDynamic.DynEnum=o.DynEnum:this.activeInstantaneousDynamic=new u.InstantaneousDynamicExpression(s,0,p.PlacementEnum.NotYetDefined,1,t)}}}},{key:"interpretWords",value:function(e,t,n){var i=e.value;if(!t.Rules.IgnoreBracketsWords||!/^\(\s*\)$/.test(i)&&!/^\[\s*\]$/.test(i)){var a,s=e.attribute("font-style");if(s&&"italic"===s.value&&(a=x.FontStyles.Italic),i.length>0){if(e.hasAttributes&&e.attribute("default-x")&&(this.directionTimestamp=r.Fraction.createFromFraction(n)),this.checkIfWordsNodeIsRepetitionInstruction(i))return;this.fillMultiOrTempoExpression(i,t,n,a),this.initialize()}}}},{key:"readNumber",value:function(e){var t,n=1,i=null===(t=e.attribute("number"))||void 0===t?void 0:t.value;return i&&(n=Number.parseInt(i,10)),n}},{key:"interpretWedge",value:function(e,t,n,i){var a,o;void 0!==e&&e.hasAttributes&&e.attribute("default-x")&&(this.directionTimestamp=r.Fraction.createFromFraction(n));var u=this.readNumber(e),l=null===(o=null===(a=e.attribute("type"))||void 0===a?void 0:a.value)||void 0===o?void 0:o.toLowerCase();this.lastWedge&&this.lastWedge.parentMeasure.MeasureNumberXML===t.MeasureNumberXML&&this.lastWedge.StaffNumber===this.staffNumber&&this.placement===this.lastWedge.Placement&&void 0!==this.WedgeYPosXml&&this.lastWedge.YPosXml===this.WedgeYPosXml&&this.lastWedge.StartMultiExpression.Timestamp.Equals(this.directionTimestamp)&&this.lastWedge.DynamicType===s.ContDynamicEnum[l]||("stop"===l?this.createNewMultiExpressionIfNeeded(t,u,n):this.createNewMultiExpressionIfNeeded(t,u),this.addWedge(e,t,n),this.initialize())}},{key:"interpretRehearsalMark",value:function(e,t,n,i){t.rehearsalExpression=new _.RehearsalExpression(e.value,this.placement)}},{key:"createNewMultiExpressionIfNeeded",value:function(e,t,n){n||(n=this.directionTimestamp);var i=this.getMultiExpression;return(!i||i&&(i.SourceMeasureParent!==e||i.numberXml!==t||i.SourceMeasureParent===e&&i.Timestamp!==n))&&(this.getMultiExpression=i=new c.MultiExpression(e,r.Fraction.createFromFraction(n)),e.StaffLinkedExpressions[this.globalStaffIndex].push(i)),i}},{key:"createNewTempoExpressionIfNeeded",value:function(e){this.currentMultiTempoExpression&&this.currentMultiTempoExpression.SourceMeasureParent===e&&this.currentMultiTempoExpression.Timestamp===this.directionTimestamp||(this.currentMultiTempoExpression=new a.MultiTempoExpression(e,r.Fraction.createFromFraction(this.directionTimestamp)),e.TempoExpressions.push(this.currentMultiTempoExpression))}},{key:"addWedge",value:function(e,t,n){if(void 0!==e&&e.hasAttributes){var i=this.readNumber(e),r=e.attribute("type").value.toLowerCase();try{if("crescendo"===r||"diminuendo"===r){var a=new s.ContinuousDynamicExpression(s.ContDynamicEnum[r],this.placement,this.staffNumber,t,this.activeInstantaneousDynamic,i);this.lastWedge=a,this.lastWedge.YPosXml=this.WedgeYPosXml,this.openContinuousDynamicExpressions.push(a);var o=this.getMultiExpression;o||(o=this.createNewMultiExpressionIfNeeded(t,i)),o.StartingContinuousDynamic=a,a.StartMultiExpression=o,void 0!==this.activeInstantaneousDynamic&&this.activeInstantaneousDynamic.StaffNumber===a.StaffNumber&&(this.activeInstantaneousDynamic=void 0)}else if("stop"===r){var u,l=b(this.openContinuousDynamicExpressions);try{for(l.s();!(u=l.n()).done;){var c=u.value;c.NumberXml===i&&c.NumberXml===i&&this.closeOpenContinuousDynamic(c,t,n)}}catch(d){l.e(d)}finally{l.f()}}}catch(e){var h="ReaderErrorMessages/WedgeError, Error while reading Crescendo / Diminuendo.";this.musicSheet.SheetErrors.pushMeasureError(h),S.default.debug("ExpressionReader.addWedge",h,e)}}}},{key:"fillMultiOrTempoExpression",value:function(e,t,n,i){if(e){var r=e.trim();this.createExpressionFromString("",r,t,n,e,i)}}},{key:"createExpressionFromString",value:function(e,t,n,i,r,a){if(h.InstantaneousTempoExpression.isInputStringInstantaneousTempo(t)||o.ContinuousTempoExpression.isInputStringContinuousTempo(t)){if(n.TempoExpressions.length>0)for(var u=0,l=n.TempoExpressions.length;u<l;++u){var c=n.TempoExpressions[u];if(c.Timestamp===this.directionTimestamp&&void 0!==c.InstantaneousTempo&&-1!==c.InstantaneousTempo.Label.indexOf(t))return!1}if(this.createNewTempoExpressionIfNeeded(n),this.currentMultiTempoExpression.CombinedExpressionsText=r,h.InstantaneousTempoExpression.isInputStringInstantaneousTempo(t)){var p=new h.InstantaneousTempoExpression(t,this.placement,this.staffNumber,this.soundTempo,this.currentMultiTempoExpression);return this.currentMultiTempoExpression.addExpression(p,e),!0}if(o.ContinuousTempoExpression.isInputStringContinuousTempo(t)){var v=new o.ContinuousTempoExpression(t,this.placement,this.staffNumber,this.currentMultiTempoExpression);return this.currentMultiTempoExpression.addExpression(v,e),!0}}if(s.ContinuousDynamicExpression.isInputStringContinuousDynamic(t)){var g=new s.ContinuousDynamicExpression(void 0,this.placement,this.staffNumber,n,this.activeInstantaneousDynamic,-1,t),y=this.getMultiExpression;return y&&this.closeOpenContinuousDynamic(y.StartingContinuousDynamic,n,i),this.createNewMultiExpressionIfNeeded(n,-1),void 0!==this.activeInstantaneousDynamic&&this.activeInstantaneousDynamic.StaffNumber===g.StaffNumber&&(this.activeInstantaneousDynamic=void 0),this.openContinuousDynamicExpressions.push(g),g.StartMultiExpression=this.getMultiExpression,this.getMultiExpression.addExpression(g,e),!0}if(d.MoodExpression.isInputStringMood(t)){var b=this.createNewMultiExpressionIfNeeded(n,-1);n.hasMoodExpressions=!0;var S=new d.MoodExpression(t,this.placement,this.staffNumber);return S.fontStyle=a,b.addExpression(S,e),!0}var x=this.createNewMultiExpressionIfNeeded(n,-1);if(n.TempoExpressions.length>0)for(var _=0,E=n.TempoExpressions.length;_<E;++_){var k=n.TempoExpressions[_];if(k.Timestamp===this.directionTimestamp&&void 0!==k.InstantaneousTempo&&k.EntriesList.length>0&&!this.hasDigit(t)&&this.globalStaffIndex>0){if(k.EntriesList[0].label.indexOf(t)>=0)return!1;break}}var M=m.TextAlignmentEnum.CenterBottom;this.musicSheet.Rules.CompactMode&&(M=m.TextAlignmentEnum.LeftBottom);var w=new f.UnknownExpression(t,this.placement,M,this.staffNumber);return w.fontStyle=a,x.addExpression(w,e),!1}},{key:"closeOpenContinuousDynamic",value:function(e,t,n){if(e){var i=e.NumberXml;e.EndMultiExpression=this.createNewMultiExpressionIfNeeded(t,i,n),e.StartMultiExpression.EndingContinuousDynamic=e,this.openContinuousDynamicExpressions=this.openContinuousDynamicExpressions.filter((function(t){return t!==e}))}}},{key:"closeOpenContinuousTempo",value:function(e){this.openContinuousTempoExpression.AbsoluteEndTimestamp=e,this.openContinuousTempoExpression=void 0}},{key:"checkIfWordsNodeIsRepetitionInstruction",value:function(e){return"coda"===(e=e.trim().toLowerCase())||"tocoda"===e||"to coda"===e||"fine"===e||"d.c."===e||"dacapo"===e||"da capo"===e||"d.s."===e||"dalsegno"===e||"dal segno"===e||"d.c. al fine"===e||"d.s. al fine"===e||"d.c. al coda"===e||"d.s. al coda"===e}},{key:"hasDigit",value:function(e){return/\d/.test(e)}}]),e}()},2535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LyricsReader=void 0;var i=n(2672),r=n(7274),a=n(6331);t.LyricsReader=function(){function e(t){g(this,e),this.openLyricWords={},this.musicSheet=t}return y(e,[{key:"addLyricEntry",value:function(e,t){var n,s;if(e){for(var o=e,u=0,l=o.length;u<l;++u){var c=o[u];try{var h="single";if(c.element("text")){var d=c.element("text");if(c.element("syllabic")&&(h=c.element("syllabic").value),d){var f,p="",m=c.elements(),v=b(m);try{for(v.s();!(f=v.n()).done;){var g=f.value;"text"!==g.name&&"elision"!==g.name||(p+=g.value)}}catch(R){v.e(R)}finally{v.f()}if(p=p.replace("  "," "),void 0!==c.element("elision")&&"-"===p){for(var y=c.elements(),S=void 0,x=void 0,_=0,E=0;E<y.length;E++)if("elision"===y[E].name){_=E;break}if(_>0)for(var k=_;k<y.length;k++){var M=y[k];"text"===M.name&&(S=M),"syllabic"===M.name&&(x=M)}void 0!==S&&x&&(d=S,h="middle")}var w=void 0,P=1,T=!1;if(void 0!==c.attributes()&&c.attribute("number")){try{P=parseInt(c.attribute("number").value,10)}catch(e){T=!0}if(T=T||isNaN(P))try{var C=c.attribute("number").value.toLowerCase().split("verse");C.length>1&&(P=parseInt(C[1],10))}catch(e){var I=a.ITextTranslation.translateText("ReaderErrorMessages/LyricVerseNumberError","Invalid lyric verse number");this.musicSheet.SheetErrors.pushMeasureError(I);continue}}if("single"===h||"end"===h){if(this.openLyricWords[P]){this.currentLyricWord=this.openLyricWords[P];var A=this.currentLyricWord.Syllables.length;w=new r.LyricsEntry(p,P,this.currentLyricWord,t,A),this.currentLyricWord.Syllables.push(w),delete this.openLyricWords[P],this.currentLyricWord=void 0}else w=new r.LyricsEntry(p,P,void 0,t);w.extend=void 0!==c.element("extend")}else if("begin"===h)this.openLyricWords[P]&&(delete this.openLyricWords[P],this.currentLyricWord=void 0),this.currentLyricWord=new i.LyricWord,this.openLyricWords[P]=this.currentLyricWord,w=new r.LyricsEntry(p,P,this.currentLyricWord,t,0),this.currentLyricWord.Syllables.push(w);else if("middle"===h)if(this.openLyricWords[P]){this.currentLyricWord=this.openLyricWords[P];var L=this.currentLyricWord.Syllables.length;w=new r.LyricsEntry(p,P,this.currentLyricWord,t,L),this.currentLyricWord.Syllables.push(w)}else w=new r.LyricsEntry(p,P,void 0,t);w&&(t.LyricsEntries[P]||(t.LyricsEntries.setValue(P,w),(null===(s=null===(n=t.ParentSourceStaffEntry)||void 0===n?void 0:n.VerticalContainerParent)||void 0===s?void 0:s.ParentMeasure)&&(t.ParentSourceStaffEntry.VerticalContainerParent.ParentMeasure.hasLyrics=!0)),t.ParentVoice.Parent.LyricVersesNumbers[P]||t.ParentVoice.Parent.LyricVersesNumbers.push(P))}}}catch(e){var O=a.ITextTranslation.translateText("ReaderErrorMessages/LyricError","Error while reading lyric entry.");this.musicSheet.SheetErrors.pushMeasureError(O);continue}}t.ParentVoice.Parent.LyricVersesNumbers=t.ParentVoice.Parent.LyricVersesNumbers.filter((function(e,t,n){return n.indexOf(e)===t}))}}}]),e}()},6789:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RepetitionBuildingContainer=t.RepetitionCalculator=void 0;var r=n(6189),a=n(6189),s=n(1703),o=n(4990),u=i(n(2043));t.RepetitionCalculator=function(){function e(){g(this,e),this.repetitionInstructions=[],this.openRepetitions=[],this.lastRepetitionCommonPartStartIndex=0}return y(e,[{key:"calculateRepetitions",value:function(e,t){this.musicSheet=e,this.repetitionInstructions=t,this.openRepetitions.length=0,this.lastRepetitionCommonPartStartIndex=0;var n,i=this.musicSheet.SourceMeasures,s=b(this.repetitionInstructions);try{for(s.s();!(n=s.n()).done;){var l=n.value;this.currentMeasureIndex=l.measureIndex;try{this.currentMeasure=i[this.currentMeasureIndex],this.handleRepetitionInstructions(l)}catch(e){u.default.error("RepetitionCalculator: calculateRepetitions",e)}}}catch(T){s.e(T)}finally{s.f()}for(;this.openRepetitions.length>0;)try{var c=this.openRepetitions.last();if(c.RepetitonUnderConstruction.FromWords){if(c.WaitingForCoda){var h=c.RepetitonUnderConstruction.BackwardJumpInstructions.last().measureIndex+1;h>=this.musicSheet.SourceMeasures.length&&(h=-1),c.RepetitonUnderConstruction.setEndingStartIndex(2,h)}else if(0===c.RepetitonUnderConstruction.BackwardJumpInstructions.length){this.openRepetitions.splice(this.openRepetitions.length-1,1);continue}}else if(0===c.RepetitonUnderConstruction.BackwardJumpInstructions.length){var d=i.length-1,f=new r.RepetitionInstruction(d,r.RepetitionInstructionEnum.BackJumpLine,r.AlignmentType.End,c.RepetitonUnderConstruction);c.RepetitonUnderConstruction.BackwardJumpInstructions.push(f),i[d].LastRepetitionInstructions.push(f)}this.finalizeRepetition(this.openRepetitions.last())}catch(e){try{var p,m=this.openRepetitions.last().RepetitonUnderConstruction,v=b(this.repetitionInstructions);try{for(v.s();!(p=v.n()).done;){var g=p.value;g.parentRepetition===m&&(g.parentRepetition=void 0)}}catch(T){v.e(T)}finally{v.f()}this.openRepetitions.splice(this.openRepetitions.length-1,1)}catch(e){u.default.error("RepetitionCalculator: calculateRepetitions2",e)}}var y,S=!1,x=this.musicSheet.SourceMeasures.length-1,_=b(this.musicSheet.Repetitions);try{for(_.s();!(y=_.n()).done;){var E=y.value;if(0===E.StartIndex&&E.EndIndex===x){S=!0;break}}}catch(T){_.e(T)}finally{_.f()}if(!S){var k=new o.Repetition(this.musicSheet,!0);k.FromWords=!0,k.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.StartLine),k.startMarker.parentRepetition=k,this.musicSheet.SourceMeasures[0].FirstRepetitionInstructions.push(k.startMarker),k.endMarker=new r.RepetitionInstruction(x,r.RepetitionInstructionEnum.BackJumpLine),k.endMarker.parentRepetition=k,k.BackwardJumpInstructions.push(k.endMarker),k.UserNumberOfRepetitions=k.DefaultNumberOfRepetitions,this.musicSheet.Repetitions.push(k)}for(var M=0,w=this.musicSheet.SourceMeasures.length;M<w;++M){var P=this.musicSheet.SourceMeasures[M];P.FirstRepetitionInstructions.length>1&&P.FirstRepetitionInstructions.sort(a.RepetitionInstructionComparer.Compare),P.LastRepetitionInstructions.length>1&&P.LastRepetitionInstructions.sort(a.RepetitionInstructionComparer.Compare)}}},{key:"handleRepetitionInstructions",value:function(e){var t;switch(e.type){case r.RepetitionInstructionEnum.StartLine:t=this.createNewRepetition(this.currentMeasureIndex),e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.FromWords=!1,t.RepetitonUnderConstruction.startMarker=e,this.currentMeasure.FirstRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.BackJumpLine:t=this.getOrCreateCurrentRepetition2(!1),e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e),0===t.RepetitonUnderConstruction.EndingParts.length&&this.finalizeRepetition(t);break;case r.RepetitionInstructionEnum.Ending:if(t=this.getOrCreateCurrentRepetition(),e.parentRepetition=t.RepetitonUnderConstruction,e.endingIndices.contains(1)&&e.alignment===r.AlignmentType.Begin){if(t.RepetitonUnderConstruction.BackwardJumpInstructions.length>0||t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)){t=void 0;for(var n=this.openRepetitions.length-1;n>=0;n--){var i=this.openRepetitions[n];if(0===i.RepetitonUnderConstruction.BackwardJumpInstructions.length)for(t=i;this.openRepetitions.length-1>n;){var a=this.openRepetitions.last();this.finalizeRepetition(a)}}void 0===t&&((t=this.createNewRepetition(0)).RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None))}void 0===t.RepetitonUnderConstruction.forwardJumpInstruction&&(t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(this.currentMeasureIndex-1,r.RepetitionInstructionEnum.ForwardJump,r.AlignmentType.End,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[this.currentMeasureIndex-1].LastRepetitionInstructions.push(t.RepetitonUnderConstruction.forwardJumpInstruction))}if(e.alignment===r.AlignmentType.Begin)t.RepetitonUnderConstruction.setEndingsStartIndex(e.endingIndices,this.currentMeasureIndex),this.currentMeasure.FirstRepetitionInstructions.push(e);else for(var o=0,u=e.endingIndices.length;o<u;++o){var l=e.endingIndices[o];t.RepetitonUnderConstruction.setEndingEndIndex(l,this.currentMeasureIndex),this.currentMeasure.LastRepetitionInstructions.push(e)}break;case r.RepetitionInstructionEnum.Segno:if(void 0!==(t=this.getCurrentRepetition(!0))&&t.SegnoFound&&t.RepetitonUnderConstruction.BackwardJumpInstructions.length>0&&Math.abs(t.RepetitonUnderConstruction.BackwardJumpInstructions.last().measureIndex-this.currentMeasureIndex)<=1)break;t=this.createNewRepetition(this.currentMeasureIndex),e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.FromWords=!0,t.SegnoFound=!0,t.RepetitonUnderConstruction.startMarker=e,this.currentMeasure.FirstRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.Fine:if(0===this.openRepetitions.length)break;if(void 0===(t=this.getCurrentRepetition(!0)))break;e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.FromWords=!0,void 0===t.RepetitonUnderConstruction.forwardJumpInstruction?(t.FineFound=!0,t.RepetitonUnderConstruction.forwardJumpInstruction=e,t.RepetitonUnderConstruction.setEndingStartIndex(2,-2),this.currentMeasure.LastRepetitionInstructions.push(e)):this.currentMeasure.LastRepetitionInstructions.push(new r.RepetitionInstruction(this.currentMeasureIndex,r.RepetitionInstructionEnum.Fine,r.AlignmentType.End,void 0));break;case r.RepetitionInstructionEnum.ToCoda:if(0===this.openRepetitions.length)break;if(void 0===(t=this.getCurrentRepetition(!0)))break;void 0===t.RepetitonUnderConstruction.forwardJumpInstruction&&(e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.FromWords=!0,t.ToCodaFound=!0,t.RepetitonUnderConstruction.forwardJumpInstruction=e,this.currentMeasure.LastRepetitionInstructions.push(e));break;case r.RepetitionInstructionEnum.Coda:if(0===this.openRepetitions.length)break;t=this.getOrCreateCurrentRepetition2(!0),e.parentRepetition=t.RepetitonUnderConstruction,t.WaitingForCoda?(t.CodaFound=!0,t.RepetitonUnderConstruction.setEndingStartIndex(2,this.currentMeasureIndex),this.currentMeasure.LastRepetitionInstructions.push(e),this.finalizeRepetition(t),this.currentMeasureIndex>0&&(this.musicSheet.SourceMeasures[this.currentMeasureIndex-1].printNewSystemXml=!0)):t.ToCodaFound||(0===t.RepetitonUnderConstruction.BackwardJumpInstructions.length?(t.ToCodaFound=!0,t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(this.currentMeasureIndex,r.RepetitionInstructionEnum.ToCoda,r.AlignmentType.End,t.RepetitonUnderConstruction),this.currentMeasure.LastRepetitionInstructions.push(t.RepetitonUnderConstruction.forwardJumpInstruction)):this.currentMeasure.LastRepetitionInstructions.push(new r.RepetitionInstruction(this.currentMeasureIndex,r.RepetitionInstructionEnum.Coda,r.AlignmentType.Begin,void 0)));break;case r.RepetitionInstructionEnum.DaCapo:(t=this.getOrCreateCurrentRepetition()).RepetitonUnderConstruction.BackwardJumpInstructions.length>0&&this.finalizeRepetition(t),0!==t.RepetitonUnderConstruction.StartIndex&&(t=this.createNewRepetition(0)),e.parentRepetition=t.RepetitonUnderConstruction,t.RepetitonUnderConstruction.FromWords=!0,t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e),0===t.RepetitonUnderConstruction.EndingParts.length&&this.finalizeRepetition(t);break;case r.RepetitionInstructionEnum.DalSegno:if((t=this.getOrCreateCurrentRepetition2(!0)).RepetitonUnderConstruction.BackwardJumpInstructions.length>0&&(this.finalizeRepetition(t),(t=this.createNewRepetition(0)).RepetitonUnderConstruction.FromWords=!0,t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,t.RepetitonUnderConstruction)),e.parentRepetition=t.RepetitonUnderConstruction,!t.SegnoFound){var c=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Segno,e.measureIndex);c>=0&&(t.SegnoFound=!0,t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(c,r.RepetitionInstructionEnum.Segno,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[c].FirstRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.startMarker))}t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)&&t.RepetitonUnderConstruction.setEndingEndIndex(1,this.currentMeasureIndex),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.DalSegnoAlFine:if(0===this.openRepetitions.length)break;if(t=this.getOrCreateCurrentRepetition2(!0),e.parentRepetition=t.RepetitonUnderConstruction,!t.SegnoFound){var h=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Segno,e.measureIndex);h>=0&&(t.SegnoFound=!0,t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(h,r.RepetitionInstructionEnum.Segno,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[h].FirstRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.startMarker))}if(!t.FineFound){var d=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Fine,e.measureIndex);d>=0&&(t.FineFound=!0,t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(d,r.RepetitionInstructionEnum.Fine,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.setEndingStartIndex(2,-2),this.musicSheet.SourceMeasures[d].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction))}t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)||t.RepetitonUnderConstruction.setEndingEndIndex(1,this.currentMeasureIndex),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.DaCapoAlFine:if((t=this.getOrCreateCurrentRepetition()).RepetitonUnderConstruction.BackwardJumpInstructions.length>0&&(this.finalizeRepetition(t),t=this.createNewRepetition(0)),void 0!==t.RepetitonUnderConstruction.startMarker&&0!==t.RepetitonUnderConstruction.StartIndex&&(t=this.createNewRepetition(0)),t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.FromWords=!0,e.parentRepetition=t.RepetitonUnderConstruction,!t.FineFound){var f=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Fine,e.measureIndex);f>=0&&(t.FineFound=!0,t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(f,r.RepetitionInstructionEnum.Fine,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.setEndingStartIndex(2,-2),this.musicSheet.SourceMeasures[f].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction))}t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)||t.RepetitonUnderConstruction.setEndingEndIndex(1,this.currentMeasureIndex),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.DalSegnoAlCoda:if(0===this.openRepetitions.length)break;if(t=this.getOrCreateCurrentRepetition2(!0),e.parentRepetition=t.RepetitonUnderConstruction,!t.SegnoFound){var p=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Segno,e.measureIndex);p>=0&&(t.SegnoFound=!0,t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(p,r.RepetitionInstructionEnum.Segno,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[p].FirstRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.startMarker))}if(!t.ToCodaFound){var m=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.ToCoda,e.measureIndex);if(m>=0)t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(m,r.RepetitionInstructionEnum.ToCoda,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[m].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction),t.ToCodaFound=!0;else{var v=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Coda,e.measureIndex);v>=0&&(t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(v,r.RepetitionInstructionEnum.ToCoda,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[v].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction),t.ToCodaFound=!0)}}t.ToCodaFound&&(t.WaitingForCoda=!0),t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)||t.RepetitonUnderConstruction.setEndingEndIndex(1,this.currentMeasureIndex),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.DaCapoAlCoda:if((t=this.getOrCreateCurrentRepetition()).RepetitonUnderConstruction.BackwardJumpInstructions.length>0?(this.finalizeRepetition(t),t=this.createNewRepetition(0)):0===t.RepetitonUnderConstruction.EndingParts.length&&(t=this.createNewRepetition(0)),void 0!==t.RepetitonUnderConstruction.startMarker&&0!==t.RepetitonUnderConstruction.StartIndex&&(t=this.createNewRepetition(0)),t.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.FromWords=!0,e.parentRepetition=t.RepetitonUnderConstruction,!t.ToCodaFound){var g=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.ToCoda,e.measureIndex);if(g>=0)t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(g,r.RepetitionInstructionEnum.ToCoda,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[g].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction),t.ToCodaFound=!0;else{var y=this.findInstructionInMainListBackwards(r.RepetitionInstructionEnum.Coda,e.measureIndex);y>=0&&(t.RepetitonUnderConstruction.forwardJumpInstruction=new r.RepetitionInstruction(y,r.RepetitionInstructionEnum.ToCoda,r.AlignmentType.Begin,t.RepetitonUnderConstruction),this.musicSheet.SourceMeasures[y].LastRepetitionInstructions.splice(0,0,t.RepetitonUnderConstruction.forwardJumpInstruction),t.ToCodaFound=!0)}}t.ToCodaFound&&(t.WaitingForCoda=!0),t.RepetitonUnderConstruction.EndingIndexDict.hasOwnProperty(1)||t.RepetitonUnderConstruction.setEndingEndIndex(1,this.currentMeasureIndex),t.RepetitonUnderConstruction.BackwardJumpInstructions.push(e),this.currentMeasure.LastRepetitionInstructions.push(e);break;case r.RepetitionInstructionEnum.None:break;default:throw new s.ArgumentOutOfRangeException("currentRepetitionInstruction")}return!0}},{key:"findInstructionInMainListBackwards",value:function(e,t){for(var n=this.repetitionInstructions.length-1;n>=0;n--){var i=this.repetitionInstructions[n];if(i.measureIndex<=t&&i.type===e)return i.measureIndex}return-1}},{key:"finalizeRepetition",value:function(e){var t=e.RepetitonUnderConstruction;if(t.BackwardJumpInstructions.length>0){var n=!0,i=this.getLastFinalizedRepetition();if(void 0!==i&&t.coversIdenticalMeasures(i)){if(t.NumberOfEndings>i.NumberOfEndings){var a=this.musicSheet.Repetitions.indexOf(i,0);a>-1&&this.musicSheet.Repetitions.splice(a,1),i.removeFromRepetitionInstructions(),this.musicSheet.Repetitions.push(t)}n=!1,t.removeFromRepetitionInstructions()}else this.musicSheet.Repetitions.push(t);n&&(t.startMarker.type===r.RepetitionInstructionEnum.None&&this.musicSheet.SourceMeasures[t.StartIndex].FirstRepetitionInstructions.push(t.startMarker),t.UserNumberOfRepetitions=t.DefaultNumberOfRepetitions)}this.openRepetitions.splice(this.openRepetitions.length-1,1)}},{key:"getCurrentRepetition",value:function(e){for(var t,n=this.openRepetitions.length-1;n>=0;n--)if(this.openRepetitions[n].RepetitonUnderConstruction.FromWords===e){for(t=this.openRepetitions[n];n<this.openRepetitions.length-1;)this.finalizeRepetition(this.openRepetitions.last());return t}return t}},{key:"getOrCreateCurrentRepetition",value:function(){if(this.openRepetitions.length>0)return this.openRepetitions.last();var e=this.createNewRepetition(0);return e.RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(0,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,e.RepetitonUnderConstruction),e}},{key:"getOrCreateCurrentRepetition2",value:function(e){for(var t,n=this.openRepetitions.length-1;n>=0;n--)if((t=this.openRepetitions[n]).RepetitonUnderConstruction.FromWords===e){for(;n<this.openRepetitions.length-1;)this.finalizeRepetition(this.openRepetitions.last());return t}return(t=this.createNewRepetition(this.lastRepetitionCommonPartStartIndex)).RepetitonUnderConstruction.startMarker=new r.RepetitionInstruction(this.lastRepetitionCommonPartStartIndex,r.RepetitionInstructionEnum.None,r.AlignmentType.Begin,t.RepetitonUnderConstruction),t.RepetitonUnderConstruction.FromWords=e,t}},{key:"createNewRepetition",value:function(e){if(this.openRepetitions.length>0){var t=this.openRepetitions.last(),n=t.RepetitonUnderConstruction;if(n.BackwardJumpInstructions.length>0){var i=Object.keys(n.EndingIndexDict);(0===i.length||n.EndingIndexDict[i[i.length-1]].part.EndIndex>=0)&&this.finalizeRepetition(t)}}var r=new l(this.musicSheet);return this.lastRepetitionCommonPartStartIndex=e,this.openRepetitions.push(r),r}},{key:"getLastFinalizedRepetition",value:function(){if(this.musicSheet.Repetitions.length>0)return this.musicSheet.Repetitions.last()}}]),e}();var l=function e(t){g(this,e),this.RepetitonUnderConstruction=new o.Repetition(t)};t.RepetitionBuildingContainer=l},9934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepetitionInstructionReader=void 0;var i=n(6189),r=n(6189),a=n(1211);t.RepetitionInstructionReader=function(){function e(){g(this,e)}return y(e,[{key:"MusicSheet",set:function(e){this.musicSheet=e,this.xmlMeasureList=new Array(this.musicSheet.Instruments.length),this.repetitionInstructions=[]}},{key:"prepareReadingMeasure",value:function(e,t){this.currentMeasureIndex=t}},{key:"handleLineRepetitionInstructions",value:function(e){var t=!1;if(e.elements().length>0){var n="",r=!1,a="",s="",o="",u=[],l=e.element("bar-style");l&&(o=l.value),n=e.attributes().length>0&&e.attribute("location")?e.attribute("location").value:"right";for(var c=e.elements(),h=0,d=c.length;h<d;++h){var f=c[h];if("repeat"===f.name&&f.hasAttributes)r=!0,a=f.attribute("direction").value;else if("ending"===f.name&&f.hasAttributes&&void 0!==f.attribute("type")&&f.attribute("number")){s=f.attribute("type").value;for(var p=f.attribute("number").value.split("[,+]"),m=0,v=p.length;m<v;++m){var g=p[m],y=g.match("[0-9]");if(-1!==g.search("-")&&2===y.length)for(var b=parseInt(y[0],10),S=parseInt(y[1],10),x=b;x<=S;x++)u.push(x);else for(var _=0,E=y.length;_<E;++_){var k=y[_];u.push(parseInt(k,10))}}}}if("light-heavy"!==o||0!==u.length||r||(t=!0),r||u.length>0)if("left"===n){if("start"===s){var M=new i.RepetitionInstruction(this.currentMeasureIndex,i.RepetitionInstructionEnum.Ending,i.AlignmentType.Begin,void 0,u);this.addInstruction(this.repetitionInstructions,M)}if("forward"===a){var w=new i.RepetitionInstruction(this.currentMeasureIndex,i.RepetitionInstructionEnum.StartLine);this.addInstruction(this.repetitionInstructions,w)}}else{if("stop"===s){var P=new i.RepetitionInstruction(this.currentMeasureIndex,i.RepetitionInstructionEnum.Ending,i.AlignmentType.End,void 0,u);this.addInstruction(this.repetitionInstructions,P)}if("backward"===a){var T=new i.RepetitionInstruction(this.currentMeasureIndex,i.RepetitionInstructionEnum.BackJumpLine);this.addInstruction(this.repetitionInstructions,T)}}}return t}},{key:"handleRepetitionInstructionsFromWordsOrSymbols",value:function(e,t){var n=e.element("words"),r=this.currentMeasureIndex;if(n){var s="d\\s?\\.s\\.",o=n.value.trim().toLowerCase();if(a.StringUtil.StringContainsSeparatedWord(o,s+" al fine",!0)){var u=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DalSegnoAlFine);return this.addInstruction(this.repetitionInstructions,u),!0}var l,c="d\\.\\s?c\\.";if(a.StringUtil.StringContainsSeparatedWord(o,c+" al coda",!0)){var h=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DalSegnoAlCoda);return this.addInstruction(this.repetitionInstructions,h),!0}if(a.StringUtil.StringContainsSeparatedWord(o,c+" al fine",!0)){var d=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DaCapoAlFine);return this.addInstruction(this.repetitionInstructions,d),!0}if(a.StringUtil.StringContainsSeparatedWord(o,c+" al coda",!0)){var f=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DaCapoAlCoda);return this.addInstruction(this.repetitionInstructions,f),!0}if(a.StringUtil.StringContainsSeparatedWord(o,c)||a.StringUtil.StringContainsSeparatedWord(o,"da\\s?capo",!0)){var p=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DaCapo);return this.addInstruction(this.repetitionInstructions,p),!0}if(a.StringUtil.StringContainsSeparatedWord(o,s,!0)||a.StringUtil.StringContainsSeparatedWord(o,"dal\\s?segno",!0))return l=a.StringUtil.StringContainsSeparatedWord(o,"al\\s?coda",!0)?new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DalSegnoAlCoda):new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.DalSegno),this.addInstruction(this.repetitionInstructions,l),!0;if(a.StringUtil.StringContainsSeparatedWord(o,"to\\s?coda",!0)||a.StringUtil.StringContainsSeparatedWord(o,"a (la )?coda",!0)){var m=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.ToCoda);return this.addInstruction(this.repetitionInstructions,m),!0}if(a.StringUtil.StringContainsSeparatedWord(o,"fine",!0)){var v=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.Fine);return this.addInstruction(this.repetitionInstructions,v),!0}if(a.StringUtil.StringContainsSeparatedWord(o,"coda",!0)){var g=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.Coda);return this.addInstruction(this.repetitionInstructions,g),!0}if(a.StringUtil.StringContainsSeparatedWord(o,"segno",!0)){var y=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.Segno);return this.addInstruction(this.repetitionInstructions,y),!0}}else{if(e.element("segno")){var b=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.Segno);return this.addInstruction(this.repetitionInstructions,b),!0}if(e.element("coda")){var S=new i.RepetitionInstruction(r,i.RepetitionInstructionEnum.Coda);return this.addInstruction(this.repetitionInstructions,S),!0}}return!1}},{key:"removeRedundantInstructions",value:function(){for(var e=0,t=0,n=0,a=0,s=0;s<this.repetitionInstructions.length;s++){var o=this.repetitionInstructions[s];switch(o.type){case i.RepetitionInstructionEnum.Coda:n>0&&this.findInstructionInPreviousMeasure(s,o.measureIndex,i.RepetitionInstructionEnum.ToCoda)&&(o.type=i.RepetitionInstructionEnum.None),0===t&&0===n&&(o.type=i.RepetitionInstructionEnum.ToCoda,o.alignment=i.AlignmentType.End,o.measureIndex--);break;case i.RepetitionInstructionEnum.Segno:if(e-a>0){for(var u=!1,l=0,c=this.repetitionInstructions.length;l<c;++l){var h=this.repetitionInstructions[l];if(o.measureIndex-h.measureIndex==1)switch(h.type){case i.RepetitionInstructionEnum.BackJumpLine:h.type=n-t>0?i.RepetitionInstructionEnum.DalSegnoAlCoda:i.RepetitionInstructionEnum.DalSegno,o.type=i.RepetitionInstructionEnum.None,u=!0;break;case i.RepetitionInstructionEnum.DalSegno:case i.RepetitionInstructionEnum.DalSegnoAlFine:case i.RepetitionInstructionEnum.DalSegnoAlCoda:o.type=i.RepetitionInstructionEnum.None,u=!0}if(u)break}if(u)break;o.type=n-t>0?i.RepetitionInstructionEnum.DalSegnoAlCoda:i.RepetitionInstructionEnum.DalSegno,o.alignment=i.AlignmentType.End,o.measureIndex--}}if(this.backwardSearchForPreviousIdenticalInstruction(s,o)||o.type===i.RepetitionInstructionEnum.None)this.repetitionInstructions.splice(s,1),s--;else switch(o.type){case i.RepetitionInstructionEnum.Fine:break;case i.RepetitionInstructionEnum.ToCoda:n++;break;case i.RepetitionInstructionEnum.Coda:t++;break;case i.RepetitionInstructionEnum.Segno:e++;break;case i.RepetitionInstructionEnum.DalSegnoAlFine:case i.RepetitionInstructionEnum.DalSegnoAlCoda:a++}}this.repetitionInstructions.sort(r.RepetitionInstructionComparer.Compare)}},{key:"findInstructionInPreviousMeasure",value:function(e,t,n){for(var i=e-1;i>=0;i--){var r=this.repetitionInstructions[i];if(t-r.measureIndex==1&&r.type===n)return!0}return!1}},{key:"backwardSearchForPreviousIdenticalInstruction",value:function(e,t){for(var n=e-1;n>=0;n--)if(this.repetitionInstructions[n].equals(t))return!0;return!1}},{key:"addInstruction",value:function(e,t){for(var n=!0,i=0,r=e.length;i<r;++i){var a=e[i];if(t.equals(a)){n=!1;break}}n&&e.push(t)}}]),e}()},3755:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SlurReader=void 0;var r=n(1928),a=i(n(2043)),s=n(6331),o=n(2343);t.SlurReader=function(){function e(t){g(this,e),this.openSlurDict={},this.musicSheet=t}return y(e,[{key:"addSlur",value:function(e,t){try{if(e){var n,i=b(e);try{for(i.s();!(n=i.n()).done;){var u=n.value;if(u.attributes().length>0){var l=u.attribute("type").value,c=1;try{u.attribute("number")&&(c=parseInt(u.attribute("number").value,10))}catch(e){a.default.debug("VoiceGenerator.addSlur number: ",e)}var h=o.PlacementEnum.NotYetDefined,d=u.attribute("placement");d&&d.value&&("above"===d.value?h=o.PlacementEnum.Above:"below"===d.value&&(h=o.PlacementEnum.Below));var f=u.attribute("orientation");if(f&&f.value&&("over"===f.value?h=o.PlacementEnum.Above:"under"===f.value&&(h=o.PlacementEnum.Below)),"start"===l){var p=this.openSlurDict[c];p||(p=new r.Slur,this.openSlurDict[c]=p),p.StartNote=t,p.PlacementXml=h}else if("stop"===l){var m=this.openSlurDict[c];m&&(m.EndNote=t,t.checkForDoubleSlur(m)||(t.NoteSlurs.push(m),m.StartNote.NoteSlurs.push(m)),delete this.openSlurDict[c])}}}}catch(g){i.e(g)}finally{i.f()}}}catch(e){var v=s.ITextTranslation.translateText("ReaderErrorMessages/SlurError","Error while reading slur.");this.musicSheet.SheetErrors.pushMeasureError(v)}}}]),e}()},1651:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(7677),t),r(n(2905),t),r(n(8198),t),r(n(4671),t),r(n(2535),t),r(n(6789),t),r(n(9934),t),r(n(3755),t)},2458:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReaderPluginManager=void 0;var r=i(n(2043));t.ReaderPluginManager=function(){function e(){g(this,e),this.voiceMeasureReadPlugins=[]}return y(e,[{key:"addVoiceMeasureReadPlugin",value:function(e){this.voiceMeasureReadPlugins.push(e)}},{key:"processVoiceMeasureReadPlugins",value:function(e,t,n){var i,a=b(this.voiceMeasureReadPlugins);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{s.measureReadCalculations(e,t,n)}catch(e){r.default.info("VoiceGenerator.addSingleNote: ",e)}}}catch(o){a.e(o)}finally{a.f()}}}]),e}()},8109:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceGenerator=void 0;var r=n(2947),a=n(3884),s=n(908),o=n(5253),u=n(9050),l=n(9224),c=n(4555),h=n(5544),d=n(8069),f=n(1797),p=n(6331),m=n(2535),v=n(1703),S=n(8640),_=n(8640),E=n(4447),k=i(n(2043)),M=n(8640),w=n(2337),P=n(7677),T=n(766),C=n(3029),I=n(2478),A=n(2953),L=n(3748);t.VoiceGenerator=function(){function e(t,n,i,s,o){g(this,e),this.openBeams=[],this.beamNumberOffset=0,this.currentOctaveShift=0,this.tupletDict={},this.openTupletNumber=0,this.currMeasureVoiceEntries=[],this.graceVoiceEntriesTempList=[],this.staff=n,this.instrument=n.ParentInstrument,this.musicSheet=this.instrument.GetMusicSheet,this.slurReader=s,this.pluginManager=t,this.voice=o?new r.LinkedVoice(this.instrument,i,o):new a.Voice(this.instrument,i),this.instrument.Voices.push(this.voice),this.staff.Voices.push(this.voice),this.lyricsReader=new m.LyricsReader(this.musicSheet),this.articulationReader=new P.ArticulationReader(this.musicSheet.Rules)}return y(e,[{key:"openTieDict",get:function(){return this.staff.openTieDict}},{key:"GetVoice",get:function(){return this.voice}},{key:"OctaveShift",get:function(){return this.currentOctaveShift},set:function(e){this.currentOctaveShift=e}},{key:"createVoiceEntry",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.activeKey=n,this.activeRhythm=i,this.currentVoiceEntry=new s.VoiceEntry(f.Fraction.createFromFraction(e),this.voice,t,!0,r,a,o),r?this.graceVoiceEntriesTempList.push(this.currentVoiceEntry):(this.currentNormalVoiceEntry=this.currentVoiceEntry,this.currMeasureVoiceEntries.push(this.currentNormalVoiceEntry),this.graceVoiceEntriesTempList.length>0&&(this.currentVoiceEntry.GraceVoiceEntriesBefore=this.graceVoiceEntriesTempList,this.graceVoiceEntriesTempList=[]))}},{key:"finalizeReadingMeasure",value:function(){this.graceVoiceEntriesTempList.length>0&&void 0!==this.currentNormalVoiceEntry&&this.currentNormalVoiceEntry.GraceVoiceEntriesAfter.concat(this.graceVoiceEntriesTempList),this.graceVoiceEntriesTempList=[],this.pluginManager.processVoiceMeasureReadPlugins(this.currMeasureVoiceEntries,this.activeKey,this.activeRhythm),this.currMeasureVoiceEntries.length=0,this.openBeams.length>1&&this.handleOpenBeam()}},{key:"read",value:function(e,t,n,i,r,a,s,o,u,l,c,d,f,m,v,g,y,S,x,_){this.currentStaffEntry=s,this.currentMeasure=o;try{this.currentNote=a?this.addRestNote(e.element("rest"),t,i,n,r,f,m,x):this.addSingleNote(e,t,i,n,r,c,d,f,m,v,g,y,S,x),this.currentNote.DotsXml=_;var E=e.elements("lyric");void 0!==this.lyricsReader&&E&&(this.lyricsReader.addLyricEntry(E,this.currentVoiceEntry),this.voice.Parent.HasLyrics=!0);var M=!1,w=e.element("notations");if(w){this.articulationReader&&this.readArticulations(w,this.currentVoiceEntry,this.currentNote);var P=w.elements("slur");void 0!==this.slurReader&&P.length>0&&!this.currentNote.ParentVoiceEntry.IsGrace&&this.slurReader.addSlur(P,this.currentNote);var T=w.elements("tuplet");T.length>0&&(this.openTupletNumber=this.addTuplet(e,T),M=!0);var I=w.element("arpeggiate");if(void 0!==I){var A;if(this.currentVoiceEntry.Arpeggio)A=this.currentVoiceEntry.Arpeggio;else{var L,O=!1,R=b(this.currentStaffEntry.VoiceEntries);try{for(R.s();!(L=R.n()).done;){var N=L.value;if(N.Arpeggio){O=!0,A=N.Arpeggio;break}}}catch(z){R.e(z)}finally{R.f()}if(!O){var B=C.ArpeggioType.ARPEGGIO_DIRECTIONLESS,D=I.attribute("direction");if(D)switch(D.value){case"up":B=C.ArpeggioType.ROLL_UP;break;case"down":B=C.ArpeggioType.ROLL_DOWN;break;default:B=C.ArpeggioType.ARPEGGIO_DIRECTIONLESS}A=new C.Arpeggio(this.currentVoiceEntry,B),this.currentVoiceEntry.Arpeggio=A}}A.addNote(this.currentNote)}var F=w.elements("tied");F.length>0&&this.addTie(F,u,l,h.TieTypes.SIMPLE);var j=w.elements("slide");j.length>0&&this.addTie(j,u,l,h.TieTypes.SLIDE);var V=w.element("technical");if(V){var G=V.elements("hammer-on");G.length>0&&this.addTie(G,u,l,h.TieTypes.HAMMERON);var W=V.elements("pull-off");W.length>0&&this.addTie(W,u,l,h.TieTypes.PULLOFF)}}void 0===e.element("time-modification")||M||this.handleTimeModificationNode(e)}catch(e){k.default.warn(e);var U=p.ITextTranslation.translateText("ReaderErrorMessages/NoteError","Ignored erroneous Note.");this.musicSheet.SheetErrors.pushMeasureError(U),this.musicSheet.SheetErrors.pushMeasureError(e)}return this.currentNote}},{key:"checkForStaffEntryLink",value:function(e,t,n,i){var r=new E.StaffEntryLink(this.currentVoiceEntry);r.LinkStaffEntries.push(n),n.Link=r;var a=this.currentVoiceEntry.Timestamp.clone(),s=i.getVerticalContainerByTimestamp(a);return(n=s.StaffEntries[e])||(n=new u.SourceStaffEntry(s,t),s.StaffEntries[e]=n),n.VoiceEntries.push(this.currentVoiceEntry),r.LinkStaffEntries.push(n),n.Link=r,n}},{key:"checkForOpenBeam",value:function(){this.openBeams.length>0&&this.currentNote&&this.handleOpenBeam()}},{key:"checkOpenTies",value:function(){var e=this.openTieDict;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];f.Fraction.plus(n.StartNote.ParentStaffEntry.Timestamp,n.Duration).lt(n.StartNote.SourceMeasure.Duration)&&delete e[t]}}},{key:"hasVoiceEntry",value:function(){return void 0!==this.currentVoiceEntry}},{key:"readArticulations",value:function(e,t,n){var i=e.element("articulations");i&&this.articulationReader.addArticulationExpression(i,t);var r=e.element("fermata");r&&this.articulationReader.addFermata(r,t);var a=e.element("technical");a&&this.articulationReader.addTechnicalArticulations(a,t,n);var s=e.element("ornaments");s&&this.articulationReader.addOrnament(s,t)}},{key:"addSingleNote",value:function(e,t,n,i,r,a,u,l,c,h,d,m,g,y){for(var b,E,w,P,C=0,I=S.AccidentalEnum.NONE,L=_.NoteEnum.C,O=_.NoteEnum.C,R=0,N=0,B=e.elements(),D=0,F=B.length;D<F;++D){var j=B[D];try{if("pitch"===j.name)for(var V=j.elements(),G=0,W=V.length;G<W;++G){var U=V[G];w=void 0,P=void 0;try{if("step"===U.name){if(void 0===(L=_.NoteEnum[U.value])){var z=p.ITextTranslation.translateText("ReaderErrorMessages/NotePitchError","Invalid pitch while reading note.");throw this.musicSheet.SheetErrors.pushMeasureError(z),new v.MusicSheetReadingException(z,void 0)}}else if("alter"===U.name){if(C=parseFloat(U.value),isNaN(C)){var H=p.ITextTranslation.translateText("ReaderErrorMessages/NoteAlterationError","Invalid alteration while reading note.");throw this.musicSheet.SheetErrors.pushMeasureError(H),new v.MusicSheetReadingException(H,void 0)}I=M.Pitch.AccidentalFromHalfTones(C)}else if("octave"===U.name&&(R=parseInt(U.value,10),isNaN(R))){var X=p.ITextTranslation.translateText("ReaderErrorMessages/NoteOctaveError","Invalid octave value while reading note.");throw this.musicSheet.SheetErrors.pushMeasureError(X),new v.MusicSheetReadingException(X,void 0)}}catch(e){k.default.info("VoiceGenerator.addSingleNote read Step: ",e.message)}}else if("accidental"===j.name)"natural"===(b=j.value)?I=S.AccidentalEnum.NATURAL:"slash-flat"===b?I=S.AccidentalEnum.SLASHFLAT:"slash-quarter-sharp"===b?I=S.AccidentalEnum.SLASHQUARTERSHARP:"slash-sharp"===b?I=S.AccidentalEnum.SLASHSHARP:"double-slash-flat"===b?I=S.AccidentalEnum.DOUBLESLASHFLAT:"sori"===b?I=S.AccidentalEnum.SORI:"koron"===b&&(I=S.AccidentalEnum.KORON);else if("unpitched"===j.name){var Y=j.element("display-step"),K=j.element("display-octave");if(K&&(N=(R=parseInt(K.value,10))-3,u&&(R+=1),1===this.instrument.Staves[0].StafflineCount&&(N+=1)),Y){var q,Z;L=_.NoteEnum[Y.value.toUpperCase()];var J=this.musicSheet.Rules.PercussionXMLDisplayStepNoteValueShift;1===this.instrument.Staves[0].StafflineCount&&(J-=3),q=M.Pitch.lineShiftFromNoteEnum(L,J),O=(Z=x(q,2))[0],N+=Z[1]}}else"instrument"===j.name?j.firstAttribute&&(E=j.firstAttribute.value):"notehead"===j.name&&(w=j.value,j.attribute("filled")&&(P="yes"===j.attribute("filled").value))}catch(e){k.default.info("VoiceGenerator.addSingleNote: ",e)}}R-=M.Pitch.OctaveXmlDifference;var Q,$=new M.Pitch(L,R,I,b),ee=f.Fraction.createFromFraction(t),te=-1,ne=-1,ie=[],re=e.element("notations");if(re){var ae=re.element("technical");if(ae){var se=ae.element("string");se&&(te=parseInt(se.value,10));var oe=ae.element("fret");oe&&(ne=parseInt(oe.value,10)),ae.elements("bend").forEach((function(e){var t=e.element("bend-alter");void 0!==e.element("release")?ie.push({bendalter:parseInt(t.value,10),direction:"down"}):ie.push({bendalter:parseInt(t.value,10),direction:"up"})}))}}return Q=te<0||ne<0?new o.Note(this.currentVoiceEntry,this.currentStaffEntry,ee,$,this.currentMeasure):new A.TabNote(this.currentVoiceEntry,this.currentStaffEntry,ee,$,this.currentMeasure,te,ne,ie),this.addNoteInfo(Q,n,l,c,r,O,N,y,y),Q.TypeLength=i,Q.IsGraceNote=h,Q.StemDirectionXml=d,Q.TremoloStrokes=m,Q.PlaybackInstrumentId=E,(void 0!==w&&"normal"!==w||void 0!==P)&&(Q.Notehead=new T.Notehead(Q,w,P)),Q.NoteheadColorXml=y,Q.NoteheadColor=y,Q.PlaybackInstrumentId=E,this.currentVoiceEntry.addNote(Q),d===s.StemDirectionType.None&&(g="#00000000"),this.currentVoiceEntry.StemDirectionXml=d,g&&(this.currentVoiceEntry.StemColorXml=g,this.currentVoiceEntry.StemColor=g,Q.StemColorXml=g),e.elements("beam")&&!a&&this.createBeam(e,Q),Q}},{key:"addRestNote",value:function(e,t,n,i,r,a,s,u){var l,c,h,d=f.Fraction.createFromFraction(t),p=e.element("display-step"),m=e.element("display-octave");p&&m&&(l=_.NoteEnum[p.value.toUpperCase()],c=parseInt(m.value,10),h=new M.Pitch(l,c,S.AccidentalEnum.NONE));var v=new o.Note(this.currentVoiceEntry,this.currentStaffEntry,d,h,this.currentMeasure,!0);return this.addNoteInfo(v,n,a,s,r,l,c,u,u),v.TypeLength=i,this.currentVoiceEntry.Notes.push(v),this.openBeams.length>0&&this.openBeams.last().ExtendedNoteList.push(v),v}},{key:"addNoteInfo",value:function(e,t,n,i,r,a,s,o,u){e.NoteTypeXml=t,e.PrintObject=n,e.IsCueNote=i,e.NormalNotes=r,e.displayStepUnpitched=a,e.displayOctaveUnpitched=s,e.NoteheadColorXml=o,e.NoteheadColor=o}},{key:"createBeam",value:function(e,t){var n;try{var i,r=e.element("beam");if(void 0!==r&&r.hasAttributes&&(i=r.attribute("number")),i){var a=parseInt(i.value,10),s=e.elements("beam"),o=s[0].value;s&&("begin"===o?(a===(null===(n=this.openBeams.last())||void 0===n?void 0:n.BeamNumber)?(this.beamNumberOffset++,a+=this.beamNumberOffset):this.openBeams.last()&&this.handleOpenBeam(),this.openBeams.push(new l.Beam(a,this.beamNumberOffset))):a+=this.beamNumberOffset);var u=!1;if(!(a>0&&a<=this.openBeams.length&&this.openBeams[a-1]))return void k.default.debug("[OSMD] invalid beamnumber");for(var c=0,h=this.openBeams[a-1].Notes.length;c<h;++c){var d=this.openBeams[a-1].Notes[c];this.currentVoiceEntry===d.ParentVoiceEntry&&(u=!0)}u||(this.openBeams[a-1].addNoteToBeam(t),"end"===o&&this.endBeam())}}catch(e){var f=p.ITextTranslation.translateText("ReaderErrorMessages/BeamError","Error while reading beam.");throw this.musicSheet.SheetErrors.pushMeasureError(f),new v.MusicSheetReadingException("",e)}}},{key:"endBeam",value:function(){this.openBeams.pop(),this.beamNumberOffset=Math.max(0,this.beamNumberOffset-1)}},{key:"handleOpenBeam",value:function(){var e=this.openBeams.last();if(0!==e.Notes.length){if(1===e.Notes.length)return e.Notes[0].NoteBeam=void 0,void this.endBeam();if(this.currentNote===w.CollectionUtil.last(e.Notes))this.endBeam();else{var t=w.CollectionUtil.last(e.Notes).ParentStaffEntry,n=this.currentMeasure.getVerticalContainerIndexByTimestamp(t.Timestamp),i=t.VerticalContainerParent.StaffEntries.indexOf(t);if(n<this.currentMeasure.VerticalSourceStaffEntryContainers.length-1){var r=this.currentMeasure.VerticalSourceStaffEntryContainers[n+1].StaffEntries[i];if(r)for(var a=0,s=r.VoiceEntries.length;a<s;++a){var o=r.VoiceEntries[a];if(o.ParentVoice===this.voice){var u=o.Notes[0];u.Length.lte(new f.Fraction(1,8))?(this.openBeams.last().addNoteToBeam(u),this.endBeam()):this.endBeam()}}}else this.endBeam()}}else this.endBeam()}},{key:"addTuplet",value:function(e,t){var n=!1;if(void 0!==t&&t.length>1){var i=e.element("time-modification");i&&(i=i.element("actual-notes"));for(var r=t,a=0,o=r.length;a<o;++a){var u=r[a];if(void 0!==u&&u.attributes()){var l=u.attribute("bracket");l&&"yes"===l.value&&(n=!0);var c=u.attribute("type");if(c&&"start"===c.value){var h=1;u.attribute("number")&&(h=parseInt(u.attribute("number").value,10));var f=0;if(i&&(f=parseInt(i.value,10),isNaN(f))){var m=p.ITextTranslation.translateText("ReaderErrorMessages/TupletNoteDurationError","Invalid tuplet note duration.");throw this.musicSheet.SheetErrors.pushMeasureError(m),new v.MusicSheetReadingException(m,void 0)}var g=new d.Tuplet(f,n);g.tupletLabelNumberPlacement=L.PlacementEnum.Above;var y=u.attribute("placement");y&&("below"===y.value&&(g.tupletLabelNumberPlacement=L.PlacementEnum.Below),g.PlacementFromXml=!0),this.tupletDict[h]&&(delete this.tupletDict[h],0===Object.keys(this.tupletDict).length?this.openTupletNumber=0:Object.keys(this.tupletDict).length>1&&this.openTupletNumber--),this.tupletDict[h]=g;var S=[];S.push(this.currentNote),g.Notes.push(S),g.Fractions.push(this.getTupletNoteDurationFromType(e)),this.currentNote.NoteTuplet=g,this.openTupletNumber=h}else if("stop"===c.value){var x=1;u.attribute("number")&&(x=parseInt(u.attribute("number").value,10));var _=this.tupletDict[x];if(_){var E=u.attribute("placement");E&&("below"===E.value?_.tupletLabelNumberPlacement=L.PlacementEnum.Below:_.tupletLabelNumberPlacement=L.PlacementEnum.Above,_.PlacementFromXml=!0);var k=[];if(k.push(this.currentNote),_.Notes.push(k),!_.PlacementFromXml){var M,w=!1,P=b(_.Notes);try{for(P.s();!(M=P.n()).done;){var T,C=M.value,I=b(C);try{for(I.s();!(T=I.n()).done;){var A=T.value;if(!A.isRest()){A.StemDirectionXml===s.StemDirectionType.Down?_.tupletLabelNumberPlacement=L.PlacementEnum.Below:_.tupletLabelNumberPlacement=L.PlacementEnum.Above,w=!0;break}}}catch(ee){I.e(ee)}finally{I.f()}if(w)break}}catch(ee){P.e(ee)}finally{P.f()}}_.Fractions.push(this.getTupletNoteDurationFromType(e)),this.currentNote.NoteTuplet=_,delete this.tupletDict[x],0===Object.keys(this.tupletDict).length?this.openTupletNumber=0:Object.keys(this.tupletDict).length>1&&this.openTupletNumber--}}}}}else if(t[0]){var O=t[0];if(O.hasAttributes){var R=O.attribute("type").value,N=1;O.attribute("number")&&(N=parseInt(O.attribute("number").value,10));var B=isNaN(N),D=O.attribute("bracket");if(D&&"yes"===D.value&&(n=!0),"start"===R){var F=0,j=e.element("time-modification");if(j&&(j=j.element("actual-notes")),j&&(F=parseInt(j.value,10),isNaN(F))){var V=p.ITextTranslation.translateText("ReaderErrorMessages/TupletNoteDurationError","Invalid tuplet note duration.");throw this.musicSheet.SheetErrors.pushMeasureError(V),new v.MusicSheetReadingException(V)}B&&(this.openTupletNumber++,N=this.openTupletNumber);var G=this.tupletDict[N];G||((G=this.tupletDict[N]=new d.Tuplet(F,n)).tupletLabelNumberPlacement=L.PlacementEnum.Above);var W=O.attribute("placement");W&&("below"===W.value?G.tupletLabelNumberPlacement=L.PlacementEnum.Below:G.tupletLabelNumberPlacement=L.PlacementEnum.Above,G.PlacementFromXml=!0);var U=[];U.push(this.currentNote),G.Notes.push(U),G.Fractions.push(this.getTupletNoteDurationFromType(e)),this.currentNote.NoteTuplet=G,this.openTupletNumber=N}else if("stop"===R){B&&(N=this.openTupletNumber);var z=this.tupletDict[this.openTupletNumber];if(z){var H=O.attribute("placement");H&&("below"===H.value?z.tupletLabelNumberPlacement=L.PlacementEnum.Below:z.tupletLabelNumberPlacement=L.PlacementEnum.Above,z.PlacementFromXml=!0);var X=[];if(X.push(this.currentNote),z.Notes.push(X),!z.PlacementFromXml){var Y,K=!1,q=b(z.Notes);try{for(q.s();!(Y=q.n()).done;){var Z,J=Y.value,Q=b(J);try{for(Q.s();!(Z=Q.n()).done;){var $=Z.value;if(!$.isRest()){$.StemDirectionXml===s.StemDirectionType.Down?z.tupletLabelNumberPlacement=L.PlacementEnum.Below:z.tupletLabelNumberPlacement=L.PlacementEnum.Above,K=!0;break}}}catch(ee){Q.e(ee)}finally{Q.f()}if(K)break}}catch(ee){q.e(ee)}finally{q.f()}}z.Fractions.push(this.getTupletNoteDurationFromType(e)),this.currentNote.NoteTuplet=z,0===Object.keys(this.tupletDict).length?this.openTupletNumber=0:Object.keys(this.tupletDict).length>1&&this.openTupletNumber--,delete this.tupletDict[N]}}}}return this.openTupletNumber}},{key:"handleTimeModificationNode",value:function(e){if(this.tupletDict[this.openTupletNumber])try{var t,n=this.tupletDict[this.openTupletNumber],i=w.CollectionUtil.last(n.Notes);i[0].ParentVoiceEntry.Timestamp.Equals(this.currentVoiceEntry.Timestamp)?t=i:(t=[],n.Notes.push(t),n.Fractions.push(this.getTupletNoteDurationFromType(e))),t.push(this.currentNote),this.currentNote.NoteTuplet=n}catch(e){var r=p.ITextTranslation.translateText("ReaderErrorMessages/TupletNumberError","Invalid tuplet number.");throw this.musicSheet.SheetErrors.pushMeasureError(r),e}else if(this.currentVoiceEntry.Notes.length>0){var a=this.currentVoiceEntry.Notes[0];if(a.NoteTuplet){var s=a.NoteTuplet;w.CollectionUtil.last(s.Notes).push(this.currentNote),this.currentNote.NoteTuplet=s}}}},{key:"addTie",value:function(e,t,n,i){if(e)if(1===e.length){var r=e[0];if(void 0!==r&&r.attributes()){var a=this.getTieDirection(r),s=r.attribute("type").value;try{if("start"===s){var o=this.findCurrentNoteInTieDict(this.currentNote);o<0&&delete this.openTieDict[o];var u=this.getNextAvailableNumberForTie(),l=new c.Tie(this.currentNote,i);this.openTieDict[u]=l,l.TieNumber=u,l.TieDirection=a}else if("stop"===s){var h=this.findCurrentNoteInTieDict(this.currentNote),d=this.openTieDict[h];d&&(d.AddNote(this.currentNote),delete this.openTieDict[h])}}catch(e){var f=p.ITextTranslation.translateText("ReaderErrorMessages/TieError","Error while reading tie.");this.musicSheet.SheetErrors.pushMeasureError(f)}}}else if(2===e.length){var m=this.findCurrentNoteInTieDict(this.currentNote);if(m>=0){var v=this.openTieDict[m];v.AddNote(this.currentNote);var g,y=b(e);try{for(y.s();!(g=y.n()).done;){var S=g.value;if("start"===S.attribute("type").value){var x=this.getTieDirection(S);v.NoteIndexToTieDirection[v.Notes.length-1]=x}}}catch(_){y.e(_)}finally{y.f()}}}}},{key:"getTieDirection",value:function(e){var t=L.PlacementEnum.NotYetDefined,n=e.attribute("placement");n&&("above"===n.value?t=L.PlacementEnum.Above:"below"===n.value&&(t=L.PlacementEnum.Below));var i=e.attribute("orientation");return i&&("over"===i.value?t=L.PlacementEnum.Above:"under"===i.value&&(t=L.PlacementEnum.Below)),t}},{key:"getNextAvailableNumberForTie",value:function(){var e=Object.keys(this.openTieDict);if(0===e.length)return 1;e.sort((function(e,t){return+e-+t}));for(var t=0;t<e.length;t++)if(""+(t+1)!==e[t])return t+1;return+e[e.length-1]+1}},{key:"findCurrentNoteInTieDict",value:function(e){var t=this.openTieDict;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],r=i.Notes[0],a=e;if(i.Pitch.FundamentalNote===e.Pitch.FundamentalNote&&i.Pitch.Octave===e.Pitch.Octave)return parseInt(n,10);if(void 0!==r.StringNumberTab&&r.StringNumberTab===a.StringNumberTab)return parseInt(n,10)}return-1}},{key:"getTupletNoteDurationFromType",value:function(e){if(e.element("type")){var t=e.element("type");if(t){var n=t.value;try{return I.NoteTypeHandler.getNoteDurationFromType(n)}catch(e){var i=p.ITextTranslation.translateText("ReaderErrorMessages/NoteDurationError","Invalid note duration.");throw this.musicSheet.SheetErrors.pushMeasureError(i),new v.MusicSheetReadingException("",e)}}}}}]),e}()},9714:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(2393),t),r(n(1372),t),r(n(8736),t),r(n(8109),t),r(n(1651),t),r(n(2458),t)},5142:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SubInstrument=void 0;var r=n(289),a=i(n(2043)),s=function(){function e(t){g(this,e),this.parentInstrument=t,this.fixedKey=-1,this.name=this.parseMidiInstrument(this.parentInstrument.Name),this.midiInstrumentID=e.midiInstrument[this.name],this.volume=1}return y(e,[{key:"ParentInstrument",get:function(){return this.parentInstrument}},{key:"setMidiInstrument",value:function(t){this.midiInstrumentID=e.midiInstrument[this.parseMidiInstrument(t)]}},{key:"parseMidiInstrument",value:function(t){try{if(t){var n=t.toLowerCase().trim();for(var i in e.midiInstrument)if(-1!==n.indexOf(i))return i}if(this.parentInstrument.Name){var r=this.parentInstrument.Name.toLowerCase().trim();for(var s in e.midiInstrument)if(-1!==r.indexOf(s))return s}}catch(t){a.default.error("Error parsing MIDI Instrument. Default to Grand Piano.")}return"unnamed"}}],[{key:"isPianoInstrument",value:function(e){return e===r.MidiInstrument.Acoustic_Grand_Piano||e===r.MidiInstrument.Bright_Acoustic_Piano||e===r.MidiInstrument.Electric_Grand_Piano||e===r.MidiInstrument.Electric_Piano_1||e===r.MidiInstrument.Electric_Piano_2}}]),e}();t.SubInstrument=s,s.midiInstrument={alt:r.MidiInstrument.Synth_Voice,alto:r.MidiInstrument.Synth_Voice,banjo:r.MidiInstrument.Banjo,bariton:r.MidiInstrument.Synth_Voice,baritone:r.MidiInstrument.Synth_Voice,bass:r.MidiInstrument.Synth_Voice,"blockfl\xf6te":r.MidiInstrument.Recorder,brass:r.MidiInstrument.Trombone,bratsche:r.MidiInstrument.Viola,cello:r.MidiInstrument.Cello,clarinet:r.MidiInstrument.Clarinet,contrabass:r.MidiInstrument.Contrabass,drums:r.MidiInstrument.Percussion,flute:r.MidiInstrument.Flute,"fl\xf6te":r.MidiInstrument.Flute,frenchhorn:r.MidiInstrument.French_Horn,gitarre:r.MidiInstrument.Acoustic_Guitar_nylon,guitar:r.MidiInstrument.Acoustic_Guitar_nylon,harfe:r.MidiInstrument.Orchestral_Harp,harp:r.MidiInstrument.Orchestral_Harp,klarinette:r.MidiInstrument.Clarinet,klavier:r.MidiInstrument.Acoustic_Grand_Piano,kontrabass:r.MidiInstrument.Contrabass,oboe:r.MidiInstrument.Oboe,organ:r.MidiInstrument.Church_Organ,orgel:r.MidiInstrument.Church_Organ,orgue:r.MidiInstrument.Church_Organ,percussion:r.MidiInstrument.Percussion,piano:r.MidiInstrument.Acoustic_Grand_Piano,piccolo:r.MidiInstrument.Piccolo,posaune:r.MidiInstrument.Trombone,recorder:r.MidiInstrument.Recorder,sax:r.MidiInstrument.Tenor_Sax,schlagwerk:r.MidiInstrument.Percussion,schlagzeug:r.MidiInstrument.Percussion,sopran:r.MidiInstrument.Synth_Voice,steeldrum:r.MidiInstrument.Steel_Drums,streicher:r.MidiInstrument.String_Ensemble_1,strings:r.MidiInstrument.String_Ensemble_1,tenor:r.MidiInstrument.Synth_Voice,tpt:r.MidiInstrument.Trumpet,trombone:r.MidiInstrument.Trombone,trompete:r.MidiInstrument.Trumpet,trumpet:r.MidiInstrument.Trumpet,tuba:r.MidiInstrument.Tuba,unnamed:r.MidiInstrument.Acoustic_Grand_Piano,viola:r.MidiInstrument.Viola,violin:r.MidiInstrument.Violin,"violon-c":r.MidiInstrument.Cello,"violon.":r.MidiInstrument.Violin,voice:r.MidiInstrument.Synth_Voice,woodblock:r.MidiInstrument.Woodblock}},3029:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ArpeggioType=t.Arpeggio=void 0,t.Arpeggio=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.ARPEGGIO_DIRECTIONLESS;g(this,e),this.parentVoiceEntry=t,this.type=i,this.notes=[]}return y(e,[{key:"addNote",value:function(e){this.notes.push(e),e.Arpeggio=this}}]),e}(),function(e){e[e.BRUSH_DOWN=1]="BRUSH_DOWN",e[e.BRUSH_UP=2]="BRUSH_UP",e[e.ROLL_DOWN=3]="ROLL_DOWN",e[e.ROLL_UP=4]="ROLL_UP",e[e.RASQUEDO_DOWN=5]="RASQUEDO_DOWN",e[e.RASQUEDO_UP=6]="RASQUEDO_UP",e[e.ARPEGGIO_DIRECTIONLESS=7]="ARPEGGIO_DIRECTIONLESS"}(n=t.ArpeggioType||(t.ArpeggioType={}))},1662:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Articulation=void 0,t.Articulation=function(){function e(t,n){g(this,e),this.articulationEnum=t,this.placement=n}return y(e,[{key:"Equals",value:function(e){return e.articulationEnum===this.articulationEnum&&e.placement===this.placement}}]),e}()},9224:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.BeamEnum=t.Beam=void 0,t.Beam=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;g(this,e),this.notes=[],this.extendedNoteList=[],this.BeamNumberOffsetToXML=0,this.BeamNumber=t,this.BeamNumberOffsetToXML=n}return y(e,[{key:"Notes",get:function(){return this.notes},set:function(e){this.notes=e}},{key:"ExtendedNoteList",get:function(){return this.extendedNoteList},set:function(e){this.extendedNoteList=e}},{key:"addNoteToBeam",value:function(e){e&&(e.NoteBeam=this,this.notes.push(e),this.extendedNoteList.push(e))}}]),e}(),(n=t.BeamEnum||(t.BeamEnum={}))[n.BeamNone=-1]="BeamNone",n[n.BeamBegin=0]="BeamBegin",n[n.BeamContinue=1]="BeamContinue",n[n.BeamEnd=2]="BeamEnd",n[n.BeamForward=3]="BeamForward",n[n.BeamBackward=4]="BeamBackward"},4123:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChordSymbolEnum=t.ChordDegreeText=t.CustomChord=t.Degree=t.ChordSymbolContainer=void 0;var i=n(8640),r=n(4040),a=n(8640);t.ChordSymbolContainer=function(){function e(t,n,i,r,a){g(this,e),this.rootPitch=t,this.chordKind=n,this.bassPitch=i,this.degrees=r,this.rules=a}return y(e,[{key:"RootPitch",get:function(){return this.rootPitch}},{key:"ChordKind",get:function(){return this.chordKind}},{key:"BassPitch",get:function(){return this.bassPitch}},{key:"ChordDegrees",get:function(){return this.degrees}},{key:"getTextForAccidental",value:function(e){var t=this.rules.ChordAccidentalTexts.getValue(e);return void 0!==t?t:""}},{key:"getTextFromChordKindEnum",value:function(e){var t;return null!==(t=this.rules.ChordSymbolLabelTexts.getValue(e))&&void 0!==t?t:""}}],[{key:"calculateChordText",value:function(e,t,n){var u=e.RootPitch;if(r.MusicSheetCalculator.transposeCalculator&&(u=r.MusicSheetCalculator.transposeCalculator.transposePitch(e.RootPitch,n,t)),e.ChordKind===o.none)return e.getTextFromChordKindEnum(e.ChordKind);var l=i.Pitch.getNoteEnumString(u.FundamentalNote);u.Accidental!==a.AccidentalEnum.NONE&&(l+=e.getTextForAccidental(u.Accidental));var c,h={adds:[],alts:[],subs:[]},d=b(e.ChordDegrees);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(f){var p="";switch(f.alteration!==a.AccidentalEnum.NONE&&(p+=e.getTextForAccidental(f.alteration)),p+=f.value,f.text){case s.add:h.adds.push(p);break;case s.alter:h.alts.push(p);break;case s.subtract:h.subs.push(p)}}}}catch(B){d.e(B)}finally{d.f()}var m,v=e.getTextFromChordKindEnum(e.ChordKind),g=["adds","alts","subs"],y=e.rules.CustomChords,S=b(y);try{for(S.s();!(m=S.n()).done;){var x=m.value;if(x.chordKind===e.chordKind){var _,E=!0,k=b(g);try{for(k.s();!(_=k.n()).done;){var M,w=_.value,P=b(x.degrees[w]||[]);try{for(P.s();!(M=P.n()).done;){var T=M.value;if(h[w].indexOf(T)<0){E=!1;break}}}catch(B){P.e(B)}finally{P.f()}if(!E)break}}catch(B){k.e(B)}finally{k.f()}if(E){var C,I=b(g);try{for(I.s();!(C=I.n()).done;){var A,L=C.value,O=b(x.degrees[L]||[]);try{for(O.s();!(A=O.n()).done;){var R=A.value;h[L].splice(h[L].indexOf(R),1)}}catch(B){O.e(B)}finally{O.f()}}}catch(B){I.e(B)}finally{I.f()}v=x.alternateName}}}}catch(B){S.e(B)}finally{S.f()}if(l+=v,h.adds.length>0&&(l+="("+h.adds.join(",")+")"),h.alts.length>0&&(l+="(alt "+h.alts.join(",")+")"),h.subs.length>0&&(l+="(omit "+h.subs.join(",")+")"),e.BassPitch){var N=e.BassPitch;r.MusicSheetCalculator.transposeCalculator&&(N=r.MusicSheetCalculator.transposeCalculator.transposePitch(e.BassPitch,n,t)),l+="/",l+=i.Pitch.getNoteEnumString(N.FundamentalNote),l+=e.getTextForAccidental(N.Accidental)}return l}}]),e}(),t.Degree=function(){function e(t,n,i){g(this,e),this.value=t,this.alteration=n,this.text=i}return e}();var s,o,u=function(){function e(t,n,i){g(this,e),this.alternateName=t,this.chordKind=n,this.degrees=i}return y(e,null,[{key:"createCustomChord",value:function(t,n,i){return new e(t,n,i)}},{key:"renameCustomChord",value:function(e,t,n){var i,r=b(n);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.alternateName===e&&(a.alternateName=t)}}catch(s){r.e(s)}finally{r.f()}}}]),e}();t.CustomChord=u,function(e){e[e.add=0]="add",e[e.alter=1]="alter",e[e.subtract=2]="subtract"}(s=t.ChordDegreeText||(t.ChordDegreeText={})),function(e){e[e.major=0]="major",e[e.minor=1]="minor",e[e.augmented=2]="augmented",e[e.diminished=3]="diminished",e[e.dominant=4]="dominant",e[e.majorseventh=5]="majorseventh",e[e.minorseventh=6]="minorseventh",e[e.diminishedseventh=7]="diminishedseventh",e[e.augmentedseventh=8]="augmentedseventh",e[e.halfdiminished=9]="halfdiminished",e[e.majorminor=10]="majorminor",e[e.majorsixth=11]="majorsixth",e[e.minorsixth=12]="minorsixth",e[e.dominantninth=13]="dominantninth",e[e.majorninth=14]="majorninth",e[e.minorninth=15]="minorninth",e[e.dominant11th=16]="dominant11th",e[e.major11th=17]="major11th",e[e.minor11th=18]="minor11th",e[e.dominant13th=19]="dominant13th",e[e.major13th=20]="major13th",e[e.minor13th=21]="minor13th",e[e.suspendedsecond=22]="suspendedsecond",e[e.suspendedfourth=23]="suspendedfourth",e[e.Neapolitan=24]="Neapolitan",e[e.Italian=25]="Italian",e[e.French=26]="French",e[e.German=27]="German",e[e.pedal=28]="pedal",e[e.power=29]="power",e[e.Tristan=30]="Tristan",e[e.none=31]="none"}(o=t.ChordSymbolEnum||(t.ChordSymbolEnum={}))},3748:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementEnum=t.AbstractExpression=void 0,t.AbstractExpression=function(){function e(t){g(this,e),this.placement=t}return y(e,[{key:"Placement",get:function(){return this.placement}}],[{key:"isStringInStringList",value:function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n];if(t.toLowerCase()===r.toLowerCase().trim())return!0}return!1}},{key:"PlacementEnumFromString",value:function(e){switch(e.toLowerCase()){case"above":return n.Above;case"below":return n.Below;case"aboveorbelow":case"abovebelow":return n.AboveOrBelow;case"left":return n.Left;case"right":return n.Right;default:return n.NotYetDefined}}}]),e}(),function(e){e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.NotYetDefined=4]="NotYetDefined",e[e.AboveOrBelow=5]="AboveOrBelow"}(n=t.PlacementEnum||(t.PlacementEnum={}))},9775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTempoExpression=void 0;var i=function(e){h(n,e);var t=d(n);function n(e,i,r,a){var s;return g(this,n),(s=t.call(this,i)).label=e,s.staffNumber=r,s.parentMultiTempoExpression=a,s}return y(n,[{key:"Label",get:function(){return this.label},set:function(e){this.label=e}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"ParentMultiTempoExpression",get:function(){return this.parentMultiTempoExpression}}],[{key:"isStringInStringList",value:function(e,t){var i,r=b(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(n.stringContainsSeparatedWord(t.toLowerCase().trim(),a.toLowerCase().trim()))return!0}}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"stringContainsSeparatedWord",value:function(e,t){return e===t||-1!==e.indexOf(" "+t)||-1!==e.indexOf(t+" ")}}]),n}(n(3748).AbstractExpression);t.AbstractTempoExpression=i},7839:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContDynamicEnum=t.ContinuousDynamicExpression=void 0;var i,r=n(3748),s=n(1797),o=function(e){h(n,e);var t=d(n);function n(e,i,r,s,o,l){var h,d,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return g(this,n),d=t.call(this,i),a((h=c(d),u(n.prototype)),"parentMeasure",s,h,!0),d.NumberXml=l,d.dynamicType=e,d.label=f,d.staffNumber=r,d.activeInstantaneousDynamic=o,d.startVolume=1,d.endVolume=1,d.setStartAndEndVolume(),""!==f&&d.setType(),d}return y(n,[{key:"setStartAndEndVolume",value:function(){this.activeInstantaneousDynamic&&(this.dynamicType===i.crescendo&&(this.startVolume=this.activeInstantaneousDynamic.Volume,this.endVolume=1.2*this.activeInstantaneousDynamic.Volume),this.dynamicType===i.diminuendo&&(this.startVolume=this.activeInstantaneousDynamic.Volume,this.endVolume=.8*this.activeInstantaneousDynamic.Volume))}},{key:"DynamicType",get:function(){return this.dynamicType},set:function(e){this.dynamicType=e}},{key:"StartMultiExpression",get:function(){return this.startMultiExpression},set:function(e){this.startMultiExpression=e}},{key:"EndMultiExpression",get:function(){return this.endMultiExpression},set:function(e){this.endMultiExpression=e}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"StartVolume",get:function(){return this.startVolume},set:function(e){this.startVolume=e}},{key:"EndVolume",get:function(){return this.endVolume},set:function(e){this.endVolume=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"Label",get:function(){return this.label},set:function(e){this.label=e,this.setType()}},{key:"getInterpolatedDynamic",value:function(e){var t,n=this.StartMultiExpression.AbsoluteTimestamp;if(t=this.EndMultiExpression?this.EndMultiExpression.AbsoluteTimestamp:s.Fraction.plus(this.startMultiExpression.SourceMeasureParent.AbsoluteTimestamp,this.startMultiExpression.SourceMeasureParent.Duration),e.lt(n))return-1;if(t.lt(e))return-2;var i=s.Fraction.minus(e,n).RealValue/s.Fraction.minus(t,n).RealValue;return Math.max(0,Math.min(99.9,this.startVolume+(this.endVolume-this.startVolume)*i))}},{key:"isWedge",value:function(){return!this.label}},{key:"setType",value:function(){n.isStringInStringList(n.listContinuousDynamicIncreasing,this.label)?this.dynamicType=i.crescendo:n.isStringInStringList(n.listContinuousDynamicDecreasing,this.label)&&(this.dynamicType=i.diminuendo)}}],[{key:"isInputStringContinuousDynamic",value:function(e){return!!e&&(n.isStringInStringList(n.listContinuousDynamicIncreasing,e)||n.isStringInStringList(n.listContinuousDynamicDecreasing,e))}}]),n}(r.AbstractExpression);t.ContinuousDynamicExpression=o,o.listContinuousDynamicIncreasing=["crescendo","cresc","cresc.","cres."],o.listContinuousDynamicDecreasing=["decrescendo","decresc","decr.","diminuendo","dim.","dim"],function(e){e[e.crescendo=0]="crescendo",e[e.diminuendo=1]="diminuendo"}(i=t.ContDynamicEnum||(t.ContDynamicEnum={}))},280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContinuousTempoType=t.ContinuousTempoExpression=void 0;var i,r=n(1797),a=function(e){h(n,e);var t=d(n);function n(e,i,r,a){var s;return g(this,n),(s=t.call(this,e,i,r,a)).setTempoType(),s}return y(n,[{key:"TempoType",get:function(){return this.tempoType},set:function(e){this.tempoType=e}},{key:"StartTempo",get:function(){return this.startTempo},set:function(e){this.startTempo=e}},{key:"EndTempo",get:function(){return this.endTempo},set:function(e){this.endTempo=e}},{key:"AbsoluteEndTimestamp",get:function(){return this.absoluteEndTimestamp},set:function(e){this.absoluteEndTimestamp=e}},{key:"AbsoluteTimestamp",get:function(){return this.ParentMultiTempoExpression.AbsoluteTimestamp}},{key:"getAbsoluteFloatTimestamp",value:function(){return this.ParentMultiTempoExpression.AbsoluteTimestamp.RealValue}},{key:"getInterpolatedTempo",value:function(e){var t=r.Fraction.plus(this.parentMultiTempoExpression.SourceMeasureParent.AbsoluteTimestamp,this.parentMultiTempoExpression.Timestamp);if(e.lt(t))return-1;if(this.absoluteEndTimestamp.lt(e))return-2;var n=r.Fraction.minus(e,t).RealValue/r.Fraction.minus(this.absoluteEndTimestamp,t).RealValue;return Math.max(0,Math.min(250,this.startTempo+(this.endTempo-this.startTempo)*n))}},{key:"setTempoType",value:function(){n.isStringInStringList(n.listContinuousTempoFaster,this.label)?this.tempoType=i.accelerando:n.isStringInStringList(n.listContinuousTempoSlower,this.label)&&(this.tempoType=i.ritardando)}}],[{key:"isInputStringContinuousTempo",value:function(e){return!!e&&(n.isStringInStringList(n.listContinuousTempoFaster,e)||n.isStringInStringList(n.listContinuousTempoSlower,e))}},{key:"isIncreasingTempo",value:function(e){return e<=i.piuMosso}},{key:"isDecreasingTempo",value:function(e){return e>=i.allargando&&e<=i.ritenuto}}]),n}(n(9775).AbstractTempoExpression);t.ContinuousTempoExpression=a,a.listContinuousTempoFaster=["accelerando","piu mosso","poco piu","stretto"],a.listContinuousTempoSlower=["poco meno","meno mosso","piu lento","calando","allargando","rallentando","ritardando","ritenuto","ritard.","ritard","rit.","rit","riten.","riten"],function(e){e[e.accelerando=0]="accelerando",e[e.stretto=1]="stretto",e[e.stringendo=2]="stringendo",e[e.mosso=3]="mosso",e[e.piuMosso=4]="piuMosso",e[e.allargando=5]="allargando",e[e.calando=6]="calando",e[e.menoMosso=7]="menoMosso",e[e.rallentando=8]="rallentando",e[e.ritardando=9]="ritardando",e[e.ritard=10]="ritard",e[e.rit=11]="rit",e[e.ritenuto=12]="ritenuto",e[e.rubato=13]="rubato",e[e.precipitando=14]="precipitando"}(i=t.ContinuousTempoType||(t.ContinuousTempoType={}))},5853:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OctaveEnum=t.OctaveShift=void 0;var i,r=n(8640);t.OctaveShift=function(){function e(t,n){g(this,e),this.numberXml=1,this.setOctaveShiftValue(t,n)}return y(e,[{key:"Type",get:function(){return this.octaveValue},set:function(e){this.octaveValue=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"ParentStartMultiExpression",get:function(){return this.startMultiExpression},set:function(e){this.startMultiExpression=e}},{key:"ParentEndMultiExpression",get:function(){return this.endMultiExpression},set:function(e){this.endMultiExpression=e}},{key:"setOctaveShiftValue",value:function(e,t){this.octaveValue=1===t&&"down"===e?i.VA8:1===t&&"up"===e?i.VB8:2===t&&"down"===e?i.MA15:2===t&&"up"===e?i.MB15:i.NONE}}],[{key:"getPitchFromOctaveShift",value:function(e,t){if(e){var n=e.Octave;switch(t){case i.VA8:n-=1;break;case i.VB8:n+=1;break;case i.MA15:n-=2;break;case i.MB15:n+=2;break;case i.NONE:default:n+=0}return new r.Pitch(e.FundamentalNote,n,e.Accidental)}}}]),e}(),function(e){e[e.VA8=0]="VA8",e[e.VB8=1]="VB8",e[e.MA15=2]="MA15",e[e.MB15=3]="MB15",e[e.NONE=4]="NONE"}(i=t.OctaveEnum||(t.OctaveEnum={}))},308:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pedal=void 0,t.Pedal=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];g(this,e),this.ChangeEnd=!1,this.ChangeBegin=!1,this.line=t,this.sign=n}return y(e,[{key:"IsLine",get:function(){return this.line}},{key:"IsSign",get:function(){return this.sign}}]),e}()},1928:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Slur=void 0;var i=n(1797);t.Slur=function(){function e(){g(this,e)}return y(e,[{key:"StartNote",get:function(){return this.startNote},set:function(e){this.startNote=e}},{key:"EndNote",get:function(){return this.endNote},set:function(e){this.endNote=e}},{key:"startNoteHasMoreStartingSlurs",value:function(){if(!this.startNote)return!1;for(var e=0,t=this.startNote.NoteSlurs.length;e<t;++e){var n=this.startNote.NoteSlurs[e];if(n!==this&&n.StartNote===this.startNote)return!0}return!1}},{key:"endNoteHasMoreEndingSlurs",value:function(){if(!this.endNote)return!1;for(var e=0,t=this.endNote.NoteSlurs.length;e<t;++e){var n=this.endNote.NoteSlurs[e];if(n!==this&&n.EndNote===this.endNote)return!0}return!1}},{key:"isCrossed",value:function(){return this.startNote.ParentStaffEntry.ParentStaff!==this.endNote.ParentStaffEntry.ParentStaff}},{key:"isSlurLonger",value:function(){if(!this.endNote||!this.startNote)return!1;for(var e=i.Fraction.minus(this.endNote.getAbsoluteTimestamp(),this.startNote.getAbsoluteTimestamp()),t=0,n=this.startNote.NoteSlurs.length;t<n;++t){var r=this.startNote.NoteSlurs[t];if(r!==this&&void 0!==r.EndNote&&void 0!==r.StartNote&&-1===i.Fraction.minus(r.EndNote.getAbsoluteTimestamp(),r.StartNote.getAbsoluteTimestamp()).CompareTo(e))return!0}for(var a=0,s=this.endNote.NoteSlurs.length;a<s;++a){var o=this.endNote.NoteSlurs[a];if(o!==this&&void 0!==o.EndNote&&void 0!==o.StartNote&&i.Fraction.minus(o.EndNote.getAbsoluteTimestamp(),o.StartNote.getAbsoluteTimestamp()).CompareTo(e))return!0}return!1}}]),e}()},2163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavyLine=void 0;var i=function(e){h(n,e);var t=d(n);function n(e){return g(this,n),t.call(this,e)}return n}(n(3748).AbstractExpression);t.WavyLine=i},8084:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(7839),t),r(n(280),t),r(n(5853),t),r(n(1928),t)},4802:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicExpressionSymbolEnum=void 0,(n=t.DynamicExpressionSymbolEnum||(t.DynamicExpressionSymbolEnum={}))[n.p=0]="p",n[n.f=1]="f",n[n.s=2]="s",n[n.z=3]="z",n[n.m=4]="m",n[n.r=5]="r"},9793:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicEnum=t.InstantaneousDynamicExpression=void 0;var r,s=n(3748),o=n(4802),l=n(1703),f=i(n(2043)),p=n(1649),m=function(e){h(n,e);var t=d(n);function n(e,i,s,o,l){var h,d;return g(this,n),d=t.call(this,s),a((h=c(d),u(n.prototype)),"parentMeasure",l,h,!0),d.dynamicEnum=r[e.toLowerCase()],d.soundDynamic=i,d.staffNumber=o,d}return y(n,[{key:"ParentMultiExpression",get:function(){return this.multiExpression},set:function(e){this.multiExpression=e}},{key:"DynEnum",get:function(){return this.dynamicEnum},set:function(e){this.dynamicEnum=e}},{key:"SoundDynamic",get:function(){return this.soundDynamic},set:function(e){this.soundDynamic=e}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"Length",get:function(){return Math.abs(this.length)<1e-4&&(this.length=this.calculateLength()),this.length}},{key:"MidiVolume",get:function(){return 127*this.Volume}},{key:"Volume",get:function(){return n.dynamicToRelativeVolumeDict.getValue(this.dynamicEnum)}},{key:"getDynamicExpressionSymbol",value:function(e){switch(e){case"p":return o.DynamicExpressionSymbolEnum.p;case"f":return o.DynamicExpressionSymbolEnum.f;case"s":return o.DynamicExpressionSymbolEnum.s;case"z":return o.DynamicExpressionSymbolEnum.z;case"m":return o.DynamicExpressionSymbolEnum.m;case"r":return o.DynamicExpressionSymbolEnum.r;default:throw new l.InvalidEnumArgumentException("unknown DynamicExpressionSymbolEnum: "+e)}}},{key:"calculateLength",value:function(){return f.default.debug("[Andrea] instantaneousDynamicExpression: not implemented: calculateLength!"),0}}],[{key:"staticConstructor",value:function(){n.dynamicToRelativeVolumeDict.setValue(r.ffffff,1),n.dynamicToRelativeVolumeDict.setValue(r.fffff,126/127),n.dynamicToRelativeVolumeDict.setValue(r.ffff,125/127),n.dynamicToRelativeVolumeDict.setValue(r.fff,124/127),n.dynamicToRelativeVolumeDict.setValue(r.ff,122/127),n.dynamicToRelativeVolumeDict.setValue(r.f,108/127),n.dynamicToRelativeVolumeDict.setValue(r.mf,76/127),n.dynamicToRelativeVolumeDict.setValue(r.sf,.5),n.dynamicToRelativeVolumeDict.setValue(r.sfp,.5),n.dynamicToRelativeVolumeDict.setValue(r.sfpp,.5),n.dynamicToRelativeVolumeDict.setValue(r.fp,.5),n.dynamicToRelativeVolumeDict.setValue(r.rf,.5),n.dynamicToRelativeVolumeDict.setValue(r.rfz,.5),n.dynamicToRelativeVolumeDict.setValue(r.sfz,.5),n.dynamicToRelativeVolumeDict.setValue(r.sffz,.5),n.dynamicToRelativeVolumeDict.setValue(r.fz,.5),n.dynamicToRelativeVolumeDict.setValue(r.mp,60/127),n.dynamicToRelativeVolumeDict.setValue(r.p,28/127),n.dynamicToRelativeVolumeDict.setValue(r.pp,12/127),n.dynamicToRelativeVolumeDict.setValue(r.ppp,10/127),n.dynamicToRelativeVolumeDict.setValue(r.pppp,7/127),n.dynamicToRelativeVolumeDict.setValue(r.ppppp,5/127),n.dynamicToRelativeVolumeDict.setValue(r.pppppp,4/127)}},{key:"isInputStringInstantaneousDynamic",value:function(e){return!!e&&n.isStringInStringList(n.listInstantaneousDynamics,e)}}]),n}(s.AbstractExpression);t.InstantaneousDynamicExpression=m,m.dynamicToRelativeVolumeDict=new p.Dictionary,m.listInstantaneousDynamics=["pppppp","ppppp","pppp","ppp","pp","p","ffffff","fffff","ffff","fff","ff","f","mf","mp","sf","sff","sp","spp","fp","rf","rfz","sfz","sffz","fz"],function(e){e[e.pppppp=0]="pppppp",e[e.ppppp=1]="ppppp",e[e.pppp=2]="pppp",e[e.ppp=3]="ppp",e[e.pp=4]="pp",e[e.p=5]="p",e[e.mp=6]="mp",e[e.mf=7]="mf",e[e.f=8]="f",e[e.ff=9]="ff",e[e.fff=10]="fff",e[e.ffff=11]="ffff",e[e.fffff=12]="fffff",e[e.ffffff=13]="ffffff",e[e.sf=14]="sf",e[e.sff=15]="sff",e[e.sfp=16]="sfp",e[e.sfpp=17]="sfpp",e[e.fp=18]="fp",e[e.rf=19]="rf",e[e.rfz=20]="rfz",e[e.sfz=21]="sfz",e[e.sffz=22]="sffz",e[e.fz=23]="fz",e[e.other=24]="other"}(r=t.DynamicEnum||(t.DynamicEnum={})),m.staticConstructor()},9667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TempoEnum=t.InstantaneousTempoExpression=void 0;var i,r=n(9775),a=n(1703),s=n(1797),o=function(e){h(n,e);var t=d(n);function n(e,i,r,a,s){var o;return g(this,n),(o=t.call(this,e,i,r,s)).setTempoAndTempoType(a),o}return y(n,[{key:"Label",get:function(){return this.label},set:function(e){this.label=e}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"Enum",get:function(){return this.tempoEnum}},{key:"TempoInBpm",get:function(){return this.tempoInBpm},set:function(e){this.tempoInBpm=e}},{key:"ParentMultiTempoExpression",get:function(){return this.parentMultiTempoExpression}},{key:"getAbsoluteTimestamp",value:function(){return s.Fraction.plus(this.ParentMultiTempoExpression.SourceMeasureParent.AbsoluteTimestamp,this.ParentMultiTempoExpression.Timestamp)}},{key:"getAbsoluteFloatTimestamp",value:function(){return s.Fraction.plus(this.ParentMultiTempoExpression.SourceMeasureParent.AbsoluteTimestamp,this.ParentMultiTempoExpression.Timestamp).RealValue}},{key:"setTempoAndTempoType",value:function(e){return this.label?n.isStringInStringList(n.listInstantaneousTempoLarghissimo,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.larghissimo)),this.tempoInBpm=e,void(this.tempoEnum=i.larghissimo)):n.isStringInStringList(n.listInstantaneousTempoGrave,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.grave)),this.tempoInBpm=e,void(this.tempoEnum=i.grave)):n.isStringInStringList(n.listInstantaneousTempoLento,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.lento)),this.tempoInBpm=e,void(this.tempoEnum=i.lento)):n.isStringInStringList(n.listInstantaneousTempoLargo,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.largo)),this.tempoInBpm=e,void(this.tempoEnum=i.largo)):n.isStringInStringList(n.listInstantaneousTempoLarghetto,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.larghetto)),this.tempoInBpm=e,void(this.tempoEnum=i.larghetto)):n.isStringInStringList(n.listInstantaneousTempoAdagio,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.adagio)),this.tempoInBpm=e,void(this.tempoEnum=i.adagio)):n.isStringInStringList(n.listInstantaneousTempoAdagietto,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.adagietto)),this.tempoInBpm=e,void(this.tempoEnum=i.adagietto)):n.isStringInStringList(n.listInstantaneousTempoAndanteModerato,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.andanteModerato)),this.tempoInBpm=e,void(this.tempoEnum=i.andanteModerato)):n.isStringInStringList(n.listInstantaneousTempoAndante,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.andante)),this.tempoInBpm=e,void(this.tempoEnum=i.andante)):n.isStringInStringList(n.listInstantaneousTempoAndantino,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.andantino)),this.tempoInBpm=e,void(this.tempoEnum=i.andantino)):n.isStringInStringList(n.listInstantaneousTempoModerato,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.moderato)),this.tempoInBpm=e,void(this.tempoEnum=i.moderato)):n.isStringInStringList(n.listInstantaneousTempoAllegretto,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.allegretto)),this.tempoInBpm=e,void(this.tempoEnum=i.allegretto)):n.isStringInStringList(n.listInstantaneousTempoAllegroModerato,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.allegroModerato)),this.tempoInBpm=e,void(this.tempoEnum=i.allegroModerato)):n.isStringInStringList(n.listInstantaneousTempoAllegro,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.allegro)),this.tempoInBpm=e,void(this.tempoEnum=i.allegro)):n.isStringInStringList(n.listInstantaneousTempoVivace,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.vivace)),this.tempoInBpm=e,void(this.tempoEnum=i.vivace)):n.isStringInStringList(n.listInstantaneousTempoVivacissimo,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.vivacissimo)),this.tempoInBpm=e,void(this.tempoEnum=i.vivacissimo)):n.isStringInStringList(n.listInstantaneousTempoAllegrissimo,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.allegrissimo)),this.tempoInBpm=e,void(this.tempoEnum=i.allegrissimo)):n.isStringInStringList(n.listInstantaneousTempoPresto,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.presto)),this.tempoInBpm=e,void(this.tempoEnum=i.presto)):n.isStringInStringList(n.listInstantaneousTempoPrestissimo,this.label)?(0===e&&(e=n.getDefaultValueForTempoType(i.prestissimo)),this.tempoInBpm=e,void(this.tempoEnum=i.prestissimo)):n.isStringInStringList(n.listInstantaneousTempoAddons,this.label)?(this.tempoInBpm=0,void(this.tempoEnum=i.addon)):n.isStringInStringList(n.listInstantaneousTempoChangesGeneral,this.label)?(this.tempoInBpm=0,void(this.tempoEnum=i.changes)):void 0:(this.tempoInBpm=e,void(this.tempoEnum=i.metronomeMark))}}],[{key:"getDefaultValueForTempoType",value:function(e){switch(e){case i.larghissimo:return 20;case i.grave:return 30;case i.lento:return 48;case i.largo:return 52;case i.larghetto:return 63;case i.adagio:return 70;case i.adagietto:return 75;case i.andanteModerato:return 88;case i.andante:return 92;case i.andantino:return 96;case i.moderato:return 106;case i.allegretto:return 112;case i.allegroModerato:return 118;case i.allegro:return 130;case i.vivace:return 140;case i.vivacissimo:return 155;case i.allegrissimo:return 170;case i.presto:return 184;case i.prestissimo:return 200;default:throw new a.ArgumentOutOfRangeException("tempoEnum")}}},{key:"isInputStringInstantaneousTempo",value:function(e){return!!e&&(n.isStringInStringList(n.listInstantaneousTempoLarghissimo,e)||n.isStringInStringList(n.listInstantaneousTempoGrave,e)||n.isStringInStringList(n.listInstantaneousTempoLento,e)||n.isStringInStringList(n.listInstantaneousTempoLargo,e)||n.isStringInStringList(n.listInstantaneousTempoLarghetto,e)||n.isStringInStringList(n.listInstantaneousTempoAdagio,e)||n.isStringInStringList(n.listInstantaneousTempoAdagietto,e)||n.isStringInStringList(n.listInstantaneousTempoAndanteModerato,e)||n.isStringInStringList(n.listInstantaneousTempoAndante,e)||n.isStringInStringList(n.listInstantaneousTempoAndantino,e)||n.isStringInStringList(n.listInstantaneousTempoModerato,e)||n.isStringInStringList(n.listInstantaneousTempoAllegretto,e)||n.isStringInStringList(n.listInstantaneousTempoAllegroModerato,e)||n.isStringInStringList(n.listInstantaneousTempoAllegro,e)||n.isStringInStringList(n.listInstantaneousTempoVivace,e)||n.isStringInStringList(n.listInstantaneousTempoVivacissimo,e)||n.isStringInStringList(n.listInstantaneousTempoAllegrissimo,e)||n.isStringInStringList(n.listInstantaneousTempoPresto,e)||n.isStringInStringList(n.listInstantaneousTempoPrestissimo,e)||n.isStringInStringList(n.listInstantaneousTempoChangesGeneral,e))}}]),n}(r.AbstractTempoExpression);t.InstantaneousTempoExpression=o,o.listInstantaneousTempoLarghissimo=["Larghissimo","Sehr breit","very, very slow"],o.listInstantaneousTempoGrave=["Grave","Schwer","slow and solemn"],o.listInstantaneousTempoLento=["Lento","Lent","Langsam","slowly"],o.listInstantaneousTempoLargo=["Largo","Breit","broadly"],o.listInstantaneousTempoLarghetto=["Larghetto","Etwas breit","rather broadly"],o.listInstantaneousTempoAdagio=["Adagio","Langsam","Ruhig","slow and stately"],o.listInstantaneousTempoAdagietto=["Adagietto","Ziemlich ruhig","Ziemlich langsam","rather slow"],o.listInstantaneousTempoAndanteModerato=["Andante moderato"],o.listInstantaneousTempoAndante=["Andante","Gehend","Schreitend","at a walking pace"],o.listInstantaneousTempoAndantino=["Andantino"],o.listInstantaneousTempoModerato=["Moderato","M\xe4\xdfig","Mod\ufffdr\ufffd","moderately"],o.listInstantaneousTempoAllegretto=["Allegretto","fast"],o.listInstantaneousTempoAllegroModerato=["Allegro moderato"],o.listInstantaneousTempoAllegro=["Allegro","Rapide","Vite","Rasch","Schnell","Fr\ufffdhlich"],o.listInstantaneousTempoVivace=["Vivace","Lebhaft","Lebendig","lively and fast"],o.listInstantaneousTempoVivacissimo=["Vivacissimo","Sehr lebhaft","Sehr lebendig"],o.listInstantaneousTempoAllegrissimo=["Allegrissimo","very fast"],o.listInstantaneousTempoPresto=["Presto","Sehr schnell","Geschwind"],o.listInstantaneousTempoPrestissimo=["Prestissimo","\xe4u\xdferst schnell"],o.listInstantaneousTempoChangesGeneral=["tempo primo","a tempo","tempo i","rubato","doppio movimento"],o.listInstantaneousTempoAddons=["assai","amoroso","cantabile","con brio","con dolore","con espressione","con fuoco","con moto","con spirito","spiritoso","espressivo","giocoso","giusto","grazioso","lesto","lugubre","maestoso","ma non troppo","marcato","molto","morendo","mosso","non tanto","piu","un poco","poco","quasi","risoluto","scherzando","sostenuto","teneramente","tempo giusto","tranquillo","sehr","lieblich","liebevoll","mit Leidenschaft","mit Liebe","amour\xf6s","gesanglich","mit Schwung","mit Feuer","mit Schmerz","mit Ausdruck","mit Bewegung","geistvoll","ausdrucksvoll","freudig","verspielt","angemessen","grazi\xf6s","mit Grazie","flink","beh\xe4nde","traurig","klagend","majest\xe4tisch","aber nicht zu sehr","markant","gem\xe4\xdfigt","viel","sehr","ersterbend","bewegt","nicht zu sehr","mehr","ein wenig","gleichsam","entschlossen","zupackend","heiter","nachdr\xfccklich","getragen","gewichtig","zart","z\xe4rtlich","im angemessenen Zeitma\xdf","ruhig","ein wenig","alla marcia","ad libitum","alla breve"],function(e){e[e.none=0]="none",e[e.larghissimo=1]="larghissimo",e[e.grave=2]="grave",e[e.lento=3]="lento",e[e.largo=4]="largo",e[e.larghetto=5]="larghetto",e[e.adagio=6]="adagio",e[e.adagietto=7]="adagietto",e[e.andanteModerato=8]="andanteModerato",e[e.andante=9]="andante",e[e.andantino=10]="andantino",e[e.moderato=11]="moderato",e[e.allegretto=12]="allegretto",e[e.allegroModerato=13]="allegroModerato",e[e.allegro=14]="allegro",e[e.vivace=15]="vivace",e[e.vivacissimo=16]="vivacissimo",e[e.allegrissimo=17]="allegrissimo",e[e.presto=18]="presto",e[e.prestissimo=19]="prestissimo",e[e.lastRealTempo=20]="lastRealTempo",e[e.addon=21]="addon",e[e.changes=22]="changes",e[e.metronomeMark=23]="metronomeMark"}(i=t.TempoEnum||(t.TempoEnum={}))},7527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MoodEnum=t.MoodExpression=void 0;var i,r=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,i)).label=e,a.staffNumber=r,a.setMoodType(),a}return y(n,[{key:"Label",get:function(){return this.label},set:function(e){this.label=e}},{key:"Mood",get:function(){return this.moodType},set:function(e){this.moodType=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"setMoodType",value:function(){n.isStringInStringList(n.listMoodAffettuoso,this.label)?this.moodType=i.Affettuoso:n.isStringInStringList(n.listMoodAgitato,this.label)?this.moodType=i.Agitato:n.isStringInStringList(n.listMoodAnimato,this.label)?this.moodType=i.Animato:n.isStringInStringList(n.listMoodAppassionato,this.label)?this.moodType=i.Appassionato:n.isStringInStringList(n.listMoodBrillante,this.label)?this.moodType=i.Brillante:n.isStringInStringList(n.listMoodCantabile,this.label)?this.moodType=i.Cantabile:n.isStringInStringList(n.listMoodDolce,this.label)?this.moodType=i.Dolce:n.isStringInStringList(n.listMoodEnergico,this.label)?this.moodType=i.Energico:n.isStringInStringList(n.listMoodEroico,this.label)?this.moodType=i.Eroico:n.isStringInStringList(n.listMoodEspressivo,this.label)?this.moodType=i.Espressivo:n.isStringInStringList(n.listMoodFurioso,this.label)?this.moodType=i.Furioso:n.isStringInStringList(n.listMoodGiocoso,this.label)?this.moodType=i.Giocoso:n.isStringInStringList(n.listMoodGioioso,this.label)?this.moodType=i.Gioioso:n.isStringInStringList(n.listMoodGrandioso,this.label)?this.moodType=i.Grandioso:n.isStringInStringList(n.listMoodGrazioso,this.label)?this.moodType=i.Grazioso:n.isStringInStringList(n.listMoodLacrimoso,this.label)?this.moodType=i.Lacrimoso:n.isStringInStringList(n.listMoodLeggiero,this.label)?this.moodType=i.Leggiero:n.isStringInStringList(n.listMoodMaestoso,this.label)?this.moodType=i.Maestoso:n.isStringInStringList(n.listMoodMalinconico,this.label)?this.moodType=i.Malinconico:n.isStringInStringList(n.listMoodMarcato,this.label)?this.moodType=i.Marcato:n.isStringInStringList(n.listMoodMarziale,this.label)?this.moodType=i.Marziale:n.isStringInStringList(n.listMoodMesto,this.label)?this.moodType=i.Mesto:n.isStringInStringList(n.listMoodMorendo,this.label)?this.moodType=i.Morendo:n.isStringInStringList(n.listMoodNobilmente,this.label)?this.moodType=i.Nobilmente:n.isStringInStringList(n.listMoodPatetico,this.label)?this.moodType=i.Patetico:n.isStringInStringList(n.listMoodPesante,this.label)?this.moodType=i.Pesante:n.isStringInStringList(n.listMoodSaltando,this.label)?this.moodType=i.Saltando:n.isStringInStringList(n.listMoodSautille,this.label)?this.moodType=i.Sautille:n.isStringInStringList(n.listMoodScherzando,this.label)?this.moodType=i.Scherzando:n.isStringInStringList(n.listMoodSostenuto,this.label)?this.moodType=i.Sostenuto:n.isStringInStringList(n.listMoodSpiccato,this.label)?this.moodType=i.Spiccato:n.isStringInStringList(n.listMoodTenerezza,this.label)?this.moodType=i.Tenerezza:n.isStringInStringList(n.listMoodTranquillamente,this.label)?this.moodType=i.Tranquillamente:n.isStringInStringList(n.listMoodTrionfante,this.label)&&(this.moodType=i.Trionfante)}}],[{key:"isInputStringMood",value:function(e){return!!e&&(n.isStringInStringList(n.listMoodAffettuoso,e)||n.isStringInStringList(n.listMoodAgitato,e)||n.isStringInStringList(n.listMoodAnimato,e)||n.isStringInStringList(n.listMoodAppassionato,e)||n.isStringInStringList(n.listMoodBrillante,e)||n.isStringInStringList(n.listMoodCantabile,e)||n.isStringInStringList(n.listMoodDolce,e)||n.isStringInStringList(n.listMoodEnergico,e)||n.isStringInStringList(n.listMoodEroico,e)||n.isStringInStringList(n.listMoodEspressivo,e)||n.isStringInStringList(n.listMoodFurioso,e)||n.isStringInStringList(n.listMoodGiocoso,e)||n.isStringInStringList(n.listMoodGioioso,e)||n.isStringInStringList(n.listMoodGrandioso,e)||n.isStringInStringList(n.listMoodGrazioso,e)||n.isStringInStringList(n.listMoodLacrimoso,e)||n.isStringInStringList(n.listMoodLeggiero,e)||n.isStringInStringList(n.listMoodMaestoso,e)||n.isStringInStringList(n.listMoodMalinconico,e)||n.isStringInStringList(n.listMoodMarcato,e)||n.isStringInStringList(n.listMoodMarziale,e)||n.isStringInStringList(n.listMoodMesto,e)||n.isStringInStringList(n.listMoodMorendo,e)||n.isStringInStringList(n.listMoodNobilmente,e)||n.isStringInStringList(n.listMoodPatetico,e)||n.isStringInStringList(n.listMoodPesante,e)||n.isStringInStringList(n.listMoodSaltando,e)||n.isStringInStringList(n.listMoodSautille,e)||n.isStringInStringList(n.listMoodScherzando,e)||n.isStringInStringList(n.listMoodSostenuto,e)||n.isStringInStringList(n.listMoodSpiccato,e)||n.isStringInStringList(n.listMoodTenerezza,e)||n.isStringInStringList(n.listMoodTranquillamente,e)||n.isStringInStringList(n.listMoodTrionfante,e))}}]),n}(n(3748).AbstractExpression);t.MoodExpression=r,r.listMoodAffettuoso=["affettuoso"],r.listMoodAgitato=["agitato"],r.listMoodAppassionato=["appassionato"],r.listMoodAnimato=["animato","lively"],r.listMoodBrillante=["brillante"],r.listMoodCantabile=["cantabile"],r.listMoodDolce=["dolce"],r.listMoodEnergico=["energico"],r.listMoodEroico=["eroico"],r.listMoodEspressivo=["espressivo"],r.listMoodFurioso=["furioso"],r.listMoodGiocoso=["giocoso"],r.listMoodGioioso=["gioioso"],r.listMoodLacrimoso=["lacrimoso"],r.listMoodGrandioso=["grandioso"],r.listMoodGrazioso=["grazioso"],r.listMoodLeggiero=["leggiero"],r.listMoodMaestoso=["maestoso"],r.listMoodMalinconico=["malinconico"],r.listMoodMarcato=["marcato"],r.listMoodMarziale=["marziale"],r.listMoodMesto=["mesto"],r.listMoodMorendo=["morendo"],r.listMoodNobilmente=["nobilmente"],r.listMoodPatetico=["patetico"],r.listMoodPesante=["pesante"],r.listMoodSautille=["sautille"],r.listMoodSaltando=["saltando"],r.listMoodScherzando=["scherzando"],r.listMoodSostenuto=["sostenuto"],r.listMoodSpiccato=["spiccato"],r.listMoodTenerezza=["tenerezza"],r.listMoodTranquillamente=["tranquillamente"],r.listMoodTrionfante=["trionfante"],function(e){e[e.Affettuoso=0]="Affettuoso",e[e.Agitato=1]="Agitato",e[e.Appassionato=2]="Appassionato",e[e.Animato=3]="Animato",e[e.Brillante=4]="Brillante",e[e.Cantabile=5]="Cantabile",e[e.Dolce=6]="Dolce",e[e.Energico=7]="Energico",e[e.Eroico=8]="Eroico",e[e.Espressivo=9]="Espressivo",e[e.Furioso=10]="Furioso",e[e.Giocoso=11]="Giocoso",e[e.Gioioso=12]="Gioioso",e[e.Lacrimoso=13]="Lacrimoso",e[e.Grandioso=14]="Grandioso",e[e.Grazioso=15]="Grazioso",e[e.Leggiero=16]="Leggiero",e[e.Maestoso=17]="Maestoso",e[e.Malinconico=18]="Malinconico",e[e.Marcato=19]="Marcato",e[e.Marziale=20]="Marziale",e[e.Mesto=21]="Mesto",e[e.Morendo=22]="Morendo",e[e.Nobilmente=23]="Nobilmente",e[e.Patetico=24]="Patetico",e[e.Pesante=25]="Pesante",e[e.Sautille=26]="Sautille",e[e.Saltando=27]="Saltando",e[e.Scherzando=28]="Scherzando",e[e.Sostenuto=29]="Sostenuto",e[e.Spiccato=30]="Spiccato",e[e.Tenerezza=31]="Tenerezza",e[e.Tranquillamente=32]="Tranquillamente",e[e.Trionfante=33]="Trionfante",e[e.Vivace=34]="Vivace"}(i=t.MoodEnum||(t.MoodEnum={}))},6943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiExpressionEntry=t.MultiExpression=void 0;var i=n(1797),r=n(9793),a=n(7839),s=n(7527),o=n(1614),u=n(3748),l=n(2562);t.MultiExpression=function(){function e(t,n){g(this,e),this.unknownList=[],this.moodList=[],this.expressions=[],this.sourceMeasure=t,this.timestamp=n}return y(e,[{key:"SourceMeasureParent",get:function(){return this.sourceMeasure},set:function(e){this.sourceMeasure=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"Timestamp",get:function(){return this.timestamp},set:function(e){this.timestamp=e}},{key:"AbsoluteTimestamp",get:function(){return i.Fraction.plus(this.timestamp,this.sourceMeasure.AbsoluteTimestamp)}},{key:"InstantaneousDynamic",get:function(){return this.instantaneousDynamic},set:function(e){this.instantaneousDynamic=e}},{key:"EndingContinuousDynamic",get:function(){return this.endingContinuousDynamic},set:function(e){this.endingContinuousDynamic=e}},{key:"StartingContinuousDynamic",get:function(){return this.startingContinuousDynamic},set:function(e){this.startingContinuousDynamic=e}},{key:"MoodList",get:function(){return this.moodList}},{key:"UnknownList",get:function(){return this.unknownList}},{key:"EntriesList",get:function(){return this.expressions}},{key:"OctaveShiftStart",get:function(){return this.octaveShiftStart},set:function(e){this.octaveShiftStart=e}},{key:"OctaveShiftEnd",get:function(){return this.octaveShiftEnd},set:function(e){this.octaveShiftEnd=e}},{key:"CombinedExpressionsText",get:function(){return this.combinedExpressionsText},set:function(e){this.combinedExpressionsText=e}},{key:"getPlacementOfFirstEntry",value:function(){var e=u.PlacementEnum.Above;return this.expressions.length>0&&(this.expressions[0].expression instanceof r.InstantaneousDynamicExpression||this.expressions[0].expression instanceof a.ContinuousDynamicExpression||this.expressions[0].expression instanceof s.MoodExpression||this.expressions[0].expression instanceof o.UnknownExpression)&&(e=this.expressions[0].expression.Placement),e}},{key:"getFontstyleOfFirstEntry",value:function(){var e,t=l.FontStyles.Regular;return this.expressions.length>0&&(this.expressions[0].expression instanceof a.ContinuousDynamicExpression||this.expressions[0].expression instanceof s.MoodExpression?t=l.FontStyles.Italic:this.expressions[0].expression instanceof o.UnknownExpression&&(t=null!==(e=this.expressions[0].expression.fontStyle)&&void 0!==e?e:l.FontStyles.Regular)),t}},{key:"addExpression",value:function(e,t){e instanceof r.InstantaneousDynamicExpression?(this.instantaneousDynamic&&this.removeExpressionFromEntryList(this.InstantaneousDynamic),this.instantaneousDynamic=e,this.instantaneousDynamic.ParentMultiExpression=this):e instanceof a.ContinuousDynamicExpression?this.startingContinuousDynamic=e:e instanceof s.MoodExpression?this.moodList.push(e):e instanceof o.UnknownExpression&&this.unknownList.push(e),this.addExpressionToEntryList(e,t)}},{key:"CompareTo",value:function(e){return this.Timestamp.RealValue>e.Timestamp.RealValue?1:this.Timestamp.RealValue<e.Timestamp.RealValue?-1:0}},{key:"addExpressionToEntryList",value:function(e,t){var n=new c;n.prefix=t,n.expression=e,e instanceof a.ContinuousDynamicExpression||e instanceof s.MoodExpression||e instanceof o.UnknownExpression?n.label=e.Label:n.label="",this.expressions.push(n)}},{key:"removeExpressionFromEntryList",value:function(e){for(var t=0,n=this.expressions.length;t<n;++t)if(this.expressions[t].expression===e){this.expressions.splice(t,1);break}}}]),e}();var c=function e(){g(this,e)};t.MultiExpressionEntry=c},6124:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TempoExpressionEntry=t.MultiTempoExpression=void 0;var i=n(1797),r=n(9667),a=n(3748),s=n(2562),o=n(280);t.MultiTempoExpression=function(){function e(t,n){g(this,e),this.expressions=[],this.sourceMeasure=t,this.timestamp=n}return y(e,[{key:"Timestamp",get:function(){return this.timestamp}},{key:"AbsoluteTimestamp",get:function(){return i.Fraction.plus(this.sourceMeasure.AbsoluteTimestamp,this.timestamp)}},{key:"SourceMeasureParent",get:function(){return this.sourceMeasure},set:function(e){this.sourceMeasure=e}},{key:"InstantaneousTempo",get:function(){return this.instantaneousTempo}},{key:"ContinuousTempo",get:function(){return this.continuousTempo}},{key:"EntriesList",get:function(){return this.expressions}},{key:"CombinedExpressionsText",get:function(){return this.combinedExpressionsText},set:function(e){this.combinedExpressionsText=e}},{key:"getPlacementOfFirstEntry",value:function(){var e=a.PlacementEnum.Above;return this.expressions.length>0&&(this.expressions[0].Expression instanceof r.InstantaneousTempoExpression||this.expressions[0].Expression instanceof o.ContinuousTempoExpression)&&(e=this.expressions[0].Expression.Placement),e}},{key:"getFontstyleOfFirstEntry",value:function(){var e=s.FontStyles.Regular;return this.expressions[0].Expression instanceof r.InstantaneousTempoExpression?e=s.FontStyles.Bold:this.expressions[0].Expression instanceof o.ContinuousTempoExpression&&(e=s.FontStyles.Italic),e}},{key:"addExpression",value:function(e,t){if(!this.checkIfAlreadyExists(e)){e instanceof r.InstantaneousTempoExpression?this.instantaneousTempo=e:e instanceof o.ContinuousTempoExpression&&(this.continuousTempo=e);var n=new u;n.prefix=t,n.Expression=e,n.label=e.Label,this.expressions.push(n)}}},{key:"CompareTo",value:function(e){return this.Timestamp.RealValue>e.Timestamp.RealValue?1:this.Timestamp.RealValue<e.Timestamp.RealValue?-1:0}},{key:"checkIfAlreadyExists",value:function(e){var t,n=b(this.expressions);try{for(n.s();!(t=n.n()).done;)if(t.value.label===e.Label)return!0}catch(i){n.e(i)}finally{n.f()}return!1}}]),e}();var u=function(){function e(){g(this,e)}return y(e,[{key:"Expression",get:function(){return this.expression},set:function(e){this.expression=e}}]),e}();t.TempoExpressionEntry=u},7513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RehearsalExpression=void 0;var i=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this,i)).label=e,r}return n}(n(3748).AbstractExpression);t.RehearsalExpression=i},1614:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownExpression=void 0;var i=n(3748),r=n(1274),a=function(e){h(n,e);var t=d(n);function n(e,i,a,s){var o;return g(this,n),(o=t.call(this,i)).label=e,o.staffNumber=s,void 0===a&&(a=r.TextAlignmentEnum.LeftBottom),o.textAlignment=a,o}return y(n,[{key:"Label",get:function(){return this.label}},{key:"Placement",get:function(){return this.placement},set:function(e){this.placement=e}},{key:"StaffNumber",get:function(){return this.staffNumber},set:function(e){this.staffNumber=e}},{key:"TextAlignment",get:function(){return this.textAlignment}}]),n}(i.AbstractExpression);t.UnknownExpression=a},2343:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(3748),t),r(n(9775),t),r(n(4802),t),r(n(9793),t),r(n(9667),t),r(n(7527),t),r(n(6943),t),r(n(6124),t),r(n(7513),t),r(n(1614),t)},5356:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicsContainer=void 0;var i=n(7839),r=n(9793);t.DynamicsContainer=function(){function e(t,n){g(this,e),t instanceof i.ContinuousDynamicExpression?this.continuousDynamicExpression=t:t instanceof r.InstantaneousDynamicExpression&&(this.instantaneousDynamicExpression=t),this.staffNumber=n}return y(e,[{key:"parMultiExpression",value:function(){return this.continuousDynamicExpression?this.continuousDynamicExpression.StartMultiExpression:this.instantaneousDynamicExpression?this.instantaneousDynamicExpression.ParentMultiExpression:void 0}}],[{key:"Compare",value:function(e,t){return e.parMultiExpression().AbsoluteTimestamp.CompareTo(t.parMultiExpression().AbsoluteTimestamp)}}]),e}()},5517:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5356),t)},1877:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractNotationInstruction=void 0,t.AbstractNotationInstruction=function(){function e(t){g(this,e),this.printObject=!0,this.parent=t}return y(e,[{key:"Parent",get:function(){return this.parent},set:function(e){this.parent=e}},{key:"PrintObject",get:function(){return this.printObject},set:function(e){this.printObject=e}}]),e}()},289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MidiInstrument=t.ClefEnum=t.ClefInstruction=void 0;var i,r,a=n(8640),s=n(1877),o=n(8640),u=n(8640),l=n(1703),c=function(e){h(n,e);var t=d(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.G,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return g(this,n),(e=t.call(this,void 0)).clefType=i.G,e.line=2,e.octaveOffset=0,e.line=s,e.clefType=r,e.octaveOffset=a,e.calcParameters(),e}return y(n,[{key:"ClefType",get:function(){return this.clefType},set:function(e){this.clefType=e}},{key:"Line",get:function(){return this.line},set:function(e){this.line=e}},{key:"OctaveOffset",get:function(){return this.octaveOffset},set:function(e){this.octaveOffset=e}},{key:"ClefPitch",get:function(){return this.clefPitch},set:function(e){this.clefPitch=e}},{key:"ReferenceCyPosition",get:function(){return this.referenceCyPosition},set:function(e){this.referenceCyPosition=e}},{key:"Equals",value:function(e){return this===e||!(!this||!e)&&this.clefPitch===e.clefPitch&&this.Line===e.Line}},{key:"NotEqual",value:function(e){return!this.Equals(e)}},{key:"ToString",value:function(){return"ClefType: "+this.clefType}},{key:"calcParameters",value:function(){switch(this.clefType){case i.G:this.clefPitch=new a.Pitch(o.NoteEnum.G,1+this.octaveOffset,u.AccidentalEnum.NONE),this.referenceCyPosition=5-this.line+2;break;case i.F:this.clefPitch=new a.Pitch(o.NoteEnum.F,0+this.octaveOffset,u.AccidentalEnum.NONE),this.referenceCyPosition=5-this.line+1.5;break;case i.C:this.clefPitch=new a.Pitch(o.NoteEnum.C,1+this.octaveOffset,u.AccidentalEnum.NONE),this.referenceCyPosition=5-this.line;break;case i.percussion:this.clefPitch=new a.Pitch(o.NoteEnum.C,2,u.AccidentalEnum.NONE),this.referenceCyPosition=2;break;case i.TAB:this.clefPitch=new a.Pitch(o.NoteEnum.G,0,u.AccidentalEnum.NONE),this.referenceCyPosition=0;break;default:throw new l.ArgumentOutOfRangeException("clefType")}}}],[{key:"getDefaultClefFromMidiInstrument",value:function(e){switch(e){case r.Acoustic_Grand_Piano:case r.Electric_Bass_finger:case r.Electric_Bass_pick:case r.Fretless_Bass:case r.Slap_Bass_1:case r.Slap_Bass_2:case r.Synth_Bass_1:case r.Synth_Bass_2:case r.Contrabass:return new n(i.F,0,4);default:return new n(i.G,0,2)}}},{key:"getAllPossibleClefs",value:function(){for(var e=[],t=0;t<=2;t++){var r=new n(i.G,t,2);e.push(r)}for(var a=-2;a<=0;a++){var s=new n(i.F,a,4);e.push(s)}return e}},{key:"isSupportedClef",value:function(e){switch(e){case i.G:case i.F:case i.C:case i.percussion:case i.TAB:return!0;default:return!1}}}]),n}(s.AbstractNotationInstruction);t.ClefInstruction=c,function(e){e[e.G=0]="G",e[e.F=1]="F",e[e.C=2]="C",e[e.percussion=3]="percussion",e[e.TAB=4]="TAB"}(i=t.ClefEnum||(t.ClefEnum={})),function(e){e[e.None=-1]="None",e[e.Acoustic_Grand_Piano=0]="Acoustic_Grand_Piano",e[e.Bright_Acoustic_Piano=1]="Bright_Acoustic_Piano",e[e.Electric_Grand_Piano=2]="Electric_Grand_Piano",e[e.Honky_tonk_Piano=3]="Honky_tonk_Piano",e[e.Electric_Piano_1=4]="Electric_Piano_1",e[e.Electric_Piano_2=5]="Electric_Piano_2",e[e.Harpsichord=6]="Harpsichord",e[e.Clavinet=7]="Clavinet",e[e.Celesta=8]="Celesta",e[e.Glockenspiel=9]="Glockenspiel",e[e.Music_Box=10]="Music_Box",e[e.Vibraphone=11]="Vibraphone",e[e.Marimba=12]="Marimba",e[e.Xylophone=13]="Xylophone",e[e.Tubular_Bells=14]="Tubular_Bells",e[e.Dulcimer=15]="Dulcimer",e[e.Drawbar_Organ=16]="Drawbar_Organ",e[e.Percussive_Organ=17]="Percussive_Organ",e[e.Rock_Organ=18]="Rock_Organ",e[e.Church_Organ=19]="Church_Organ",e[e.Reed_Organ=20]="Reed_Organ",e[e.Accordion=21]="Accordion",e[e.Harmonica=22]="Harmonica",e[e.Tango_Accordion=23]="Tango_Accordion",e[e.Acoustic_Guitar_nylon=24]="Acoustic_Guitar_nylon",e[e.Acoustic_Guitar_steel=25]="Acoustic_Guitar_steel",e[e.Electric_Guitar_jazz=26]="Electric_Guitar_jazz",e[e.Electric_Guitar_clean=27]="Electric_Guitar_clean",e[e.Electric_Guitar_muted=28]="Electric_Guitar_muted",e[e.Overdriven_Guitar=29]="Overdriven_Guitar",e[e.Distortion_Guitar=30]="Distortion_Guitar",e[e.Guitar_harmonics=31]="Guitar_harmonics",e[e.Acoustic_Bass=32]="Acoustic_Bass",e[e.Electric_Bass_finger=33]="Electric_Bass_finger",e[e.Electric_Bass_pick=34]="Electric_Bass_pick",e[e.Fretless_Bass=35]="Fretless_Bass",e[e.Slap_Bass_1=36]="Slap_Bass_1",e[e.Slap_Bass_2=37]="Slap_Bass_2",e[e.Synth_Bass_1=38]="Synth_Bass_1",e[e.Synth_Bass_2=39]="Synth_Bass_2",e[e.Violin=40]="Violin",e[e.Viola=41]="Viola",e[e.Cello=42]="Cello",e[e.Contrabass=43]="Contrabass",e[e.Tremolo_Strings=44]="Tremolo_Strings",e[e.Pizzicato_Strings=45]="Pizzicato_Strings",e[e.Orchestral_Harp=46]="Orchestral_Harp",e[e.Timpani=47]="Timpani",e[e.String_Ensemble_1=48]="String_Ensemble_1",e[e.String_Ensemble_2=49]="String_Ensemble_2",e[e.Synth_Strings_1=50]="Synth_Strings_1",e[e.Synth_Strings_2=51]="Synth_Strings_2",e[e.Choir_Aahs=52]="Choir_Aahs",e[e.Voice_Oohs=53]="Voice_Oohs",e[e.Synth_Voice=54]="Synth_Voice",e[e.Orchestra_Hit=55]="Orchestra_Hit",e[e.Trumpet=56]="Trumpet",e[e.Trombone=57]="Trombone",e[e.Tuba=58]="Tuba",e[e.Muted_Trumpet=59]="Muted_Trumpet",e[e.French_Horn=60]="French_Horn",e[e.Brass_Section=61]="Brass_Section",e[e.Synth_Brass_1=62]="Synth_Brass_1",e[e.Synth_Brass_2=63]="Synth_Brass_2",e[e.Soprano_Sax=64]="Soprano_Sax",e[e.Alto_Sax=65]="Alto_Sax",e[e.Tenor_Sax=66]="Tenor_Sax",e[e.Baritone_Sax=67]="Baritone_Sax",e[e.Oboe=68]="Oboe",e[e.English_Horn=69]="English_Horn",e[e.Bassoon=70]="Bassoon",e[e.Clarinet=71]="Clarinet",e[e.Piccolo=72]="Piccolo",e[e.Flute=73]="Flute",e[e.Recorder=74]="Recorder",e[e.Pan_Flute=75]="Pan_Flute",e[e.Blown_Bottle=76]="Blown_Bottle",e[e.Shakuhachi=77]="Shakuhachi",e[e.Whistle=78]="Whistle",e[e.Ocarina=79]="Ocarina",e[e.Lead_1_square=80]="Lead_1_square",e[e.Lead_2_sawtooth=81]="Lead_2_sawtooth",e[e.Lead_3_calliope=82]="Lead_3_calliope",e[e.Lead_4_chiff=83]="Lead_4_chiff",e[e.Lead_5_charang=84]="Lead_5_charang",e[e.Lead_6_voice=85]="Lead_6_voice",e[e.Lead_7_fifths=86]="Lead_7_fifths",e[e.Lead_8_bass_lead=87]="Lead_8_bass_lead",e[e.Pad_1_new_age=88]="Pad_1_new_age",e[e.Pad_2_warm=89]="Pad_2_warm",e[e.Pad_3_polysynth=90]="Pad_3_polysynth",e[e.Pad_4_choir=91]="Pad_4_choir",e[e.Pad_5_bowed=92]="Pad_5_bowed",e[e.Pad_6_metallic=93]="Pad_6_metallic",e[e.Pad_7_halo=94]="Pad_7_halo",e[e.Pad_8_sweep=95]="Pad_8_sweep",e[e.FX_1_rain=96]="FX_1_rain",e[e.FX_2_soundtrack=97]="FX_2_soundtrack",e[e.FX_3_crystal=98]="FX_3_crystal",e[e.FX_4_atmosphere=99]="FX_4_atmosphere",e[e.FX_5_brightness=100]="FX_5_brightness",e[e.FX_6_goblins=101]="FX_6_goblins",e[e.FX_7_echoes=102]="FX_7_echoes",e[e.FX_8_scifi=103]="FX_8_scifi",e[e.Sitar=104]="Sitar",e[e.Banjo=105]="Banjo",e[e.Shamisen=106]="Shamisen",e[e.Koto=107]="Koto",e[e.Kalimba=108]="Kalimba",e[e.Bag_pipe=109]="Bag_pipe",e[e.Fiddle=110]="Fiddle",e[e.Shanai=111]="Shanai",e[e.Tinkle_Bell=112]="Tinkle_Bell",e[e.Agogo=113]="Agogo",e[e.Steel_Drums=114]="Steel_Drums",e[e.Woodblock=115]="Woodblock",e[e.Taiko_Drum=116]="Taiko_Drum",e[e.Melodic_Tom=117]="Melodic_Tom",e[e.Synth_Drum=118]="Synth_Drum",e[e.Reverse_Cymbal=119]="Reverse_Cymbal",e[e.Guitar_Fret_Noise=120]="Guitar_Fret_Noise",e[e.Breath_Noise=121]="Breath_Noise",e[e.Seashore=122]="Seashore",e[e.Bird_Tweet=123]="Bird_Tweet",e[e.Telephone_Ring=124]="Telephone_Ring",e[e.Helicopter=125]="Helicopter",e[e.Applause=126]="Applause",e[e.Gunshot=127]="Gunshot",e[e.Percussion=128]="Percussion"}(r=t.MidiInstrument||(t.MidiInstrument={}))},5198:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyEnum=t.NoteEnumToHalfToneLink=t.KeyInstruction=void 0;var i,r=n(1877),a=n(8640),s=n(8640),o=function(e){h(n,e);var t=d(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.major;return g(this,n),(r=t.call(this,e)).isTransposedBy=0,r.Key=a,r.keyTypeOriginal=a,r.mode=s,r.alteratedNotes=r.calcAlteratedNotes(),r}return y(n,[{key:"Key",get:function(){return this.keyType},set:function(e){this.keyType=e,this.alteratedNotes=this.calcAlteratedNotes()}},{key:"Mode",get:function(){return this.mode},set:function(e){this.mode=e}},{key:"AlteratedNotes",get:function(){return this.alteratedNotes}},{key:"calcAlteratedNotes",value:function(){var e=[];if(this.keyType>0)for(var t=0;t<this.keyType;t++)e.push(n.sharpPositionList[t]);else if(this.keyType<0)for(var i=0;i<-this.keyType;i++)e.push(n.flatPositionList[i]);return e}},{key:"willAlterateNote",value:function(e){return this.alteratedNotes.indexOf(e)>=0}},{key:"getAlterationForPitch",value:function(e){return this.keyType>0&&this.alteratedNotes.indexOf(e.FundamentalNote)<=this.keyType?s.AccidentalEnum.SHARP:this.keyType<0&&this.alteratedNotes.indexOf(e.FundamentalNote)<=Math.abs(this.keyType)?s.AccidentalEnum.FLAT:s.AccidentalEnum.NONE}},{key:"ToString",value:function(){return"Key: "+this.keyType+this.mode}},{key:"OperatorEquals",value:function(e){var t=this;return t===e||!(!t||!e)&&t.Key===e.Key&&t.Mode===e.Mode}},{key:"OperatorNotEqual",value:function(e){return!this.OperatorEquals(e)}}],[{key:"copy",value:function(e){var t=new n(e.parent,e.Key,e.Mode);return t.keyTypeOriginal=e.keyTypeOriginal,t}},{key:"getAllPossibleMajorKeyInstructions",value:function(){for(var e=[],t=-7;t<7;t++){var r=new n(void 0,t,i.major);e.push(r)}return e}}]),n}(r.AbstractNotationInstruction);t.KeyInstruction=o,o.sharpPositionList=[a.NoteEnum.F,a.NoteEnum.C,a.NoteEnum.G,a.NoteEnum.D,a.NoteEnum.A,a.NoteEnum.E,a.NoteEnum.B],o.flatPositionList=[a.NoteEnum.B,a.NoteEnum.E,a.NoteEnum.A,a.NoteEnum.D,a.NoteEnum.G,a.NoteEnum.C,a.NoteEnum.F],t.NoteEnumToHalfToneLink=function(){function e(t,n){g(this,e),this.note=t,this.halfTone=n}return e}(),function(e){e[e.major=0]="major",e[e.minor=1]="minor",e[e.none=2]="none",e[e.dorian=3]="dorian",e[e.phrygian=4]="phrygian",e[e.lydian=5]="lydian",e[e.mixolydian=6]="mixolydian",e[e.aeolian=7]="aeolian",e[e.ionian=8]="ionian",e[e.locrian=9]="locrian"}(i=t.KeyEnum||(t.KeyEnum={}))},6189:function(e,t){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.AlignmentType=t.RepetitionInstructionEnum=t.RepetitionInstruction=t.RepetitionInstructionComparer=void 0,t.RepetitionInstructionComparer=function(){function e(){g(this,e)}return y(e,null,[{key:"Compare",value:function(e,t){if(void 0!==e.parentRepetition&&t.parentRepetition){if(e.alignment===i.End&&t.alignment===i.End){if(e.parentRepetition.StartIndex<t.parentRepetition.StartIndex)return 1;if(e.parentRepetition.StartIndex>t.parentRepetition.StartIndex)return-1}if(e.alignment===i.Begin&&t.alignment===i.Begin){if(e.parentRepetition.EndIndex<t.parentRepetition.EndIndex)return 1;if(e.parentRepetition.EndIndex>t.parentRepetition.EndIndex)return-1}}return 0}}]),e}(),t.RepetitionInstruction=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.End,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;g(this,e),this.endingIndices=void 0,this.measureIndex=t,s&&(this.endingIndices=s.slice()),this.type=n,this.alignment=r,this.parentRepetition=a}return y(e,[{key:"CompareTo",value:function(e){var t=e;if(this.measureIndex>t.measureIndex)return 1;if(this.measureIndex<t.measureIndex)return-1;if(this.alignment===i.Begin){if(t.alignment===i.End)return-1;switch(this.type){case n.Ending:return 1;case n.StartLine:return t.type===n.Ending?-1:1;case n.Coda:case n.Segno:return t.type===n.Coda?1:-1}}else{if(t.alignment===i.Begin)return 1;switch(this.type){case n.Ending:return-1;case n.Fine:case n.ToCoda:return t.type===n.Ending?1:-1;case n.ForwardJump:switch(t.type){case n.Ending:case n.Fine:case n.ToCoda:return 1}return-1;case n.DalSegnoAlFine:case n.DaCapoAlFine:case n.DalSegnoAlCoda:case n.DaCapoAlCoda:case n.DaCapo:case n.DalSegno:case n.BackJumpLine:return 1}}return 0}},{key:"equals",value:function(e){if(this.measureIndex!==e.measureIndex||this.type!==e.type||this.alignment!==e.alignment)return!1;if(this.endingIndices===e.endingIndices)return!0;if(!this.endingIndices||!e.endingIndices||this.endingIndices.length!==e.endingIndices.length)return!1;for(var t=0;t<this.endingIndices.length;t++)if(this.endingIndices[t]!==e.endingIndices[t])return!1;return!0}}]),e}(),function(e){e[e.StartLine=0]="StartLine",e[e.ForwardJump=1]="ForwardJump",e[e.BackJumpLine=2]="BackJumpLine",e[e.Ending=3]="Ending",e[e.DaCapo=4]="DaCapo",e[e.DalSegno=5]="DalSegno",e[e.Fine=6]="Fine",e[e.ToCoda=7]="ToCoda",e[e.DalSegnoAlFine=8]="DalSegnoAlFine",e[e.DaCapoAlFine=9]="DaCapoAlFine",e[e.DalSegnoAlCoda=10]="DalSegnoAlCoda",e[e.DaCapoAlCoda=11]="DaCapoAlCoda",e[e.Coda=12]="Coda",e[e.Segno=13]="Segno",e[e.None=14]="None"}(n=t.RepetitionInstructionEnum||(t.RepetitionInstructionEnum={})),function(e){e[e.Begin=0]="Begin",e[e.End=1]="End"}(i=t.AlignmentType||(t.AlignmentType={}))},3331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RhythmSymbolEnum=t.RhythmInstruction=void 0;var i,r=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this,void 0)).rhythm=e,r.numerator=e.Numerator,r.denominator=e.Denominator,r.symbolEnum=i,r}return y(n,[{key:"Rhythm",get:function(){return this.rhythm},set:function(e){this.rhythm=e}},{key:"SymbolEnum",get:function(){return this.symbolEnum},set:function(e){this.symbolEnum=e}},{key:"clone",value:function(){return new n(this.rhythm.clone(),this.symbolEnum)}},{key:"OperatorEquals",value:function(e){var t=this;return t===e||!(!t||!e)&&t.numerator===e.numerator&&t.denominator===e.denominator}},{key:"OperatorNotEqual",value:function(e){return!(this===e)}},{key:"ToString",value:function(){return"Rhythm: "+this.rhythm.toString()}}]),n}(n(1877).AbstractNotationInstruction);t.RhythmInstruction=r,(i=t.RhythmSymbolEnum||(t.RhythmSymbolEnum={}))[i.NONE=0]="NONE",i[i.COMMON=1]="COMMON",i[i.CUT=2]="CUT"},1357:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TechnicalInstruction=t.TechnicalInstructionType=void 0,(n=t.TechnicalInstructionType||(t.TechnicalInstructionType={}))[n.Fingering=0]="Fingering",n[n.String=1]="String",t.TechnicalInstruction=function(){function e(){g(this,e)}return e}()},6065:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(1877),t),r(n(289),t),r(n(5198),t),r(n(6189),t),r(n(3331),t),r(n(1357),t)},2947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedVoice=void 0;var i=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,e,i)).master=r,a}return y(n,[{key:"Master",get:function(){return this.master}}]),n}(n(3884).Voice);t.LinkedVoice=i},7274:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LyricsEntry=void 0,t.LyricsEntry=function(){function e(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;g(this,e),this.text=t,this.word=i,this.parent=r,this.verseNumber=n,a>=0&&(this.syllableIndex=a)}return y(e,[{key:"Text",get:function(){return this.text},set:function(e){this.text=e}},{key:"Word",get:function(){return this.word}},{key:"Parent",get:function(){return this.parent},set:function(e){this.parent=e}},{key:"VerseNumber",get:function(){return this.verseNumber}},{key:"SyllableIndex",get:function(){return this.syllableIndex}}]),e}()},2672:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LyricWord=void 0,t.LyricWord=function(){function e(){g(this,e),this.syllables=[]}return y(e,[{key:"Syllables",get:function(){return this.syllables}},{key:"containsVoiceEntry",value:function(e){for(var t=0,n=this.Syllables.length;t<n;++t)if(this.Syllables[t].Parent===e)return!0;return!1}},{key:"findLyricEntryInVoiceEntry",value:function(e){for(var t=0,n=this.Syllables.length;t<n;++t){var i=this.Syllables[t];if(i.Parent===e)return i}}}]),e}()},5253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Appearance=t.Note=void 0;var i,r=n(1797);t.Note=function(){function e(t,n,i,r,a,s){g(this,e),this.slurs=[],this.playbackInstrumentId=void 0,this.notehead=void 0,this.printObject=!0,this.voiceEntry=t,this.parentStaffEntry=n,this.length=i,this.pitch=r,this.sourceMeasure=a,this.isRestFlag=null!=s&&s,this.halfTone=r?r.getHalfTone():0}return y(e,[{key:"NoteAsString",get:function(){return this.pitch.toString()}},{key:"ParentVoiceEntry",get:function(){return this.voiceEntry},set:function(e){this.voiceEntry=e}},{key:"ParentStaffEntry",get:function(){return this.parentStaffEntry}},{key:"ParentStaff",get:function(){return this.parentStaffEntry.ParentStaff}},{key:"Length",get:function(){return this.length},set:function(e){this.length=e}},{key:"PlaybackNote",get:function(){return this.playbackNote},set:function(e){this.playbackNote=e}},{key:"SourceMeasure",get:function(){return this.sourceMeasure}},{key:"TypeLength",get:function(){return this.typeLength},set:function(e){this.typeLength=e}},{key:"NoteTypeXml",get:function(){return this.noteTypeXml},set:function(e){this.noteTypeXml=e}},{key:"NormalNotes",get:function(){return this.normalNotes},set:function(e){this.normalNotes=e}},{key:"Pitch",get:function(){return this.pitch}},{key:"NoteBeam",get:function(){return this.beam},set:function(e){this.beam=e}},{key:"Notehead",get:function(){return this.notehead},set:function(e){this.notehead=e}},{key:"NoteTuplet",get:function(){return this.tuplet},set:function(e){this.tuplet=e}},{key:"NoteTie",get:function(){return this.tie},set:function(e){this.tie=e}},{key:"NoteSlurs",get:function(){return this.slurs},set:function(e){this.slurs=e}},{key:"PlaybackInstrumentId",get:function(){return this.playbackInstrumentId},set:function(e){this.playbackInstrumentId=e}},{key:"PrintObject",get:function(){return this.printObject},set:function(e){this.printObject=e}},{key:"Arpeggio",get:function(){return this.arpeggio},set:function(e){this.arpeggio=e}},{key:"IsCueNote",get:function(){return this.isCueNote},set:function(e){this.isCueNote=e}},{key:"StemDirectionXml",get:function(){return this.stemDirectionXml},set:function(e){this.stemDirectionXml=e}},{key:"TremoloStrokes",get:function(){return this.tremoloStrokes},set:function(e){this.tremoloStrokes=e}},{key:"StemColorXml",get:function(){return this.stemColorXml},set:function(e){this.stemColorXml=e}},{key:"NoteheadColorXml",get:function(){return this.noteheadColorXml},set:function(e){this.noteheadColorXml=e}},{key:"NoteheadColor",get:function(){return this.noteheadColor},set:function(e){this.noteheadColor=e}},{key:"NoteheadColorCurrentlyRendered",get:function(){return this.noteheadColorCurrentlyRendered},set:function(e){this.noteheadColorCurrentlyRendered=e}},{key:"isRest",value:function(){return this.isRestFlag}},{key:"isWholeRest",value:function(){return this.isRest()&&this.Length.RealValue===this.sourceMeasure.ActiveTimeSignature.RealValue}},{key:"ToString",value:function(){return this.pitch?this.Pitch.ToString()+", length: "+this.length.toString():"rest note, length: "+this.length.toString()}},{key:"getAbsoluteTimestamp",value:function(){return r.Fraction.plus(this.voiceEntry.Timestamp,this.sourceMeasure.AbsoluteTimestamp)}},{key:"checkForDoubleSlur",value:function(e){for(var t=0,n=this.slurs.length;t<n;++t){var i=this.slurs[t];if(void 0!==i.StartNote&&void 0!==i.EndNote&&void 0!==e.StartNote&&e.StartNote===i.StartNote&&i.EndNote===this)return!0}return!1}}]),e}(),(i=t.Appearance||(t.Appearance={}))[i.Normal=0]="Normal",i[i.Grace=1]="Grace",i[i.Cue=2]="Cue"},2478:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoteTypeHandler=t.NoteType=void 0;var i,r=n(1797),a=n(6331),s=n(1703);!function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e._1024th=1]="_1024th",e[e._512th=2]="_512th",e[e._256th=3]="_256th",e[e._128th=4]="_128th",e[e._64th=5]="_64th",e[e._32nd=6]="_32nd",e[e._16th=7]="_16th",e[e.EIGTH=8]="EIGTH",e[e.QUARTER=9]="QUARTER",e[e.HALF=10]="HALF",e[e.WHOLE=11]="WHOLE",e[e.BREVE=12]="BREVE",e[e.LONG=13]="LONG",e[e.MAXIMA=14]="MAXIMA"}(i=t.NoteType||(t.NoteType={}));var o=function(){function e(){g(this,e)}return y(e,null,[{key:"NoteTypeToString",value:function(e){return this.NoteTypeXmlValues[e]}},{key:"StringToNoteType",value:function(e){var t=this.NoteTypeXmlValues.indexOf(e);return-1!==t?t:i.UNDEFINED}},{key:"getNoteDurationFromType",value:function(e){switch(e){case"1024th":return new r.Fraction(1,1024);case"512th":return new r.Fraction(1,512);case"256th":return new r.Fraction(1,256);case"128th":return new r.Fraction(1,128);case"64th":return new r.Fraction(1,64);case"32th":case"32nd":return new r.Fraction(1,32);case"16th":return new r.Fraction(1,16);case"eighth":return new r.Fraction(1,8);case"quarter":return new r.Fraction(1,4);case"half":return new r.Fraction(1,2);case"whole":return new r.Fraction(1,1);case"breve":return new r.Fraction(2,1);case"long":return new r.Fraction(4,1);case"maxima":return new r.Fraction(8,1);default:var t=a.ITextTranslation.translateText("ReaderErrorMessages/NoteDurationError","Invalid note duration.");throw new s.MusicSheetReadingException(t)}}}]),e}();t.NoteTypeHandler=o,o.NoteTypeXmlValues=["","1024th","512th","256th","128th","64th","32nd","16th","eigth","quarter","half","whole","breve","long","maxima"]},766:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteHeadShape=t.Notehead=void 0;var r,a=i(n(2043)),s=function(){function e(t,n,i){g(this,e),this.sourceNote=t,this.setShapeFromXml(n,i)}return y(e,[{key:"setShapeFromXml",value:function(t,n){this.shape=e.ShapeTypeXmlToShape(t);var i=n;void 0===i&&(this.sourceNote?i=this.sourceNote.Length.Denominator>2:(a.default.warn("notehead: sourceNote and filledXmlAttribute undefined."),i=!0)),this.filled=i}},{key:"SourceNote",get:function(){return this.sourceNote}},{key:"Shape",get:function(){return this.shape}},{key:"Filled",get:function(){return this.filled}}],[{key:"ShapeTypeXmlToShape",value:function(e){switch(e.toLowerCase()){case"normal":return r.NORMAL;case"x":return r.X;case"slash":return r.SLASH;case"diamond":return r.DIAMOND;case"square":case"la":return r.SQUARE;case"do":case"triangle":return r.TRIANGLE;case"rectangle":return r.RECTANGLE;case"circle-x":return r.CIRCLEX;default:return a.default.info("unsupported/unhandled xml notehead '"+e+"'. Using normal notehead."),r.NORMAL}}}]),e}();t.Notehead=s,function(e){e[e.CIRCLEX=0]="CIRCLEX",e[e.DIAMOND=1]="DIAMOND",e[e.NORMAL=2]="NORMAL",e[e.RECTANGLE=3]="RECTANGLE",e[e.SLASH=4]="SLASH",e[e.SQUARE=5]="SQUARE",e[e.TRIANGLE=6]="TRIANGLE",e[e.X=7]="X"}(r=t.NoteHeadShape||(t.NoteHeadShape={}))},5922:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrnamentEnum=t.OrnamentContainer=void 0;var i,r=n(8640),a=n(3748);t.OrnamentContainer=function(){function e(t){g(this,e),this.placement=a.PlacementEnum.Above,this.accidentalAbove=r.AccidentalEnum.NONE,this.accidentalBelow=r.AccidentalEnum.NONE,this.ornament=t}return y(e,[{key:"GetOrnament",get:function(){return this.ornament}},{key:"AccidentalAbove",get:function(){return this.accidentalAbove},set:function(e){this.accidentalAbove=e}},{key:"AccidentalBelow",get:function(){return this.accidentalBelow},set:function(e){this.accidentalBelow=e}}]),e}(),(i=t.OrnamentEnum||(t.OrnamentEnum={}))[i.Trill=0]="Trill",i[i.Turn=1]="Turn",i[i.InvertedTurn=2]="InvertedTurn",i[i.DelayedTurn=3]="DelayedTurn",i[i.DelayedInvertedTurn=4]="DelayedInvertedTurn",i[i.Mordent=5]="Mordent",i[i.InvertedMordent=6]="InvertedMordent"},5942:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceMeasure=void 0;var i=n(1797),r=n(141),a=n(9050),s=n(6189),o=n(908),u=n(289),l=n(5198),c=n(6894);t.SourceMeasure=function(){function e(t,n){g(this,e),this.printNewSystemXml=!1,this.printNewPageXml=!1,this.IsSystemStartMeasure=!1,this.hasLyrics=!1,this.hasMoodExpressions=!1,this.allRests=!1,this.isReducedToMultiRest=!1,this.multipleRestMeasureNumber=0,this.staffLinkedExpressions=[],this.tempoExpressions=[],this.verticalSourceStaffEntryContainers=[],this.graphicalMeasureErrors=[],this.firstRepetitionInstructions=[],this.lastRepetitionInstructions=[],this.WasRendered=!1,this.completeNumberOfStaves=t,this.implicitMeasure=!1,this.hasEndLine=!1,this.endingBarStyleXml="",this.endingBarStyleEnum=c.SystemLinesEnum.SingleThin,this.firstInstructionsStaffEntries=new Array(t),this.lastInstructionsStaffEntries=new Array(t),this.rules=n,this.TempoInBPM=0;for(var i=0;i<t;i++)this.graphicalMeasureErrors.push(!1),this.staffLinkedExpressions.push([])}return y(e,[{key:"MeasureNumber",get:function(){return this.measureNumber},set:function(e){this.measureNumber=e}},{key:"getPrintedMeasureNumber",value:function(){return this.rules.UseXMLMeasureNumbers&&Number.isInteger(this.MeasureNumberXML)?(this.MeasureNumberPrinted=this.MeasureNumberXML,this.MeasureNumberPrinted):(this.MeasureNumberPrinted=this.MeasureNumber,this.MeasureNumberPrinted)}},{key:"AbsoluteTimestamp",get:function(){return this.absoluteTimestamp},set:function(e){this.absoluteTimestamp=e}},{key:"CompleteNumberOfStaves",get:function(){return this.completeNumberOfStaves}},{key:"Duration",get:function(){return this.duration},set:function(e){this.duration=e}},{key:"ActiveTimeSignature",get:function(){return this.activeTimeSignature},set:function(e){this.activeTimeSignature=e}},{key:"ImplicitMeasure",get:function(){return this.implicitMeasure},set:function(e){this.implicitMeasure=e}},{key:"HasEndLine",get:function(){return this.hasEndLine},set:function(e){this.hasEndLine=e}},{key:"StaffLinkedExpressions",get:function(){return this.staffLinkedExpressions}},{key:"TempoExpressions",get:function(){return this.tempoExpressions}},{key:"VerticalSourceStaffEntryContainers",get:function(){return this.verticalSourceStaffEntryContainers}},{key:"FirstInstructionsStaffEntries",get:function(){return this.firstInstructionsStaffEntries}},{key:"LastInstructionsStaffEntries",get:function(){return this.lastInstructionsStaffEntries}},{key:"FirstRepetitionInstructions",get:function(){return this.firstRepetitionInstructions}},{key:"LastRepetitionInstructions",get:function(){return this.lastRepetitionInstructions}},{key:"getErrorInMeasure",value:function(e){return this.graphicalMeasureErrors[e]}},{key:"setErrorInGraphicalMeasure",value:function(e,t){this.graphicalMeasureErrors[e]=t}},{key:"getNextMeasure",value:function(e){return e[this.measureListIndex+1]}},{key:"getPreviousMeasure",value:function(e){if(this.measureListIndex>1)return e[this.measureListIndex-1]}},{key:"Rules",get:function(){return this.rules}},{key:"VerticalMeasureList",get:function(){return this.verticalMeasureList},set:function(e){this.verticalMeasureList=e}},{key:"TempoInBPM",get:function(){return this.tempoInBPM},set:function(e){this.tempoInBPM=e}},{key:"findOrCreateStaffEntry",value:function(e,t,n){var i,s,o,u=b(this.verticalSourceStaffEntryContainers);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(l.Timestamp.Equals(e)){s=l;break}}}catch(m){u.e(m)}finally{u.f()}if(s)return s.StaffEntries[t]?i=s.StaffEntries[t]:(i=new a.SourceStaffEntry(s,n),s.StaffEntries[t]=i),{createdNewContainer:!1,staffEntry:i};var c=this.verticalSourceStaffEntryContainers[this.verticalSourceStaffEntryContainers.length-1];if(0===this.verticalSourceStaffEntryContainers.length||c.Timestamp.lt(e)){var h=new r.VerticalSourceStaffEntryContainer(this,e.clone(),this.completeNumberOfStaves);this.verticalSourceStaffEntryContainers.push(h),i=new a.SourceStaffEntry(h,n),h.StaffEntries[t]=i}else for(var d=this.verticalSourceStaffEntryContainers.length-1;d>=0;d--){if(this.verticalSourceStaffEntryContainers[d].Timestamp.lt(e)){var f=new r.VerticalSourceStaffEntryContainer(this,e.clone(),this.completeNumberOfStaves);this.verticalSourceStaffEntryContainers.splice(d+1,0,f),i=new a.SourceStaffEntry(f,n),f.StaffEntries[t]=i;break}if(0===d){var p=new r.VerticalSourceStaffEntryContainer(this,e.clone(),this.completeNumberOfStaves);this.verticalSourceStaffEntryContainers.splice(d,0,p),i=new a.SourceStaffEntry(p,n),p.StaffEntries[t]=i;break}}return{createdNewContainer:!0,staffEntry:i}}},{key:"findOrCreateVoiceEntry",value:function(e,t){var n,i,r=!1,a=b(e.VoiceEntries);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s.ParentVoice===t){n=s;break}}}catch(u){a.e(u)}finally{a.f()}return n||(n=new o.VoiceEntry(e.Timestamp,t,e),r=!0),{createdVoiceEntry:r,voiceEntry:n}}},{key:"getPreviousSourceStaffEntryFromIndex",value:function(e,t){for(var n=t-1;n>=0;n--)if(this.verticalSourceStaffEntryContainers[n][e])return this.verticalSourceStaffEntryContainers[n][e]}},{key:"getVerticalContainerIndexByTimestamp",value:function(e){for(var t=0,n=this.VerticalSourceStaffEntryContainers.length;t<n;++t)if(this.VerticalSourceStaffEntryContainers[t].Timestamp.Equals(e))return t;return-1}},{key:"getVerticalContainerByTimestamp",value:function(e){for(var t=0,n=this.VerticalSourceStaffEntryContainers.length;t<n;++t){var i=this.VerticalSourceStaffEntryContainers[t];if(i.Timestamp.Equals(e))return i}}},{key:"checkForEmptyVerticalContainer",value:function(e){for(var t=0,n=0;n<this.completeNumberOfStaves;n++)this.verticalSourceStaffEntryContainers[e][n]||t++;t===this.completeNumberOfStaves&&this.verticalSourceStaffEntryContainers.splice(e,1)}},{key:"reverseCheck",value:function(e,t){for(var n=new i.Fraction(0,1),r=[],a=0;a<e.Instruments.length;a++){for(var s=new i.Fraction(0,1),o=e.getGlobalStaffIndexOfFirstStaff(e.Instruments[a]),u=0;u<e.Instruments[a].Staves.length;u++){var l=this.getLastSourceStaffEntryForInstrument(o+u);if(void 0!==l&&!l.hasTie())for(var c=this.verticalSourceStaffEntryContainers.indexOf(l.VerticalContainerParent)-1;c>=0;c--){var h=this.verticalSourceStaffEntryContainers[c][o+u];if(void 0!==h&&h.hasTie()&&s.lt(i.Fraction.plus(h.Timestamp,h.calculateMaxNoteLength()))){s=i.Fraction.plus(h.Timestamp,h.calculateMaxNoteLength());break}}}r.push(s)}for(var d=0,f=r.length;d<f;++d){var p=r[d];n.lt(p)&&(n=p)}return i.Fraction.max(n,t)}},{key:"calculateInstrumentsDuration",value:function(e,t){for(var n=[],r=0;r<e.Instruments.length;r++){for(var a=new i.Fraction(0,1),s=e.getGlobalStaffIndexOfFirstStaff(e.Instruments[r]),o=0;o<e.Instruments[r].Staves.length;o++){var u=this.getLastSourceStaffEntryForInstrument(s+o);void 0!==u&&u.Timestamp&&a.lt(i.Fraction.plus(u.Timestamp,u.calculateMaxNoteLength()))&&(a=i.Fraction.plus(u.Timestamp,u.calculateMaxNoteLength()))}a.lt(t[r])&&(a=t[r]),n.push(a)}return n}},{key:"getEntriesPerStaff",value:function(e){var t,n=[],i=b(this.VerticalSourceStaffEntryContainers);try{for(i.s();!(t=i.n()).done;){var r=t.value.StaffEntries[e];r&&n.push(r)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"hasBeginInstructions",value:function(){for(var e=0,t=this.FirstInstructionsStaffEntries.length;e<t;e++){var n=this.FirstInstructionsStaffEntries[e];if(void 0!==n&&n.Instructions.length>0)return!0}return!1}},{key:"beginsWithLineRepetition",value:function(){for(var e=0,t=this.FirstRepetitionInstructions.length;e<t;++e){var n=this.FirstRepetitionInstructions[e];if(n.type===s.RepetitionInstructionEnum.StartLine)return!0;if(void 0!==n.parentRepetition&&n===n.parentRepetition.startMarker&&!n.parentRepetition.FromWords)return!0}return!1}},{key:"endsWithLineRepetition",value:function(){for(var e=0,t=this.LastRepetitionInstructions.length;e<t;++e){var n=this.LastRepetitionInstructions[e];if(n.type===s.RepetitionInstructionEnum.BackJumpLine)return!0;var i=n.parentRepetition;if(i&&!i.FromWords)for(var r=0,a=i.BackwardJumpInstructions.length;r<a;++r)if(n===i.BackwardJumpInstructions[r])return!0}return!1}},{key:"beginsWithWordRepetition",value:function(){for(var e=0,t=this.FirstRepetitionInstructions.length;e<t;++e){var n=this.FirstRepetitionInstructions[e];if(void 0!==n.parentRepetition&&n===n.parentRepetition.startMarker&&n.parentRepetition.FromWords)return!0}return!1}},{key:"endsWithWordRepetition",value:function(){for(var e=0,t=this.LastRepetitionInstructions.length;e<t;++e){var n=this.LastRepetitionInstructions[e],i=n.parentRepetition;if(i&&i.FromWords){for(var r=0,a=i.BackwardJumpInstructions.length;r<a;++r)if(n===i.BackwardJumpInstructions[r])return!0;if(n===i.forwardJumpInstruction)return!0}}return!1}},{key:"beginsRepetitionEnding",value:function(){var e,t=b(this.FirstRepetitionInstructions);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.type===s.RepetitionInstructionEnum.Ending&&n.alignment===s.AlignmentType.Begin)return!0}}catch(i){t.e(i)}finally{t.f()}return!1}},{key:"endsRepetitionEnding",value:function(){var e,t=b(this.LastRepetitionInstructions);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.type===s.RepetitionInstructionEnum.Ending&&n.alignment===s.AlignmentType.End)return!0}}catch(i){t.e(i)}finally{t.f()}return!1}},{key:"getKeyInstruction",value:function(e){if(this.FirstInstructionsStaffEntries[e])for(var t=this.FirstInstructionsStaffEntries[e],n=0,i=t.Instructions.length;n<i;++n){var r=t.Instructions[n];if(r instanceof l.KeyInstruction)return r}}},{key:"getLastSourceStaffEntryForInstrument",value:function(e){for(var t,n=this.verticalSourceStaffEntryContainers.length-1;n>=0&&!(t=this.verticalSourceStaffEntryContainers[n].StaffEntries[e]);n--);return t}},{key:"canBeReducedToMultiRest",value:function(){var e,t,n,i=!0,r=!1,a=b(this.verticalSourceStaffEntryContainers);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s){var o,l=b(s.StaffEntries);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c&&c.ParentStaff.ParentInstrument.Visible){if(c.ChordContainers.length>0)return!1;if(c.ParentStaff.hasLyrics&&(r=!0),this.firstRepetitionInstructions.length>0||this.lastRepetitionInstructions.length>0)return!1;var h,d=b(c.VoiceEntries);try{for(d.s();!(h=d.n()).done;){var f,p=h.value,m=b(p.Notes);try{for(m.s();!(f=m.n()).done;)if(!f.value.isRest()){i=!1;break}}catch(k){m.e(k)}finally{m.f()}if(!i)break}}catch(k){d.e(k)}finally{d.f()}}}}catch(k){l.e(k)}finally{l.f()}}}}catch(k){a.e(k)}finally{a.f()}if(!i||r||this.hasMoodExpressions||this.tempoExpressions.length>0)return!1;var v,g=b(this.staffLinkedExpressions);try{for(g.s();!(v=g.n()).done;)if(v.value.length>0)return!1}catch(k){g.e(k)}finally{g.f()}var y,S=b(this.lastInstructionsStaffEntries);try{for(S.s();!(y=S.n()).done;)for(var x=y.value,_=0,E=null==x?void 0:x.Instructions.length;_<E;++_)if(x.Instructions[_]instanceof u.ClefInstruction)return!1}catch(k){S.e(k)}finally{S.f()}return(null===(e=this.Duration)||void 0===e?void 0:e.RealValue)===(null===(t=this.ActiveTimeSignature)||void 0===t?void 0:t.RealValue)}}]),e}()},9050:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceStaffEntry=void 0;var i=n(1797),r=n(289),a=n(5198),s=n(3331);t.SourceStaffEntry=function(){function e(t,n){g(this,e),this.voiceEntries=[],this.instructions=[],this.chordSymbolContainers=[],this.verticalContainerParent=t,this.parentStaff=n}return y(e,[{key:"ParentStaff",get:function(){return this.parentStaff}},{key:"VerticalContainerParent",get:function(){return this.verticalContainerParent}},{key:"Timestamp",get:function(){if(this.VerticalContainerParent)return this.VerticalContainerParent.Timestamp}},{key:"AbsoluteTimestamp",get:function(){if(this.VerticalContainerParent)return i.Fraction.plus(this.VerticalContainerParent.ParentMeasure.AbsoluteTimestamp,this.VerticalContainerParent.Timestamp)}},{key:"VoiceEntries",get:function(){return this.voiceEntries},set:function(e){this.voiceEntries=e}},{key:"Link",get:function(){return this.staffEntryLink},set:function(e){this.staffEntryLink=e}},{key:"Instructions",get:function(){return this.instructions},set:function(e){this.instructions=e}},{key:"ChordContainers",get:function(){return this.chordSymbolContainers},set:function(e){this.chordSymbolContainers=e}},{key:"removeAllInstructionsOfTypeClefInstruction",value:function(){for(var e=0,t=0;e<this.instructions.length;)this.instructions[e]instanceof r.ClefInstruction?(this.instructions.splice(e,1),t++):e++;return t}},{key:"removeFirstInstructionOfTypeClefInstruction",value:function(){for(var e=0;e<this.instructions.length;e++)if(this.instructions[e]instanceof r.ClefInstruction)return this.instructions.splice(e,1),!0;return!1}},{key:"removeAllInstructionsOfTypeKeyInstruction",value:function(){for(var e=0,t=0;e<this.instructions.length;)this.instructions[e]instanceof a.KeyInstruction?(this.instructions.splice(e,1),t++):e++;return t}},{key:"removeFirstInstructionOfTypeKeyInstruction",value:function(){for(var e=0;e<this.instructions.length;e++)if(this.instructions[e]instanceof a.KeyInstruction)return this.instructions.splice(e,1),!0;return!1}},{key:"removeAllInstructionsOfTypeRhythmInstruction",value:function(){for(var e=0,t=0;e<this.instructions.length;)this.instructions[e]instanceof s.RhythmInstruction?(this.instructions.splice(e,1),t++):e++;return t}},{key:"removeFirstInstructionOfTypeRhythmInstruction",value:function(){for(var e=0;e<this.instructions.length;e++)if(this.instructions[e]instanceof s.RhythmInstruction)return this.instructions.splice(e,1),!0;return!1}},{key:"calculateMinNoteLength",value:function(){for(var e=new i.Fraction(Number.MAX_VALUE,1),t=0,n=this.VoiceEntries.length;t<n;++t)for(var r=this.VoiceEntries[t],a=0,s=r.Notes.length;a<s;++a){var o=r.Notes[a];o.Length.lt(e)&&(e=o.Length)}return e}},{key:"calculateMaxNoteLength",value:function(){for(var e=new i.Fraction(0,1),t=0,n=this.VoiceEntries.length;t<n;++t)for(var r=this.VoiceEntries[t],a=0,s=r.Notes.length;a<s;++a){var o=r.Notes[a];if(o.NoteTie){var u,l=i.Fraction.createFromFraction(o.Length),c=!1,h=b(o.NoteTie.Notes);try{for(h.s();!(u=h.n()).done;){var d=u.value;d!==o?c&&l.Add(d.Length):c=!0}}catch(f){h.e(f)}finally{h.f()}e.lt(l)&&(e=l)}else e.lt(o.Length)&&(e=o.Length)}return e}},{key:"hasNotes",value:function(){for(var e=0,t=this.VoiceEntries.length;e<t;++e)if(this.VoiceEntries[e].Notes.length>0)return!0;return!1}},{key:"hasTie",value:function(){for(var e=0,t=this.VoiceEntries.length;e<t;++e)if(this.VoiceEntries[e].hasTie())return!0;return!1}},{key:"findLinkedNotes",value:function(e){for(var t=0,n=this.voiceEntries.length;t<n;++t)for(var i=this.voiceEntries[t],r=0,a=i.Notes.length;r<a;++r){var s=i.Notes[r];s.ParentStaffEntry===this&&e.push(s)}}},{key:"hasOnlyRests",get:function(){var e,t=b(this.voiceEntries);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,r=b(i.Notes);try{for(r.s();!(n=r.n()).done;)if(!n.value.isRest)return!1}catch(a){r.e(a)}finally{r.f()}}}catch(a){t.e(a)}finally{t.f()}return!0}}]),e}()},0:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Staff=void 0,t.Staff=function(){function e(t,n){g(this,e),this.isTab=!1,this.voices=[],this.volume=1,this.stafflineCount=5,this.hasLyrics=!1,this.openTieDict={},this.parentInstrument=t,this.id=n,this.audible=!0,this.following=!0}return y(e,[{key:"ParentInstrument",get:function(){return this.parentInstrument},set:function(e){this.parentInstrument=e}},{key:"Voices",get:function(){return this.voices}},{key:"Solo",get:function(){return this.solo},set:function(e){this.solo=e}},{key:"Id",get:function(){return this.id}},{key:"Volume",get:function(){return this.volume},set:function(e){this.volume=e}},{key:"StafflineCount",get:function(){return this.stafflineCount},set:function(e){this.stafflineCount=e}},{key:"toString",value:function(){return"Staff "+this.idInMusicSheet.toString()}}]),e}()},4447:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaffEntryLink=void 0,t.StaffEntryLink=function(){function e(t){g(this,e),this.linkStaffEntries=[],this.voiceEntry=t}return y(e,[{key:"GetVoiceEntry",get:function(){return this.voiceEntry}},{key:"LinkStaffEntries",get:function(){return this.linkStaffEntries},set:function(e){this.linkStaffEntries=e}}]),e}()},2953:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabNote=void 0;var i=function(e){h(n,e);var t=d(n);function n(e,i,r,a,s,o,u,l){var c;return g(this,n),(c=t.call(this,e,i,r,a,s)).stringNumberTab=o,c.fretNumber=u,c.bendArray=l,c}return y(n,[{key:"StringNumberTab",get:function(){return this.stringNumberTab}},{key:"FretNumber",get:function(){return this.fretNumber}},{key:"BendArray",get:function(){return this.bendArray}}]),n}(n(5253).Note);t.TabNote=i},4555:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Tie=void 0;var r=n(1797),a=n(3748),s=i(n(2043));t.Tie=function(){function e(t,n){g(this,e),this.notes=[],this.TieNumber=1,this.TieDirection=a.PlacementEnum.NotYetDefined,this.NoteIndexToTieDirection={},this.AddNote(t),this.type=n}return y(e,[{key:"getTieDirection",value:function(e){if(!e)return this.TieDirection;for(var t=0;t<this.Notes.length;t++)if(this.Notes[t]===e)return this.NoteIndexToTieDirection[t]||this.TieDirection;return s.default.debug("tie.getTieDuration note not in tie.Notes"),this.TieDirection}},{key:"Notes",get:function(){return this.notes}},{key:"Type",get:function(){return this.type}},{key:"StartNote",get:function(){return this.notes[0]}},{key:"Duration",get:function(){var e,t=new r.Fraction,n=b(this.notes);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.Add(i.Length)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"Pitch",get:function(){return this.StartNote.Pitch}},{key:"AddNote",value:function(e){this.notes.push(e),e.NoteTie=this}}]),e}()},8069:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tuplet=void 0,t.Tuplet=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g(this,e),this.PlacementFromXml=!1,this.RenderTupletNumber=!0,this.notes=[],this.fractions=[],this.tupletLabelNumber=t,this.bracket=n}return y(e,[{key:"TupletLabelNumber",get:function(){return this.tupletLabelNumber},set:function(e){this.tupletLabelNumber=e}},{key:"Notes",get:function(){return this.notes},set:function(e){this.notes=e}},{key:"Fractions",get:function(){return this.fractions},set:function(e){this.fractions=e}},{key:"Bracket",get:function(){return this.bracket},set:function(e){this.bracket=e}},{key:"getNoteIndex",value:function(e){for(var t=this.notes.length-1;t>=0;t--)for(var n=0;n<this.notes[t].length;n++)if(e===this.notes[t][n])return t;return 0}}]),e}()},141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalSourceStaffEntryContainer=void 0;var i=n(1797);t.VerticalSourceStaffEntryContainer=function(){function e(t,n,i){g(this,e),this.staffEntries=[],this.comments=[],this.timestamp=n,this.staffEntries=new Array(i),this.parentMeasure=t}return y(e,[{key:"$get$",value:function(e){return this.staffEntries[e]}},{key:"$set$",value:function(e,t){this.staffEntries[e]=t}},{key:"Timestamp",get:function(){return this.timestamp},set:function(e){this.timestamp=e}},{key:"StaffEntries",get:function(){return this.staffEntries},set:function(e){this.staffEntries=e}},{key:"Comments",get:function(){return this.comments},set:function(e){this.comments=e}},{key:"ParentMeasure",get:function(){return this.parentMeasure},set:function(e){this.parentMeasure=e}},{key:"getAbsoluteTimestamp",value:function(){return i.Fraction.plus(this.timestamp,this.parentMeasure.AbsoluteTimestamp)}}]),e}()},3884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Voice=void 0,t.Voice=function(){function e(t,n){g(this,e),this.voiceEntries=[],this.volume=1,this.parent=t,this.visible=!0,this.audible=!0,this.following=!0,this.voiceId=n,this.uniqueVoiceId="I:"+this.parent.Id+" V: "+this.voiceId}return y(e,[{key:"VoiceEntries",get:function(){return this.voiceEntries}},{key:"Parent",get:function(){return this.parent}},{key:"Visible",get:function(){return this.visible},set:function(e){this.visible=e}},{key:"Audible",get:function(){return this.audible},set:function(e){this.audible=e}},{key:"Following",get:function(){return this.following},set:function(e){this.following=e}},{key:"Solo",get:function(){return this.solo},set:function(e){this.solo=e}},{key:"VoiceId",get:function(){return this.voiceId}},{key:"Volume",get:function(){return this.volume},set:function(e){this.volume=e}},{key:"toString",value:function(){return this.uniqueVoiceId}}]),e}()},908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StemDirectionType=t.ArticulationEnum=t.VoiceEntry=void 0;var i,r,a=n(1649),s=n(4170),o=n(6591);t.VoiceEntry=function(){function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(g(this,e),this.notes=[],this.graceVoiceEntriesBefore=[],this.graceVoiceEntriesAfter=[],this.articulations=[],this.playbackEntries=[],this.technicalInstructions=[],this.lyricsEntries=new a.Dictionary,this.wantedStemDirection=r.Undefined,this.stemDirectionXml=r.Undefined,this.stemDirection=r.Undefined,this.timestamp=t,this.parentVoice=n,this.parentSourceStaffEntry=i,this.isGrace=u,this.graceAfterMainNote=!1,this.graceNoteSlash=l,this.graceSlur=c,u||n.VoiceEntries.push(this),o&&void 0!==i){var h=i.VoiceEntries;-1===h.indexOf(this)&&h.push(this)}this.mainPlaybackEntry=new s.PlaybackEntry(this),this.PlaybackEntries.push(this.mainPlaybackEntry)}return y(e,[{key:"ParentSourceStaffEntry",get:function(){return this.parentSourceStaffEntry}},{key:"ParentVoice",get:function(){return this.parentVoice}},{key:"Timestamp",get:function(){return this.timestamp},set:function(e){this.timestamp=e}},{key:"Notes",get:function(){return this.notes}},{key:"addNote",value:function(e){this.notes.push(e),e.isRest()||void 0!==e.NoteTie&&e.NoteTie.StartNote!==e||this.MainPlaybackEntry.Notes.push(new o.PlaybackNote(this.MainPlaybackEntry,e))}},{key:"GraceVoiceEntriesBefore",get:function(){return this.graceVoiceEntriesBefore},set:function(e){this.graceVoiceEntriesBefore=e;var t,n=b(this.graceVoiceEntriesBefore);try{for(n.s();!(t=n.n()).done;)t.value.parentSourceStaffEntry=this.ParentSourceStaffEntry}catch(i){n.e(i)}finally{n.f()}}},{key:"GraceVoiceEntriesAfter",get:function(){return this.graceVoiceEntriesAfter},set:function(e){this.graceVoiceEntriesAfter=e;var t,n=b(this.graceVoiceEntriesAfter);try{for(n.s();!(t=n.n()).done;)t.value.parentSourceStaffEntry=this.ParentSourceStaffEntry}catch(i){n.e(i)}finally{n.f()}}},{key:"IsGrace",get:function(){return this.isGrace},set:function(e){this.isGrace=e}},{key:"GraceAfterMainNote",get:function(){return this.graceAfterMainNote},set:function(e){this.graceAfterMainNote=e}},{key:"GraceNoteSlash",get:function(){return this.graceNoteSlash},set:function(e){this.graceNoteSlash=e}},{key:"GraceSlur",get:function(){return this.graceSlur},set:function(e){this.graceSlur=e}},{key:"Articulations",get:function(){return this.articulations}},{key:"PlaybackEntries",get:function(){return this.playbackEntries}},{key:"Fermata",get:function(){return this.fermata}},{key:"MainPlaybackEntry",get:function(){return this.mainPlaybackEntry},set:function(e){this.mainPlaybackEntry=e}},{key:"removeMainPlaybackEntry",value:function(){void 0!==this.mainPlaybackEntry&&this.removePlaybackEntry(this.mainPlaybackEntry)}},{key:"removePlaybackEntry",value:function(e){this.mainPlaybackEntry===e&&(this.mainPlaybackEntry=void 0);var t=this.playbackEntries.indexOf(e);t>-1&&this.playbackEntries.splice(t,1)}},{key:"TechnicalInstructions",get:function(){return this.technicalInstructions}},{key:"LyricsEntries",get:function(){return this.lyricsEntries}},{key:"Arpeggio",get:function(){return this.arpeggio},set:function(e){this.arpeggio=e}},{key:"OrnamentContainer",get:function(){return this.ornamentContainer},set:function(e){this.ornamentContainer=e}},{key:"WantedStemDirection",get:function(){return this.wantedStemDirection},set:function(e){this.wantedStemDirection=e}},{key:"StemDirectionXml",get:function(){return this.stemDirectionXml},set:function(e){this.stemDirectionXml=e}},{key:"StemDirection",get:function(){return this.stemDirection},set:function(e){this.stemDirection=e}},{key:"StemColorXml",get:function(){return this.stemColorXml},set:function(e){this.stemColorXml=e}},{key:"StemColor",get:function(){return this.stemColor},set:function(e){this.stemColor=e}},{key:"VolumeModifier",get:function(){return this.volumeModifier},set:function(e){this.volumeModifier=e}},{key:"DurationModifier",get:function(){return this.durationModifier},set:function(e){this.durationModifier=e}},{key:"hasArticulation",value:function(e){var t,n=b(this.articulations);try{for(n.s();!(t=n.n()).done;)if(t.value.Equals(e))return!0}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"hasTie",value:function(){for(var e=0,t=this.Notes.length;e<t;++e)if(this.Notes[e].NoteTie)return!0;return!1}},{key:"hasSlur",value:function(){for(var e=0,t=this.Notes.length;e<t;++e)if(this.Notes[e].NoteSlurs.length>0)return!0;return!1}},{key:"isStaccato",value:function(){var e,t=b(this.Articulations);try{for(t.s();!(e=t.n()).done;)if(e.value.articulationEnum===i.staccato)return!0}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"isAccent",value:function(){var e,t=b(this.Articulations);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.articulationEnum===i.accent||n.articulationEnum===i.strongaccent)return!0}}catch(r){t.e(r)}finally{t.f()}return!1}},{key:"getVerseNumberForLyricEntry",value:function(e){var t=1;return this.lyricsEntries.forEach((function(n,i){e===i&&(t=n)})),t}}],[{key:"isSupportedArticulation",value:function(e){switch(e){case i.accent:case i.strongaccent:case i.softaccent:case i.invertedstrongaccent:case i.staccato:case i.staccatissimo:case i.spiccato:case i.tenuto:case i.fermata:case i.invertedfermata:case i.breathmark:case i.caesura:case i.lefthandpizzicato:case i.naturalharmonic:case i.snappizzicato:case i.upbow:case i.downbow:case i.bend:return!0;default:return!1}}}]),e}(),function(e){e[e.accent=0]="accent",e[e.strongaccent=1]="strongaccent",e[e.softaccent=2]="softaccent",e[e.marcatoup=3]="marcatoup",e[e.marcatodown=4]="marcatodown",e[e.invertedstrongaccent=5]="invertedstrongaccent",e[e.staccato=6]="staccato",e[e.staccatissimo=7]="staccatissimo",e[e.spiccato=8]="spiccato",e[e.tenuto=9]="tenuto",e[e.fermata=10]="fermata",e[e.invertedfermata=11]="invertedfermata",e[e.breathmark=12]="breathmark",e[e.caesura=13]="caesura",e[e.lefthandpizzicato=14]="lefthandpizzicato",e[e.naturalharmonic=15]="naturalharmonic",e[e.snappizzicato=16]="snappizzicato",e[e.upbow=17]="upbow",e[e.downbow=18]="downbow",e[e.scoop=19]="scoop",e[e.plop=20]="plop",e[e.doit=21]="doit",e[e.falloff=22]="falloff",e[e.stress=23]="stress",e[e.unstress=24]="unstress",e[e.detachedlegato=25]="detachedlegato",e[e.otherarticulation=26]="otherarticulation",e[e.bend=27]="bend"}(i=t.ArticulationEnum||(t.ArticulationEnum={})),function(e){e[e.Undefined=-1]="Undefined",e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.None=2]="None",e[e.Double=3]="Double"}(r=t.StemDirectionType||(t.StemDirectionType={}))},6550:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(3029),t),r(n(9224),t),r(n(4123),t),r(n(2947),t),r(n(5253),t),r(n(766),t),r(n(2478),t),r(n(5922),t),r(n(5942),t),r(n(9050),t),r(n(0),t),r(n(4447),t),r(n(4555),t),r(n(8069),t),r(n(141),t),r(n(3884),t),r(n(908),t),r(n(6065),t),r(n(5253),t),r(n(2478),t),r(n(5942),t),r(n(9050),t),r(n(141),t),r(n(4555),t)},4761:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(1703),t),r(n(6842),t),r(n(884),t),r(n(2255),t),r(n(7514),t),r(n(5142),t),r(n(6550),t),r(n(4990),t),r(n(4257),t),r(n(9714),t),r(n(4759),t),r(n(4143),t),r(n(1295),t)},3495:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AJAX=void 0,t.AJAX=function(){function e(){g(this,e)}return y(e,null,[{key:"ajax",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e3,i=e.indexOf(".mxl")>-1?"text/plain; charset=x-user-defined":"application/xml";if(XMLHttpRequest)t=new XMLHttpRequest;else{if(!ActiveXObject)return Promise.reject(new Error("XMLHttp not supported."));t=new ActiveXObject("Microsoft.XMLHTTP")}return t.timeout=n,new Promise((function(n,r){t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status||0===t.status&&t.responseText?n(t.responseText):r(new Error("Could not retrieve requested URL "+t.status)))},t.ontimeout=function(e){r(new Error("Server request Timeout"))},t.overrideMimeType(i),t.open("GET",e,!0),t.send()}))}}]),e}()},530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cursor=void 0;var i=n(301),r=n(1797);t.Cursor=function(){function e(t,n,i){g(this,e),this.hidden=!1,this.currentPageNumber=1,this.container=t,this.openSheetMusicDisplay=n,this.rules=this.openSheetMusicDisplay.EngravingRules,this.cursorOptions=i;var r=0;for(this.cursorElementId="cursorImg-0";document.getElementById(this.cursorElementId);)r++,this.cursorElementId="cursorImg-".concat(r);var a=document.createElement("img");a.id=this.cursorElementId,a.style.position="absolute",!0===this.cursorOptions.follow?(this.wantedZIndex="-1",a.style.zIndex=this.wantedZIndex):(this.wantedZIndex="-2",a.style.zIndex=this.wantedZIndex),this.cursorElement=a,this.container.appendChild(a)}return y(e,[{key:"cursorPositionChanged",value:function(e,t){for(;this.iterator.CurrentEnrolledTimestamp.lt(e)&&!this.iterator.EndReached;)this.iterator.moveToNext();this.iterator.CurrentEnrolledTimestamp.gt(e)&&(this.iterator=new i.MusicPartManagerIterator(this.manager.MusicSheet,e)),this.updateWithTimestamp(t.PredictedPosition)}},{key:"pauseOccurred",value:function(e){}},{key:"selectionEndReached",value:function(e){}},{key:"resetOccurred",value:function(e){this.reset()}},{key:"notesPlaybackEventOccurred",value:function(e){}},{key:"adjustToBackgroundColor",value:function(){var e;e=this.rules.PageBackgroundColor?"1":this.wantedZIndex,this.cursorElement.style.zIndex=e}},{key:"init",value:function(e,t){this.manager=e,this.graphic=t,this.reset(),this.hidden=!1}},{key:"show",value:function(){this.hidden=!1,this.update(),this.adjustToBackgroundColor()}},{key:"resetIterator",value:function(){if(this.openSheetMusicDisplay.Sheet&&this.openSheetMusicDisplay.Sheet.SourceMeasures){var e=this.openSheetMusicDisplay.Sheet.SourceMeasures.length-1,t=this.rules.MinMeasureToDrawIndex;t=Math.min(t,e);var n=this.rules.MaxMeasureToDrawIndex;if(n=Math.min(n,e),this.openSheetMusicDisplay.Sheet&&(!this.openSheetMusicDisplay.Sheet.SelectionStart||this.openSheetMusicDisplay.Sheet.SelectionStart.WholeValue<t)&&this.openSheetMusicDisplay.Sheet.SourceMeasures.length>t&&(this.openSheetMusicDisplay.Sheet.SelectionStart=this.openSheetMusicDisplay.Sheet.SourceMeasures[t].AbsoluteTimestamp),this.openSheetMusicDisplay.Sheet&&this.openSheetMusicDisplay.Sheet.SourceMeasures.length>n){var i=this.openSheetMusicDisplay.Sheet.SourceMeasures[n];this.openSheetMusicDisplay.Sheet.SelectionEnd=r.Fraction.plus(i.AbsoluteTimestamp,i.Duration)}this.iterator=this.manager.getIterator()}else console.log("OSMD.Cursor.resetIterator(): sheet or measures were null/undefined.")}},{key:"getStaffEntryFromVoiceEntry",value:function(e){var t=e.ParentSourceStaffEntry.VerticalContainerParent.ParentMeasure.measureListIndex,n=e.ParentSourceStaffEntry.ParentStaff.idInMusicSheet;return this.graphic.findGraphicalStaffEntryFromMeasureList(n,t,e.ParentSourceStaffEntry)}},{key:"updateWithTimestamp",value:function(e){var t=this.manager.absoluteEnrolledToSheetTimestamp(e),n=this.graphic.calculateXPositionFromTimestamp(t),i=n[0],r=n[1];this.updateCurrentPageFromSystem(r);var a=n[2];if(a){var s,o,u=Math.max(a.parentMeasure.MeasureNumber,1),l=b(this.graphic.MeasureList[u-1]);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c){s=c;break}}}catch(m){l.e(m)}finally{l.f()}var h=this.graphic.calculateCursorPoints(i,r),d=h[0].y,f=h[1].y-d;if(this.updateWidthAndStyle(s.PositionAndShape,i,d,f),this.openSheetMusicDisplay.FollowCursor){var p=this.cursorElement.getBoundingClientRect().top;this.cursorElement.scrollIntoView({behavior:p<1e3?"smooth":"auto",block:"center"})}this.cursorElement.style.display=""}}},{key:"update",value:function(){var e,t,n=this;if(!this.hidden&&void 0!==this.hidden&&null!==this.hidden){this.updateCurrentPage();var i=this.Iterator,r=i.CurrentVisibleVoiceEntries();if(!i.EndReached&&i.CurrentVoiceEntries&&0!==r.length){var a,s=0,o=0,u=0;if(i.CurrentMeasure.isReducedToMultiRest){var l=this.graphic.findGraphicalMeasure(i.CurrentMeasureIndex,0),c=l.parentSourceMeasure.multipleRestMeasures,h=i.CurrentMeasure.multipleRestMeasureNumber/(c+1),d=l.PositionAndShape.Size.width-l.beginInstructionsWidth;s=l.PositionAndShape.AbsolutePosition.x+l.beginInstructionsWidth+h*d,a=l.ParentMusicSystem}else{var f=r.map((function(e){return n.getStaffEntryFromVoiceEntry(e)})).sort((function(e,t){var n,i,r,a;return(null===(i=null===(n=null==e?void 0:e.PositionAndShape)||void 0===n?void 0:n.AbsolutePosition)||void 0===i?void 0:i.x)<=(null===(a=null===(r=null==t?void 0:t.PositionAndShape)||void 0===r?void 0:r.AbsolutePosition)||void 0===a?void 0:a.x)?-1:1}))[0];f&&(s=f.PositionAndShape.AbsolutePosition.x,a=f.parentMeasure.ParentMusicSystem)}if(a){o=null!==(t=a.PositionAndShape.AbsolutePosition.y+(null===(e=a.StaffLines[0])||void 0===e?void 0:e.PositionAndShape.RelativePosition.y))&&void 0!==t?t:0;var p=a.PositionAndShape.AbsolutePosition.y,m=a.StaffLines[a.StaffLines.length-1];m&&(p+=m.PositionAndShape.RelativePosition.y+m.StaffHeight),u=p-o;var v=this.graphic.findGraphicalMeasure(i.CurrentMeasureIndex,0).PositionAndShape;if(this.updateWidthAndStyle(v,s,o,u),this.openSheetMusicDisplay.FollowCursor&&this.cursorOptions.follow)if(this.openSheetMusicDisplay.EngravingRules.RenderSingleHorizontalStaffline)this.cursorElement.scrollIntoView({behavior:"smooth",inline:"center"});else{var g=this.cursorElement.getBoundingClientRect().top;this.cursorElement.scrollIntoView({behavior:g<1e3?"smooth":"auto",block:"center"})}this.cursorElement.style.display=""}}}}},{key:"updateWidthAndStyle",value:function(e,t,n,i){var r=this.cursorElement,a=0,s=i;switch(this.cursorOptions.type){case 1:r.style.top=10*n*this.openSheetMusicDisplay.zoom+"px",r.style.left=10*(t-1.5)*this.openSheetMusicDisplay.zoom+"px",s=10*i*this.openSheetMusicDisplay.zoom,r.height=s,r.style.height=s+"px",a=5*this.openSheetMusicDisplay.zoom;break;case 2:r.style.top=10*(n-2.5)*this.openSheetMusicDisplay.zoom+"px",r.style.left=10*t*this.openSheetMusicDisplay.zoom+"px",s=15*this.openSheetMusicDisplay.zoom,r.height=s,r.style.height=s+"px",a=5*this.openSheetMusicDisplay.zoom;break;case 3:r.style.top=10*e.AbsolutePosition.y*this.openSheetMusicDisplay.zoom+"px",r.style.left=10*e.AbsolutePosition.x*this.openSheetMusicDisplay.zoom+"px",s=10*i*this.openSheetMusicDisplay.zoom,r.height=s,r.style.height=s+"px",a=10*e.Size.width*this.openSheetMusicDisplay.zoom;break;case 4:r.style.top=10*e.AbsolutePosition.y*this.openSheetMusicDisplay.zoom+"px",r.style.left=10*e.AbsolutePosition.x*this.openSheetMusicDisplay.zoom+"px",s=10*i*this.openSheetMusicDisplay.zoom,r.height=s,r.style.height=s+"px",a=10*(t-e.AbsolutePosition.x)*this.openSheetMusicDisplay.zoom;break;default:r.style.top=10*n*this.openSheetMusicDisplay.zoom+"px",r.style.left=10*(t-1.5)*this.openSheetMusicDisplay.zoom+"px",s=10*i*this.openSheetMusicDisplay.zoom,r.height=s,r.style.height=s+"px",a=30*this.openSheetMusicDisplay.zoom}a!==r.width&&(r.width=a,this.updateStyle(a,this.cursorOptions))}},{key:"hide",value:function(){this.cursorElement.style.display="none",this.hidden=!0}},{key:"next",value:function(){this.Iterator.moveToNextVisibleVoiceEntry(!1),this.update()}},{key:"reset",value:function(){this.resetIterator();var e=this.manager.getIterator(this.graphic.ParentMusicSheet.SelectionStart);this.updateWithTimestamp(e.CurrentEnrolledTimestamp)}},{key:"updateStyle",value:function(e,t){void 0!==t&&(this.cursorOptions=t);var n=document.createElement("canvas");n.width=this.cursorElement.width,n.height=1;var i=n.getContext("2d");i.globalAlpha=this.cursorOptions.alpha;var r=i.createLinearGradient(0,0,this.cursorElement.width,0);switch(this.cursorOptions.type){case 1:case 2:case 3:case 4:r.addColorStop(1,this.cursorOptions.color);break;default:r.addColorStop(0,"white"),r.addColorStop(.2,this.cursorOptions.color),r.addColorStop(.8,this.cursorOptions.color),r.addColorStop(1,"white")}i.fillStyle=r,i.fillRect(0,0,e,1),this.cursorElement.src=n.toDataURL("image/png")}},{key:"Iterator",get:function(){return this.iterator}},{key:"Hidden",get:function(){return this.hidden}},{key:"VoicesUnderCursor",value:function(e){return this.Iterator.CurrentVisibleVoiceEntries(e)}},{key:"NotesUnderCursor",value:function(e){var t=this.VoicesUnderCursor(e),n=[];return t.forEach((function(e){n.push.apply(n,e.Notes)})),n}},{key:"GNotesUnderCursor",value:function(e){var t=this,n=this.VoicesUnderCursor(e),i=[];return n.forEach((function(e){i.push.apply(i,S(e.Notes.map((function(e){return t.rules.GNote(e)}))))})),i}},{key:"updateCurrentPage",value:function(){var e,t=this.Iterator.currentTimeStamp,n=b(this.graphic.MusicPages);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.MusicSystems.last().GetSystemsLastTimeStamp().gt(t)){var r=i.PageNumber;return r!==this.currentPageNumber&&(this.container.removeChild(this.cursorElement),this.container=document.getElementById("osmdCanvasPage"+r),this.container.appendChild(this.cursorElement)),this.currentPageNumber=r}}}catch(a){n.e(a)}finally{n.f()}return 1}},{key:"updateCurrentPageFromSystem",value:function(e){if(null==e?void 0:e.Parent){var t=e.Parent.PageNumber;return t!==this.currentPageNumber&&(this.container.removeChild(this.cursorElement),this.container=document.getElementById("osmdCanvasPage"+t),this.container.appendChild(this.cursorElement)),this.currentPageNumber=t}return 1}},{key:"Dispose",value:function(){this.rules=void 0,this.openSheetMusicDisplay=void 0,this.cursorOptions=void 0}}]),e}()},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OSMDOptions=t.SkyBottomLineBatchCalculatorBackendType=t.BackendType=t.FillEmptyMeasuresWithWholeRests=t.AlignRestOption=t.CursorType=void 0;var i,r,a,s,o,u=n(7459);(o=t.CursorType||(t.CursorType={}))[o.Standard=0]="Standard",o[o.ThinLeft=1]="ThinLeft",o[o.ShortThinTopLeft=2]="ShortThinTopLeft",o[o.CurrentArea=3]="CurrentArea",o[o.CurrentAreaLeft=4]="CurrentAreaLeft",(s=t.AlignRestOption||(t.AlignRestOption={}))[s.Never=0]="Never",s[s.Always=1]="Always",s[s.Auto=2]="Auto",(a=t.FillEmptyMeasuresWithWholeRests||(t.FillEmptyMeasuresWithWholeRests={}))[a.No=0]="No",a[a.YesVisible=1]="YesVisible",a[a.YesInvisible=2]="YesInvisible",function(e){e[e.SVG=0]="SVG",e[e.Canvas=1]="Canvas"}(i=t.BackendType||(t.BackendType={})),(r=t.SkyBottomLineBatchCalculatorBackendType||(t.SkyBottomLineBatchCalculatorBackendType={}))[r.Plain=0]="Plain",r[r.WebGL=1]="WebGL",t.OSMDOptions=function(){function e(){g(this,e)}return y(e,null,[{key:"OSMDOptionsStandard",value:function(){return{autoResize:!0,backend:"svg",drawingParameters:u.DrawingParametersEnum.default}}},{key:"BackendTypeFromString",value:function(e){return e&&"canvas"===e.toLowerCase()?i.Canvas:i.SVG}}]),e}()},9629:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenSheetMusicDisplay=void 0;var r=n(9228),a=n(8738),s=n(1372),o=n(4324),u=n(4040),l=n(5820),c=n(9505),h=n(4028),d=n(530),f=n(7056),p=n(3495),m=i(n(2043)),v=n(7459),S=n(41),x=n(1405),_=n(3748),E=n(1649),k=n(8155),M=n(8640),w=n(1596),P=n(2660),T=n(4821),C=n(8198),I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.OSMDOptions.OSMDOptionsStandard(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new x.EngravingRules;if(g(this,e),this.version="1.6.0-audio-extended",this.cursorsOptions=[],this.cursors=[],this.zoom=1,this.zoomUpdated=!1,this.loadUrlTimeout=5e3,this.rules=i,"string"==typeof t?this.container=document.getElementById(t):t&&"appendChild"in t&&(this.container=t),!this.container)throw new Error("Please pass a valid div container to OpenSheetMusicDisplay");void 0===n.autoResize&&(n.autoResize=!0),this.backendType=S.BackendType.SVG,this.setOptions(n),this.interactionManager=new T.WebDisplayInteractionManager(this.container),this.renderingManager=new P.WebSheetRenderingManager(this.interactionManager,this.rules)}return y(e,[{key:"cursor",get:function(){return this.cursors[0]}},{key:"RenderingManager",get:function(){return this.renderingManager}},{key:"PlaybackManager",get:function(){var e;return null===(e=this.renderingManager)||void 0===e?void 0:e.PlaybackManager},set:function(e){this.renderingManager&&(this.renderingManager.PlaybackManager=e)}},{key:"isUrl",value:function(e){return e.length<2083}},{key:"isMxl",value:function(e){return"PK\x03\x04"===e.substr(0,4)}},{key:"processMxl",value:function(e,t,n){var i=this;f.MXLHelper.MXLtoXMLstring(e).then((function(e){t(i.processStringXml(e))}),(function(e){m.default.error(new Error("[OSMD] Invalid MXL file: "+e)),n(new Error("[OSMD] Invalid MXL file: "+e))}))}},{key:"processStringXml",value:function(e){var t=new DOMParser;if("\uf7ef\uf7bb\uf7bf"===e.substr(0,3))return m.default.debug("[OSMD] UTF with BOM detected, truncate first three bytes and pass along: "+e),t.parseFromString(e.substr(3),"application/xml");if(e.substr(0,6).includes("<?xml")){var n=this.OnXMLRead(e);return m.default.debug("[OSMD] Finally parsing XML content, length: "+n.length),t.parseFromString(n,"application/xml")}}},{key:"load",value:function(e){this.reset();var t=this;return new Promise((function(n,i){new Promise((function(n,i){if("string"==typeof e){var r=e.trim();if(t.isMxl(r))m.default.debug("[OSMD] This is a zip file, unpack it first: "+r),t.processMxl(r,n,i);else{var a=t.processStringXml(r);if(a)n(a);else if(t.isUrl(r))p.AJAX.ajax(r).then((function(e){t.isMxl(e)?t.processMxl(e,n,i):n(t.processStringXml(e))}),(function(e){throw i(e),e}));else{var s=new Error("[OSMD] osmd.load(string): Could not process string. Did not find <?xml at beginning.");console.error(s.message),i(s)}}}else if(e instanceof Document)n(e);else{var o=new Error("[OSMD] osmd.load(): content is not string or Document. Could not load.");console.error(o.message),i(o)}})).then((function(e){e&&e.nodeName||i(new Error("OpenSheetMusicDisplay: The document which was provided is invalid"));var a,o=e.childNodes;m.default.debug("[OSMD] load(), Document url: "+e.URL);for(var u=0,l=o.length;u<l;u+=1){var c=o[u];if(c.nodeType===Node.ELEMENT_NODE&&"score-partwise"===c.nodeName.toLowerCase()){a=c;break}}a||(console.error("Could not parse MusicXML, no valid partwise element found"),i(new Error("OpenSheetMusicDisplay: Document is not a valid 'partwise' MusicXML")));var h=new r.IXmlElement(a),d=new C.DynamicsCalculator,f=new w.PlaybackNoteGenerator,p=new s.MusicSheetReader([d,f],t.rules);t.sheet=p.createMusicSheet(h,"Untitled Score"),void 0===t.sheet&&i(new Error("given music sheet was incomplete or could not be loaded.")),m.default.info("[OSMD] Loaded sheet ".concat(t.sheet.TitleString," successfully.")),t.needBackendUpdate=!0,t.updateGraphic(),n()})).catch((function(e){m.default.debug("Content XML Promise was rejected"),i(e)}))}))}},{key:"updateGraphic",value:function(){var e=this,t=new a.VexFlowMusicSheetCalculator(this.rules);this.graphic=new o.GraphicalMusicSheet(this.sheet,t),this.drawingParameters.drawCursors&&this.cursors.forEach((function(t){t.init(e.sheet.MusicPartManager,e.graphic)})),this.renderingManager.setMusicSheet(this.graphic),this.interactionManager.Initialize()}},{key:"render",value:function(){var e;if(!this.graphic)throw new Error("OpenSheetMusicDisplay: Before rendering a music sheet, please load a MusicXML file");null===(e=this.drawer)||void 0===e||e.clear();var t=this.container.offsetWidth;this.rules.RenderSingleHorizontalStaffline&&(t=this.rules.SheetMaximumWidth),this.sheet.pageWidth=t/this.zoom/10,this.renderingManager.MainViewingRegion.WidthInUnits=this.sheet.pageWidth,this.rules.PageFormat&&!this.rules.PageFormat.IsUndefined?(this.rules.PageHeight=this.sheet.pageWidth/this.rules.PageFormat.aspectRatio,m.default.debug("[OSMD] PageHeight: "+this.rules.PageHeight)):(m.default.debug("[OSMD] endless/undefined pageformat, id: "+this.rules.PageFormat.idString),this.rules.PageHeight=100001),this.graphic.reCalculate(),this.drawingParameters.drawCursors&&(this.graphic.Cursors.length=0),this.createOrRefreshRenderBackend(),this.needBackendUpdate=!1,this.drawer.setZoom(this.zoom);var n,i=b(this.sheet.SourceMeasures);try{for(i.s();!(n=i.n()).done;)n.value.WasRendered=!1}catch(r){i.e(r)}finally{i.f()}this.drawer.drawSheet(this.graphic),this.enableOrDisableCursors(this.drawingParameters.drawCursors),this.drawingParameters.drawCursors&&this.cursors.forEach((function(e){e.update()})),this.zoomUpdated=!1,this.interactionManager.displaySizeChanged(this.container.clientWidth,this.container.clientHeight)}},{key:"createOrRefreshRenderBackend",value:function(){this.drawer&&this.drawer.Backends&&(this.drawer.Backends[0]&&this.drawer.Backends[0].removeAllChildrenFromContainer(this.container),this.drawer.Backends.clear()),this.drawingParameters.Rules=this.rules,this.drawer=new l.VexFlowMusicSheetDrawer(this.drawingParameters),this.drawer.drawableBoundingBoxElement=this.DrawBoundingBox,this.drawer.bottomLineVisible=this.drawBottomLine,this.drawer.skyLineVisible=this.drawSkyLine;var e,t=this.container.offsetWidth;this.rules.RenderSingleHorizontalStaffline&&(t=10*(this.EngravingRules.PageLeftMargin+this.graphic.MusicPages[0].PositionAndShape.Size.width+this.EngravingRules.PageRightMargin)*this.zoom);var n,i=32767,r=b(this.graphic.MusicPages);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.PageNumber>this.rules.MaxPageToDrawNumber)break;var s=this.createBackend(this.backendType,a),o=" exceeds CanvasBackend limit of 32767. Cutting off score.";s.getOSMDBackendType()===S.BackendType.Canvas&&t>i&&(m.default.warn("[OSMD] Warning: width of "+t+o),t=i),this.rules.PageFormat&&!this.rules.PageFormat.IsUndefined?e=t/this.rules.PageFormat.aspectRatio:(e=a.PositionAndShape.Size.height,e+=this.rules.PageBottomMargin,s.getOSMDBackendType()===S.BackendType.Canvas&&(e+=.1),e+=a.PositionAndShape.BorderTop,this.rules.RenderTitle&&(e+=this.rules.TitleTopDistance),e*=10*this.zoom),s.getOSMDBackendType()===S.BackendType.Canvas&&e>i&&(m.default.warn("[OSMD] Warning: height of "+e+o),e=Math.min(e,i)),s.resize(t,e),s.clear(),s.getContext().setFillStyle(this.rules.DefaultColorMusic),s.getContext().setStrokeStyle(this.rules.DefaultColorMusic),this.drawer.Backends.push(s),this.graphic.drawer=this.drawer}}catch(u){r.e(u)}finally{r.f()}}},{key:"exportSVG",value:function(){var e,t,n=b(null===(e=this.drawer)||void 0===e?void 0:e.Backends);try{for(n.s();!(t=n.n()).done;){var i=t.value;i instanceof c.SvgVexFlowBackend&&i.export()}}catch(r){n.e(r)}finally{n.f()}}},{key:"IsReadyToRender",value:function(){return void 0!==this.graphic}},{key:"clear",value:function(){var e;null===(e=this.drawer)||void 0===e||e.clear(),this.reset()}},{key:"dispose",value:function(){this.disposeResizeListener&&this.disposeResizeListener(),this.InteractionManager&&this.InteractionManager.Dispose()}},{key:"setOptions",value:function(e){if(this.rules||(this.rules=new x.EngravingRules),this.drawingParameters||e.drawingParameters?e.drawingParameters&&(this.drawingParameters?this.drawingParameters.DrawingParametersEnum=v.DrawingParametersEnum[e.drawingParameters.toLowerCase()]:this.drawingParameters=new v.DrawingParameters(v.DrawingParametersEnum[e.drawingParameters],this.rules)):this.drawingParameters=new v.DrawingParameters(v.DrawingParametersEnum.default,this.rules),null!=e){this.OnXMLRead=function(e){return e},e.onXMLRead&&(this.OnXMLRead=e.onXMLRead);var t=!this.drawer||!this.drawer.Backends||this.drawer.Backends.length<1;if(void 0!==e.backend){var n=S.OSMDOptions.BackendTypeFromString(e.backend);t=t||this.backendType!==n,this.backendType=n}this.needBackendUpdate=t,void 0!==e.autoBeam&&(this.rules.AutoBeamNotes=e.autoBeam);var i=e.autoBeamOptions;if(i&&(void 0===i.maintain_stem_directions&&(i.maintain_stem_directions=!1),this.rules.AutoBeamOptions=i,i.groups&&i.groups.length)){var r,a=b(i.groups);try{for(a.s();!(r=a.n()).done;)if(2!==r.value.length)throw new Error("Each fraction in autoBeamOptions.groups must be of length 2, e.g. [3,4] for beaming three fourths")}catch(s){a.e(s)}finally{a.f()}}void 0!==e.percussionOneLineCutoff&&(this.rules.PercussionOneLineCutoff=e.percussionOneLineCutoff),0!==this.rules.PercussionOneLineCutoff&&void 0!==e.percussionForceVoicesOneLineCutoff&&(this.rules.PercussionForceVoicesOneLineCutoff=e.percussionForceVoicesOneLineCutoff),void 0!==e.alignRests&&(this.rules.AlignRests=e.alignRests),void 0!==e.coloringMode&&this.setColoringMode(e),void 0!==e.coloringEnabled&&(this.rules.ColoringEnabled=e.coloringEnabled),void 0!==e.colorStemsLikeNoteheads&&(this.rules.ColorStemsLikeNoteheads=e.colorStemsLikeNoteheads),e.disableCursor&&(this.drawingParameters.drawCursors=!1),e.drawHiddenNotes&&(this.drawingParameters.drawHiddenNotes=!0),void 0!==e.drawCredits&&(this.drawingParameters.DrawCredits=e.drawCredits),void 0!==e.drawComposer&&(this.drawingParameters.DrawComposer=e.drawComposer),void 0!==e.drawTitle&&(this.drawingParameters.DrawTitle=e.drawTitle),void 0!==e.drawSubtitle&&(this.drawingParameters.DrawSubtitle=e.drawSubtitle),void 0!==e.drawLyricist&&(this.drawingParameters.DrawLyricist=e.drawLyricist),void 0!==e.drawMetronomeMarks&&(this.rules.MetronomeMarksDrawn=e.drawMetronomeMarks),void 0!==e.drawPartNames&&(this.drawingParameters.DrawPartNames=e.drawPartNames,e.drawPartAbbreviations||(this.rules.RenderPartAbbreviations=e.drawPartNames)),void 0!==e.drawPartAbbreviations&&(this.rules.RenderPartAbbreviations=e.drawPartAbbreviations),!1===e.drawFingerings&&(this.rules.RenderFingerings=!1),void 0!==e.drawMeasureNumbers&&(this.rules.RenderMeasureNumbers=e.drawMeasureNumbers),e.drawMeasureNumbersOnlyAtSystemStart&&(this.rules.RenderMeasureNumbersOnlyAtSystemStart=e.drawMeasureNumbersOnlyAtSystemStart),void 0!==e.drawLyrics&&(this.rules.RenderLyrics=e.drawLyrics),void 0!==e.drawTimeSignatures&&(this.rules.RenderTimeSignatures=e.drawTimeSignatures),void 0!==e.drawSlurs&&(this.rules.RenderSlurs=e.drawSlurs),void 0!==e.measureNumberInterval&&(this.rules.MeasureNumberLabelOffset=e.measureNumberInterval),void 0!==e.useXMLMeasureNumbers&&(this.rules.UseXMLMeasureNumbers=e.useXMLMeasureNumbers),void 0!==e.fingeringPosition&&(this.rules.FingeringPosition=_.AbstractExpression.PlacementEnumFromString(e.fingeringPosition)),void 0!==e.fingeringInsideStafflines&&(this.rules.FingeringInsideStafflines=e.fingeringInsideStafflines),void 0!==e.newSystemFromXML&&(this.rules.NewSystemAtXMLNewSystemAttribute=e.newSystemFromXML),void 0!==e.newPageFromXML&&(this.rules.NewPageAtXMLNewPageAttribute=e.newPageFromXML),void 0!==e.fillEmptyMeasuresWithWholeRest&&(this.rules.FillEmptyMeasuresWithWholeRest=e.fillEmptyMeasuresWithWholeRest),void 0!==e.followCursor&&(this.FollowCursor=e.followCursor),void 0!==e.setWantedStemDirectionByXml&&(this.rules.SetWantedStemDirectionByXml=e.setWantedStemDirectionByXml),e.darkMode?(this.rules.applyDefaultColorMusic("#FFFFFF"),this.rules.PageBackgroundColor="#000000"):!1===e.darkMode&&(this.rules.applyDefaultColorMusic("#000000"),this.rules.PageBackgroundColor=void 0),e.defaultColorMusic&&this.rules.applyDefaultColorMusic(e.defaultColorMusic),e.defaultColorNotehead&&(this.rules.DefaultColorNotehead=e.defaultColorNotehead),e.defaultColorRest&&(this.rules.DefaultColorRest=e.defaultColorRest),e.defaultColorStem&&(this.rules.DefaultColorStem=e.defaultColorStem),e.defaultColorLabel&&(this.rules.DefaultColorLabel=e.defaultColorLabel),e.defaultColorTitle&&(this.rules.DefaultColorTitle=e.defaultColorTitle),e.defaultFontFamily&&(this.rules.DefaultFontFamily=e.defaultFontFamily),e.defaultFontStyle&&(this.rules.DefaultFontStyle=e.defaultFontStyle),e.drawUpToMeasureNumber&&(this.rules.MaxMeasureToDrawIndex=e.drawUpToMeasureNumber-1),e.drawFromMeasureNumber&&(this.rules.MinMeasureToDrawIndex=e.drawFromMeasureNumber-1),e.drawUpToPageNumber&&(this.rules.MaxPageToDrawNumber=e.drawUpToPageNumber),e.drawUpToSystemNumber&&(this.rules.MaxSystemToDrawNumber=e.drawUpToSystemNumber),e.tupletsRatioed&&(this.rules.TupletsRatioed=!0),e.tupletsBracketed&&(this.rules.TupletsBracketed=!0),e.tripletsBracketed&&(this.rules.TripletsBracketed=!0),e.autoResize?(this.resizeHandlerAttached||this.autoResize(),this.autoResizeEnabled=!0):!1===e.autoResize&&(this.autoResizeEnabled=!1),void 0!==e.pageFormat&&this.setPageFormat(e.pageFormat),void 0!==e.pageBackgroundColor&&(this.rules.PageBackgroundColor=e.pageBackgroundColor),void 0!==e.performanceMode&&(this.rules.PerformanceMode=e.performanceMode),void 0!==e.renderSingleHorizontalStaffline&&(this.rules.RenderSingleHorizontalStaffline=e.renderSingleHorizontalStaffline),void 0!==e.spacingFactorSoftmax&&(this.rules.SoftmaxFactorVexFlow=e.spacingFactorSoftmax),void 0!==e.spacingBetweenTextLines&&(this.rules.SpacingBetweenTextLines=e.spacingBetweenTextLines),void 0!==e.stretchLastSystemLine&&(this.rules.StretchLastSystemLine=e.stretchLastSystemLine),void 0!==e.autoGenerateMutipleRestMeasuresFromRestMeasures&&(this.rules.AutoGenerateMutipleRestMeasuresFromRestMeasures=e.autoGenerateMutipleRestMeasuresFromRestMeasures),void 0!==e.cursorsOptions?this.cursorsOptions=e.cursorsOptions:this.cursorsOptions=[{type:0,color:this.EngravingRules.DefaultColorCursor,alpha:.5,follow:!0}],void 0!==e.preferredSkyBottomLineBatchCalculatorBackend&&(this.rules.PreferredSkyBottomLineBatchCalculatorBackend=e.preferredSkyBottomLineBatchCalculatorBackend),void 0!==e.skyBottomLineBatchMinMeasures&&(this.rules.SkyBottomLineBatchMinMeasures=e.skyBottomLineBatchMinMeasures)}else m.default.warn("warning: osmd.setOptions() called without an options parameter, has no effect.\nexample usage: osmd.setOptions({drawCredits: false, drawPartNames: false})")}},{key:"setColoringMode",value:function(e){if(e.coloringMode!==v.ColoringModes.XML){var t,n=[M.NoteEnum.C,M.NoteEnum.D,M.NoteEnum.E,M.NoteEnum.F,M.NoteEnum.G,M.NoteEnum.A,M.NoteEnum.B,-1];if(e.coloringMode===v.ColoringModes.CustomColorSet){if(!e.coloringSetCustom||8!==e.coloringSetCustom.length)throw new Error("Invalid amount of colors: With coloringModes.customColorSet, you have to provide a coloringSetCustom parameter with 8 strings (C to B, rest note).");var i,r=b(e.coloringSetCustom);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(!/^\#[0-9a-fA-F]{6}$/.test(a))throw new Error("One of the color strings in options.coloringSetCustom was not a valid HTML Hex color:\n"+a)}}catch(c){r.e(c)}finally{r.f()}t=e.coloringSetCustom}else if(e.coloringMode===v.ColoringModes.AutoColoring){t=[];for(var s=Object.keys(k.AutoColorSet),o=0;o<s.length;o++)t.push(k.AutoColorSet[s[o]])}for(var u=new E.Dictionary,l=0;l<n.length;l++)u.setValue(n[l],t[l]);u.setValue(-1,t[7]),this.rules.ColoringSetCurrent=u,this.rules.ColoringMode=e.coloringMode}else this.rules.ColoringMode=v.ColoringModes.XML}},{key:"setLogLevel",value:function(e){switch(e){case"trace":m.default.setLevel(m.default.levels.TRACE);break;case"debug":m.default.setLevel(m.default.levels.DEBUG);break;case"info":m.default.setLevel(m.default.levels.INFO);break;case"warn":m.default.setLevel(m.default.levels.WARN);break;case"error":m.default.setLevel(m.default.levels.ERROR);break;case"silent":m.default.setLevel(m.default.levels.SILENT);break;default:m.default.warn("Could not set log level to ".concat(e,". Using warn instead.")),m.default.setLevel(m.default.levels.WARN)}}},{key:"getLogLevel",value:function(){return m.default.getLevel()}},{key:"reset",value:function(){this.drawingParameters.drawCursors&&this.cursors.forEach((function(e){e.hide()})),this.sheet=void 0,this.graphic=void 0,this.zoom=1}},{key:"autoResize",value:function(){var e=this,t=this;this.handleResize((function(){}),(function(){var n;(null===(n=e.graphic)||void 0===n?void 0:n.GetCalculator)instanceof a.VexFlowMusicSheetCalculator&&(e.graphic.GetCalculator.beamsNeedUpdate=!0),t.IsReadyToRender()&&t.render()}))}},{key:"handleResize",value:function(e,t){var n,i,r=this,a=this;function s(){a.AutoResizeEnabled&&(n=(new Date).getTime(),i||(e(),n=(new Date).getTime(),i=window.setTimeout(o,200)))}function o(){i=void 0,window.clearTimeout(i),(new Date).getTime()-n<200?i=window.setTimeout(o,200):t()}window.attachEvent?window.attachEvent("onresize",s):window.addEventListener("resize",s),this.disposeResizeListener=function(){window.detachEvent?window.detachEvent("onresize",s):window.removeEventListener("resize",s),r.resizeHandlerAttached=!1},this.resizeHandlerAttached=!0,window.setTimeout(e,0),window.setTimeout(t,1)}},{key:"enableOrDisableCursors",value:function(e){var t,n,i,r,a,s,o;if(this.drawingParameters.drawCursors=e,e){for(var u=0;u<this.cursorsOptions.length;u++){var l=null!==(n=null===(t=this.cursors[u])||void 0===t?void 0:t.Hidden)&&void 0!==n&&n,c=null===(i=this.cursors[u])||void 0===i?void 0:i.Iterator;null===(r=this.cursors[u])||void 0===r||r.hide();var h=null===(a=this.drawer)||void 0===a?void 0:a.Backends[0];if(h&&this.rules.RestoreCursorAfterRerender&&this.cursors[u]){var f=this.cursors[u].updateCurrentPage();h=this.drawer.Backends[f-1]}h&&h.getRenderElement()&&(this.cursors[u]&&(null===(s=this.PlaybackManager)||void 0===s||s.removeListener(this.cursors[u]),this.cursors[u].Dispose()),this.cursors[u]=new d.Cursor(h.getRenderElement(),this,this.cursorsOptions[u])),this.sheet&&this.graphic&&this.cursors[u]&&this.cursors[u].init(this.sheet.MusicPartManager,this.graphic),this.rules.RestoreCursorAfterRerender&&(c&&(this.cursors[u].iterator=c),l?this.cursors[u].hide():this.cursors[u].show())}null===(o=this.renderingManager.PlaybackManager)||void 0===o||o.addListener(this.cursor)}else this.cursors.forEach((function(e){e.hide()}))}},{key:"createBackend",value:function(e,t){var n;return(n=void 0===e||e===S.BackendType.SVG?new c.SvgVexFlowBackend(this.rules):new h.CanvasVexFlowBackend(this.rules)).graphicalMusicPage=t,n.initialize(this.container,this.zoom),n}},{key:"setPageFormat",value:function(t){var n=e.StringToPageFormat(t);this.needBackendUpdate=!n.Equals(this.rules.PageFormat),this.rules.PageFormat=n}},{key:"setCustomPageFormat",value:function(e,t){if(e>0&&t>0){var n=new x.PageFormat(e,t);this.rules.PageFormat=n}}},{key:"DrawSkyLine",get:function(){return this.drawer.skyLineVisible},set:function(e){this.drawSkyLine=e,this.drawer&&(this.drawer.skyLineVisible=e)}},{key:"DrawBottomLine",get:function(){return this.drawer.bottomLineVisible},set:function(e){this.drawBottomLine=e,this.drawer&&(this.drawer.bottomLineVisible=e)}},{key:"DrawBoundingBox",get:function(){return this.drawBoundingBox},set:function(e){this.setDrawBoundingBox(e,!0)}},{key:"setDrawBoundingBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.drawBoundingBox=e,this.drawer&&(this.drawer.drawableBoundingBoxElement=e),t&&this.render()}},{key:"AutoResizeEnabled",get:function(){return this.autoResizeEnabled},set:function(e){this.autoResizeEnabled=e}},{key:"Zoom",get:function(){return this.zoom},set:function(e){var t;this.zoom=e,this.zoomUpdated=!0,(null===(t=this.graphic)||void 0===t?void 0:t.GetCalculator)instanceof a.VexFlowMusicSheetCalculator&&(this.graphic.GetCalculator.beamsNeedUpdate=this.zoomUpdated)}},{key:"FollowCursor",get:function(){return this.followCursor},set:function(e){this.followCursor=e}},{key:"TransposeCalculator",get:function(){return u.MusicSheetCalculator.transposeCalculator},set:function(e){u.MusicSheetCalculator.transposeCalculator=e}},{key:"Sheet",get:function(){return this.sheet}},{key:"Drawer",get:function(){return this.drawer}},{key:"GraphicSheet",get:function(){return this.graphic}},{key:"DrawingParameters",get:function(){return this.drawingParameters}},{key:"EngravingRules",get:function(){return this.rules}},{key:"InteractionManager",get:function(){return this.interactionManager}},{key:"Version",get:function(){return this.version}}],[{key:"StringToPageFormat",value:function(t){var n=x.PageFormat.UndefinedPageFormat;if(t.match("^[0-9]+x[0-9]+$")){var i=t.split("x"),r=Number.parseInt(i[0],10),a=Number.parseInt(i[1],10);r>0&&r<32768&&a>0&&a<32768&&(n=new x.PageFormat(r,a,"customPageFormat".concat(t)))}return t=(t=(t=t.replace(" ","_")).replace("Landscape","L")).replace("Portrait","P"),e.PageFormatStandards.hasOwnProperty(t)?n=e.PageFormatStandards[t]:n}}]),e}();t.OpenSheetMusicDisplay=I,I.PageFormatStandards={A3_L:new x.PageFormat(420,297,"A3_L"),A3_P:new x.PageFormat(297,420,"A3_P"),A4_L:new x.PageFormat(297,210,"A4_L"),A4_P:new x.PageFormat(210,297,"A4_P"),A5_L:new x.PageFormat(210,148,"A5_L"),A5_P:new x.PageFormat(148,210,"A5_P"),A6_L:new x.PageFormat(148,105,"A6_L"),A6_P:new x.PageFormat(105,148,"A6_P"),Endless:x.PageFormat.UndefinedPageFormat,Letter_L:new x.PageFormat(279.4,215.9,"Letter_L"),Letter_P:new x.PageFormat(215.9,279.4,"Letter_P")}},2861:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(3495),t),r(n(530),t),r(n(41),t),r(n(9629),t)},419:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasicAudioPlayer=void 0;var o=n(289),u=n(807),l=a(n(8346)),c=s(n(722));t.BasicAudioPlayer=function(){function e(){g(this,e),this.ac=new u.AudioContext,this.channelVolumes=[],this.memoryLoadedSoundFonts=new Map,this.channelToSoundFont=new Map,this.SoundfontInstrumentOptions={from:void 0,nameToUrl:void 0},this.GainMultiplier=1,this.SoundfontInstrumentOptions.nameToUrl=this.nameToSoundfontUrl}return y(e,[{key:"open",value:function(){var e=v(f.mark((function e(t){var n,i,r=arguments;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:16,e.t0=void 0===this.piano,!e.t0){e.next=6;break}return e.next=5,l.instrument(this.ac,c.default[o.MidiInstrument.Acoustic_Grand_Piano].toLowerCase(),this.SoundfontInstrumentOptions);case 5:this.piano=e.sent;case 6:for(i=0;i<n;i++)this.channelVolumes[i]=.8;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"close",value:function(){}},{key:"tuningChanged",value:function(e){console.warn("BasicAudioPlayer tuningChanged not implemented")}},{key:"playSound",value:function(e,t,n,i){if(!(t>=128)){var r=Math.min(1,this.channelVolumes[e]*n);this.memoryLoadedSoundFonts.get(this.channelToSoundFont.get(e)).schedule(0,[{note:t,duration:i/1e3,gain:r*this.GainMultiplier}])}}},{key:"stopSound",value:function(e,t){}},{key:"setSound",value:function(){var e=v(f.mark((function e(t,n){return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=void 0===this.memoryLoadedSoundFonts.get(n),!e.t0){e.next=4;break}return e.next=4,this.loadSoundFont(n);case 4:this.channelToSoundFont.set(t,n);case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"loadSoundFont",value:function(){var e=v(f.mark((function e(t){var n,i;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.memoryLoadedSoundFonts.get(t)){e.next=2;break}return e.abrupt("return",this.memoryLoadedSoundFonts.get(t));case 2:return n=c.default[t].toLowerCase(),t===o.MidiInstrument.Percussion&&(n="https://paulrosen.github.io/midi-js-soundfonts/FluidR3_GM/percussion-mp3.js"),e.next=6,l.instrument(this.ac,n,this.SoundfontInstrumentOptions);case 6:return i=e.sent,e.abrupt("return",(this.memoryLoadedSoundFonts.set(t,i),i));case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"nameToSoundfontUrl",value:function(e,t,n){for(var i="https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js",r={"honky_tonk_piano-mp3.js":"honkytonk_piano-mp3.js","synth_voice-mp3.js":"synth_choir-mp3.js","lead_8_bass_lead-mp3.js":"lead_8_bass__lead-mp3.js"},a=0,s=Object.keys(r);a<s.length;a++){var o=s[a];i=i.replace(o,r[o])}return i}},{key:"setVolume",value:function(e,t){this.channelVolumes[e]=t}},{key:"setSoundFontFilePath",value:function(e,t){}},{key:"playbackHasStopped",value:function(){}},{key:"getMemoryLoadedSoundFonts",value:function(){return S(this.memoryLoadedSoundFonts.values())}}]),e}()},3575:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetronomeInstrument=void 0,t.MetronomeInstrument=function(){function e(t,n,i,r,a,s){g(this,e),this.id=t,this.name=n,this.visible=i,this.audible=r,this.Volume=a,this.MidiInstrumentId=s}return y(e,[{key:"PreCountVolume",get:function(){return this.preCountVolume>=0?this.preCountVolume:this.Volume},set:function(e){this.preCountVolume=e}},{key:"Audible",get:function(){return this.audible},set:function(e){this.audible=e}},{key:"Visible",get:function(){return this.visible},set:function(e){this.visible=e}},{key:"Mute",get:function(){return!this.Audible},set:function(e){this.Audible=!e}},{key:"Name",get:function(){return this.name}},{key:"setVoiceAudible",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setStaffAudible",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setVoiceFollowing",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setStaffFollow",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setVoicePitchMonitor",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setStaffPitchMonitor",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setInstrumentParameter",value:function(e,t){throw new Error("Method not implemented.")}},{key:"Id",get:function(){return this.id}}]),e}()},936:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackManager=t.ChannelNote=void 0;var r=n(9822),a=n(1649),s=n(6550),o=n(8918),u=n(3575),l=n(8151),c=n(9986),h=n(4761),d=n(8084),p=i(n(2043)),m=n(2406),S=function e(t,n,i){g(this,e),this.note=i,this.key=t,this.channel=n};t.ChannelNote=S,t.PlaybackManager=function(){function t(e,n,i,r){g(this,t),this.overrideBPM=void 0,this.listeners=[],this.percussionChannel=10,this.metronomeChannel=9,this.instrumentToStaffToMidiChannelDict=new a.Dictionary,this.instrumentIdMapping=new a.Dictionary,this.freeMidiChannels=[],this.notesToStop=new a.Dictionary,this.metronomeNote=new S(88,this.metronomeChannel),this.metronomeNoteFirstBeat=new S(64,this.metronomeChannel),this.currentMeasure=void 0,this.currentTimestamp=void 0,this.closestNextTimestamp=void 0,this.currentMetronomeBaseTimestamp=void 0,this.currentBeatDuration=void 0,this.currentIteratorSourceTimeStamp=void 0,this.beatCounter=0,this.runningState=m.PlaybackState.Stopped,this.isRunning=!1,this.isInitialized=!1,this.isPlaying=!1,this.metronomeSoundPlayed=!1,this.tempoImpactFactor=1,this.defaultVolume=.8,this.currentVolume=this.defaultVolume,this.dynamicImpactFactor=.6,this.scorePositionChangedData=new l.CursorPosChangedData,this.tooManyInstruments=!1,this.metronomeOnlyBPM=100,this.highlightPlayedNotes=!1,this.MoveCursorDuringPrecount=!0,this.doPreCount=!0,this.IgnoreFixedInstrumentKeysForPercussion=!0,this.SoloAttenuationValue=0;var o=c.TextTranslation.translateText("Playback/LabelMetronome","Metronome");this.metronome=new u.MetronomeInstrument(-1,o,!1,!0,0,s.MidiInstrument.Percussion),this.timingSource=e,this.audioMetronomePlayer=n,this.audioPlayer=i,this.messageViewer=r}return y(t,[{key:"addListener",value:function(e){this.listeners.includes(e)||this.listeners.push(e)}},{key:"removeListener",value:function(e){var t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}},{key:"CursorIterator",get:function(){return this.cursorIterator}},{key:"InstrumentIdMapping",get:function(){return this.instrumentIdMapping}},{key:"RunningState",get:function(){return this.runningState},set:function(e){this.runningState=e}},{key:"DoPreCount",get:function(){return this.doPreCount},set:function(e){this.doPreCount!==e&&(this.doPreCount=e)}},{key:"Metronome",get:function(){return this.metronome}},{key:"MetronomeOnlyBPM",get:function(){return this.metronomeOnlyBPM},set:function(e){this.metronomeOnlyBPM=e}},{key:"OriginalBpm",get:function(){return this.currentReferenceBPM}},{key:"playVoiceEntry",value:function(e){var t=e;if(void 0!==t){if(this.stopAllCurrentlyPlayingNotes(),this.highlightPlayedNotes){var n,i=[],r=b(t.Notes);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.state=h.NoteState.Selected,i.push(a)}}catch(E){r.e(E)}finally{r.f()}}var o,u=this.instrumentToStaffToMidiChannelDict.getValue(t.Notes[0].ParentStaff),l=t.ParentVoice.Parent,c=l.MidiInstrumentId===s.MidiInstrument.Percussion,d=.8,f=[],m=this.musicPartManager.MusicSheet.Transpose,v=t.ParentVoice.Parent.PlaybackTranspose,g=b(t.MainPlaybackEntry.Notes.filter((function(e){return 0!==e.MidiKey})));try{for(g.s();!(o=g.n()).done;){var y=o.value,x=y.MidiKey;if(c||(x+=v+m),void 0!==y.ParentNote.PlaybackInstrumentId){var _=l.getSubInstrument(y.ParentNote.PlaybackInstrumentId);void 0!==_&&_.fixedKey>=0&&(x=_.fixedKey)}try{void 0!==this.audioPlayer&&this.audioPlayer.playSound(u,x,d,500)}catch(e){p.default.info("PlaybackManager.playVoiceEntry: ",e)}f.push(new S(x,u,y))}}catch(E){g.e(E)}finally{g.f()}}}},{key:"initialize",value:function(e){if(this.isInitialized&&(this.stopAllCurrentlyPlayingNotes(),void 0!==this.audioPlayer&&this.audioPlayer.close(),this.cursorIterator=void 0,this.playbackIterator=void 0),this.isInitialized=!1,this.musicPartManager=e,void 0!==this.musicPartManager){var t=this.musicPartManager.MusicSheet;if(this.cursorIterator=this.musicPartManager.getIterator(),this.playbackIterator=new r.PlaybackIterator(t),void 0!==this.audioPlayer){var n=Array.from(new Set(t.Instruments.map((function(e){return e.MidiInstrumentId}))));this.audioPlayer.open(n,16),this.audioPlayer.setSound(this.percussionChannel,s.MidiInstrument.Percussion),this.audioPlayer.setSound(this.metronomeChannel,s.MidiInstrument.Woodblock)}this.currentReferenceBPM=this.sheetStartBPM=t.getExpressionsStartTempoInBPM(),this.tempoUserFactor=t.userStartTempoInBPM/this.sheetStartBPM;var i=0;this.tooManyInstruments=!1,this.instrumentToStaffToMidiChannelDict.clear(),this.instrumentIdMapping.clear();for(var a=0;a<this.percussionChannel;a++)this.freeMidiChannels.push(a);for(var o=this.percussionChannel+1;o<16;o++)this.freeMidiChannels.push(o);var u,l=b(t.Instruments);try{for(l.s();!(u=l.n()).done;){var h=u.value;this.instrumentIdMapping.setValue(i,h);var d,f=b(h.Staves);try{for(f.s();!(d=f.n()).done;){var p=d.value;this.instrumentToStaffToMidiChannelDict.setValue(p,-1)}}catch(g){f.e(g)}finally{f.f()}this.setSound(i,h.MidiInstrumentId),i++}}catch(g){l.e(g)}finally{l.f()}if(void 0!==this.audioPlayer&&this.tooManyInstruments){var v=c.TextTranslation.translateText("MidiNumberError","This music sheet has more parts than are supported for midi playback. Some parts will not be played with the desired instrument sounds.");void 0!==this.messageViewer&&void 0!==this.messageViewer.MessageOccurred&&this.messageViewer.MessageOccurred(m.MessageBoxType.Warning,v)}this.checkForSoloDeactivated()}this.isInitialized=!0,this.reset()}},{key:"play",value:function(){var e=v(f.mark((function e(){return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0!==this.cursorIterator&&this.cursorIterator.EndReached&&this.currentTimestamp.gte(this.cursorIterator.CurrentEnrolledTimestamp)&&(console.log("End reached, resetting"),this.reset()),this.isPlaying=!0,this.RunningState=m.PlaybackState.Running,e.next=5,this.timingSource.start();case 5:this.loop();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"pause",value:function(){var t=v(f.mark((function t(){var n,i,r;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isPlaying=!1,this.stopAllCurrentlyPlayingNotes(),void 0!==this.audioPlayer&&this.audioPlayer.playbackHasStopped(),this.RunningState=m.PlaybackState.Stopped,t.next=6,this.timingSource.pause();case 6:try{n=b(this.listeners);try{for(n.s();!(i=n.n()).done;)null==(r=i.value)||r.pauseOccurred(void 0)}catch(a){n.e(a)}finally{n.f()}}catch(e){p.default.debug("PlaybackManager.pause: ",e)}case 7:case"end":return t.stop()}}),t,this)})));function n(){return t.apply(this,arguments)}return n}()},{key:"reset",value:function(){if(this.doReset(this.DoPreCount,this.PreCountMeasures),void 0!==this.musicPartManager){this.RunningState,m.PlaybackState.Stopped;var e,t=b(this.listeners);try{for(t.s();!(e=t.n()).done;){var n=e.value;null==n||n.resetOccurred(void 0)}}catch(i){t.e(i)}finally{t.f()}}}},{key:"playFromMs",value:function(){var e=v(f.mark((function e(t){var n,i;return f.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pause();case 2:n=this.getTimestampFromMs(t),i=this.musicPartManager.MusicSheet.SelectionStart.clone(),this.musicPartManager.MusicSheet.SelectionStart=n,this.reset(),this.play(),this.musicPartManager.MusicSheet.SelectionStart=i;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTimestampFromMs",value:function(e){return this.timingSource.Settings.getDurationAsNoteDuration(e)}},{key:"setPlaybackStart",value:function(e){e||(e=this.musicPartManager.MusicSheet.SourceMeasures[0].AbsoluteTimestamp),this.musicPartManager.MusicSheet.SelectionStart=e,this.reset()}},{key:"Dispose",value:function(){this.listeners=[],this.isRunning=!1,this.isInitialized&&(this.stopAllCurrentlyPlayingNotes(),void 0!==this.audioPlayer&&this.audioPlayer.close())}},{key:"setSound",value:function(e,t){if(t<=s.MidiInstrument.None||t>s.MidiInstrument.Percussion)return!1;try{var n=t===s.MidiInstrument.Percussion;if(-1===e)void 0===this.audioPlayer||n||this.audioPlayer.setSound(0,t);else{var i,r=!1,a=this.musicPartManager.MusicSheet;i=-2===e?a.Instruments.find((function(t){return t.Id===e})):a.Instruments[e],this.instrumentIdMapping.setValue(i.Id,i);var o,u=b(i.Staves);try{for(u.s();!(o=u.n()).done;){var l=o.value,c=this.instrumentToStaffToMidiChannelDict.getValue(l),h=c===this.percussionChannel;if(n){var d=c;c=this.percussionChannel,d>0&&!h&&(this.freeMidiChannels.push(d),this.freeMidiChannels.sort((function(e,t){return e-t})))}else(c<0||h)&&(this.freeMidiChannels.length>0?(c=this.freeMidiChannels[0],this.freeMidiChannels.shift()):(this.tooManyInstruments=!0,c=15,this.instrumentToStaffToMidiChannelDict.setValue(l,c),r=!0));this.instrumentToStaffToMidiChannelDict.setValue(l,c),void 0===this.audioPlayer||n||this.audioPlayer.setSound(c,t)}}catch(f){u.e(f)}finally{u.f()}if(r)return!1}return!0}catch(e){return p.default.info("PlaybackManager.setSound: ",e),!1}}},{key:"setBpm",value:function(e){this.tempoUserFactor=e/this.sheetStartBPM,this.setTempo()}},{key:"handlePlaybackEvent",value:function(){var e,t,n=this.resetRequested;this.resetRequested=!1;var i=n,r=!1;if(n){var a=this.DoPreCount;this.doReset(a)}if(void 0!==this.musicPartManager){this.currentTimestamp=this.timingSource.getCurrentTimestamp(),r=this.cursorIterator.EndReached;var u=this.cursorIterator.CurrentMeasure;if(!u||u.WasRendered||u.isReducedToMultiRest||(r=!0),this.stopFinishedNotes(),this.processTempoInstructions(),this.RunningState===m.PlaybackState.Running){var l=this.currentTimestamp.gte(this.cursorIterator.CurrentEnrolledTimestamp)&&!r;if(l){if(this.isPreCounting=!1,this.currentMeasure!==this.cursorIterator.CurrentMeasure&&void 0!==this.cursorIterator.CurrentMeasure){this.currentMeasure=this.cursorIterator.CurrentMeasure,this.startRhythmBeats=this.currentMeasure.ActiveTimeSignature.Numerator,this.startRhythmDenominator=this.currentMeasure.ActiveTimeSignature.Denominator;var c=this.cursorIterator.CurrentRelativeInMeasureTimestamp;this.currentMetronomeBaseTimestamp=o.Fraction.minus(this.cursorIterator.CurrentEnrolledTimestamp,c),this.currentBeatDuration=new o.Fraction(1,this.currentMeasure.Duration.Denominator);var f=this.currentMeasure.TempoInBPM;f!==this.currentBPM&&f>0&&this.bpmChanged(f,!1);var v=new o.Fraction;for(this.beatCounter=0;v.lt(c);)v.Add(this.currentBeatDuration),this.beatCounter++;this.playNextMetronomeAt=o.Fraction.plus(this.currentMetronomeBaseTimestamp,new o.Fraction(this.beatCounter,this.currentMeasure.Duration.Denominator))}var g,y=this.cursorIterator.getCurrentDynamicChangingExpressions(),x=b(y);try{for(x.s();!(g=x.n()).done;){var _=g.value,E=this.musicPartManager.MusicSheet.getStaffFromIndex(_.staffNumber),k=this.instrumentToStaffToMidiChannelDict.getValue(E),M=this.currentVolume;if(void 0!==_.parMultiExpression().StartingContinuousDynamic){var w=_.parMultiExpression().StartingContinuousDynamic.getInterpolatedDynamic(this.cursorIterator.CurrentSourceTimestamp);w>=0&&(M=this.calculateFinalVolume(w))}else M=this.calculateFinalVolume(_.parMultiExpression().InstantaneousDynamic.Volume);try{void 0!==this.audioPlayer&&this.audioPlayer.setVolume(k,M)}catch(e){p.default.info("PlaybackManager.handlePlaybackEvent: ",e)}}}catch(re){x.e(re)}finally{x.f()}y.clear()}var P=this.playbackIterator.Update(this.currentTimestamp);if(P.length>0&&this.DoPlayback){var T,C=[],I=b(P);try{for(I.s();!(T=I.n()).done;){var A=T.value;if(A.playbackEntry.ParentVoiceEntry.ParentSourceStaffEntry.VerticalContainerParent.ParentMeasure.WasRendered){var L=A.playbackEntry,O=L.ParentVoiceEntry;if(0!==L.Notes.length){var R=O.ParentVoice.Parent,N=O.Notes[0].ParentStaff,B=h.MusicSheet.getIndexFromStaff(N),D=this.instrumentToStaffToMidiChannelDict.getValue(N),F=R.MidiInstrumentId===s.MidiInstrument.Percussion;F&&(D=this.percussionChannel);var j=this.cursorIterator.ActiveDynamicExpressions[B];if(j instanceof d.ContinuousDynamicExpression){var V=j.getInterpolatedDynamic(this.cursorIterator.CurrentSourceTimestamp);if(V>=0){var G=this.calculateFinalVolume(V);try{void 0!==this.audioPlayer&&this.audioPlayer.setVolume(D,G)}catch(e){p.default.info("PlaybackManager.handlePlaybackEvent: ",e)}}}var W=R.Volume*N.Volume*O.ParentVoice.Volume,U=this.SoloActive&&!(R.Solo||O.ParentVoice.Solo||N.Solo);U&&(W*=this.SoloAttenuationValue);var z=void 0!==O.VolumeModifier;z&&(W*=1.3,W=Math.min(1,W));var H,X=this.musicPartManager.MusicSheet.Transpose,Y=null!==(e=R.PlaybackTranspose)&&void 0!==e?e:0,K=b(L.Notes.filter((function(e){return 0!==e.MidiKey})));try{for(K.s();!(H=K.n()).done;){var q=H.value,Z=q.MidiKey;if(F||(Z+=Y+X),void 0!==q.ParentNote.PlaybackInstrumentId){var J=R.getSubInstrument(q.ParentNote.PlaybackInstrumentId);void 0!==J&&(!(J.fixedKey>=0)||F&&this.IgnoreFixedInstrumentKeysForPercussion||(Z=J.fixedKey)),W=(null!==(t=null==J?void 0:J.volume)&&void 0!==t?t:1)*N.Volume*O.ParentVoice.Volume,U&&(W*=this.SoloAttenuationValue),z&&(W*=1.3,W=Math.min(1,W))}var Q=void 0,$=o.Fraction.createFromFraction(q.Length);void 0!==O.DurationModifier?($=new o.Fraction(2*$.Numerator,3*$.Denominator),Q=o.Fraction.plus(A.enrolledTimestamp,$)):Q=o.Fraction.plus(A.enrolledTimestamp,$);try{void 0!==this.audioPlayer&&this.audioPlayer.playSound(D,Z,W,this.timingSource.getDurationInMs($))}catch(e){p.default.info("PlaybackManager.handlePlaybackEvent. Failed playing sound: ",e)}this.notesToStop.containsKey(Q)||this.notesToStop.setValue(Q,[]),this.notesToStop.getValue(Q).push(new S(Z,D,q)),this.highlightPlayedNotes&&(q.ParentNote.state=h.NoteState.Selected),C.push(q)}}catch(re){K.e(re)}finally{K.f()}}}}}catch(re){I.e(re)}finally{I.f()}this.NotesPlaybackEventOccurred(C)}if(l&&(this.currentIteratorSourceTimeStamp=this.cursorIterator.CurrentSourceTimestamp,this.currentMeasureIndex=this.cursorIterator.CurrentMeasureIndex,this.cursorIterator.moveToNext(),this.nextIteratorTimestamp=this.cursorIterator.CurrentEnrolledTimestamp,i=!0),this.stopMetronomeSound(),r&&this.currentTimestamp.gte(this.cursorIterator.CurrentEnrolledTimestamp)){var ee,te=b(this.listeners);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;null==ne||ne.selectionEndReached(void 0)}}catch(re){te.e(re)}finally{te.f()}this.handleEndReached()}else{if(this.currentTimestamp.gte(this.playNextMetronomeAt)){i=!0;var ie=this.beatCounter%this.startRhythmBeats==0;this.playMetronomeSound(ie),this.beatCounter++}void 0!==this.currentMetronomeBaseTimestamp&&(this.playNextMetronomeAt=o.Fraction.plus(this.currentMetronomeBaseTimestamp,new o.Fraction(this.beatCounter,this.startRhythmDenominator))),this.calculateClosestNextTimestamp()}}else this.isPlaying=!1;(i||r&&!this.loopTriggeredReset)&&this.updateScoreCursorPosition(n)}}},{key:"NotesPlaybackEventOccurred",value:function(e){var t,n=b(this.listeners);try{for(n.s();!(t=n.n()).done;){var i=t.value;null==i||i.notesPlaybackEventOccurred(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"calculateFinalVolume",value:function(e){return(e-this.defaultVolume)*this.dynamicImpactFactor+this.defaultVolume}},{key:"loop",value:function(){var t=this;try{if(this.isRunning=!0,this.isPlaying)try{if(this.isRunning&&this.isInitialized&&(this.handlePlaybackEvent(),void 0!==this.closestNextTimestamp)){var n=this.timingSource.getWaitingTimeForTimestampInMs(this.closestNextTimestamp);window.setTimeout((function(){t.loop()}),Math.max(0,n))}}catch(e){this.pause(),this.reset();var i=c.TextTranslation.translateText("MidiPlaybackError","An error occurred at the Midi Playback.");p.default.info("PlaybackManager.loop: "+i+" ",e),void 0!==this.messageViewer&&void 0!==this.messageViewer.MessageOccurred&&this.messageViewer.MessageOccurred(m.MessageBoxType.Error,i)}}catch(e){var r=c.TextTranslation.translateText("MidiPlaybackLoopError","An error occurred at the Midi Playback. Please restart the program in order for the Playback to be availiable again.");p.default.info("PlaybackManager.loop: "+r+" ",e),void 0!==this.messageViewer&&void 0!==this.messageViewer.MessageOccurred&&this.messageViewer.MessageOccurred(m.MessageBoxType.Error,r)}this.isRunning=!1}},{key:"stopAllCurrentlyPlayingNotes",value:function(){try{if(void 0!==this.audioPlayer){this.audioPlayer.stopSound(this.metronomeNoteFirstBeat.channel,this.metronomeNoteFirstBeat.key),this.audioPlayer.stopSound(this.metronomeNote.channel,this.metronomeNote.key);var t,n=b(this.notesToStop.values());try{for(n.s();!(t=n.n()).done;){var i,r=t.value,a=b(r);try{for(a.s();!(i=a.n()).done;){var s=i.value;this.audioPlayer.stopSound(s.channel,s.key)}}catch(v){a.e(v)}finally{a.f()}}}catch(v){n.e(v)}finally{n.f()}}var o,u=[],l=b(this.notesToStop.values());try{for(l.s();!(o=l.n()).done;){var c,d=o.value,f=b(d);try{for(f.s();!(c=f.n()).done;){var m=c.value;m.note.ParentNote.state=h.NoteState.Normal,u.push(m.note.ParentNote)}}catch(v){f.e(v)}finally{f.f()}}}catch(v){l.e(v)}finally{l.f()}this.highlightPlayedNotes,this.notesToStop.clear()}catch(e){p.default.info("PlaybackManager.stoppAllCurrentlyPlayingNotes: ",e)}}},{key:"doReset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.nextIteratorTimestamp=void 0,this.playNextMetronomeAt=void 0,this.closestNextTimestamp=void 0,this.currentMeasure=void 0,this.beatCounter=0,this.fermataActive=!1,this.stopAllCurrentlyPlayingNotes(),void 0!==this.musicPartManager&&(this.cursorIterator=this.musicPartManager.getIterator()),void 0!==this.cursorIterator){this.playbackIterator.Reset(),this.currentIteratorSourceTimeStamp=this.cursorIterator.CurrentSourceTimestamp,this.nextIteratorTimestamp=this.cursorIterator.CurrentEnrolledTimestamp,this.currentMeasure=this.cursorIterator.CurrentMeasure,this.currentMeasureIndex=this.cursorIterator.CurrentMeasureIndex,this.startRhythmBeats=this.cursorIterator.currentPlaybackSettings().Rhythm.Numerator,this.startRhythmDenominator=this.cursorIterator.currentPlaybackSettings().Rhythm.Denominator;var n=new o.Fraction;if(e){this.isPreCounting=!0;var i=new o.Fraction(this.startRhythmBeats*t,this.startRhythmDenominator),r=this.musicPartManager.MusicSheet.SourceMeasures[this.currentMeasureIndex].Duration,a=new o.Fraction(r.Numerator*t,r.Denominator),s=o.Fraction.plus(this.musicPartManager.MusicSheet.SourceMeasures[this.currentMeasureIndex].AbsoluteTimestamp,a).Sub(this.currentIteratorSourceTimeStamp);if(n=i,i.gte(s)){var u=o.Fraction.minus(i,s);u.RealValue/i.RealValue<.5?n.Add(u):n=u}}this.currentMetronomeBaseTimestamp=this.playNextMetronomeAt=o.Fraction.minus(this.cursorIterator.CurrentEnrolledTimestamp,n),this.timingSource.setTimeAndBpm(this.currentMetronomeBaseTimestamp,this.cursorIterator.currentPlaybackSettings().BeatsPerMinute),this.calculateClosestNextTimestamp()}}},{key:"calculateClosestNextTimestamp",value:function(){var e=[];this.notesToStop.size()>0&&e.push(this.notesToStop.keys().reduce((function(e,t){return e.lt(t)?e:t}))),void 0!==this.playbackIterator.NextEntryTimestamp&&e.push(this.playbackIterator.NextEntryTimestamp),void 0!==this.nextIteratorTimestamp&&e.push(this.nextIteratorTimestamp),void 0!==this.playNextMetronomeAt&&e.push(this.playNextMetronomeAt),e.length>0?this.closestNextTimestamp=e.reduce((function(e,t){return e.lt(t)?e:t})):this.closestNextTimestamp=void 0}},{key:"handleEndReached",value:function(){this.pause()}},{key:"updateScoreCursorPosition",value:function(e){if(!this.isPreCounting||this.MoveCursorDuringPrecount){this.scorePositionChangedData.CurrentMeasureIndex=this.currentMeasureIndex,this.scorePositionChangedData.CurrentRepetition=this.currentRepetition,this.scorePositionChangedData.PredictedPosition=this.currentTimestamp,this.scorePositionChangedData.CurrentBpm=this.musicPartManager.MusicSheet.SheetPlaybackSetting.BeatsPerMinute,this.scorePositionChangedData.ResetOccurred=e;var t,n=b(this.listeners);try{for(n.s();!(t=n.n()).done;){var i=t.value;null==i||i.cursorPositionChanged(this.currentIteratorSourceTimeStamp,this.scorePositionChangedData)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"stopMetronomeSound",value:function(){this.metronomeSoundPlayed&&(void 0!==this.audioPlayer&&(this.audioPlayer.stopSound(this.metronomeNoteFirstBeat.channel,this.metronomeNoteFirstBeat.key),this.audioPlayer.stopSound(this.metronomeNote.channel,this.metronomeNote.key)),this.metronomeSoundPlayed=!1)}},{key:"playMetronomeSound",value:function(e){if(this.metronome.Audible||this.metronome.Solo||this.isPreCounting){var t=this.isPreCounting?this.metronome.PreCountVolume:this.metronome.Volume;if(this.isPreCounting||!this.SoloActive||this.metronome.Solo||(t*=this.SoloAttenuationValue),t>0){if(e)try{void 0!==this.audioPlayer&&this.audioPlayer.playSound(this.metronomeNoteFirstBeat.channel,this.metronomeNoteFirstBeat.key,t,1e3),void 0!==this.audioMetronomePlayer&&this.audioMetronomePlayer.playFirstBeatSample(t)}catch(e){p.default.info("PlaybackManager.playMetronomeSound: ",e)}else try{void 0!==this.audioPlayer&&this.audioPlayer.playSound(this.metronomeNote.channel,this.metronomeNote.key,t,1e3),void 0!==this.audioMetronomePlayer&&this.audioMetronomePlayer.playBeatSample(t)}catch(e){p.default.info("PlaybackManager.playMetronomeSound: ",e)}this.metronomeSoundPlayed=!0}}}},{key:"stopFinishedNotes",value:function(){var e,t=this;e=void 0!==this.currentTimestamp?this.notesToStop.keys().filter((function(e){return e.lte(t.currentTimestamp)})):this.notesToStop.keys();var n,i=b(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=this.notesToStop.getValue(r);if(void 0!==this.audioPlayer){var s,o=b(a);try{for(o.s();!(s=o.n()).done;){var u=s.value;this.audioPlayer.stopSound(u.channel,u.key)}}catch(p){o.e(p)}finally{o.f()}}var l,c=[],d=b(a);try{for(d.s();!(l=d.n()).done;){var f=l.value;f.note.ParentNote.state=h.NoteState.Normal,c.push(f.note.ParentNote)}}catch(p){d.e(p)}finally{d.f()}this.highlightPlayedNotes,this.notesToStop.remove(r)}}catch(p){i.e(p)}finally{i.f()}}},{key:"processTempoInstructions",value:function(){Math.abs(this.currentReferenceBPM-this.cursorIterator.CurrentBpm)>.001&&this.changeTempo(this.cursorIterator.CurrentBpm),this.handleFermata()}},{key:"handleFermata",value:function(){var e=!1;if(!this.cursorIterator.EndReached&&this.currentTimestamp.gte(this.cursorIterator.CurrentEnrolledTimestamp)){var t,n=b(this.cursorIterator.CurrentVoiceEntries);try{for(n.s();!(t=n.n()).done;)e=void 0!==t.value.Fermata}catch(i){n.e(i)}finally{n.f()}}e?this.fermataActive||(this.fermataActive=!0,this.changeTempo(this.cursorIterator.CurrentBpm/3)):this.fermataActive&&(this.fermataActive=!1,this.changeTempo(this.cursorIterator.CurrentBpm))}},{key:"bpmChanged",value:function(e,t){var n,i;e>0?(t&&(null===(i=null===(n=this.musicPartManager)||void 0===n?void 0:n.MusicSheet.SourceMeasures)||void 0===i?void 0:i.length)>0&&(this.overrideBPM=e,this.musicPartManager.MusicSheet.SourceMeasures.forEach((function(t){t.TempoInBPM=e}))),this.currentBPM=e,this.timingSource.setBpm(e)):p.default.info("invalid bpm set: "+e+". Ignoring.")}},{key:"volumeChanged",value:function(e,t){this.currentVolume=t/100,-1===e?this.metronome.Volume=this.currentVolume:this.instrumentIdMapping.getValue(e).Volume=this.currentVolume}},{key:"volumeMute",value:function(e){-1===e?this.metronome.Mute=!0:this.instrumentIdMapping.getValue(e).Audible=!1}},{key:"volumeUnmute",value:function(e){-1===e?this.metronome.Mute=!1:this.instrumentIdMapping.getValue(e).Audible=!0}},{key:"changeTempo",value:function(e){p.default.debug("PlaybackManager.changeTempo","current tempo in BPM: ".concat(e)),e>0&&(this.currentReferenceBPM=e,this.setTempo())}},{key:"setTempo",value:function(){this.currentBPM=this.tempoUserFactor*this.getCurrentReferenceBPM(),this.timingSource.setBpm(this.currentBPM)}},{key:"getCurrentReferenceBPM",value:function(){return(this.currentReferenceBPM-this.sheetStartBPM)*this.tempoImpactFactor+this.sheetStartBPM}},{key:"checkForSoloDeactivated",value:function(){if(void 0!==this.musicPartManager.MusicSheet){var e,t=!1,n=b(this.musicPartManager.MusicSheet.Instruments);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,a=b(r.Staves);try{for(a.s();!(i=a.n()).done;){var s=i.value;t=t||s.Solo}}catch(c){a.e(c)}finally{a.f()}var o,u=b(r.Voices);try{for(u.s();!(o=u.n()).done;){var l=o.value;t=t||l.Solo}}catch(c){u.e(c)}finally{u.f()}}}catch(c){n.e(c)}finally{n.f()}(t=t||this.Metronome.Solo)||(this.SoloActive=!1)}else this.SoloActive=!1}},{key:"getSheetDurationInMs",value:function(){var e,t=0,n=b(this.musicPartManager.MusicSheet.SourceMeasures);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=6e4/i.TempoInBPM;t+=i.Duration.RealValue*r/.25}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getSheetDurationInMsEvenBpm",value:function(){return this.timingSource.getDurationInMs(this.musicPartManager.MusicSheet.SheetEndTimestamp)}}]),t}()},2011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTimingSource=void 0;var i=n(8918);t.AbstractTimingSource=function(){function e(){g(this,e),this.anchorTimestamp=new i.Fraction}return y(e,[{key:"setBpm",value:function(e){this.anchorTimestamp=i.Fraction.createFromFraction(this.getCurrentTimestamp()),void 0!==this.Settings&&(this.Settings.BeatsPerMinute=e),this.reset()}},{key:"setTimeAndBpm",value:function(e,t){this.anchorTimestamp=i.Fraction.createFromFraction(e),void 0!==this.Settings&&t&&(this.Settings.BeatsPerMinute=t),this.reset()}},{key:"getCurrentTimestamp",value:function(){var e=this.getCurrentTimeInMs(),t=this.getDuration(e);return i.Fraction.plus(t,this.anchorTimestamp)}},{key:"getWaitingTimeForTimestampInMs",value:function(e){var t=this.getCurrentTimestamp(),n=i.Fraction.minus(e,t);return this.getDurationInMs(n)}},{key:"getDurationInMs",value:function(e){return Math.round(this.Settings.getDurationInMilliseconds(e))}},{key:"getDuration",value:function(e){return void 0===this.Settings?new i.Fraction:this.Settings.getDurationAsNoteDuration(e)}},{key:"getCurrentTimeInMs",value:function(){throw new Error("not implemented")}},{key:"getTimestampForTimeInMs",value:function(e){throw new Error("not implemented")}},{key:"start",value:function(){throw new Error("not implemented")}},{key:"pause",value:function(){throw new Error("not implemented")}},{key:"reset",value:function(){throw new Error("not implemented")}},{key:"getCurrentAudioDelayRevisedTimestamp",value:function(){throw new Error("not implemented")}}]),e}()},5141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinearTimingSource=void 0;var i=n(2011),r=n(807),a=n(8918),s=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).audioContext=new r.AudioContext,e.audioInputDelay=320,e.lastResetTime=0,e.audioContext.suspend(),e.lastResetTime=e.audioContext.currentTime,e}return y(n,[{key:"getCurrentTimeInMs",value:function(){return 1e3*(this.audioContext.currentTime-this.lastResetTime)}},{key:"getCurrentAudioDelayRevisedTimestamp",value:function(){return a.Fraction.plus(this.getDuration(this.getCurrentTimeInMs()-this.audioInputDelay),this.anchorTimestamp)}},{key:"getTimestampForTimeInMs",value:function(e){var t=this.getCurrentTimeInMs()-e,n=this.getCurrentTimestamp(),i=this.Settings.getDurationAsNoteDuration(t);return a.Fraction.minus(n,i)}},{key:"start",value:function(){return console.log("Start linear timing source"),this.audioContext.resume()}},{key:"pause",value:function(){return console.log("Pause linear timing source"),this.audioContext.suspend()}},{key:"reset",value:function(){console.log("Reset linear timing source"),this.lastResetTime=this.audioContext.currentTime}}]),n}(i.AbstractTimingSource);t.LinearTimingSource=s},8731:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlPanel=void 0;var r=n(7181),a=i(n(9402)),s=i(n(8068)),o=i(n(1268)),u=n(5088),l=n(1154),c=n(9333),f=n(7933),p=n(3254),m=n(1649),v=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.apply(this,arguments)).bpmValue=80,e.volumeSliders=new m.Dictionary,e.volumeSliderElements=new m.Dictionary,e}return y(n,[{key:"volumeMute",value:function(e){throw new Error("Method not implemented.")}},{key:"volumeUnmute",value:function(e){throw new Error("Method not implemented.")}},{key:"bpmChanged",value:function(e,t){this.bpmValue=e,this.bpmSlider&&(this.bpmSlider.value=this.bpmValue)}},{key:"volumeChanged",value:function(e,t){throw new Error("Method not implemented.")}},{key:"play",value:function(){throw new Error("Method not implemented.")}},{key:"pause",value:function(){throw new Error("Method not implemented.")}},{key:"reset",value:function(){throw new Error("Method not implemented.")}},{key:"IsClosed",get:function(){return this.controlPanelElement.classList.contains("hide")}},{key:"clearVolumeTracks",value:function(){var e,t=b(this.volumeSliders.values());try{for(t.s();!(e=t.n()).done;)e.value.destroy()}catch(r){t.e(r)}finally{t.f()}this.volumeSliders.clear();var n,i=b(this.volumeSliderElements.values());try{for(i.s();!(n=i.n()).done;)n.value.parentElement.remove()}catch(r){i.e(r)}finally{i.f()}this.volumeSliderElements.clear()}},{key:"addVolumeTrack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,i=this.generateHtmlTemplate(s.default,{name:e,id:t.toString()});this.volumeToolbarElement.insertAdjacentHTML("beforeend",i);var r=this.volumeToolbarElement.lastChild,a=r.getElementsByClassName("volume-slider")[0],o=r.getElementsByClassName("mute-button")[0],l=new p.MDCIconButtonToggle(o);l.initialize(),this.volumeSliderElements.setValue(t,a);var c=new u.MDCSlider(a);c.value=n,c.initialize();var h=this;l.listen("MDCIconButtonToggle:change",(function(e){e.preventDefault();var n,i=b(h.eventListeners);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.detail.isOn?r.volumeMute(t):(r.volumeUnmute(t),o.classList.remove("mdc-ripple-upgraded--background-focused"))}}catch(a){i.e(a)}finally{i.f()}})),l.on=!1,c.listen("MDCSlider:input",(function(){var e,n=b(h.eventListeners);try{for(n.s();!(e=n.n()).done;)e.value.volumeChanged(t,c.value)}catch(i){n.e(i)}finally{n.f()}})),this.volumeSliders.setValue(t,c)}},{key:"initialize",value:function(){this.generateAndInsertHtmlTemplate(a.default),this.controlPanelElement=this.parentElement.lastChild,this.generateAndInsertHtmlTemplate(o.default),this.playbackButtonsContainerElement=this.parentElement.lastChild,this.resetButton=this.playbackButtonsContainerElement.getElementsByClassName("reset-button")[0],this.playPauseButton=new l.PlayPauseButton(this.playbackButtonsContainerElement.getElementsByClassName("playpause-button")[0]),this.playPauseButton.listen((function(e){if("playing"===e){var t,i=b(n.eventListeners);try{for(i.s();!(t=i.n()).done;)t.value.play()}catch(s){i.e(s)}finally{i.f()}}else{var r,a=b(n.eventListeners);try{for(a.s();!(r=a.n()).done;)r.value.pause()}catch(s){a.e(s)}finally{a.f()}}})),this.resetButton.addEventListener("click",(function(){var e,t=b(n.eventListeners);try{for(t.s();!(e=t.n()).done;)e.value.reset()}catch(i){t.e(i)}finally{t.f()}})),document.addEventListener("keydown",(function(e){if("ArrowLeft"===e.code){var t,i=b(n.eventListeners);try{for(i.s();!(t=i.n()).done;)t.value.reset()}catch(r){i.e(r)}finally{i.f()}}})),this.metronomeToolbarElement=this.controlPanelElement.getElementsByClassName("metronome-toolbar")[0],this.volumeToolbarElement=this.controlPanelElement.getElementsByClassName("volume-toolbar")[0];var e=new c.MDCTabBar(this.controlPanelElement.getElementsByClassName("playback-tabs")[0]);e.initialize(),this.titleContentElement=this.controlPanelElement.getElementsByClassName("playback-title")[0],this.closeButtonElement=this.controlPanelElement.getElementsByClassName("close-playback")[0];var t=new f.MDCRipple(this.closeButtonElement);t.unbounded=!0,t.initialize();var n=this;this.closeButtonElement[this.upEventName]=function(){n.hideAndClear()},e.activateTab(0),e.listen("MDCTabBar:activated",(function(e){var t;switch(e.detail.index){case 0:n.metronomeToolbarElement.classList.remove("hide"),n.volumeToolbarElement.classList.add("hide"),null===(t=n.bpmSlider)||void 0===t||t.destroy(),n.bpmSlider=new u.MDCSlider(n.controlPanelElement.getElementsByClassName("metronome-slider")[0]),n.bpmSlider.initialize(),n.bpmSlider.value=n.bpmValue,n.bpmSlider.listen("MDCSlider:input",(function(){n.bpmValue=n.bpmSlider.value;var e,t=b(n.eventListeners);try{for(t.s();!(e=t.n()).done;)e.value.bpmChanged(n.bpmValue,!0)}catch(i){t.e(i)}finally{t.f()}})),n.titleContentElement.innerText="Tempo (BPM)";break;case 1:n.metronomeToolbarElement.classList.add("hide"),n.volumeToolbarElement.classList.remove("hide");var i,r=b(n.volumeSliders.keys());try{var a=function(){var e=i.value,t=n.volumeSliders.getValue(e);t.destroy(),(t=new u.MDCSlider(n.volumeSliderElements.getValue(e))).initialize(),t.listen("MDCSlider:input",(function(){var i,r=b(n.eventListeners);try{for(r.s();!(i=r.n()).done;)i.value.volumeChanged(e,t.value)}catch(a){r.e(a)}finally{r.f()}}))};for(r.s();!(i=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}n.titleContentElement.innerText="Volume Mixer"}}))}},{key:"hideAndClear",value:function(){this.controlPanelElement.classList.add("hide")}},{key:"show",value:function(){var e,t=this;this.controlPanelElement.classList.remove("hide");var n=this;if(this.metronomeToolbarElement.classList.contains("hide")){var i,r=b(n.volumeSliders.keys());try{var a=function(){var e=i.value,t=n.volumeSliders.getValue(e);t.destroy(),(t=new u.MDCSlider(n.volumeSliderElements.getValue(e))).initialize(),t.listen("MDCSlider:input",(function(){var i,r=b(n.eventListeners);try{for(r.s();!(i=r.n()).done;)i.value.volumeChanged(e,t.value)}catch(a){r.e(a)}finally{r.f()}}))};for(r.s();!(i=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}else null===(e=this.bpmSlider)||void 0===e||e.destroy(),this.bpmSlider=new u.MDCSlider(this.controlPanelElement.getElementsByClassName("metronome-slider")[0]),this.bpmSlider.initialize(),this.bpmSlider.value=this.bpmValue,this.bpmSlider.listen("MDCSlider:input",(function(){t.bpmValue=n.bpmSlider.value;var e,i=b(n.eventListeners);try{for(i.s();!(e=i.n()).done;)e.value.bpmChanged(n.bpmSlider.value,!0)}catch(s){i.e(s)}finally{i.f()}}))}}]),n}(r.AUIController);t.ControlPanel=v},1154:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayPauseButton=void 0,t.PlayPauseButton=function(){function e(t){var n=this;g(this,e),this.listeners=[],this.el=t,this.el.addEventListener("click",(function(){n.toggleState();var e,t=b(n.listeners);try{for(t.s();!(e=t.n()).done;)(0,e.value)(n.state)}catch(i){t.e(i)}finally{t.f()}})),document.addEventListener("keydown",(function(e){if("Space"===e.code&&document.activeElement===n.el){e.preventDefault(),n.toggleState();var t,i=b(n.listeners);try{for(i.s();!(t=i.n()).done;)(0,t.value)(n.state)}catch(r){i.e(r)}finally{i.f()}}}))}return y(e,[{key:"toggleState",value:function(){"playing"===this.state?(this.state="paused",this.el.classList.remove("playing")):(this.state="playing",this.el.classList.add("playing"))}},{key:"listen",value:function(e){this.listeners.push(e)}}]),e}()},293:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(936),t),r(n(419),t),r(n(5141),t),r(n(8731),t)},722:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Acoustic_Grand_Piano","Bright_Acoustic_Piano","Electric_Grand_Piano","Honky_tonk_Piano","Electric_Piano_1","Electric_Piano_2","Harpsichord","Clavinet","Celesta","Glockenspiel","Music_Box","Vibraphone","Marimba","Xylophone","Tubular_Bells","Dulcimer","Drawbar_Organ","Percussive_Organ","Rock_Organ","Church_Organ","Reed_Organ","Accordion","Harmonica","Tango_Accordion","Acoustic_Guitar_nylon","Acoustic_Guitar_steel","Electric_Guitar_jazz","Electric_Guitar_clean","Electric_Guitar_muted","Overdriven_Guitar","Distortion_Guitar","Guitar_harmonics","Acoustic_Bass","Electric_Bass_finger","Electric_Bass_pick","Fretless_Bass","Slap_Bass_1","Slap_Bass_2","Synth_Bass_1","Synth_Bass_2","Violin","Viola","Cello","Contrabass","Tremolo_Strings","Pizzicato_Strings","Orchestral_Harp","Timpani","String_Ensemble_1","String_Ensemble_2","Synth_Strings_1","Synth_Strings_2","Choir_Aahs","Voice_Oohs","Synth_Voice","Orchestra_Hit","Trumpet","Trombone","Tuba","Muted_Trumpet","French_Horn","Brass_Section","Synth_Brass_1","Synth_Brass_2","Soprano_Sax","Alto_Sax","Tenor_Sax","Baritone_Sax","Oboe","English_Horn","Bassoon","Clarinet","Piccolo","Flute","Recorder","Pan_Flute","Blown_Bottle","Shakuhachi","Whistle","Ocarina","Lead_1_square","Lead_2_sawtooth","Lead_3_calliope","Lead_4_chiff","Lead_5_charang","Lead_6_voice","Lead_7_fifths","Lead_8_bass_lead","Pad_1_new_age","Pad_2_warm","Pad_3_polysynth","Pad_4_choir","Pad_5_bowed","Pad_6_metallic","Pad_7_halo","Pad_8_sweep","FX_1_rain","FX_2_soundtrack","FX_3_crystal","FX_4_atmosphere","FX_5_brightness","FX_6_goblins","FX_7_echoes","FX_8_scifi","Sitar","Banjo","Shamisen","Koto","Kalimba","Bagpipe","Fiddle","Shanai","Tinkle_Bell","Agogo","Steel_Drums","Woodblock","Taiko_Drum","Melodic_Tom","Synth_Drum","Reverse_Cymbal","Guitar_Fret_Noise","Breath_Noise","Seashore","Bird_Tweet","Telephone_Ring","Helicopter","Applause","Gunshot","Percussion"]},8265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransposeCalculator=void 0;var i=n(8918),r=function(){function e(){g(this,e)}return y(e,[{key:"transposePitch",value:function(t,n,r){for(var a=i.NoteEnum.C,s=0,o=i.AccidentalEnum.NONE,u=i.Pitch.CalculateTransposedHalfTone(t,r),l=u.halftone,c=u.overflow,h=0;h<e.noteEnums.length;h++){var d=e.noteEnums[h];if(d===l){var f=h;return a=e.noteEnums[f],s=t.Octave+c,o=i.AccidentalEnum.NONE,new i.Pitch(a,s,o)}if(d>l)break}for(var p=0;p<e.noteEnums.length;p++)if(e.noteEnums[p]>l){var m=p,v=i.Pitch.HalfTonesFromAccidental(t.Accidental);for((v>0||0===v&&n.Key>=0)&&m--;m<0;)m+=7,l+=12,c--;for(;m>=7;)m-=7,l-=12,c++;a=e.noteEnums[m],o=i.Pitch.AccidentalFromHalfTones(l-a),s=t.Octave+c;break}return new i.Pitch(a,s,o)}},{key:"transposeKey",value:function(t,n){for(var i=0;i<e.keyMapping.length&&e.keyMapping[i]!==t.keyTypeOriginal;i++);for(var r=i+n;r>=12;)r-=12;for(;r<0;)r+=12;t.Key=e.keyMapping[r],t.isTransposedBy=n}}]),e}();t.TransposeCalculator=r,r.keyMapping=[0,-5,2,-3,4,-1,6,1,-4,3,-2,5],r.noteEnums=[i.NoteEnum.C,i.NoteEnum.D,i.NoteEnum.E,i.NoteEnum.F,i.NoteEnum.G,i.NoteEnum.A,i.NoteEnum.B]},5742:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(8265),t)},8447:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5742),t)},2337:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionUtil=void 0,Array.prototype.last||Object.defineProperty(Array.prototype,"last",{enumerable:!1,value:function(){return this[this.length-1]}}),Array.prototype.clear||Object.defineProperty(Array.prototype,"clear",{enumerable:!1,value:function(){this.length=0}}),Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{enumerable:!1,value:function(e){return-1!==this.indexOf(e)}}),t.CollectionUtil=function(){function e(){g(this,e)}return y(e,null,[{key:"contains2",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}},{key:"last",value:function(e){return e[e.length-1]}},{key:"removeDictElementIfTrue",value:function(e,t,n){var i=[];t.forEach((function(t,r){n(e,t,r)&&i.push(t)}));for(var r=0;r<i.length;r++)t.remove(i[r])}},{key:"getLastElement",value:function(e){return e[e.length-1]}},{key:"binarySearch",value:function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length-1,a=1,s=-1;i<=r&&(a=Math.floor((i+r)/2))!==s;){var o=n(e[a],t);if(0===o)return a;o<0&&(i=a+1),0<o&&(r=a),s=a}return-a}}]),e}()},4242:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PSMath=void 0;var n=function(){function e(){g(this,e)}return y(e,null,[{key:"log",value:function(e,t){return Math.log(t)/Math.log(e)}},{key:"log10",value:function(t){return e.log(10,t)}},{key:"meanSimple",value:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}},{key:"meanWeighted",value:function(e,t){if(e.length!==t.length||0===e.length)return 0;for(var n=0,i=0,r=0;r<e.length;r++){var a=t[r];n+=e[r]*a,i+=a}return n/i}}]),e}();t.PSMath=n},8559:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(2337),t),r(n(4242),t)},3607:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(2861),t),r(n(4761),t),r(n(8559),t),r(n(5205),t),r(n(2571),t),r(n(293),t),r(n(8447),t)},655:function(e,t,n){"use strict";n.d(t,{CR:function(){return s},ZT:function(){return r},fl:function(){return o},pi:function(){return a}});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)};function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return s}function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}},8071:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(n(3176).default);t.default=a},3176:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(278),a=function(){function e(e){this.root=null,this.compare=e||i.defaultCompare,this.nElements=0}return e.prototype.add=function(e){return!i.isUndefined(e)&&null!==this.insertNode(this.createNode(e))&&(this.nElements++,!0)},e.prototype.clear=function(){this.root=null,this.nElements=0},e.prototype.isEmpty=function(){return 0===this.nElements},e.prototype.size=function(){return this.nElements},e.prototype.contains=function(e){return!i.isUndefined(e)&&null!==this.searchNode(this.root,e)},e.prototype.search=function(e){var t=this.searchNode(this.root,e);if(null!==t)return t.element},e.prototype.remove=function(e){var t=this.searchNode(this.root,e);return null!==t&&(this.removeNode(t),this.nElements--,!0)},e.prototype.inorderTraversal=function(e){this.inorderTraversalAux(this.root,e,{stop:!1})},e.prototype.preorderTraversal=function(e){this.preorderTraversalAux(this.root,e,{stop:!1})},e.prototype.postorderTraversal=function(e){this.postorderTraversalAux(this.root,e,{stop:!1})},e.prototype.levelTraversal=function(e){this.levelTraversalAux(this.root,e)},e.prototype.minimum=function(){if(!this.isEmpty()&&null!==this.root)return this.minimumAux(this.root).element},e.prototype.maximum=function(){if(!this.isEmpty()&&null!==this.root)return this.maximumAux(this.root).element},e.prototype.forEach=function(e){this.inorderTraversal(e)},e.prototype.toArray=function(){var e=[];return this.inorderTraversal((function(t){return e.push(t),!0})),e},e.prototype.height=function(){return this.heightAux(this.root)},e.prototype.searchNode=function(e,t){for(var n=1;null!==e&&0!==n;)(n=this.compare(t,e.element))<0?e=e.leftCh:n>0&&(e=e.rightCh);return e},e.prototype.transplant=function(e,t){null===e.parent?this.root=t:e===e.parent.leftCh?e.parent.leftCh=t:e.parent.rightCh=t,null!==t&&(t.parent=e.parent)},e.prototype.removeNode=function(e){if(null===e.leftCh)this.transplant(e,e.rightCh);else if(null===e.rightCh)this.transplant(e,e.leftCh);else{var t=this.minimumAux(e.rightCh);t.parent!==e&&(this.transplant(t,t.rightCh),t.rightCh=e.rightCh,t.rightCh.parent=t),this.transplant(e,t),t.leftCh=e.leftCh,t.leftCh.parent=t}},e.prototype.inorderTraversalAux=function(e,t,n){null===e||n.stop||(this.inorderTraversalAux(e.leftCh,t,n),n.stop||(n.stop=!1===t(e.element),n.stop||this.inorderTraversalAux(e.rightCh,t,n)))},e.prototype.levelTraversalAux=function(e,t){var n=new r.default;for(null!==e&&n.enqueue(e),e=n.dequeue()||null;null!=e;){if(!1===t(e.element))return;null!==e.leftCh&&n.enqueue(e.leftCh),null!==e.rightCh&&n.enqueue(e.rightCh),e=n.dequeue()||null}},e.prototype.preorderTraversalAux=function(e,t,n){null===e||n.stop||(n.stop=!1===t(e.element),n.stop||(this.preorderTraversalAux(e.leftCh,t,n),n.stop||this.preorderTraversalAux(e.rightCh,t,n)))},e.prototype.postorderTraversalAux=function(e,t,n){null===e||n.stop||(this.postorderTraversalAux(e.leftCh,t,n),n.stop||(this.postorderTraversalAux(e.rightCh,t,n),n.stop||(n.stop=!1===t(e.element))))},e.prototype.minimumAux=function(e){for(;null!=e&&null!==e.leftCh;)e=e.leftCh;return e},e.prototype.maximumAux=function(e){for(;null!=e&&null!==e.rightCh;)e=e.rightCh;return e},e.prototype.heightAux=function(e){return null===e?-1:Math.max(this.heightAux(e.leftCh),this.heightAux(e.rightCh))+1},e.prototype.insertNode=function(e){for(var t=null,n=this.root;null!==n;){var i=this.compare(e.element,n.element);if(0===i)return null;i<0?(t=n,n=n.leftCh):(t=n,n=n.rightCh)}return e.parent=t,null===t?this.root=e:this.compare(e.element,t.element)<0?t.leftCh=e:t.rightCh=e,e},e.prototype.createNode=function(e){return{element:e,leftCh:null,rightCh:null,parent:null}},e}();t.default=a},2070:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(8805),a=n(7818),s=function(){function e(e){this.toStrF=e||i.defaultToString,this.dictionary=new r.default(this.toStrF),this.nElements=0}return e.prototype.add=function(e,t){if(void 0===t&&(t=1),i.isUndefined(e)||t<=0)return!1;if(this.contains(e))this.dictionary.getValue(e).copies+=t;else{var n={value:e,copies:t};this.dictionary.setValue(e,n)}return this.nElements+=t,!0},e.prototype.count=function(e){return this.contains(e)?this.dictionary.getValue(e).copies:0},e.prototype.contains=function(e){return this.dictionary.containsKey(e)},e.prototype.remove=function(e,t){if(void 0===t&&(t=1),i.isUndefined(e)||t<=0)return!1;if(this.contains(e)){var n=this.dictionary.getValue(e);return t>n.copies?this.nElements-=n.copies:this.nElements-=t,n.copies-=t,n.copies<=0&&this.dictionary.remove(e),!0}return!1},e.prototype.toArray=function(){for(var e=[],t=0,n=this.dictionary.values();t<n.length;t++)for(var i=n[t],r=i.value,a=i.copies,s=0;s<a;s++)e.push(r);return e},e.prototype.toSet=function(){for(var e=new a.default(this.toStrF),t=0,n=this.dictionary.values();t<n.length;t++){var i=n[t].value;e.add(i)}return e},e.prototype.forEach=function(e){this.dictionary.forEach((function(t,n){for(var i=n.value,r=n.copies,a=0;a<r;a++)if(!1===e(i))return!1;return!0}))},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return 0===this.nElements},e.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},e}();t.default=s},8805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=function(){function e(e){this.table={},this.nElements=0,this.toStr=e||i.defaultToString}return e.prototype.getValue=function(e){var t=this.table["$"+this.toStr(e)];if(!i.isUndefined(t))return t.value},e.prototype.setValue=function(e,t){if(!i.isUndefined(e)&&!i.isUndefined(t)){var n,r="$"+this.toStr(e),a=this.table[r];return i.isUndefined(a)?(this.nElements++,n=void 0):n=a.value,this.table[r]={key:e,value:t},n}},e.prototype.remove=function(e){var t="$"+this.toStr(e),n=this.table[t];if(!i.isUndefined(n))return delete this.table[t],this.nElements--,n.value},e.prototype.keys=function(){var e=[];for(var t in this.table)if(i.has(this.table,t)){var n=this.table[t];e.push(n.key)}return e},e.prototype.values=function(){var e=[];for(var t in this.table)if(i.has(this.table,t)){var n=this.table[t];e.push(n.value)}return e},e.prototype.forEach=function(e){for(var t in this.table)if(i.has(this.table,t)){var n=this.table[t];if(!1===e(n.key,n.value))return}},e.prototype.containsKey=function(e){return!i.isUndefined(this.getValue(e))},e.prototype.clear=function(){this.table={},this.nElements=0},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return this.nElements<=0},e.prototype.toString=function(){var e="{";return this.forEach((function(t,n){e+="\n\t"+t+" : "+n})),e+"\n}"},e}();t.default=r},2734:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(8805),s=n(9205),o=function(e){function t(t,n){var i=e.call(this,n)||this;return i.defaultFactoryFunction=t,i}return r(t,e),t.prototype.setDefault=function(t,n){var i=e.prototype.getValue.call(this,t);return s.isUndefined(i)?(this.setValue(t,n),n):i},t.prototype.getValue=function(e){return this.setDefault(e,this.defaultFactoryFunction())},t}(a.default);t.default=o},2422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(1229),a=function(){function e(e){this.data=[],this.compare=e||i.defaultCompare}return e.prototype.leftChildIndex=function(e){return 2*e+1},e.prototype.rightChildIndex=function(e){return 2*e+2},e.prototype.parentIndex=function(e){return Math.floor((e-1)/2)},e.prototype.minIndex=function(e,t){return t>=this.data.length?e>=this.data.length?-1:e:this.compare(this.data[e],this.data[t])<=0?e:t},e.prototype.siftUp=function(e){for(var t=this.parentIndex(e);e>0&&this.compare(this.data[t],this.data[e])>0;)r.swap(this.data,t,e),e=t,t=this.parentIndex(e)},e.prototype.siftDown=function(e){for(var t=this.minIndex(this.leftChildIndex(e),this.rightChildIndex(e));t>=0&&this.compare(this.data[e],this.data[t])>0;)r.swap(this.data,t,e),e=t,t=this.minIndex(this.leftChildIndex(e),this.rightChildIndex(e))},e.prototype.peek=function(){return this.data.length>0?this.data[0]:void 0},e.prototype.add=function(e){return!i.isUndefined(e)&&(this.data.push(e),this.siftUp(this.data.length-1),!0)},e.prototype.removeRoot=function(){if(this.data.length>0){var e=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),e}},e.prototype.contains=function(e){var t=i.compareToEquals(this.compare);return r.contains(this.data,e,t)},e.prototype.size=function(){return this.data.length},e.prototype.isEmpty=function(){return this.data.length<=0},e.prototype.clear=function(){this.data.length=0},e.prototype.forEach=function(e){r.forEach(this.data,e)},e}();t.default=a},3272:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=n(8805),s=n(9205),o=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},e}(),u=function(){function e(){this.key=null,this.value=null}return e.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},e}(),l=function(e){function t(t){var n=e.call(this,t)||this;return n.head=new u,n.tail=new u,n.head.next=n.tail,n.tail.prev=n.head,n}return r(t,e),t.prototype.appendToTail=function(e){var t=this.tail.prev;t.next=e,e.prev=t,e.next=this.tail,this.tail.prev=e},t.prototype.getLinkedDictionaryPair=function(e){if(!s.isUndefined(e)){var t="$"+this.toStr(e);return this.table[t]}},t.prototype.getValue=function(e){var t=this.getLinkedDictionaryPair(e);if(!s.isUndefined(t))return t.value},t.prototype.remove=function(t){var n=this.getLinkedDictionaryPair(t);if(!s.isUndefined(n))return e.prototype.remove.call(this,t),n.unlink(),n.value},t.prototype.clear=function(){e.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},t.prototype.replace=function(e,t){var n="$"+this.toStr(t.key);t.next=e.next,t.prev=e.prev,this.remove(e.key),t.prev.next=t,t.next.prev=t,this.table[n]=t,++this.nElements},t.prototype.setValue=function(e,t){if(!s.isUndefined(e)&&!s.isUndefined(t)){var n=this.getLinkedDictionaryPair(e),i=new o(e,t),r="$"+this.toStr(e);return s.isUndefined(n)?(this.appendToTail(i),this.table[r]=i,void++this.nElements):(this.replace(n,i),n.value)}},t.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(t)})),e},t.prototype.values=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),e},t.prototype.forEach=function(e){for(var t=this.head.next;t.next;){if(!1===e(t.key,t.value))return;t=t.next}},t}(a.default);t.default=l},5456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(1229),a=function(){function e(){this.firstNode=null,this.lastNode=null,this.nElements=0}return e.prototype.add=function(e,t){if(i.isUndefined(t)&&(t=this.nElements),t<0||t>this.nElements||i.isUndefined(e))return!1;var n=this.createNode(e);if(0===this.nElements||null===this.lastNode)this.firstNode=n,this.lastNode=n;else if(t===this.nElements)this.lastNode.next=n,this.lastNode=n;else if(0===t)n.next=this.firstNode,this.firstNode=n;else{var r=this.nodeAtIndex(t-1);if(null===r)return!1;n.next=r.next,r.next=n}return this.nElements++,!0},e.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},e.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},e.prototype.elementAtIndex=function(e){var t=this.nodeAtIndex(e);if(null!==t)return t.element},e.prototype.indexOf=function(e,t){var n=t||i.defaultEquals;if(i.isUndefined(e))return-1;for(var r=this.firstNode,a=0;null!==r;){if(n(r.element,e))return a;a++,r=r.next}return-1},e.prototype.contains=function(e,t){return this.indexOf(e,t)>=0},e.prototype.remove=function(e,t){var n=t||i.defaultEquals;if(this.nElements<1||i.isUndefined(e))return!1;for(var r=null,a=this.firstNode;null!==a;){if(n(a.element,e))return null===r?(this.firstNode=a.next,a===this.lastNode&&(this.lastNode=null)):a===this.lastNode?(this.lastNode=r,r.next=a.next,a.next=null):(r.next=a.next,a.next=null),this.nElements--,!0;r=a,a=a.next}return!1},e.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},e.prototype.equals=function(t,n){var r=n||i.defaultEquals;return t instanceof e&&this.size()===t.size()&&this.equalsAux(this.firstNode,t.firstNode,r)},e.prototype.equalsAux=function(e,t,n){for(;null!==e&&null!==t;){if(!n(e.element,t.element))return!1;e=e.next,t=t.next}return!0},e.prototype.removeElementAtIndex=function(e){if(!(e<0||e>=this.nElements||null===this.firstNode||null===this.lastNode)){var t;if(1===this.nElements)t=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var n=this.nodeAtIndex(e-1);null===n?(t=this.firstNode.element,this.firstNode=this.firstNode.next):n.next===this.lastNode&&(t=this.lastNode.element,this.lastNode=n),null!==n&&null!==n.next&&(t=n.next.element,n.next=n.next.next)}return this.nElements--,t}},e.prototype.forEach=function(e){for(var t=this.firstNode;null!==t&&!1!==e(t.element);)t=t.next},e.prototype.reverse=function(){for(var e=null,t=this.firstNode,n=null;null!==t;)n=t.next,t.next=e,e=t,t=n;n=this.firstNode,this.firstNode=this.lastNode,this.lastNode=n},e.prototype.toArray=function(){for(var e=[],t=this.firstNode;null!==t;)e.push(t.element),t=t.next;return e},e.prototype.size=function(){return this.nElements},e.prototype.isEmpty=function(){return this.nElements<=0},e.prototype.toString=function(){return r.toString(this.toArray())},e.prototype.nodeAtIndex=function(e){if(e<0||e>=this.nElements)return null;if(e===this.nElements-1)return this.lastNode;for(var t=this.firstNode,n=0;n<e&&null!==t;n++)t=t.next;return t},e.prototype.createNode=function(e){return{element:e,next:null}},e}();t.default=a},6072:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(8805),a=n(1229),s=function(){function e(e,t,n){void 0===n&&(n=!1),this.dict=new r.default(e),this.equalsF=t||i.defaultEquals,this.allowDuplicate=n}return e.prototype.getValue=function(e){var t=this.dict.getValue(e);return i.isUndefined(t)?[]:a.copy(t)},e.prototype.setValue=function(e,t){if(i.isUndefined(e)||i.isUndefined(t))return!1;var n=this.dict.getValue(e);return i.isUndefined(n)?(this.dict.setValue(e,[t]),!0):!(!this.allowDuplicate&&a.contains(n,t,this.equalsF)||(n.push(t),0))},e.prototype.remove=function(e,t){if(i.isUndefined(t)){var n=this.dict.remove(e);return!i.isUndefined(n)}var r=this.dict.getValue(e);return!(i.isUndefined(r)||!a.remove(r,t,this.equalsF)||(0===r.length&&this.dict.remove(e),0))},e.prototype.keys=function(){return this.dict.keys()},e.prototype.values=function(){for(var e=[],t=0,n=this.dict.values();t<n.length;t++)for(var i=0,r=n[t];i<r.length;i++){var a=r[i];e.push(a)}return e},e.prototype.containsKey=function(e){return this.dict.containsKey(e)},e.prototype.clear=function(){this.dict.clear()},e.prototype.size=function(){return this.dict.size()},e.prototype.isEmpty=function(){return this.dict.isEmpty()},e}();t.default=s},1489:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER",e[e.INSIDE_AT_END=2]="INSIDE_AT_END",e[e.INSIDE_AT_START=3]="INSIDE_AT_START"}(n||(n={}));var i=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.rootIds=e,this.nodes=t,this.initRootIds(),this.initNodes()}return e.prototype.initRootIds=function(){for(var e=0,t=this.rootIds;e<t.length;e++){var n=t[e];this.createEmptyNodeIfNotExist(n)}},e.prototype.initNodes=function(){for(var e in this.nodes)if(this.nodes.hasOwnProperty(e))for(var t=0,n=this.nodes[e];t<n.length;t++){var i=n[t];this.createEmptyNodeIfNotExist(i)}},e.prototype.createEmptyNodeIfNotExist=function(e){this.nodes[e]||(this.nodes[e]=[])},e.prototype.getRootIds=function(){return this.rootIds.slice()},e.prototype.getNodes=function(){var e={};for(var t in this.nodes)this.nodes.hasOwnProperty(t)&&(e[t]=this.nodes[t].slice());return e},e.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},e.prototype.toObject=function(){return this.getObject()},e.prototype.flatten=function(){for(var e=this,t=[],n=0;n<this.rootIds.length;n++){var i=this.rootIds[n];t.push({id:i,level:0,hasParent:!1,childrenCount:0}),u(i,this.nodes,t,0)}for(var r=0,a=t;r<a.length;r++){var s=a[r];s.childrenCount=(o=s.id,e.nodes[o]?e.nodes[o].length:0)}var o;return t;function u(e,t,n,i){if(void 0===i&&(i=0),e&&t&&n&&t[e]){i++;for(var r=t[e],a=0;a<r.length;a++){var s=r[a];n.push({id:s,level:i,hasParent:!0}),u(s,t,n,i)}i--}}},e.prototype.moveIdBeforeId=function(e,t){return this.moveId(e,t,n.BEFORE)},e.prototype.moveIdAfterId=function(e,t){return this.moveId(e,t,n.AFTER)},e.prototype.moveIdIntoId=function(e,t,i){return void 0===i&&(i=!0),i?this.moveId(e,t,n.INSIDE_AT_START):this.moveId(e,t,n.INSIDE_AT_END)},e.prototype.swapRootIdWithRootId=function(e,t){var n=this.findRootId(e),i=this.findRootId(t);this.swapRootPositionWithRootPosition(n,i)},e.prototype.swapRootPositionWithRootPosition=function(e,t){var n=this.rootIds[t];this.rootIds[t]=this.rootIds[e],this.rootIds[e]=n},e.prototype.deleteId=function(e){this.rootDeleteId(e),this.nodeAndSubNodesDelete(e),this.nodeRefrencesDelete(e)},e.prototype.insertIdBeforeId=function(e,t){var n=this.findRootId(e);for(var i in n>-1&&this.insertIdIntoRoot(t,n),this.nodes)if(this.nodes.hasOwnProperty(i)){var r=this.findNodeId(i,e);r>-1&&this.insertIdIntoNode(i,t,r)}},e.prototype.insertIdAfterId=function(e,t){var n=this.findRootId(e);for(var i in n>-1&&this.insertIdIntoRoot(t,n+1),this.nodes)if(this.nodes.hasOwnProperty(i)){var r=this.findNodeId(i,e);r>-1&&this.insertIdIntoNode(i,t,r+1)}},e.prototype.insertIdIntoId=function(e,t){this.nodeInsertAtEnd(e,t),this.nodes[t]=[]},e.prototype.insertIdIntoRoot=function(e,t){if(void 0===t)this.rootInsertAtEnd(e);else if(t<0){var n=this.rootIds.length;this.rootIds.splice(t+n+1,0,e)}else this.rootIds.splice(t,0,e);this.nodes[e]=this.nodes[e]||[]},e.prototype.insertIdIntoNode=function(e,t,n){if(this.nodes[e]=this.nodes[e]||[],this.nodes[t]=this.nodes[t]||[],void 0===n)this.nodeInsertAtEnd(e,t);else if(n<0){var i=this.nodes[e].length;this.nodes[e].splice(n+i+1,0,t)}else this.nodes[e].splice(n,0,t)},e.prototype.moveId=function(e,t,i){var r=e,a=this.findRootId(r);for(var s in this.nodes[t],this.nodes)if(this.nodes.hasOwnProperty(s)){this.findNodeId(s,t);break}var o=t,u=this.findRootId(o);for(var s in this.nodes[t],this.nodes)if(this.nodes.hasOwnProperty(s)){this.findNodeId(s,t);break}if(a>-1){if(u>-1)switch(this.rootDelete(a),u>a&&u--,i){case n.BEFORE:this.insertIdIntoRoot(r,u);break;case n.AFTER:this.insertIdIntoRoot(r,u+1);break;case n.INSIDE_AT_START:this.nodeInsertAtStart(o,r);break;case n.INSIDE_AT_END:this.nodeInsertAtEnd(o,r)}else for(var s in this.rootDelete(a),this.nodes)if(this.nodes.hasOwnProperty(s)&&(l=this.findNodeId(s,o))>-1){switch(i){case n.BEFORE:this.insertIdIntoNode(s,r,l);break;case n.AFTER:this.insertIdIntoNode(s,r,l+1);break;case n.INSIDE_AT_START:this.nodeInsertAtStart(o,r);break;case n.INSIDE_AT_END:this.nodeInsertAtEnd(o,r)}break}}else if(u>-1){for(var s in this.nodes)if(this.nodes.hasOwnProperty(s)&&(l=this.findNodeId(s,r))>-1){this.nodeDeleteAtIndex(s,l);break}switch(i){case n.BEFORE:this.insertIdIntoRoot(r,u);break;case n.AFTER:this.insertIdIntoRoot(r,u+1);break;case n.INSIDE_AT_START:this.nodeInsertAtStart(o,r);break;case n.INSIDE_AT_END:this.nodeInsertAtEnd(o,r)}}else{for(var s in this.nodes)if(this.nodes.hasOwnProperty(s)&&(l=this.findNodeId(s,r))>-1){this.nodeDeleteAtIndex(s,l);break}for(var s in this.nodes){var l;if(this.nodes.hasOwnProperty(s)&&(l=this.findNodeId(s,o))>-1){switch(i){case n.BEFORE:this.insertIdIntoNode(s,r,l);break;case n.AFTER:this.insertIdIntoNode(s,r,l+1);break;case n.INSIDE_AT_START:this.nodeInsertAtStart(o,r);break;case n.INSIDE_AT_END:this.nodeInsertAtEnd(o,r)}break}}}},e.prototype.swapArrayElements=function(e,t,n){var i=e[t];return e[t]=e[n],e[n]=i,e},e.prototype.rootDeleteId=function(e){var t=this.findRootId(e);t>-1&&this.rootDelete(t)},e.prototype.nodeAndSubNodesDelete=function(e){for(var t=[],n=0;n<this.nodes[e].length;n++){var i=this.nodes[e][n];this.nodeAndSubNodesDelete(i),t.push(e)}for(this.nodeDelete(e),n=0;n<t.length;n++)this.nodeDelete(t[n])},e.prototype.nodeRefrencesDelete=function(e){for(var t in this.nodes)if(this.nodes.hasOwnProperty(t))for(var n=0;n<this.nodes[t].length;n++)this.nodes[t][n]===e&&this.nodeDeleteAtIndex(t,n)},e.prototype.nodeDelete=function(e){delete this.nodes[e]},e.prototype.findRootId=function(e){return this.rootIds.indexOf(e)},e.prototype.findNodeId=function(e,t){return this.nodes[e].indexOf(t)},e.prototype.findNode=function(e){return this.nodes[e]},e.prototype.nodeInsertAtStart=function(e,t){this.nodes[e].unshift(t)},e.prototype.nodeInsertAtEnd=function(e,t){this.nodes[e].push(t)},e.prototype.rootDelete=function(e){this.rootIds.splice(e,1)},e.prototype.nodeDeleteAtIndex=function(e,t){this.nodes[e].splice(t,1)},e.prototype.rootInsertAtStart=function(e){this.rootIds.unshift(e)},e.prototype.rootInsertAtEnd=function(e){this.rootIds.push(e)},e}();t.default=i},5994:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(2422),a=function(){function e(e){this.heap=new r.default(i.reverseCompareFunction(e))}return e.prototype.enqueue=function(e){return this.heap.add(e)},e.prototype.add=function(e){return this.heap.add(e)},e.prototype.dequeue=function(){if(0!==this.heap.size()){var e=this.heap.peek();return this.heap.removeRoot(),e}},e.prototype.peek=function(){return this.heap.peek()},e.prototype.contains=function(e){return this.heap.contains(e)},e.prototype.isEmpty=function(){return this.heap.isEmpty()},e.prototype.size=function(){return this.heap.size()},e.prototype.clear=function(){this.heap.clear()},e.prototype.forEach=function(e){this.heap.forEach(e)},e}();t.default=a},278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5456),r=function(){function e(){this.list=new i.default}return e.prototype.enqueue=function(e){return this.list.add(e)},e.prototype.add=function(e){return this.list.add(e)},e.prototype.dequeue=function(){if(0!==this.list.size()){var e=this.list.first();return this.list.removeElementAtIndex(0),e}},e.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},e.prototype.size=function(){return this.list.size()},e.prototype.contains=function(e,t){return this.list.contains(e,t)},e.prototype.isEmpty=function(){return this.list.size()<=0},e.prototype.clear=function(){this.list.clear()},e.prototype.forEach=function(e){this.list.forEach(e)},e}();t.default=r},7818:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205),r=n(1229),a=n(8805),s=function(){function e(e){this.dictionary=new a.default(e)}return e.prototype.contains=function(e){return this.dictionary.containsKey(e)},e.prototype.add=function(e){return!this.contains(e)&&!i.isUndefined(e)&&(this.dictionary.setValue(e,e),!0)},e.prototype.intersection=function(e){var t=this;this.forEach((function(n){return e.contains(n)||t.remove(n),!0}))},e.prototype.union=function(e){var t=this;e.forEach((function(e){return t.add(e),!0}))},e.prototype.difference=function(e){var t=this;e.forEach((function(e){return t.remove(e),!0}))},e.prototype.isSubsetOf=function(e){if(this.size()>e.size())return!1;var t=!0;return this.forEach((function(n){return!!e.contains(n)||(t=!1,!1)})),t},e.prototype.remove=function(e){return!!this.contains(e)&&(this.dictionary.remove(e),!0)},e.prototype.forEach=function(e){this.dictionary.forEach((function(t,n){return e(n)}))},e.prototype.toArray=function(){return this.dictionary.values()},e.prototype.isEmpty=function(){return this.dictionary.isEmpty()},e.prototype.size=function(){return this.dictionary.size()},e.prototype.clear=function(){this.dictionary.clear()},e.prototype.toString=function(){return r.toString(this.toArray())},e}();t.default=s},5669:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5456),r=function(){function e(){this.list=new i.default}return e.prototype.push=function(e){return this.list.add(e,0)},e.prototype.add=function(e){return this.list.add(e,0)},e.prototype.pop=function(){return this.list.removeElementAtIndex(0)},e.prototype.peek=function(){return this.list.first()},e.prototype.size=function(){return this.list.size()},e.prototype.contains=function(e,t){return this.list.contains(e,t)},e.prototype.isEmpty=function(){return this.list.isEmpty()},e.prototype.clear=function(){this.list.clear()},e.prototype.forEach=function(e){this.list.forEach(e)},e}();t.default=r},1229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9205);function r(e,t,n){for(var r=n||i.defaultEquals,a=e.length,s=0;s<a;s++)if(r(e[s],t))return s;return-1}t.indexOf=r,t.lastIndexOf=function(e,t,n){for(var r=n||i.defaultEquals,a=e.length-1;a>=0;a--)if(r(e[a],t))return a;return-1},t.contains=function(e,t,n){return r(e,t,n)>=0},t.remove=function(e,t,n){var i=r(e,t,n);return!(i<0||(e.splice(i,1),0))},t.frequency=function(e,t,n){for(var r=n||i.defaultEquals,a=e.length,s=0,o=0;o<a;o++)r(e[o],t)&&s++;return s},t.equals=function(e,t,n){var r=n||i.defaultEquals;if(e.length!==t.length)return!1;for(var a=e.length,s=0;s<a;s++)if(!r(e[s],t[s]))return!1;return!0},t.copy=function(e){return e.concat()},t.swap=function(e,t,n){if(t<0||t>=e.length||n<0||n>=e.length)return!1;var i=e[t];return e[t]=e[n],e[n]=i,!0},t.toString=function(e){return"["+e.toString()+"]"},t.forEach=function(e,t){for(var n=0,i=e;n<i.length;n++)if(!1===t(i[n]))return}},1649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1229);t.arrays=i;var r=n(2070);t.Bag=r.default;var a=n(8071);t.BSTree=a.default;var s=n(3176);t.BSTreeKV=s.default;var o=n(8805);t.Dictionary=o.default;var u=n(2422);t.Heap=u.default;var l=n(3272);t.LinkedDictionary=l.default;var c=n(5456);t.LinkedList=c.default;var h=n(6072);t.MultiDictionary=h.default;var d=n(2734);t.FactoryDictionary=d.default;var f=n(2734);t.DefaultDictionary=f.default;var p=n(278);t.Queue=p.default;var m=n(5994);t.PriorityQueue=m.default;var v=n(7818);t.Set=v.default;var g=n(5669);t.Stack=g.default;var y=n(1489);t.MultiRootTree=y.default;var b=n(9205);t.util=b},9205:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.prototype.hasOwnProperty;function i(e){return"function"==typeof e}function r(e){return void 0===e}function a(e){return"[object String]"===Object.prototype.toString.call(e)}t.has=function(e,t){return n.call(e,t)},t.defaultCompare=function(e,t){return e<t?-1:e===t?0:1},t.defaultEquals=function(e,t){return e===t},t.defaultToString=function(e){return null===e?"COLLECTION_NULL":r(e)?"COLLECTION_UNDEFINED":a(e)?"$s"+e:"$o"+e.toString()},t.makeString=function(e,n){if(void 0===n&&(n=","),null===e)return"COLLECTION_NULL";if(r(e))return"COLLECTION_UNDEFINED";if(a(e))return e.toString();var i="{",s=!0;for(var o in e)t.has(e,o)&&(s?s=!1:i+=n,i=i+o+":"+e[o]);return i+"}"},t.isFunction=i,t.isUndefined=r,t.isString=a,t.reverseCompareFunction=function(e){return r(e)||!i(e)?function(e,t){return e<t?1:e===t?0:-1}:function(t,n){return-1*e(t,n)}},t.compareToEquals=function(e){return function(t,n){return 0===e(t,n)}}},6368:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Pt}});var i=function(){};i.L=function(e,t){if(t){var n=Array.prototype.slice.call(t).join(" ");window.console.log(e+": "+n)}},i.MakeException=function(e){return function(t){h(i,t);var n=d(i);function i(t,r){var a;return g(this,i),(a=n.call(this,t)).name=e,a.message=t,a.data=r,a}return i}(r(Error))},i.RERR=i.RuntimeError=function(){function e(t,n){g(this,e),this.code=t,this.message=n}return y(e,[{key:"toString",value:function(){return"[RuntimeError] "+this.code+":"+this.message}}]),e}(),i.Merge=function(e,t){for(var n in t)e[n]=t[n];return e},i.Min=Math.min,i.Max=Math.max,i.forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},i.RoundN=function(e,t){return e%t>=t/2?parseInt(e/t,10)*t+t:parseInt(e/t,10)*t},i.MidLine=function(e,t){var n=t+(e-t)/2;return n%2>0&&(n=i.RoundN(10*n,5)/10),n},i.SortAndUnique=function(e,t,n){if(e.length>1){var i,r=[];e.sort(t);for(var a=0;a<e.length;++a)0!==a&&n(e[a],i)||r.push(e[a]),i=e[a];return r}return e},i.Contains=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},i.getCanvasContext=function(e){if(!e)throw new i.RERR("BadArgument","Invalid canvas selector: "+e);var t=document.getElementById(e);if(!t||!t.getContext)throw new i.RERR("UnsupportedBrowserError","This browser does not support HTML5 Canvas");return t.getContext("2d")},i.drawDot=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#55";e.save(),e.setFillStyle(i),e.beginPath(),e.arc(t,n,3,0,2*Math.PI,!0),e.closePath(),e.fill(),e.restore()},i.BM=function(e,t){var n=(new Date).getTime();t();var r=(new Date).getTime()-n;i.L(e+r+"ms")},i.StackTrace=function(){return(new Error).stack},i.W=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.join(" ");window.console.log("Warning: ",r,i.StackTrace())},(i.Prefix=function(e){return i.Prefix.prefix+e}).prefix="vf-";var a=function(){function e(t,n){g(this,e),this.set(t,n)}return y(e,[{key:"set",value:function(e,t){return this.numerator=void 0===e?1:e,this.denominator=void 0===t?1:t,this}},{key:"value",value:function(){return this.numerator/this.denominator}},{key:"simplify",value:function(){var t=this.numerator,n=this.denominator,i=e.GCD(t,n);return t/=i,(n/=i)<0&&(n=-n,t=-t),this.set(t,n)}},{key:"add",value:function(t,n){var i,r;t instanceof e?(i=t.numerator,r=t.denominator):(i=void 0!==t?t:0,r=void 0!==n?n:1);var a=e.LCM(this.denominator,r),s=a/this.denominator,o=a/r,u=this.numerator*s+i*o;return this.set(u,a)}},{key:"subtract",value:function(t,n){var i,r;t instanceof e?(i=t.numerator,r=t.denominator):(i=void 0!==t?t:0,r=void 0!==n?n:1);var a=e.LCM(this.denominator,r),s=a/this.denominator,o=a/r,u=this.numerator*s-i*o;return this.set(u,a)}},{key:"multiply",value:function(t,n){var i,r;return t instanceof e?(i=t.numerator,r=t.denominator):(i=void 0!==t?t:1,r=void 0!==n?n:1),this.set(this.numerator*i,this.denominator*r)}},{key:"divide",value:function(t,n){var i,r;return t instanceof e?(i=t.numerator,r=t.denominator):(i=void 0!==t?t:1,r=void 0!==n?n:1),this.set(this.numerator*r,this.denominator*i)}},{key:"equals",value:function(t){var n=e.__compareA.copy(t).simplify(),i=e.__compareB.copy(this).simplify();return n.numerator===i.numerator&&n.denominator===i.denominator}},{key:"greaterThan",value:function(t){var n=e.__compareB.copy(this);return n.subtract(t),n.numerator>0}},{key:"greaterThanEquals",value:function(t){var n=e.__compareB.copy(this);return n.subtract(t),n.numerator>=0}},{key:"lessThan",value:function(e){return!this.greaterThanEquals(e)}},{key:"lessThanEquals",value:function(e){return!this.greaterThan(e)}},{key:"clone",value:function(){return new e(this.numerator,this.denominator)}},{key:"copy",value:function(e){return"number"==typeof e?this.set(e||0,1):this.set(e.numerator,e.denominator)}},{key:"quotient",value:function(){return Math.floor(this.numerator/this.denominator)}},{key:"fraction",value:function(){return this.numerator%this.denominator}},{key:"abs",value:function(){return this.denominator=Math.abs(this.denominator),this.numerator=Math.abs(this.numerator),this}},{key:"toString",value:function(){return this.numerator+"/"+this.denominator}},{key:"toSimplifiedString",value:function(){return e.__tmp.copy(this).simplify().toString()}},{key:"toMixedString",value:function(){var t="",n=this.quotient(),i=e.__tmp.copy(this);return n<0?i.abs().fraction():i.fraction(),0!==n?(t+=n,0!==i.numerator&&(t+=" "+i.toSimplifiedString())):t=0===i.numerator?"0":i.toSimplifiedString(),t}},{key:"parse",value:function(e){var t=e.split("/"),n=parseInt(t[0],10),i=t[1]?parseInt(t[1],10):1;return this.set(n,i)}}],[{key:"GCD",value:function(e,t){if("number"!=typeof e||"number"!=typeof t)throw new i.RERR("BadArgument","Invalid numbers: ".concat(e,", ").concat(t));for(var n;0!==t;)n=t,t=e%t,e=n;return e}},{key:"LCM",value:function(t,n){return t*n/e.GCD(t,n)}},{key:"LCMM",value:function(t){if(0===t.length)return 0;if(1===t.length)return t[0];if(2===t.length)return e.LCM(t[0],t[1]);var n=t[0];return t.shift(),e.LCM(n,e.LCMM(t))}}]),e}();a.__compareA=new a,a.__compareB=new a,a.__tmp=new a;var l=i.MakeException("RegistryError");function f(e,t,n,i,r){e[t][n]||(e[t][n]={}),e[t][n][i]=r}var v=function(){function e(){g(this,e),this.clear()}return y(e,[{key:"clear",value:function(){return this.index={id:{},type:{},class:{}},this}},{key:"updateIndex",value:function(e){var t=e.id,n=e.name,i=e.value,r=e.oldValue,a=this.getElementById(t);null!==r&&this.index[n][r]&&delete this.index[n][r][t],null!==i&&f(this.index,n,i,a.getAttribute("id"),a)}},{key:"register",value:function(t,n){var i=this;if(!(n=n||t.getAttribute("id")))throw new l("Can't add element without `id` attribute to registry",t);return t.setAttribute("id",n),f(this.index,"id",n,n,t),e.INDEXES.forEach((function(e){i.updateIndex({id:n,name:e,value:t.getAttribute(e),oldValue:null})})),t.onRegister(this),this}},{key:"getElementById",value:function(e){return this.index.id[e]?this.index.id[e][e]:null}},{key:"getElementsByAttribute",value:function(e,t){var n=this.index[e];return n&&n[t]?Object.keys(n[t]).map((function(e){return n[t][e]})):[]}},{key:"getElementsByType",value:function(e){return this.getElementsByAttribute("type",e)}},{key:"getElementsByClass",value:function(e){return this.getElementsByAttribute("class",e)}},{key:"onUpdate",value:function(t){var n=t.id,i=t.name,r=t.value,a=t.oldValue;return function(e,t){return e.filter((function(e){return e===t})).length>0}(e.INDEXES.concat(["id","class"]),i)?(this.updateIndex({id:n,name:i,value:r,oldValue:a}),this):this}}],[{key:"INDEXES",get:function(){return["type"]}},{key:"enableDefaultRegistry",value:function(t){e.defaultRegistry=t}},{key:"getDefaultRegistry",value:function(){return e.defaultRegistry}},{key:"disableDefaultRegistry",value:function(){e.defaultRegistry=null}}]),e}();v.defaultRegistry=null;var _=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type;g(this,e),this.attrs={id:e.newID(),el:null,type:t||"Base",classes:{}},this.boundingBox=null,this.context=null,this.rendered=!1,v.getDefaultRegistry()&&v.getDefaultRegistry().register(this)}return y(e,[{key:"setStyle",value:function(e){return this.style=e,this}},{key:"getStyle",value:function(){return this.style}},{key:"applyStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getStyle();return t?(e.save(),t.shadowColor&&e.setShadowColor(t.shadowColor),t.shadowBlur&&e.setShadowBlur(t.shadowBlur),t.fillStyle&&e.setFillStyle(t.fillStyle),t.strokeStyle&&e.setStrokeStyle(t.strokeStyle),t.lineWidth&&e.setLineWidth(t.lineWidth),this):this}},{key:"restoreStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getStyle())?(e.restore(),this):this}},{key:"drawWithStyle",value:function(){this.checkContext(),this.applyStyle(),this.draw(),this.restoreStyle()}},{key:"hasClass",value:function(e){return!0===this.attrs.classes[e]}},{key:"addClass",value:function(e){return this.attrs.classes[e]=!0,this.registry&&this.registry.onUpdate({id:this.getAttribute("id"),name:"class",value:e,oldValue:null}),this}},{key:"removeClass",value:function(e){return delete this.attrs.classes[e],this.registry&&this.registry.onUpdate({id:this.getAttribute("id"),name:"class",value:null,oldValue:e}),this}},{key:"onRegister",value:function(e){return this.registry=e,this}},{key:"isRendered",value:function(){return this.rendered}},{key:"setRendered",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.rendered=e,this}},{key:"getAttributes",value:function(){return this.attrs}},{key:"getAttribute",value:function(e){return this.attrs[e]}},{key:"setAttribute",value:function(e,t){var n=this.attrs.id,i=this.attrs[e];return this.attrs[e]=t,this.registry&&this.registry.onUpdate({id:n,name:e,value:t,oldValue:i}),this}},{key:"getContext",value:function(){return this.context}},{key:"setContext",value:function(e){return this.context=e,this}},{key:"getBoundingBox",value:function(){return this.boundingBox}},{key:"checkContext",value:function(){if(!this.context)throw new i.RERR("NoContext","No rendering context attached to instance");return this.context}}],[{key:"newID",value:function(){return"auto"+e.ID++}}]),e}();_.ID=1e3;var E=function(){function e(t,n,i,r){g(this,e),this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.addPoint(t,n),this.addPoint(i,r)}return y(e,[{key:"width",value:function(){return this.x2-this.x1}},{key:"height",value:function(){return this.y2-this.y1}},{key:"addPoint",value:function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))}},{key:"addX",value:function(e){this.addPoint(e,null)}},{key:"addY",value:function(e){this.addPoint(null,e)}},{key:"addQuadraticCurve",value:function(e,t,n,i,r,a){var s=e+2/3*(n-e),o=t+2/3*(i-t),u=s+1/3*(r-e),l=o+1/3*(a-t);this.addBezierCurve(e,t,s,o,u,l,r,a)}},{key:"addBezierCurve",value:function(e,t,n,i,r,a,s,o){var u,l=[e,t],c=[n,i],h=[r,a],d=[s,o];this.addPoint(l[0],l[1]),this.addPoint(d[0],d[1]);var f=function(e,t){return Math.pow(1-e,3)*l[t]+3*Math.pow(1-e,2)*e*c[t]+3*(1-e)*Math.pow(e,2)*h[t]+Math.pow(e,3)*d[t]};for(u=0;u<=1;u++){var p=6*l[u]-12*c[u]+6*h[u],m=-3*l[u]+9*c[u]-9*h[u]+3*d[u],v=3*c[u]-3*l[u];if(0!==m){var g=Math.pow(p,2)-4*v*m;if(!(g<0)){var y=(-p+Math.sqrt(g))/(2*m);0<y&&y<1&&(0===u&&this.addX(f(y,u)),1===u&&this.addY(f(y,u)));var b=(-p-Math.sqrt(g))/(2*m);0<b&&b<1&&(0===u&&this.addX(f(b,u)),1===u&&this.addY(f(b,u)))}}else{if(0===p)continue;var S=-v/p;0<S&&S<1&&(0===u&&this.addX(f(S,u)),1===u&&this.addY(f(S,u)))}}}}]),e}(),k=function(){function e(t,n,i,r){g(this,e),this.x=t,this.y=n,this.w=i,this.h=r}return y(e,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getW",value:function(){return this.w}},{key:"getH",value:function(){return this.h}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setH",value:function(e){return this.h=e,this}},{key:"move",value:function(e,t){this.x+=e,this.y+=t}},{key:"clone",value:function(){return e.copy(this)}},{key:"mergeWith",value:function(e,t){var n=e,i=this.x<n.x?this.x:n.x,r=this.y<n.y?this.y:n.y,a=Math.max(this.x+this.w,n.x+n.w)-i,s=Math.max(this.y+this.h,n.y+n.h)-r;return this.x=i,this.y=r,this.w=a,this.h=s,t&&this.draw(t),this}},{key:"draw",value:function(e,t,n){t||(t=0),n||(n=0),e.rect(this.x+t,this.y+n,this.w,this.h),e.stroke()}}],[{key:"copy",value:function(t){return new e(t.x,t.y,t.w,t.h)}}]),e}(),M={glyphs:{v0:{x_min:0,x_max:514.5,ha:525,o:"m 236 648 b 246 648 238 648 242 648 b 288 646 261 648 283 648 b 472 513 364 634 428 587 b 514 347 502 464 514 413 b 462 163 514 272 499 217 b 257 44 409 83 333 44 b 50 163 181 44 103 83 b 0 347 14 217 0 272 b 40 513 0 413 12 464 b 236 648 87 591 155 638 m 277 614 b 253 616 273 616 261 616 b 242 616 247 616 243 616 b 170 499 193 609 181 589 b 159 348 163 446 159 398 b 166 222 159 308 161 266 b 201 91 174 138 183 106 b 257 76 215 81 235 76 b 311 91 277 76 299 81 b 347 222 330 106 338 138 b 353 348 352 266 353 308 b 344 499 353 398 351 446 b 277 614 333 587 322 606 m 257 -1 l 258 -1 l 255 -1 l 257 -1 m 257 673 l 258 673 l 255 673 l 257 673 "},v1:{x_min:-1.359375,x_max:344.359375,ha:351,o:"m 126 637 l 129 638 l 198 638 l 266 638 l 269 635 b 274 631 272 634 273 632 l 277 627 l 277 395 b 279 156 277 230 277 161 b 329 88 281 123 295 106 b 344 69 341 81 344 79 b 337 55 344 62 343 59 l 333 54 l 197 54 l 61 54 l 58 55 b 50 69 53 59 50 62 b 65 88 50 79 53 81 b 80 97 72 91 74 93 b 117 156 103 113 112 129 b 117 345 117 161 117 222 l 117 528 l 100 503 l 38 406 b 14 383 24 384 23 383 b -1 398 5 383 -1 390 b 4 415 -1 403 1 409 b 16 437 5 416 10 426 l 72 539 l 100 596 b 121 632 119 631 119 631 b 126 637 122 634 125 635 m 171 -1 l 172 -1 l 170 -1 l 171 -1 m 171 673 l 172 673 l 170 673 l 171 673 "},v2:{x_min:-1.359375,x_max:458.6875,ha:468,o:"m 197 648 b 216 648 201 648 208 648 b 258 646 232 648 253 648 b 419 546 333 637 393 599 b 432 489 428 528 432 509 b 356 342 432 440 405 384 b 235 278 322 313 288 295 b 69 170 166 256 107 217 b 69 169 69 170 69 169 b 69 169 69 169 69 169 b 74 173 69 169 72 170 b 209 222 112 204 163 222 b 310 195 247 222 274 215 b 371 179 332 184 352 179 b 396 181 379 179 387 179 b 428 202 409 184 423 194 b 442 212 431 209 436 212 b 458 197 450 212 458 206 b 441 148 458 190 449 165 b 299 44 409 84 353 44 b 288 45 295 44 292 44 b 250 61 274 45 268 49 b 122 99 212 86 164 99 b 73 91 104 99 88 97 b 28 63 53 84 34 72 b 14 54 25 56 20 54 b 1 62 9 54 4 56 l -1 65 l -1 79 b 0 99 -1 91 0 95 b 2 113 1 102 2 108 b 164 309 20 197 81 272 b 285 470 232 341 277 398 b 287 487 287 476 287 481 b 171 595 287 551 239 595 b 155 595 166 595 160 595 b 142 592 145 594 142 594 b 145 589 142 592 142 591 b 179 527 168 576 179 551 b 132 455 179 496 163 467 b 104 451 122 452 112 451 b 27 530 62 451 27 487 b 29 555 27 538 27 546 b 197 648 44 601 115 639 m 228 -1 l 230 -1 l 227 -1 l 228 -1 m 228 673 l 230 673 l 227 673 l 228 673 "},v3:{x_min:-1.359375,x_max:409.6875,ha:418,o:"m 174 648 b 191 648 176 648 183 648 b 225 648 204 648 220 648 b 402 523 317 638 389 588 b 404 503 404 517 404 510 b 402 484 404 495 404 488 b 264 373 389 437 334 394 b 257 370 259 371 257 371 b 257 370 257 370 257 370 b 264 369 258 370 261 369 b 409 202 359 334 409 267 b 318 72 409 152 381 104 b 200 43 281 52 240 43 b 23 113 134 43 69 68 b 0 169 6 129 0 149 b 77 249 0 210 29 249 l 77 249 b 152 174 125 249 152 212 b 103 102 152 145 137 116 b 103 102 103 102 103 102 b 147 94 103 101 132 95 b 153 94 149 94 151 94 b 265 206 219 94 265 141 b 264 226 265 213 265 219 b 147 355 253 299 204 353 b 126 371 133 356 126 362 b 147 388 126 383 132 388 b 254 474 196 391 238 424 b 259 502 258 484 259 494 b 182 592 259 544 228 582 b 156 595 175 595 166 595 b 115 592 142 595 129 594 l 111 591 l 115 588 b 152 524 141 574 152 549 b 92 449 152 491 130 458 b 76 448 87 448 81 448 b -1 530 32 448 -1 488 b 20 581 -1 548 5 566 b 174 648 55 619 108 641 m 204 -1 l 205 -1 l 202 -1 l 204 -1 m 204 673 l 205 673 l 202 673 l 204 673 "},v4:{x_min:0,x_max:468.21875,ha:478,o:"m 174 637 b 232 638 175 638 189 638 b 277 638 245 638 259 638 l 378 638 l 381 635 b 389 623 386 632 389 627 b 382 609 389 617 386 613 b 366 589 381 606 372 598 l 313 528 l 245 451 l 209 410 l 155 348 l 84 267 b 59 240 72 252 59 240 b 59 240 59 240 59 240 b 151 238 59 238 68 238 l 242 238 l 242 303 b 243 371 242 369 242 370 b 289 426 245 374 254 385 l 303 441 l 317 456 l 338 483 l 360 506 l 371 520 b 386 527 375 526 381 527 b 400 519 392 527 397 524 b 401 440 401 516 401 514 b 401 377 401 423 401 402 l 401 238 l 426 238 b 453 237 449 238 450 238 b 465 217 461 234 465 226 b 460 202 465 212 464 206 b 426 197 454 197 453 197 l 401 197 l 401 180 b 451 88 402 129 412 109 b 468 69 465 81 468 79 b 461 55 468 62 466 59 l 458 54 l 321 54 l 185 54 l 182 55 b 175 69 176 59 175 62 b 191 88 175 79 176 81 b 240 180 230 109 240 129 l 240 197 l 125 197 b 73 195 104 195 87 195 b 8 197 10 195 9 197 b 0 212 2 199 0 205 b 0 212 0 212 0 212 b 20 242 0 219 0 219 b 163 610 104 344 163 492 b 174 637 163 628 166 634 m 234 -1 l 235 -1 l 232 -1 l 234 -1 m 234 673 l 235 673 l 232 673 l 234 673 "},v5:{x_min:0,x_max:409.6875,ha:418,o:"m 47 637 b 53 638 49 638 50 638 b 69 634 55 638 61 637 b 210 610 114 619 161 610 b 363 634 259 610 311 619 b 382 638 372 637 378 638 b 392 634 386 638 389 637 b 397 623 396 630 397 627 b 393 610 397 620 396 616 b 298 505 368 552 338 520 b 212 494 277 498 246 494 b 65 517 163 494 106 502 b 61 517 62 517 61 517 b 61 517 61 517 61 517 b 51 408 61 517 51 412 b 51 408 51 408 51 408 b 51 408 51 408 51 408 b 61 412 53 408 55 409 b 125 434 80 421 103 430 b 185 441 145 440 166 441 b 409 244 310 441 409 353 b 401 191 409 227 406 209 b 197 43 375 105 287 43 b 159 47 183 43 171 44 b 23 123 112 56 61 86 b 0 180 6 140 0 159 b 76 260 0 220 31 260 b 92 259 81 260 87 259 b 152 183 132 251 152 216 b 100 112 152 152 134 122 b 95 111 98 112 95 111 b 95 111 95 111 95 111 b 129 98 95 109 119 101 b 148 97 136 97 141 97 b 264 235 206 97 261 158 b 265 248 265 240 265 244 b 210 398 265 312 243 373 b 179 408 201 406 194 408 b 174 408 178 408 176 408 b 53 369 130 408 88 394 b 34 359 39 359 38 359 b 17 374 24 359 17 365 b 39 628 17 384 38 625 b 47 637 40 631 43 635 m 204 -1 l 205 -1 l 202 -1 l 204 -1 m 204 673 l 205 673 l 202 673 l 204 673 "},v6:{x_min:0,x_max:475.03125,ha:485,o:"m 255 648 b 274 648 259 648 266 648 b 314 646 288 648 307 648 b 450 555 374 637 438 594 b 454 530 453 546 454 538 b 375 451 454 485 416 451 b 328 467 359 451 343 455 b 300 526 310 483 300 503 b 352 598 300 557 319 589 b 356 599 355 598 356 599 b 352 602 356 599 355 601 b 288 616 330 612 308 616 b 210 584 257 616 230 605 b 164 433 189 559 174 508 b 160 374 163 415 160 381 b 160 374 160 374 160 374 b 160 374 160 374 160 374 b 168 377 160 374 164 376 b 258 395 200 390 228 395 b 366 367 294 395 328 387 b 475 223 436 333 475 283 b 472 197 475 215 473 206 b 349 65 462 141 419 95 b 259 43 317 51 288 43 b 167 69 230 43 200 52 b 4 290 80 113 20 195 b 0 349 1 309 0 328 b 20 467 0 391 6 433 b 255 648 58 563 155 637 m 269 363 b 257 363 265 363 261 363 b 210 345 236 363 220 356 b 186 226 196 324 186 272 b 187 198 186 216 186 206 b 213 95 191 151 202 112 b 257 76 221 83 238 76 b 270 77 261 76 266 76 b 321 156 299 81 310 99 b 329 229 326 183 329 206 b 321 301 329 252 326 274 b 269 363 311 342 298 359 m 236 -1 l 238 -1 l 235 -1 l 236 -1 m 236 673 l 238 673 l 235 673 l 236 673 "},v7:{x_min:0,x_max:442.359375,ha:451,o:"m 147 648 b 166 649 153 649 160 649 b 313 598 217 649 273 630 b 340 587 323 588 328 587 l 341 587 b 412 628 367 587 390 601 b 427 638 416 635 421 638 b 439 632 431 638 435 637 b 442 623 441 630 442 628 b 430 569 442 616 439 603 b 352 369 408 492 377 410 b 300 259 325 324 313 298 b 273 84 283 205 273 140 b 265 55 273 65 272 59 l 261 54 l 181 54 l 99 54 l 96 55 b 91 61 95 56 92 59 l 89 63 l 89 77 b 147 263 89 133 111 202 b 261 401 176 313 212 355 b 378 541 315 449 349 489 l 382 548 l 375 544 b 240 495 333 512 285 495 b 129 535 198 495 160 509 b 84 560 108 552 95 560 b 76 559 81 560 78 560 b 31 487 59 555 43 530 b 14 470 27 473 24 470 b 1 477 8 470 4 471 l 0 480 l 0 553 l 0 627 l 1 630 b 16 638 4 635 9 638 b 23 635 17 638 20 637 b 49 626 36 626 39 626 b 96 638 59 626 80 630 b 104 639 99 638 102 639 b 117 644 107 641 112 642 b 147 648 125 645 137 648 m 220 -1 l 221 -1 l 219 -1 l 220 -1 m 220 673 l 221 673 l 219 673 l 220 673 "},v8:{x_min:0,x_max:488.640625,ha:499,o:"m 217 648 b 245 649 225 648 235 649 b 453 516 343 649 430 595 b 458 478 455 503 458 491 b 412 370 458 440 441 398 b 411 369 412 369 411 369 b 415 365 411 367 412 367 b 488 231 462 331 488 281 b 472 165 488 208 483 186 b 243 43 434 86 338 43 b 63 104 178 43 112 62 b 0 233 20 140 0 186 b 73 365 0 283 24 331 l 77 369 l 72 374 b 29 476 42 406 29 441 b 217 648 29 557 103 635 m 258 605 b 242 606 253 605 247 606 b 157 552 198 606 157 580 b 160 541 157 548 159 544 b 319 413 176 503 242 452 l 337 403 l 338 406 b 359 476 352 428 359 452 b 258 605 359 537 318 595 m 138 326 b 130 330 134 328 130 330 b 130 330 130 330 130 330 b 107 305 127 330 112 313 b 84 231 91 281 84 256 b 243 86 84 156 151 86 b 249 87 245 86 246 87 b 347 156 303 88 347 120 b 344 172 347 162 345 167 b 156 319 325 227 257 281 b 138 326 151 322 144 324 m 243 -1 l 245 -1 l 242 -1 l 243 -1 m 243 673 l 245 673 l 242 673 l 243 673 "},v9:{x_min:0,x_max:475.03125,ha:485,o:"m 191 646 b 212 649 198 648 205 649 b 255 644 227 649 243 646 b 458 448 348 616 428 539 b 475 342 469 415 475 378 b 460 244 475 308 469 274 b 193 44 421 124 303 44 b 91 69 157 44 122 51 b 19 161 43 97 19 126 b 21 181 19 167 20 174 b 98 241 32 220 65 241 b 170 186 129 241 160 223 b 172 166 171 179 172 173 b 121 94 172 134 152 102 b 117 93 118 94 117 93 b 121 90 117 93 118 91 b 185 76 142 80 164 76 b 270 119 220 76 251 91 b 308 259 287 145 300 194 b 313 317 310 277 313 310 b 313 317 313 317 313 317 b 313 317 313 317 313 317 b 304 315 313 317 308 316 b 216 295 273 302 245 295 b 145 308 193 295 170 299 b 19 398 88 327 42 360 b 0 469 5 420 0 444 b 24 551 0 496 8 526 b 191 646 54 596 125 637 m 227 614 b 215 616 224 616 220 616 b 202 614 210 616 206 616 b 152 535 174 610 163 592 b 144 463 147 509 144 485 b 152 391 144 440 147 417 b 216 328 163 344 179 328 b 280 391 253 328 269 344 b 288 463 285 417 288 440 b 280 535 288 485 285 509 b 227 614 269 594 258 610 m 236 -1 l 238 -1 l 235 -1 l 236 -1 m 236 673 l 238 673 l 235 673 l 236 673 "},va:{x_min:-149.71875,x_max:148.359375,ha:151,o:"m -8 -1 b -1 0 -5 -1 -4 0 b 16 -11 5 0 13 -4 b 83 -186 17 -12 47 -90 l 148 -358 l 148 -363 b 127 -385 148 -376 138 -385 b 112 -378 122 -385 118 -383 b 54 -226 110 -374 114 -385 b 0 -81 24 -147 0 -81 b -55 -226 -1 -81 -25 -147 b -114 -378 -115 -385 -111 -374 b -129 -385 -119 -383 -123 -385 b -149 -363 -140 -385 -149 -376 l -149 -358 l -84 -186 b -19 -11 -49 -90 -19 -12 b -8 -1 -17 -8 -12 -4 "},vb:{x_min:0,x_max:428.75,ha:438,o:"m 262 186 b 273 186 266 186 272 186 b 274 186 273 186 274 186 b 285 186 274 186 280 186 b 428 48 375 181 428 122 b 386 -68 428 12 416 -29 b 155 -187 329 -145 236 -187 b 12 -111 92 -187 38 -162 b 0 -51 4 -91 0 -72 b 262 186 0 58 122 179 "},vc:{x_min:0,x_max:447.8125,ha:457,o:"m 0 86 l 0 173 l 223 173 l 447 173 l 447 86 l 447 0 l 223 0 l 0 0 l 0 86 "},vf:{x_min:0,x_max:370.21875,ha:378,o:"m 0 0 l 0 277 l 61 277 l 122 277 l 122 0 l 122 -278 l 61 -278 l 0 -278 l 0 0 m 246 -1 l 246 277 l 308 277 l 370 277 l 370 -1 l 370 -278 l 308 -278 l 246 -278 l 246 -1 "},v10:{x_min:0,x_max:559.421875,ha:571,o:"m 5 127 b 14 127 6 127 9 127 b 51 126 25 127 43 127 b 175 98 93 122 138 112 l 186 94 b 279 51 210 86 255 65 b 285 47 280 51 283 48 b 319 27 291 44 311 31 l 326 22 b 359 0 332 19 352 4 l 367 -6 b 371 -9 368 -6 370 -8 l 379 -15 b 387 -22 383 -18 386 -20 l 398 -30 l 411 -40 l 417 -47 l 427 -55 l 434 -61 b 441 -66 436 -62 439 -65 l 446 -72 l 453 -77 l 462 -87 b 558 -188 490 -113 549 -176 b 559 -195 559 -191 559 -194 b 548 -205 559 -201 555 -205 b 541 -204 547 -205 544 -205 b 534 -198 539 -201 536 -199 l 525 -191 b 481 -162 518 -187 490 -167 b 472 -155 477 -159 472 -156 b 468 -152 470 -155 469 -154 b 461 -149 466 -152 464 -151 b 428 -130 454 -145 441 -137 b 371 -99 413 -122 372 -99 b 363 -95 371 -99 367 -98 b 353 -91 357 -94 353 -91 b 348 -90 353 -91 352 -91 b 332 -81 343 -87 341 -86 b 27 -12 230 -37 127 -13 b 0 -5 4 -11 2 -11 b 0 58 0 -2 0 27 b 0 122 0 88 0 120 b 5 127 1 124 4 126 "},v11:{x_min:-155.171875,x_max:153.8125,ha:157,o:"m -137 353 b -130 353 -136 353 -133 353 b -112 349 -125 353 -119 352 b -100 342 -110 347 -104 344 b 0 317 -69 326 -35 317 b 111 349 38 317 76 328 b 129 353 117 352 123 353 b 153 327 142 353 153 344 b 144 302 153 320 153 317 b 27 6 93 226 50 113 b 21 -13 24 -11 24 -11 b 0 -26 17 -22 8 -26 b -24 -12 -9 -26 -19 -22 b -28 5 -24 -9 -27 -2 b -145 302 -53 117 -95 224 b -155 327 -155 317 -155 320 b -137 353 -155 340 -148 349 "},v18:{x_min:0,x_max:323.9375,ha:331,o:"m 217 535 b 225 537 220 537 221 537 b 245 524 235 537 242 533 l 246 521 l 247 390 l 247 258 l 273 265 b 306 270 288 269 299 270 b 322 259 315 270 319 267 b 323 208 323 256 323 233 b 322 158 323 184 323 159 b 288 140 318 148 315 147 b 247 130 254 131 247 130 b 247 65 247 130 247 104 b 247 20 247 51 247 36 l 247 -88 l 273 -81 b 306 -76 289 -77 299 -76 b 318 -81 311 -76 315 -77 b 323 -123 323 -87 323 -86 l 323 -138 l 323 -154 b 318 -195 323 -191 323 -190 b 269 -210 314 -199 315 -199 b 249 -216 259 -213 250 -216 l 247 -216 l 247 -349 l 246 -483 l 245 -487 b 225 -499 242 -495 234 -499 b 206 -487 219 -499 210 -495 l 205 -483 l 205 -355 l 205 -227 l 204 -227 l 181 -233 l 138 -244 b 117 -249 127 -247 117 -249 b 115 -385 115 -249 115 -256 l 115 -523 l 114 -526 b 95 -538 110 -534 102 -538 b 74 -526 87 -538 78 -534 l 73 -523 l 73 -391 b 72 -260 73 -269 73 -260 b 72 -260 72 -260 72 -260 b 19 -273 61 -263 23 -273 b 0 -260 10 -273 4 -267 b 0 -209 0 -256 0 -256 l 0 -162 l 1 -158 b 61 -134 5 -148 5 -148 l 73 -131 l 73 -22 b 72 86 73 79 73 86 b 72 86 72 86 72 86 b 19 74 61 83 23 74 b 0 86 10 74 4 79 b 0 137 0 90 0 90 l 0 184 l 1 188 b 61 212 5 198 5 198 l 73 215 l 73 348 l 73 481 l 74 485 b 95 498 78 492 87 498 b 103 495 98 498 100 496 b 114 485 107 494 111 489 l 115 481 l 115 353 l 115 226 l 121 226 b 159 235 123 227 141 231 l 198 247 l 205 248 l 205 384 l 205 521 l 206 524 b 217 535 209 528 212 533 m 205 9 b 205 119 205 70 205 119 l 205 119 b 182 113 204 119 194 116 l 138 102 b 117 97 127 99 117 97 b 115 -12 115 97 115 91 l 115 -122 l 121 -120 b 159 -111 123 -119 141 -115 l 198 -101 l 205 -98 l 205 9 "},v1b:{x_min:0,x_max:559.421875,ha:571,o:"m 544 204 b 548 204 545 204 547 204 b 559 194 555 204 559 199 b 559 190 559 192 559 191 b 530 156 559 188 556 184 b 462 86 510 134 481 104 b 453 76 458 81 454 77 l 446 70 l 441 65 b 434 59 439 63 436 61 l 427 54 b 409 37 426 51 416 44 b 392 23 398 29 394 26 b 387 19 389 22 387 20 b 379 13 386 19 383 16 l 371 8 l 367 5 l 359 -1 l 337 -16 b 285 -48 319 -29 298 -41 l 279 -52 b 186 -95 255 -66 210 -87 l 175 -99 b 23 -129 127 -117 68 -129 b 17 -129 20 -129 19 -129 b 1 -123 2 -129 2 -129 b 0 -49 0 -122 0 -83 b 0 4 0 -22 0 1 b 27 11 2 9 4 9 b 185 31 78 12 145 20 b 198 34 186 31 193 33 b 314 73 234 44 277 58 b 349 88 328 79 340 84 b 353 90 352 90 353 90 b 363 94 353 90 357 93 b 371 98 367 97 371 98 b 428 129 372 98 413 120 b 461 148 441 136 454 144 b 468 151 464 149 466 151 b 472 154 469 152 470 154 b 481 161 473 155 477 158 b 525 190 490 166 518 186 l 534 197 b 540 201 536 198 539 199 b 544 204 541 202 544 204 "},v1d:{x_min:0,x_max:619.3125,ha:632,o:"m 274 184 b 307 186 285 186 296 186 b 616 22 465 186 597 116 b 619 -1 617 13 619 5 b 308 -187 619 -104 483 -187 b 0 -1 133 -187 0 -102 b 5 36 0 11 1 23 b 274 184 29 115 141 176 m 289 161 b 272 162 284 162 277 162 b 171 41 209 162 171 108 b 205 -73 171 5 182 -34 b 345 -163 243 -133 298 -163 b 436 -98 385 -163 420 -142 b 446 -43 443 -80 446 -62 b 289 161 446 47 377 147 "},v1e:{x_min:-402.890625,x_max:401.53125,ha:410,o:"m -219 173 b -213 174 -217 174 -215 174 b -202 173 -209 174 -205 173 b -114 86 -200 172 -179 151 b -28 0 -66 37 -28 0 b 40 84 -28 0 2 37 b 117 174 111 173 110 172 b 122 174 118 174 119 174 b 132 173 125 174 129 173 b 295 11 134 172 171 134 l 307 -1 l 336 34 b 374 76 366 72 368 74 b 381 77 375 77 378 77 b 401 56 392 77 401 68 b 400 48 401 54 401 51 b 223 -172 397 41 230 -166 b 210 -176 220 -174 215 -176 b 201 -174 206 -176 204 -176 b 112 -87 198 -173 178 -152 b 27 0 65 -38 27 0 b -42 -86 27 0 -4 -38 b -118 -174 -112 -174 -111 -173 b -123 -176 -119 -176 -121 -176 b -133 -174 -126 -176 -130 -174 b -296 -12 -136 -173 -172 -137 l -308 0 l -337 -34 b -375 -77 -367 -73 -370 -76 b -382 -79 -377 -79 -379 -79 b -402 -58 -393 -79 -402 -69 b -401 -49 -402 -55 -402 -52 b -224 172 -398 -43 -228 167 b -219 173 -223 172 -220 173 "},v1f:{x_min:-340.28125,x_max:338.921875,ha:346,o:"m -32 520 b -29 521 -31 520 -31 521 b -23 519 -27 521 -24 520 b -20 513 -21 517 -20 516 b -21 506 -20 512 -20 509 b -31 474 -23 502 -27 488 l -53 402 l -66 352 l -68 349 l -57 349 b -32 351 -51 349 -40 351 b 123 370 19 352 74 359 b 137 371 127 370 133 371 b 170 356 152 371 164 366 b 171 355 170 355 170 355 b 216 366 174 355 183 358 b 280 378 268 377 266 377 b 287 378 283 378 284 378 b 332 349 307 378 322 369 b 338 319 336 341 338 330 b 332 301 338 310 336 302 b 242 280 329 299 246 280 b 242 280 242 280 242 280 b 235 288 236 280 235 283 b 235 292 235 290 235 291 b 236 302 236 297 236 299 b 220 337 236 316 230 330 l 216 340 l 210 335 b 159 276 189 322 172 301 b 118 149 152 265 156 274 b 81 34 84 36 85 36 b -8 13 78 33 -4 13 b -8 13 -8 13 -8 13 b -14 20 -12 15 -14 15 b -8 44 -14 24 -12 31 b -2 66 -5 55 -2 65 b -2 66 -2 66 -2 66 l -2 66 b -43 41 -2 66 -21 55 b -114 4 -98 8 -98 8 b -144 0 -123 0 -134 0 b -242 99 -197 0 -242 43 b -242 109 -242 102 -242 105 b -212 219 -240 122 -242 116 b -185 312 -197 270 -185 312 l -185 312 b -189 312 -185 312 -186 312 b -259 312 -200 312 -227 312 b -321 310 -291 312 -310 310 b -334 312 -330 310 -334 312 b -340 319 -338 313 -340 316 b -336 326 -340 322 -338 324 b -291 337 -334 326 -314 331 l -247 347 l -210 348 b -172 348 -190 348 -172 348 b -168 363 -172 348 -171 355 b -145 442 -151 424 -145 441 b -133 452 -144 444 -140 446 l -77 489 b -32 520 -53 506 -32 520 m 57 334 b 53 335 55 335 54 335 b 44 334 50 335 49 335 b -70 316 8 326 -28 320 b -78 309 -78 316 -78 316 b -108 202 -80 305 -88 274 b -141 81 -136 112 -141 93 b -140 74 -141 79 -141 77 b -117 49 -137 59 -127 49 b -107 52 -114 49 -110 51 b 16 127 -106 54 14 126 b 42 217 16 127 42 215 b 49 241 42 222 44 229 b 73 320 53 251 73 317 b 57 334 73 327 65 333 "},v20:{x_min:-571.671875,x_max:570.3125,ha:582,o:"m -559 351 b -551 352 -556 352 -553 352 b -530 338 -543 352 -533 348 b -529 169 -530 337 -529 291 l -529 1 l -507 27 l -441 112 b -382 174 -394 169 -390 174 b -378 174 -381 174 -379 174 b -281 86 -370 174 -375 179 b -196 0 -234 37 -196 0 b -126 84 -196 0 -164 37 b -50 174 -55 173 -57 172 b -44 174 -49 174 -47 174 b -35 173 -42 174 -38 173 b 53 86 -32 172 -12 151 b 138 0 100 37 138 0 b 208 84 140 0 170 37 b 284 174 279 173 279 172 b 289 174 285 174 288 174 b 300 173 294 174 298 173 b 462 11 303 172 340 134 l 475 -1 l 503 34 b 541 76 534 72 536 74 b 548 77 544 77 545 77 b 570 56 560 77 570 68 b 567 48 570 54 568 51 b 392 -172 564 41 397 -166 b 378 -176 387 -174 382 -176 b 368 -174 375 -176 371 -176 b 280 -87 367 -173 347 -152 b 194 0 234 -38 194 0 b 126 -86 194 0 163 -38 b 49 -174 54 -174 55 -173 b 44 -176 47 -176 46 -176 b 34 -174 40 -176 36 -174 b -54 -87 31 -173 10 -152 b -140 0 -102 -38 -140 0 b -209 -86 -140 0 -171 -38 b -285 -174 -280 -174 -279 -173 b -291 -176 -287 -176 -288 -176 b -300 -174 -294 -176 -298 -174 b -464 -11 -303 -173 -374 -102 l -476 0 l -506 -37 b -539 -76 -528 -65 -537 -74 b -551 -80 -543 -79 -547 -80 b -570 -68 -558 -80 -566 -76 l -571 -65 l -571 136 b -570 340 -571 331 -571 337 b -559 351 -568 344 -564 348 "},v22:{x_min:0,x_max:432.828125,ha:442,o:"m 209 186 b 213 187 210 187 212 187 b 216 187 215 187 216 187 b 224 174 216 186 220 180 b 420 -1 269 105 338 43 b 432 -12 431 -8 432 -9 b 421 -23 432 -15 432 -16 b 228 -180 345 -70 264 -137 b 219 -188 221 -188 221 -188 l 219 -188 b 208 -177 215 -188 215 -188 b 10 1 163 -106 93 -44 b 0 11 0 6 0 8 b 10 22 0 13 0 15 b 202 179 87 69 167 136 b 209 186 206 183 209 186 "},v23:{x_min:0,x_max:133.390625,ha:136,o:"m 54 66 b 65 68 58 68 61 68 b 122 37 88 68 110 56 b 133 -1 130 26 133 12 b 104 -58 133 -23 123 -44 b 66 -69 92 -65 78 -69 b 10 -38 44 -69 23 -58 b 0 -1 2 -27 0 -13 b 54 66 0 30 20 61 "},v25:{x_min:0,x_max:318.5,ha:325,o:"m 20 376 b 167 377 23 377 96 377 b 296 376 231 377 294 377 b 318 347 311 371 318 359 b 296 316 318 333 311 320 b 159 315 294 315 227 315 b 21 316 91 315 24 315 b 0 345 6 320 0 333 b 20 376 0 359 6 371 "},v26:{x_min:-21.78125,x_max:483.1875,ha:493,o:"m -8 631 b -1 632 -6 632 -4 632 b 19 620 8 632 16 628 b 20 383 20 616 20 616 l 20 148 l 21 151 b 140 199 59 183 102 199 b 206 179 164 199 187 192 l 210 176 l 210 396 l 210 617 l 212 621 b 231 632 216 628 223 632 b 250 620 239 632 247 628 b 251 383 251 616 251 616 l 251 148 l 254 151 b 370 199 291 183 332 199 b 415 191 385 199 400 197 b 483 84 458 176 483 134 b 461 0 483 58 476 29 b 332 -142 439 -40 411 -72 l 255 -215 b 231 -229 240 -229 239 -229 b 216 -223 224 -229 220 -227 b 210 -158 210 -217 210 -223 b 210 -120 210 -148 210 -136 l 210 -29 l 205 -34 b 100 -142 182 -65 159 -88 l 23 -215 b -1 -229 9 -229 6 -229 b -20 -216 -9 -229 -17 -224 l -21 -212 l -21 201 l -21 616 l -20 620 b -8 631 -17 624 -13 630 m 110 131 b 96 133 106 133 100 133 b 89 133 93 133 91 133 b 24 87 63 129 40 113 l 20 80 l 20 -37 l 20 -156 l 23 -152 b 144 81 96 -72 144 20 l 144 83 b 110 131 144 113 134 126 m 341 131 b 328 133 337 133 332 133 b 322 133 326 133 323 133 b 257 87 296 129 273 113 l 251 80 l 251 -37 l 251 -156 l 255 -152 b 375 81 328 -72 375 20 l 375 83 b 341 131 375 113 367 126 "},v27:{x_min:0,x_max:432.828125,ha:442,o:"m 208 184 b 213 187 209 186 212 187 b 224 176 217 187 221 183 b 245 147 225 172 235 159 b 419 -1 288 90 347 38 b 431 -8 424 -4 431 -8 b 432 -12 432 -9 432 -11 b 430 -18 432 -13 432 -16 b 364 -61 424 -20 383 -47 b 225 -183 307 -102 250 -152 b 223 -187 224 -184 223 -187 b 220 -188 221 -188 220 -188 b 208 -176 216 -188 210 -184 b 187 -148 205 -173 197 -159 b 12 0 144 -90 84 -38 b 0 11 4 5 0 8 b 16 24 0 13 4 18 b 183 158 83 69 141 115 b 208 184 194 169 198 173 m 183 105 b 176 113 181 109 176 113 b 172 109 176 113 175 112 b 92 45 149 90 117 62 l 88 41 l 102 31 b 247 -105 160 -6 210 -55 l 254 -115 l 257 -112 l 269 -102 b 340 -45 287 -87 319 -61 l 344 -43 l 330 -33 b 183 105 272 6 221 54 "},v28:{x_min:-73.5,x_max:72.140625,ha:74,o:"m -72 252 l -73 254 l 0 254 l 72 254 l 70 252 b 0 -1 70 248 0 -1 b -72 252 -1 -1 -72 248 "},v29:{x_min:-590.71875,x_max:589.359375,ha:601,o:"m 175 273 b 182 274 178 273 181 274 b 202 262 190 274 198 269 b 204 158 204 259 204 259 l 204 56 l 250 112 b 303 174 296 172 298 172 b 308 174 304 174 307 174 b 318 173 313 174 317 173 b 481 11 322 172 357 134 l 494 -1 l 522 34 b 560 76 553 72 555 74 b 567 77 563 77 564 77 b 589 56 579 77 589 68 b 586 48 589 54 588 51 b 411 -172 583 41 416 -166 b 397 -176 406 -174 401 -176 b 387 -174 393 -176 390 -176 b 299 -87 386 -173 366 -152 b 213 0 253 -38 213 0 b 208 -6 213 0 210 -2 l 204 -12 l 204 -147 b 204 -210 204 -173 204 -194 b 198 -292 204 -297 204 -287 b 183 -299 194 -297 189 -299 b 164 -287 175 -299 167 -295 b 163 -174 163 -284 163 -284 l 161 -63 l 119 -117 b 65 -176 76 -170 73 -176 b 61 -176 63 -176 62 -176 b -35 -87 51 -174 57 -180 b -121 0 -83 -38 -121 0 b -190 -86 -122 0 -152 -38 b -266 -174 -261 -174 -259 -173 b -272 -176 -268 -176 -270 -176 b -281 -174 -276 -176 -280 -174 b -371 -86 -284 -173 -304 -152 b -457 0 -417 -38 -457 0 l -457 0 b -477 -26 -457 0 -470 -16 b -548 -227 -524 -88 -548 -161 b -536 -303 -548 -254 -544 -280 b -533 -317 -534 -309 -533 -313 b -553 -338 -533 -330 -541 -338 b -577 -315 -566 -338 -571 -333 b -590 -227 -586 -287 -590 -258 b -518 -9 -590 -154 -564 -77 b -465 56 -509 2 -504 8 l -402 134 b -363 174 -374 170 -371 174 b -359 174 -362 174 -360 174 b -262 86 -351 174 -356 179 b -176 0 -216 37 -176 0 b -107 84 -176 0 -145 37 b -31 174 -36 173 -38 172 b -25 174 -29 174 -28 174 b -16 173 -23 174 -19 173 b 147 11 -13 172 35 123 l 157 -1 l 160 1 l 163 4 l 163 130 b 164 260 163 256 163 258 b 175 273 166 266 170 270 "},v2a:{x_min:-21.78125,x_max:366.140625,ha:374,o:"m 276 1378 b 284 1379 279 1379 281 1379 b 306 1360 292 1379 298 1374 b 352 1247 326 1326 343 1286 b 366 1139 362 1213 366 1175 b 347 1009 366 1093 359 1049 l 344 1002 l 347 992 b 352 971 348 986 351 977 b 366 863 362 936 366 899 b 347 732 366 818 359 773 l 344 725 l 347 716 b 352 695 348 710 351 700 b 366 588 362 659 366 623 b 223 262 366 464 314 345 b 189 233 212 252 212 252 b 35 76 126 183 73 129 b -1 16 20 56 2 27 b -19 4 -4 9 -12 4 l -21 4 l -21 137 l -21 270 l -17 270 b 186 344 59 281 134 308 b 319 606 270 399 319 499 b 317 650 319 620 319 635 l 315 659 l 314 655 b 223 537 288 607 258 570 b 189 509 212 528 212 528 b 35 352 126 459 73 405 b -1 292 20 333 2 303 b -19 280 -4 285 -12 280 l -21 280 l -21 413 l -21 546 l -17 546 b 186 620 59 557 134 584 b 319 882 270 675 319 775 b 317 925 319 896 319 911 l 315 935 l 314 931 b 223 813 288 884 258 846 b 189 785 212 805 212 805 b 35 628 126 735 73 681 b -1 569 20 609 2 580 b -19 556 -4 562 -12 556 l -21 556 l -21 689 l -21 823 l -17 823 b 202 907 68 835 152 867 b 319 1157 280 968 319 1061 b 270 1338 319 1218 303 1281 b 262 1358 264 1349 262 1353 b 262 1364 262 1360 262 1363 b 276 1378 265 1371 269 1376 "},v2c:{x_min:-597.53125,x_max:596.171875,ha:608,o:"m -413 173 b -408 174 -412 174 -409 174 b -397 173 -404 174 -400 173 b -308 86 -394 172 -374 151 b -223 0 -261 37 -223 0 b -153 84 -223 0 -191 37 b -77 174 -83 173 -84 172 b -72 174 -76 174 -74 174 b -62 173 -68 174 -63 173 b 25 86 -59 172 -39 151 b 112 0 73 37 111 0 b 181 84 112 0 144 37 b 257 174 251 173 251 172 b 262 174 258 174 261 174 b 273 173 266 174 270 173 b 436 9 276 172 347 101 l 447 -1 l 477 36 b 522 79 511 79 513 79 l 522 79 b 552 51 533 79 539 73 b 596 -112 582 6 596 -51 b 567 -262 596 -161 586 -213 b 539 -322 558 -287 544 -316 b 524 -327 534 -326 529 -327 b 504 -315 515 -327 507 -323 b 503 -308 503 -312 503 -309 b 511 -285 503 -302 504 -297 b 555 -113 540 -227 555 -169 b 544 -34 555 -86 551 -59 b 522 19 540 -16 530 8 l 521 22 l 481 -26 l 405 -122 b 353 -176 366 -172 362 -176 b 349 -176 352 -176 351 -176 b 253 -87 341 -176 347 -180 b 167 0 206 -38 167 0 b 99 -86 167 0 136 -38 b 21 -174 27 -174 28 -173 b 17 -176 20 -176 19 -176 b 6 -174 13 -176 9 -174 b -81 -87 4 -173 -14 -152 b -167 0 -129 -38 -167 0 b -236 -86 -167 0 -198 -38 b -313 -174 -307 -174 -306 -173 b -318 -176 -314 -176 -315 -176 b -328 -174 -321 -176 -325 -174 b -491 -12 -330 -173 -367 -137 l -503 0 l -530 -34 b -570 -77 -562 -73 -564 -76 b -577 -79 -571 -79 -574 -79 b -597 -58 -588 -79 -597 -69 b -596 -49 -597 -55 -597 -52 b -417 172 -593 -43 -423 167 b -413 173 -417 172 -415 173 "},v2d:{x_min:0,x_max:438.28125,ha:447,o:"m 212 190 b 219 191 213 191 216 191 b 236 176 225 191 228 190 b 419 18 277 105 341 49 b 436 5 431 13 434 11 b 438 -1 438 4 438 1 b 424 -16 438 -8 432 -13 b 356 -49 409 -20 379 -36 b 234 -180 306 -83 258 -133 b 219 -192 230 -188 224 -192 b 200 -176 213 -192 206 -187 b 9 -15 157 -102 89 -45 b 0 0 2 -12 0 -6 b 16 18 0 9 2 12 b 200 176 93 48 159 104 b 212 190 205 186 208 188 m 239 113 b 236 117 238 116 238 117 b 230 108 235 117 234 115 b 92 -15 196 58 140 8 b 88 -18 91 -16 88 -18 b 92 -20 88 -18 91 -19 b 198 -116 130 -43 166 -74 b 200 -117 200 -117 200 -117 b 201 -117 200 -117 201 -117 b 264 -43 212 -98 242 -62 b 345 15 288 -19 321 4 b 348 18 347 16 348 16 b 344 20 348 18 347 19 b 239 113 307 41 266 79 "},v2f:{x_min:-1.359375,x_max:680.5625,ha:694,o:"m 597 1042 b 604 1042 600 1042 602 1042 b 642 1002 627 1042 642 1022 b 619 966 642 988 635 974 b 439 927 574 942 503 927 l 426 927 l 426 921 b 430 838 428 893 430 866 b 345 480 430 696 398 560 b 179 391 307 423 249 391 b 156 392 171 391 164 392 b 138 394 149 394 142 394 b 103 434 115 396 103 416 b 129 471 103 451 111 466 b 141 474 133 473 137 474 b 172 459 153 474 164 469 b 181 455 175 456 176 455 b 187 456 182 455 185 455 b 253 520 212 460 234 483 b 315 836 294 605 315 714 b 311 928 315 867 314 898 b 302 945 310 943 311 942 b 245 953 283 950 262 953 b 130 891 193 953 149 931 b 84 860 119 870 102 860 b 36 905 61 860 39 877 b 36 910 36 907 36 909 b 80 970 36 931 50 949 b 249 1017 125 1000 187 1017 b 322 1009 273 1017 299 1014 l 341 1003 b 436 991 372 995 406 991 b 577 1031 495 991 545 1004 b 597 1042 583 1038 590 1041 m 416 360 b 424 360 419 360 421 360 b 481 309 454 360 479 338 b 503 145 484 280 495 199 b 585 -185 525 16 555 -106 b 630 -245 596 -213 613 -237 l 634 -247 l 638 -245 b 647 -244 641 -245 645 -244 b 680 -278 666 -244 680 -262 b 664 -308 680 -290 675 -301 b 638 -312 658 -310 650 -312 b 613 -309 631 -312 623 -310 b 477 -201 555 -303 502 -260 b 417 -2 460 -159 434 -72 b 416 5 417 1 416 5 b 416 5 416 5 416 5 b 411 -5 415 5 413 0 b 359 -97 397 -33 377 -70 b 353 -106 355 -102 353 -105 b 359 -112 353 -108 355 -109 b 409 -130 375 -123 390 -129 b 426 -134 420 -130 421 -131 b 431 -147 428 -137 431 -141 b 420 -162 431 -152 427 -159 b 382 -169 409 -166 396 -169 b 323 -155 363 -169 341 -165 l 317 -152 l 314 -155 b 62 -303 240 -240 148 -295 b 36 -305 55 -305 44 -305 b 23 -303 29 -305 24 -305 b -1 -273 6 -299 -1 -287 b 31 -240 -1 -256 10 -240 b 36 -240 32 -240 34 -240 b 42 -241 38 -241 39 -241 b 134 -204 63 -241 99 -226 b 367 288 265 -115 357 81 b 375 330 368 313 370 320 b 416 360 383 347 400 358 m 360 -359 b 379 -359 363 -359 371 -359 b 424 -360 396 -359 416 -359 b 646 -502 536 -373 624 -430 b 649 -527 649 -510 649 -519 b 530 -673 649 -578 604 -635 l 521 -677 l 529 -681 b 653 -811 592 -714 637 -762 b 660 -853 658 -827 660 -839 b 645 -911 660 -873 656 -892 b 426 -1021 608 -981 519 -1021 b 283 -989 377 -1021 328 -1011 b 235 -949 249 -972 239 -964 b 234 -936 234 -946 234 -941 b 234 -928 234 -934 234 -931 l 235 -925 l 234 -927 l 225 -934 b 87 -982 186 -966 138 -982 b 80 -982 85 -982 83 -982 b 55 -981 70 -981 58 -981 b 17 -943 32 -981 17 -964 b 54 -904 17 -921 35 -904 b 78 -914 62 -904 72 -909 l 83 -918 l 88 -918 b 190 -831 122 -918 166 -881 b 269 -506 242 -727 269 -612 b 268 -462 269 -492 269 -477 b 266 -449 266 -458 266 -452 b 265 -444 266 -445 266 -444 b 257 -446 264 -444 261 -445 b 132 -545 196 -470 152 -505 b 88 -573 122 -563 104 -573 b 39 -523 63 -573 39 -553 b 63 -476 39 -505 44 -494 b 360 -359 136 -408 235 -369 m 419 -424 b 393 -423 411 -423 406 -423 l 375 -423 l 377 -426 b 379 -439 377 -427 378 -434 b 383 -510 382 -463 383 -487 b 314 -811 383 -609 360 -710 b 266 -893 296 -850 285 -870 b 264 -898 265 -896 264 -898 l 264 -898 b 264 -898 264 -898 264 -898 b 268 -898 264 -898 266 -898 b 273 -898 270 -898 272 -898 b 300 -909 283 -898 291 -900 b 426 -957 340 -941 385 -957 b 476 -949 443 -957 460 -954 b 547 -853 522 -931 547 -893 b 485 -745 547 -816 526 -775 b 397 -707 460 -727 432 -714 b 366 -675 375 -703 366 -692 b 396 -642 366 -657 377 -645 b 530 -557 455 -637 511 -601 b 536 -527 534 -548 536 -537 b 419 -424 536 -480 490 -437 "},v30:{x_min:-21.78125,x_max:367.5,ha:375,o:"m 276 1900 b 284 1901 279 1900 281 1901 b 306 1883 291 1901 298 1896 b 367 1686 347 1825 367 1757 b 343 1558 367 1643 359 1600 l 338 1549 l 343 1537 b 367 1411 359 1497 367 1454 b 343 1282 367 1367 359 1324 l 338 1272 l 343 1261 b 367 1135 359 1221 367 1178 b 343 1007 367 1090 359 1047 l 338 996 l 343 985 b 367 859 359 945 367 902 b 343 731 367 814 359 771 l 338 720 l 343 709 b 367 582 359 667 367 626 b 289 362 367 503 340 426 b 239 312 276 345 259 330 b 29 77 152 237 76 152 b -1 18 14 54 2 30 b -19 4 -4 11 -12 4 l -21 4 l -21 133 l -20 260 l -13 262 b 98 299 17 269 62 284 b 111 305 103 302 110 305 b 167 334 123 310 156 327 b 319 595 264 391 319 491 b 313 659 319 616 318 638 b 310 667 311 664 311 667 b 307 663 310 667 308 666 b 240 588 289 637 269 614 b 16 331 141 505 62 413 b -1 294 8 316 1 302 b -19 280 -4 287 -12 280 l -21 280 l -21 408 l -20 537 l -13 538 b 98 576 17 545 62 560 b 111 581 103 578 110 581 b 167 610 123 587 156 603 b 319 871 264 667 319 767 b 313 935 319 892 318 913 b 310 942 311 941 311 942 b 307 939 310 942 308 941 b 240 864 289 913 269 889 b 16 607 141 781 62 689 b -1 570 8 592 1 578 b -19 556 -4 563 -12 556 l -21 556 l -21 684 l -20 813 l -13 814 b 98 852 17 821 62 836 b 111 857 103 855 110 857 b 167 886 123 863 156 880 b 319 1147 264 943 319 1043 b 313 1211 319 1168 318 1189 b 310 1218 311 1217 311 1218 b 307 1215 310 1218 308 1217 b 240 1140 289 1188 269 1165 b 16 884 141 1057 62 966 b -1 846 8 868 1 855 b -19 832 -4 839 -12 832 l -21 832 l -21 960 l -20 1089 l -13 1090 b 98 1128 17 1097 62 1111 b 111 1134 103 1131 110 1134 b 167 1163 123 1139 156 1156 b 319 1424 264 1220 319 1320 b 313 1486 319 1444 318 1465 b 310 1494 311 1493 311 1494 b 307 1492 310 1494 308 1493 b 240 1417 289 1464 269 1442 b 16 1160 141 1333 62 1242 b -1 1121 8 1145 1 1131 b -19 1109 -4 1115 -12 1109 l -21 1109 l -21 1236 l -20 1365 l -13 1367 b 98 1404 17 1374 62 1388 b 111 1410 103 1407 110 1410 b 250 1508 172 1437 215 1467 b 319 1701 296 1564 319 1633 b 270 1859 319 1757 303 1814 b 262 1882 265 1868 262 1875 b 276 1900 262 1890 266 1896 "},v31:{x_min:0,x_max:386.5625,ha:394,o:"m 0 173 l 0 347 l 193 347 l 386 347 l 386 173 l 386 0 l 193 0 l 0 0 l 0 173 "},v33:{x_min:-423.3125,x_max:421.9375,ha:431,o:"m -10 276 b -2 277 -8 277 -5 277 b 17 265 5 277 13 273 b 19 163 19 260 19 260 l 19 68 l 39 45 b 277 -95 122 -34 200 -81 b 289 -97 281 -97 285 -97 b 378 0 332 -97 371 -54 b 378 11 378 4 378 6 b 302 83 378 55 345 83 b 242 66 283 83 262 77 b 208 56 231 59 219 56 b 148 120 175 56 148 81 b 200 186 148 151 164 172 b 261 198 220 194 240 198 b 420 45 341 198 411 137 b 421 22 421 37 421 29 b 257 -198 421 -86 347 -188 b 242 -198 251 -198 247 -198 b 20 -105 181 -198 95 -163 l 19 -104 l 19 -183 b 19 -216 19 -195 19 -206 b 12 -273 19 -272 17 -267 b -2 -278 8 -277 2 -278 b -21 -266 -10 -278 -19 -274 b -23 -165 -23 -263 -23 -262 l -23 -69 l -44 -47 b -250 86 -117 23 -183 66 b -295 94 -270 93 -284 94 b -315 91 -302 94 -308 94 b -381 5 -356 81 -381 43 b -355 -56 -381 -16 -372 -40 b -299 -81 -338 -73 -319 -81 b -246 -68 -283 -81 -265 -77 b -212 -58 -234 -61 -223 -58 b -168 -77 -196 -58 -179 -65 b -151 -122 -156 -90 -151 -105 b -179 -174 -151 -141 -160 -162 b -239 -195 -194 -184 -217 -192 b -257 -197 -245 -195 -250 -197 b -423 -5 -349 -197 -423 -113 b -423 0 -423 -4 -423 -1 b -277 194 -420 97 -362 173 b -247 197 -268 197 -258 197 b -24 104 -185 197 -100 162 l -23 102 l -23 181 b -21 265 -23 260 -23 260 b -10 276 -20 269 -14 274 "},v34:{x_min:0,x_max:622.03125,ha:635,o:"m 398 417 b 406 419 401 419 404 419 b 427 398 417 419 427 409 b 427 391 427 395 427 392 b 34 -274 424 385 38 -272 b 20 -280 29 -278 25 -280 b 0 -259 9 -280 0 -270 b 0 -252 0 -256 0 -254 b 393 413 2 -247 389 410 b 398 417 394 415 397 416 m 592 417 b 600 419 594 419 597 419 b 622 398 611 419 622 409 b 620 391 622 395 620 392 b 227 -274 617 385 231 -272 b 213 -280 223 -278 219 -280 b 193 -259 202 -280 193 -270 b 194 -252 193 -256 193 -254 b 586 413 196 -247 582 410 b 592 417 588 415 590 416 "},v36:{x_min:-1.359375,x_max:1064.390625,ha:1086,o:"m 296 692 b 314 694 302 694 307 694 b 386 685 337 694 366 689 b 548 498 480 660 548 580 b 548 481 548 492 548 487 b 455 395 541 426 499 395 b 370 462 420 395 383 417 b 362 496 364 477 362 488 b 377 514 362 509 367 514 b 393 501 386 514 390 510 b 432 474 397 484 413 474 b 470 487 445 474 458 478 b 491 530 484 496 491 510 b 490 544 491 534 491 539 b 333 660 479 606 411 657 l 323 662 l 315 646 b 269 524 285 591 269 556 b 321 431 269 492 287 466 b 349 395 338 413 343 408 b 363 342 359 378 363 362 b 359 312 363 333 362 322 b 285 158 348 266 318 206 b 281 152 283 155 281 152 b 281 152 281 152 281 152 b 287 154 283 152 284 152 b 318 155 298 154 308 155 b 461 98 371 155 419 136 l 464 97 l 483 112 b 503 129 494 120 503 127 b 504 130 503 129 504 129 b 503 138 504 131 503 134 b 500 180 500 152 500 166 b 553 326 500 238 518 288 b 604 366 560 331 592 358 b 649 381 617 376 632 381 b 696 362 665 381 681 374 b 724 302 714 347 724 324 b 695 238 724 278 714 255 b 660 210 691 234 662 212 b 579 148 658 209 582 151 b 579 148 579 148 579 148 b 596 106 579 144 589 119 b 622 77 604 88 609 83 b 657 69 632 72 645 69 b 748 112 688 69 721 84 b 755 123 754 117 755 120 b 755 127 755 124 755 126 b 751 165 752 137 751 151 b 758 219 751 183 754 202 b 894 387 774 290 820 347 b 896 390 896 388 896 388 b 891 398 896 391 895 392 b 622 560 827 477 730 535 b 600 580 605 564 600 569 b 617 596 600 591 607 596 b 628 595 622 596 624 596 b 1057 248 846 552 1020 412 b 1064 191 1061 229 1064 209 b 922 0 1064 94 1005 9 b 902 -1 916 -1 909 -1 b 774 76 847 -1 800 26 b 769 83 770 81 770 83 b 769 81 769 83 769 83 b 627 -1 733 29 677 -1 b 548 27 597 -1 570 8 b 515 88 537 37 525 61 l 513 95 l 510 93 l 453 45 b 390 0 396 0 396 0 b 390 0 390 0 390 0 b 374 15 381 0 377 4 b 268 105 359 69 314 105 b 250 104 262 105 257 105 l 243 102 l 234 90 b 155 1 201 49 159 2 b 147 -1 152 0 149 -1 b 130 15 138 -1 130 6 b 132 20 130 18 132 19 b 136 31 133 22 134 27 b 220 131 149 74 178 109 b 231 137 225 134 230 136 b 302 278 280 202 302 244 b 265 335 302 299 295 309 b 209 442 234 363 213 402 b 209 455 209 446 209 451 b 279 648 209 502 232 564 l 285 659 l 283 659 b 176 627 238 653 210 645 b 57 477 111 594 66 538 b 55 459 55 471 55 464 b 72 409 55 437 61 415 b 93 403 78 405 87 403 b 152 467 123 403 151 431 b 168 488 153 483 157 488 b 185 462 181 488 185 483 l 185 460 b 137 344 183 409 168 369 b 78 322 119 328 98 322 b 13 360 50 322 25 335 b -1 426 4 380 -1 402 b 89 610 -1 488 32 559 b 296 692 147 659 210 685 m 926 348 b 921 353 924 351 922 353 b 914 348 920 353 918 351 b 823 167 857 306 823 237 b 828 124 823 154 826 138 b 890 31 837 79 862 40 b 896 31 892 31 894 31 b 956 104 916 31 940 59 b 970 191 965 129 970 159 b 966 241 970 208 969 224 b 926 348 959 277 945 313 m 627 326 b 619 326 624 326 622 326 b 598 316 611 326 604 323 b 568 215 579 288 568 255 b 568 208 568 213 568 210 b 571 183 570 195 570 184 l 571 183 b 594 201 571 183 582 191 l 634 231 b 660 259 653 247 656 248 b 664 278 662 266 664 272 b 627 326 664 299 649 320 "},v38:{x_min:-1.359375,x_max:651.96875,ha:665,o:"m 389 644 b 405 645 394 645 400 645 b 504 566 450 645 492 613 b 507 541 506 557 507 549 b 480 471 507 514 498 489 l 477 467 l 483 470 b 609 591 539 485 586 531 b 613 601 611 595 613 599 b 631 609 619 607 624 609 b 651 588 641 609 651 602 b 200 -946 651 584 204 -941 b 182 -957 197 -953 190 -957 b 163 -945 174 -957 166 -953 b 161 -939 161 -942 161 -942 b 217 -743 161 -931 170 -904 b 272 -555 247 -639 272 -555 b 272 -555 272 -555 272 -555 b 264 -560 272 -555 268 -557 b 140 -603 227 -589 182 -603 b 36 -567 102 -603 65 -592 b -1 -487 12 -548 -1 -517 b 17 -427 -1 -466 5 -445 b 103 -380 38 -395 70 -380 b 191 -433 137 -380 172 -398 b 205 -484 201 -448 205 -466 b 178 -553 205 -509 196 -535 l 175 -557 l 182 -555 b 307 -435 236 -539 284 -494 b 372 -213 308 -430 372 -215 b 372 -213 372 -213 372 -213 b 364 -219 372 -213 368 -216 b 240 -262 328 -247 283 -262 b 137 -226 202 -262 166 -249 b 99 -145 112 -206 99 -176 b 118 -84 99 -124 106 -104 b 204 -38 138 -54 171 -38 b 292 -91 238 -38 273 -56 b 306 -141 302 -106 306 -124 b 279 -212 306 -167 296 -194 l 276 -215 l 281 -213 b 408 -93 336 -198 385 -151 b 473 129 409 -88 473 127 b 473 129 473 129 473 129 b 465 122 473 129 469 126 b 341 80 428 94 383 80 b 236 115 303 80 266 91 b 200 195 213 136 200 165 b 217 256 200 217 206 238 b 304 303 239 287 272 303 b 393 249 338 303 374 285 b 406 199 402 234 406 217 b 379 129 406 173 397 148 l 377 126 l 382 127 b 509 248 436 142 485 190 b 574 470 510 254 574 469 b 574 470 574 470 574 470 b 566 464 574 470 570 467 b 442 421 529 435 484 421 b 337 458 404 421 367 433 b 300 537 313 478 300 508 b 389 644 300 585 334 635 "},v39:{x_min:-171.5,x_max:251.8125,ha:257,o:"m -8 631 b -1 632 -6 632 -4 632 b 19 620 8 632 16 628 b 20 553 20 616 20 614 b 20 491 20 503 20 491 l 20 491 b 153 535 47 501 149 535 b 174 514 167 535 174 524 b 164 496 174 508 171 501 b 92 470 164 495 132 484 l 20 445 l 20 390 b 20 363 20 378 20 370 b 20 333 20 340 20 333 l 20 333 b 153 377 47 344 149 377 b 174 356 167 377 174 367 b 164 338 174 349 171 342 b 92 312 164 338 132 326 l 20 288 l 20 219 l 20 148 l 21 151 b 137 199 59 183 99 199 b 182 191 152 199 167 197 b 251 84 227 176 251 134 b 228 0 251 58 243 29 b 100 -142 206 -40 178 -72 l 23 -215 b -1 -229 9 -229 6 -229 b -20 -216 -9 -229 -17 -224 b -21 30 -21 -212 -21 -212 b -21 273 -21 163 -21 273 b -84 252 -21 273 -50 263 b -152 230 -133 234 -145 230 b -157 231 -155 230 -156 231 b -171 252 -166 234 -171 244 b -160 270 -171 259 -167 266 b -27 316 -159 270 -93 294 l -21 319 l -21 374 b -21 431 -21 406 -21 431 b -84 409 -21 431 -50 421 b -152 388 -133 392 -145 388 b -157 390 -155 388 -156 388 b -171 409 -166 392 -171 401 b -160 428 -171 417 -167 424 b -27 474 -159 428 -93 451 l -21 476 l -21 546 b -20 620 -21 614 -21 616 b -8 631 -17 624 -13 630 m 110 131 b 96 133 106 133 100 133 b 89 133 93 133 91 133 b 24 87 63 129 40 113 l 20 80 l 20 -37 l 20 -156 l 23 -152 b 144 81 96 -72 144 20 l 144 83 b 110 131 144 113 134 126 "},v3b:{x_min:0,x_max:484.5625,ha:494,o:"m 228 245 b 239 247 234 247 239 247 b 243 247 240 247 242 247 b 303 238 257 247 287 242 b 484 -2 417 208 484 104 b 412 -177 484 -65 461 -127 b 243 -248 363 -226 303 -248 b 6 -63 138 -248 36 -180 b 0 -1 1 -41 0 -20 b 228 245 0 127 98 240 m 255 181 b 240 183 247 183 245 183 b 232 181 238 183 235 183 b 142 152 200 180 168 170 l 138 149 l 190 97 l 242 44 l 294 97 l 345 149 l 340 152 b 255 181 315 169 284 180 m 147 -54 l 197 -1 l 147 51 l 95 104 l 91 99 b 62 -1 72 70 62 34 b 66 -43 62 -15 63 -29 b 91 -101 72 -63 80 -84 l 95 -106 l 147 -54 m 393 99 b 389 104 390 102 389 104 b 337 51 389 104 366 80 l 285 -1 l 337 -54 l 389 -106 l 393 -101 b 421 -1 412 -72 421 -36 b 393 99 421 34 412 69 m 294 -98 b 242 -45 265 -69 242 -45 b 190 -98 242 -45 219 -69 l 138 -151 l 142 -154 b 242 -184 172 -174 206 -184 b 340 -154 276 -184 311 -174 l 345 -151 l 294 -98 "},v3c:{x_min:0,x_max:450.53125,ha:460,o:"m 189 302 b 204 303 193 302 198 303 b 303 224 250 303 292 270 b 306 199 304 216 306 208 b 279 129 306 173 296 147 l 276 126 l 281 127 b 408 249 337 142 385 190 b 412 259 409 254 412 258 b 430 267 417 265 423 267 b 450 247 441 267 450 259 b 200 -605 450 242 204 -599 b 182 -616 197 -612 190 -616 b 163 -602 174 -616 166 -610 b 161 -598 161 -601 161 -601 b 217 -402 161 -589 170 -562 b 272 -213 247 -298 272 -213 b 272 -213 272 -213 272 -213 b 264 -219 272 -213 268 -216 b 140 -262 227 -247 182 -262 b 36 -226 102 -262 65 -249 b 0 -145 12 -206 0 -176 b 17 -84 0 -124 5 -104 b 103 -38 38 -54 70 -38 b 191 -91 137 -38 172 -56 b 205 -141 201 -106 205 -124 b 178 -212 205 -167 196 -194 l 175 -215 l 182 -213 b 307 -93 236 -198 284 -151 b 372 129 308 -88 372 127 b 372 129 372 129 372 129 b 364 122 372 129 368 126 b 240 80 328 94 283 80 b 137 115 202 80 166 91 b 99 194 111 136 99 165 b 189 302 99 244 133 292 "},v3e:{x_min:0,x_max:406.96875,ha:415,o:"m 21 183 b 28 183 24 183 25 183 b 42 181 34 183 39 183 b 127 108 47 179 47 179 b 202 41 168 72 202 41 b 279 108 204 41 238 72 b 357 177 321 145 356 176 b 375 183 363 181 370 183 b 406 151 392 183 406 169 b 404 137 406 147 405 141 b 322 62 401 131 398 129 b 251 0 284 27 251 0 b 322 -63 251 -1 284 -29 b 404 -138 398 -130 401 -133 b 406 -152 405 -142 406 -148 b 375 -184 406 -170 392 -184 b 357 -179 370 -184 363 -183 b 279 -109 356 -177 321 -147 b 202 -43 238 -73 204 -43 b 127 -109 202 -43 168 -73 b 49 -179 85 -147 50 -177 b 31 -184 43 -183 36 -184 b 0 -152 13 -184 0 -170 b 2 -138 0 -148 0 -142 b 83 -63 5 -133 8 -130 b 155 0 122 -29 155 -1 b 83 62 155 0 122 27 b 8 129 43 97 10 127 b 0 151 2 136 0 144 b 21 183 0 165 8 177 "},v3f:{x_min:-24.5,x_max:317.140625,ha:324,o:"m -24 -147 l -24 -5 l -20 -5 b -1 -19 -12 -5 -4 -11 b 58 -123 6 -43 31 -86 b 196 -278 93 -173 134 -219 b 317 -570 274 -356 317 -460 b 294 -713 317 -617 308 -666 l 289 -724 l 294 -735 b 317 -873 308 -780 317 -827 b 235 -1132 317 -963 288 -1054 b 209 -1165 228 -1140 224 -1146 b 189 -1177 204 -1172 196 -1177 b 171 -1164 182 -1177 175 -1172 b 168 -1154 170 -1161 168 -1159 b 181 -1132 168 -1149 172 -1142 b 269 -891 238 -1064 269 -975 b 269 -881 269 -886 269 -884 b 262 -814 269 -857 265 -827 b 258 -800 261 -811 259 -806 b 142 -628 240 -731 198 -667 b -8 -589 112 -606 47 -589 b -20 -589 -13 -589 -19 -589 l -24 -589 l -24 -449 l -24 -308 l -20 -308 b -1 -322 -12 -308 -4 -313 b 58 -424 6 -345 31 -388 b 194 -580 93 -476 136 -523 b 259 -660 221 -606 245 -635 b 261 -663 259 -662 261 -663 b 264 -656 262 -663 262 -660 b 269 -587 268 -632 269 -610 b 264 -521 269 -566 268 -544 b 262 -512 264 -517 262 -513 b 258 -498 261 -509 259 -503 b 142 -326 240 -428 198 -365 b -8 -287 112 -303 47 -288 b -20 -287 -13 -287 -19 -287 l -24 -287 l -24 -147 "},v40:{x_min:-1.359375,x_max:436.921875,ha:446,o:"m 213 205 b 217 205 215 205 216 205 b 234 194 224 205 234 199 b 236 187 234 194 235 190 l 245 167 l 261 129 l 270 106 b 355 -61 294 54 329 -13 b 420 -163 381 -105 402 -138 b 436 -188 435 -184 436 -184 b 436 -191 436 -190 436 -190 b 421 -206 436 -201 431 -206 l 421 -206 l 416 -206 l 405 -201 b 217 -158 347 -172 283 -158 b 31 -201 153 -158 88 -172 l 20 -206 l 14 -206 l 14 -206 b 0 -191 5 -206 0 -201 b -1 -188 0 -190 -1 -190 b 14 -163 -1 -186 0 -184 b 95 -34 36 -136 72 -77 b 166 106 119 8 148 68 l 175 129 l 183 148 l 200 188 b 213 205 205 199 208 202 "},v41:{x_min:-1.359375,x_max:556.6875,ha:568,o:"m 294 322 b 318 323 299 322 308 323 b 360 320 334 323 352 322 b 526 217 430 310 490 273 b 543 166 537 202 543 184 b 447 70 543 117 503 70 b 445 70 447 70 446 70 b 359 159 394 72 359 113 b 368 201 359 173 362 187 b 442 245 382 229 412 245 b 455 244 446 245 451 245 b 460 244 458 244 460 244 b 460 244 460 244 460 244 b 454 248 460 244 458 245 b 325 291 417 276 372 291 b 285 287 313 291 299 290 b 144 -2 183 269 144 190 b 281 -290 144 -208 179 -280 b 304 -291 289 -291 298 -291 b 524 -105 412 -291 506 -212 b 541 -84 526 -88 530 -84 b 556 -101 551 -84 556 -90 b 549 -138 556 -111 553 -122 b 334 -322 521 -237 435 -310 b 302 -324 323 -323 313 -324 b 13 -101 172 -324 54 -234 b -1 -1 4 -68 -1 -34 b 294 322 -1 161 121 303 "},v42:{x_min:-348.4375,x_max:24.5,ha:25,o:"m -330 155 b -322 156 -329 156 -326 156 b -315 156 -319 156 -317 156 b -298 147 -311 155 -308 154 b -19 30 -224 98 -122 55 l 2 26 b 24 -1 17 22 24 13 b 2 -27 24 -15 17 -23 l -19 -31 b -298 -148 -122 -56 -224 -99 b -322 -158 -313 -158 -315 -158 b -348 -131 -338 -158 -348 -145 b -344 -117 -348 -127 -347 -122 b -328 -104 -341 -112 -338 -111 b -127 -8 -269 -65 -202 -33 b -106 0 -115 -4 -106 -1 b -127 6 -106 0 -115 2 b -328 102 -202 31 -269 63 b -344 116 -338 109 -341 111 b -348 130 -347 120 -348 124 b -330 155 -348 141 -341 152 "},v43:{x_min:-442.359375,x_max:441,ha:450,o:"m -31 487 b -1 488 -21 488 -10 488 b 434 104 216 488 397 330 b 441 27 438 79 441 47 b 439 12 441 20 439 15 b 419 0 435 4 427 0 b 404 5 413 0 408 1 b 398 30 400 11 398 13 b 0 351 390 213 213 351 b -59 348 -20 351 -39 349 b -400 30 -251 324 -393 191 b -405 5 -400 13 -401 11 b -420 0 -409 1 -415 0 b -441 12 -428 0 -436 4 b -442 27 -441 15 -442 20 b -435 104 -442 47 -439 79 b -31 487 -401 316 -235 474 m -13 131 b -1 133 -9 133 -5 133 b 51 105 19 133 39 123 b 61 70 58 95 61 83 b 51 34 61 58 58 45 b -1 6 39 16 19 6 b -46 27 -17 6 -34 13 b -62 69 -57 38 -62 54 b -13 131 -62 98 -44 124 "},v44:{x_min:-21.78125,x_max:251.8125,ha:257,o:"m -8 631 b -1 632 -6 632 -4 632 b 19 620 8 632 16 628 b 20 383 20 616 20 616 l 20 148 l 21 151 b 137 199 59 183 99 199 b 182 191 152 199 167 197 b 251 84 227 176 251 134 b 228 0 251 58 243 29 b 100 -142 206 -40 178 -72 l 23 -215 b 0 -229 9 -229 6 -229 b -20 -216 -9 -229 -17 -224 l -21 -212 l -21 201 l -21 616 l -20 620 b -8 631 -17 624 -13 630 m 110 131 b 96 133 106 133 100 133 b 89 133 93 133 91 133 b 24 87 63 129 40 113 l 20 80 l 20 -37 l 20 -156 l 23 -152 b 144 81 96 -72 144 20 l 144 83 b 110 131 144 113 134 126 "},v45:{x_min:-402.890625,x_max:401.53125,ha:410,o:"m -10 273 b -4 274 -9 273 -6 274 b 16 262 4 274 12 269 b 17 158 17 259 17 259 l 17 56 l 62 112 b 117 174 110 172 110 172 b 122 174 118 174 119 174 b 132 173 125 174 129 173 b 295 11 134 172 171 134 l 307 -1 l 336 34 b 374 76 366 72 368 74 b 381 77 375 77 378 77 b 401 56 392 77 401 68 b 400 48 401 54 401 51 b 223 -172 397 41 230 -166 b 210 -176 220 -174 215 -176 b 201 -174 206 -176 204 -176 b 112 -87 198 -173 178 -152 b 27 0 65 -38 27 0 b 21 -6 27 0 24 -2 l 17 -12 l 17 -147 b 17 -210 17 -173 17 -194 b 10 -292 17 -297 16 -287 b -2 -299 6 -297 2 -299 b -21 -287 -10 -299 -19 -295 b -24 -174 -23 -284 -23 -284 l -24 -63 l -66 -117 b -121 -176 -110 -170 -114 -176 b -125 -176 -122 -176 -123 -176 b -296 -12 -134 -174 -125 -184 l -308 0 l -337 -34 b -375 -77 -367 -73 -370 -76 b -382 -79 -377 -79 -379 -79 b -402 -58 -393 -79 -402 -69 b -401 -49 -402 -55 -402 -52 b -224 170 -398 -43 -231 165 b -212 174 -221 173 -216 174 b -202 173 -208 174 -205 174 b -39 11 -200 172 -151 122 l -28 -1 l -25 1 l -24 4 l -24 130 b -23 260 -24 256 -24 258 b -10 273 -20 266 -16 270 "},v46:{x_min:0,x_max:627.46875,ha:640,o:"m 306 190 b 314 191 308 191 311 191 b 326 184 318 191 322 190 l 336 173 b 510 52 377 127 442 80 b 515 49 513 51 515 49 b 611 16 537 40 579 24 b 627 0 624 13 627 9 b 607 -18 627 -11 624 -13 b 330 -181 490 -49 389 -109 b 314 -192 323 -190 319 -192 b 306 -191 311 -192 308 -192 b 294 -177 302 -188 302 -188 b 257 -140 287 -170 265 -148 b 19 -18 193 -84 114 -44 b 0 0 2 -13 0 -11 b 16 16 0 9 2 13 b 110 49 47 24 89 40 b 117 52 111 49 114 51 b 145 65 126 56 130 58 b 281 163 200 93 245 124 b 300 186 288 170 291 174 b 306 190 300 187 303 188 m 317 137 b 313 142 315 141 314 142 b 308 137 313 142 311 141 b 161 4 276 84 220 33 b 155 0 159 1 155 0 b 163 -4 155 0 159 -2 b 308 -138 220 -34 276 -84 b 313 -142 311 -141 313 -142 b 317 -138 314 -142 315 -141 b 464 -4 351 -84 406 -34 b 470 0 468 -2 470 0 b 464 4 470 0 468 1 b 317 137 406 33 351 84 "},v47:{x_min:-24.5,x_max:315.78125,ha:322,o:"m -24 -145 l -24 -5 l -20 -5 b 1 -26 -10 -5 -6 -9 b 175 -241 31 -86 96 -166 b 314 -548 259 -323 304 -420 b 315 -589 315 -555 315 -571 b 314 -630 315 -606 315 -623 b 298 -730 311 -664 306 -699 l 295 -742 l 296 -748 b 314 -850 304 -778 311 -813 b 315 -892 315 -857 315 -874 b 314 -932 315 -909 315 -925 b 298 -1032 311 -967 306 -1002 l 295 -1045 l 296 -1050 b 314 -1153 304 -1081 311 -1115 b 315 -1193 315 -1160 315 -1177 b 314 -1235 315 -1211 315 -1228 b 217 -1526 306 -1338 270 -1444 b 201 -1533 213 -1532 208 -1533 b 182 -1522 193 -1533 185 -1529 b 179 -1514 181 -1518 179 -1517 b 189 -1489 179 -1508 182 -1501 b 266 -1217 240 -1403 266 -1308 b 262 -1156 266 -1196 265 -1177 b 110 -907 247 -1043 190 -950 b 0 -889 87 -895 50 -889 l -1 -889 l -24 -889 l -24 -749 l -24 -610 l -20 -610 b 1 -631 -10 -610 -6 -614 b 175 -846 31 -691 96 -771 b 259 -956 213 -884 236 -914 b 265 -966 262 -961 264 -966 b 265 -966 265 -966 265 -966 b 265 -953 265 -964 265 -959 b 266 -920 266 -943 266 -932 b 262 -853 266 -898 265 -873 b 110 -605 247 -741 190 -648 b 0 -587 87 -592 50 -587 l -1 -587 l -24 -587 l -24 -448 l -24 -308 l -20 -308 b 1 -328 -10 -308 -6 -312 b 175 -544 31 -388 96 -469 b 259 -655 213 -581 236 -612 b 265 -663 262 -659 264 -663 b 265 -663 265 -663 265 -663 b 265 -650 265 -663 265 -657 b 266 -617 266 -641 266 -630 b 262 -551 266 -595 265 -570 b 110 -303 247 -438 190 -345 b 0 -284 87 -290 50 -284 l -1 -284 l -24 -284 l -24 -145 "},v49:{x_min:0,x_max:630.203125,ha:643,o:"m 308 204 b 314 205 310 205 313 205 b 326 201 319 205 323 204 b 355 154 328 199 338 180 b 401 83 362 142 392 95 l 409 72 b 431 41 412 66 424 49 b 619 -174 498 -51 570 -134 b 630 -192 626 -180 630 -186 b 626 -202 630 -195 628 -199 b 616 -206 623 -205 620 -206 b 552 -188 608 -206 592 -202 b 310 -155 488 -169 392 -155 b 268 -156 295 -155 281 -155 b 77 -188 197 -161 126 -173 b 13 -206 35 -202 20 -206 b 9 -206 12 -206 10 -206 b 0 -191 2 -202 0 -197 b 8 -176 0 -186 2 -180 b 204 49 58 -136 138 -43 l 220 72 l 227 83 b 295 188 245 108 281 166 b 308 204 299 197 304 202 m 315 147 b 314 147 315 147 314 147 b 314 147 314 147 314 147 b 306 129 314 145 310 138 l 296 105 b 281 72 292 97 284 77 l 274 56 b 181 -123 247 -4 212 -72 l 174 -134 l 176 -133 b 314 -123 215 -127 272 -123 b 451 -133 356 -123 413 -127 l 454 -134 l 449 -123 b 353 56 417 -72 381 -4 l 347 72 b 332 105 344 77 336 97 l 322 129 b 315 147 318 138 315 145 "},v4a:{x_min:70.78125,x_max:378.390625,ha:315,o:"m 246 373 b 254 373 249 373 251 373 b 372 324 303 373 360 351 b 378 302 377 317 378 309 b 338 251 378 278 362 255 b 328 249 334 249 332 249 b 283 294 303 249 283 270 b 288 315 283 301 284 308 b 289 319 289 317 289 319 b 289 319 289 319 289 319 b 283 320 289 320 287 320 b 270 322 279 322 274 322 b 206 288 242 322 215 308 b 206 283 206 287 206 285 b 257 223 206 267 230 238 b 284 206 272 213 277 210 b 351 90 328 173 351 130 b 340 47 351 74 348 59 b 205 -30 314 -2 264 -30 b 182 -29 198 -30 190 -30 b 84 15 147 -24 103 -5 b 70 48 74 24 70 36 b 108 99 70 70 85 94 b 121 102 112 101 117 102 b 167 56 147 102 167 80 b 159 31 167 48 164 40 l 156 26 l 157 26 b 190 20 167 22 178 20 b 220 26 201 20 212 22 b 258 65 243 34 258 51 b 257 70 258 66 258 69 b 204 126 249 94 234 109 b 114 258 148 158 114 209 b 125 302 114 273 118 288 b 246 373 147 342 193 370 "},v4b:{x_min:0,x_max:503.609375,ha:514,o:"m 274 430 b 277 430 276 430 277 430 b 310 394 296 430 310 415 b 308 383 310 391 308 387 b 306 367 307 381 307 374 b 236 120 298 305 272 210 b 40 -273 189 -5 125 -134 b 20 -287 35 -283 27 -287 b 5 -281 14 -287 9 -285 b 0 -267 1 -277 0 -273 b 9 -242 0 -262 2 -255 b 246 395 137 -12 232 242 b 274 430 249 416 257 427 m 468 430 b 472 430 469 430 470 430 b 503 394 490 430 503 415 b 502 383 503 391 503 387 b 499 367 502 381 500 374 b 431 120 491 305 465 210 b 234 -273 382 -5 318 -134 b 213 -287 228 -283 220 -287 b 198 -281 208 -287 202 -285 b 193 -267 194 -277 193 -273 b 202 -242 193 -262 196 -255 b 439 395 330 -12 426 242 b 468 430 442 416 451 427 "},v4d:{x_min:-311.6875,x_max:310.328125,ha:317,o:"m -9 388 b -2 390 -8 390 -5 390 b 5 388 1 390 4 390 b 19 378 10 387 16 383 b 23 333 23 371 23 371 b 24 298 23 299 24 298 b 81 276 34 298 65 285 b 213 91 145 240 190 177 b 224 24 217 76 224 36 b 257 24 224 24 235 24 b 299 19 292 24 292 24 b 310 -1 306 15 310 6 b 299 -23 310 -11 306 -19 b 257 -27 292 -27 292 -27 b 224 -29 235 -27 224 -29 b 213 -95 224 -40 217 -80 b 81 -280 190 -181 145 -244 b 24 -301 65 -290 34 -301 b 23 -335 24 -301 23 -303 l 23 -340 b 17 -381 23 -374 23 -374 b -1 -391 13 -388 5 -391 b -21 -381 -9 -391 -17 -388 b -27 -340 -27 -374 -27 -374 l -27 -335 b -28 -301 -27 -303 -27 -301 b -85 -280 -38 -301 -69 -290 b -217 -95 -149 -244 -194 -181 b -228 -29 -221 -80 -228 -40 b -259 -27 -228 -29 -238 -27 b -300 -23 -294 -27 -294 -27 b -311 -2 -307 -19 -311 -11 b -294 23 -311 8 -304 19 b -259 24 -291 23 -284 24 b -228 24 -239 24 -228 24 b -217 91 -228 36 -221 76 b -85 276 -194 177 -149 240 b -28 298 -69 285 -38 298 b -27 333 -27 298 -27 299 b -27 371 -27 362 -27 369 b -9 388 -24 378 -17 385 m -27 136 b -28 247 -27 197 -28 247 b -61 216 -31 247 -53 226 b -123 33 -95 172 -121 98 l -125 24 l -76 24 l -27 24 l -27 136 m 29 242 b 24 247 27 245 24 247 b 23 136 24 247 23 197 l 23 24 l 72 24 l 121 24 l 119 33 b 29 242 115 116 77 206 m -27 -140 l -27 -27 l -76 -27 l -125 -27 l -123 -36 b -61 -220 -121 -102 -95 -176 b -28 -251 -53 -230 -31 -251 b -27 -140 -28 -251 -27 -201 m 119 -36 l 121 -27 l 72 -27 l 23 -27 l 23 -140 b 24 -251 23 -201 24 -251 b 57 -220 27 -251 49 -230 b 119 -36 91 -176 117 -102 "},v4e:{x_min:0,x_max:239.5625,ha:244,o:"m 10 460 b 20 462 13 462 14 462 b 39 449 28 462 35 458 l 40 446 l 40 326 b 40 205 40 259 40 205 b 127 227 40 205 80 215 b 220 249 196 244 213 249 b 227 247 224 249 225 248 b 238 237 231 245 235 241 l 239 233 l 239 -106 l 239 -448 l 238 -451 b 219 -463 234 -459 225 -463 b 198 -451 210 -463 202 -459 l 197 -448 l 197 -324 b 197 -201 197 -248 197 -201 b 110 -223 196 -201 157 -210 b 17 -245 42 -240 24 -245 b 10 -242 13 -245 13 -244 b 0 -233 6 -241 2 -237 l 0 -230 l 0 108 l 0 446 l 0 449 b 10 460 2 453 6 458 m 197 22 b 197 70 197 41 197 58 b 196 116 197 113 197 116 l 196 116 b 118 97 196 116 160 106 l 40 77 l 40 -18 b 40 -112 40 -69 40 -112 l 119 -93 l 197 -73 l 197 22 "},v51:{x_min:-1.359375,x_max:455.96875,ha:465,o:"m 352 541 b 357 542 353 542 355 542 b 377 530 364 542 372 537 l 378 526 l 378 394 l 379 262 l 404 266 b 436 270 420 269 430 270 b 450 265 443 270 446 269 b 455 220 455 259 455 260 l 455 208 l 455 161 l 454 156 b 411 140 449 147 447 147 b 378 133 393 137 379 134 b 378 68 378 133 378 106 b 378 22 378 54 378 38 l 379 -87 l 404 -83 b 436 -79 420 -80 430 -79 b 450 -84 443 -79 446 -80 b 455 -129 455 -90 455 -88 l 455 -141 l 455 -188 l 454 -192 b 413 -209 449 -202 447 -202 b 382 -215 398 -212 383 -215 l 378 -215 l 378 -345 l 378 -380 b 375 -485 378 -484 378 -480 b 357 -494 371 -491 364 -494 b 340 -485 351 -494 344 -491 b 336 -383 337 -480 336 -484 l 336 -349 l 336 -223 l 334 -223 b 291 -231 334 -223 314 -227 l 247 -240 l 247 -371 l 246 -503 l 245 -506 b 225 -519 242 -514 234 -519 b 206 -506 219 -519 210 -514 l 205 -503 l 205 -376 l 205 -248 l 160 -256 l 115 -265 l 115 -396 l 115 -527 l 114 -531 b 95 -544 110 -539 102 -544 b 76 -531 87 -544 78 -539 l 73 -527 l 73 -399 b 73 -273 73 -330 73 -273 b 49 -277 73 -273 61 -274 b 17 -281 32 -280 24 -281 b 4 -276 10 -281 8 -280 b -1 -234 0 -269 -1 -272 b 0 -219 -1 -229 0 -224 l 0 -170 l 1 -167 b 10 -158 2 -163 6 -159 b 49 -149 13 -156 16 -155 l 73 -145 l 73 -34 b 73 76 73 26 73 76 b 49 72 73 76 61 74 b 17 68 32 69 24 68 b 4 73 10 68 8 69 b -1 115 0 80 -1 77 b 0 130 -1 120 0 124 l 0 179 l 1 181 b 10 191 2 186 6 190 b 49 199 13 192 16 194 l 73 204 l 73 338 b 73 374 73 352 73 365 b 77 483 73 484 73 477 b 95 492 81 489 88 492 b 111 483 100 492 107 489 b 115 378 115 477 115 483 l 115 342 b 117 212 115 223 115 212 b 204 229 117 212 200 227 l 205 229 l 205 365 l 205 502 l 206 505 b 225 517 210 513 219 517 b 245 505 234 517 242 513 l 246 502 l 247 369 l 247 237 l 249 237 b 336 254 253 238 336 254 b 337 390 336 254 337 302 l 337 526 l 338 530 b 352 541 341 535 347 539 m 336 15 b 336 126 336 102 336 126 l 336 126 b 291 117 336 126 315 122 l 247 109 l 247 -1 l 247 -112 l 249 -112 b 336 -95 253 -111 336 -95 b 336 15 336 -95 336 -56 m 205 -120 b 205 -55 205 -120 205 -93 b 205 -9 205 -41 205 -24 l 205 101 l 160 93 l 115 84 l 115 -26 b 115 -83 115 -49 115 -69 b 117 -137 115 -133 115 -137 b 205 -120 118 -137 204 -120 "},v52:{x_min:-10.890625,x_max:298.078125,ha:294,o:"m 138 473 b 142 474 140 473 141 474 b 164 459 148 474 153 470 b 191 402 183 442 191 423 b 181 353 191 388 187 371 b 178 349 179 352 178 349 b 179 348 178 348 179 348 b 185 349 181 348 182 348 b 255 376 210 355 234 363 b 272 381 264 381 266 381 b 298 355 287 381 298 370 b 288 330 298 348 298 345 b 171 34 238 254 194 141 b 166 13 168 16 168 16 b 144 1 161 5 152 1 b 121 15 134 1 125 5 b 115 33 119 18 117 24 b 0 330 91 145 49 252 b -10 355 -9 345 -10 348 b 13 381 -10 371 0 381 b 31 376 19 381 25 380 b 132 345 61 358 103 345 l 136 345 l 137 355 b 145 378 138 359 142 370 b 152 415 149 394 152 405 b 137 452 152 427 148 438 b 133 464 134 458 133 460 b 138 473 133 467 134 470 "},v53:{x_min:0,x_max:902.421875,ha:921,o:"m 17 240 b 24 241 19 241 21 241 b 32 240 28 241 31 241 b 46 229 38 238 43 234 b 50 88 50 223 50 237 b 50 -1 50 63 50 34 b 50 -90 50 -36 50 -65 b 46 -231 50 -238 50 -224 b 25 -242 42 -238 34 -242 b 0 -224 14 -242 4 -235 b 0 2 0 -222 0 -108 b 0 223 0 112 0 220 b 17 240 2 230 9 237 m 110 240 b 118 241 111 241 114 241 b 126 240 121 241 123 241 b 142 223 133 237 140 230 b 144 123 144 220 144 205 b 144 29 144 45 144 29 b 144 29 144 29 144 29 b 393 183 166 106 264 167 b 450 186 412 184 431 186 b 756 29 600 186 732 120 b 756 29 756 29 756 29 b 758 123 758 29 758 45 b 760 227 758 226 758 223 b 784 241 766 237 774 241 b 804 229 792 241 800 237 b 809 88 808 223 809 237 l 809 -1 l 809 -90 b 804 -231 809 -238 808 -224 b 784 -242 800 -238 792 -242 b 762 -231 775 -242 766 -238 b 758 -124 756 -224 758 -231 b 756 -30 758 -47 758 -30 b 756 -30 756 -30 756 -30 b 509 -184 736 -108 637 -169 b 450 -187 488 -187 469 -187 b 144 -30 300 -187 168 -122 b 144 -30 144 -30 144 -30 b 144 -124 144 -30 144 -47 b 140 -231 144 -231 144 -224 b 118 -242 134 -238 126 -242 b 92 -224 107 -242 96 -235 b 92 2 92 -222 92 -108 b 92 223 92 112 92 220 b 110 240 95 230 102 237 m 432 161 b 413 162 426 162 420 162 b 313 41 351 162 313 109 b 347 -73 313 5 323 -34 b 487 -163 385 -133 439 -163 b 578 -97 526 -163 562 -142 b 588 -43 585 -80 588 -62 b 432 161 588 47 518 147 m 868 240 b 876 241 869 241 872 241 b 884 240 879 241 882 241 b 898 229 890 238 894 234 b 902 88 902 223 902 237 l 902 -1 l 902 -90 b 898 -231 902 -238 902 -224 b 876 -242 892 -238 884 -242 b 852 -224 865 -242 854 -235 b 850 2 850 -222 850 -108 b 852 223 850 112 850 220 b 868 240 853 230 860 237 "},v54:{x_min:-24.5,x_max:317.140625,ha:324,o:"m -24 -161 l -24 -5 l -20 -5 b 0 -24 -9 -5 -2 -12 b 171 -315 21 -124 84 -233 b 317 -660 268 -406 317 -531 b 187 -1014 317 -782 274 -909 b 161 -1034 172 -1034 171 -1034 b 141 -1013 149 -1034 141 -1025 b 152 -991 141 -1004 142 -1002 b 266 -682 228 -899 266 -788 b 174 -430 266 -588 236 -498 b -23 -317 136 -388 66 -348 b -24 -161 -23 -316 -24 -285 "},v55:{x_min:0,x_max:551.25,ha:563,o:"m 289 644 b 304 645 294 645 299 645 b 404 566 349 645 392 613 b 406 541 405 557 406 549 b 379 471 406 514 397 489 l 377 467 l 382 470 b 509 591 438 485 485 531 b 513 601 510 595 513 599 b 530 609 518 607 524 609 b 551 588 540 609 551 602 b 200 -605 551 584 204 -599 b 182 -616 197 -612 190 -616 b 163 -602 174 -616 166 -610 b 161 -598 161 -601 161 -601 b 217 -402 161 -589 170 -562 b 272 -213 247 -298 272 -213 b 272 -213 272 -213 272 -213 b 264 -219 272 -213 268 -216 b 140 -262 227 -247 182 -262 b 36 -226 102 -262 65 -249 b 0 -145 12 -206 0 -176 b 17 -84 0 -124 5 -104 b 103 -38 38 -54 70 -38 b 191 -91 137 -38 172 -56 b 205 -141 201 -106 205 -124 b 178 -212 205 -167 196 -194 l 175 -215 l 182 -213 b 307 -93 236 -198 284 -151 b 372 129 308 -88 372 127 b 372 129 372 129 372 129 b 364 122 372 129 368 126 b 240 80 328 94 283 80 b 137 115 202 80 166 91 b 99 195 112 136 99 165 b 118 256 99 217 106 238 b 204 303 138 287 171 303 b 292 249 238 303 273 285 b 306 199 302 234 306 217 b 279 129 306 173 296 148 l 276 126 l 281 127 b 408 248 336 142 385 190 b 473 470 409 254 473 469 b 473 470 473 470 473 470 b 465 464 473 470 469 467 b 341 421 428 435 383 421 b 236 458 303 421 266 433 b 200 537 212 478 200 508 b 289 644 200 585 234 635 "},v58:{x_min:-21.78125,x_max:367.5,ha:375,o:"m 259 1553 b 265 1553 261 1553 264 1553 b 288 1540 272 1553 277 1550 b 367 1351 340 1493 367 1424 b 336 1221 367 1308 357 1263 l 332 1211 l 333 1208 b 367 1077 356 1170 367 1124 b 336 945 367 1032 357 986 l 332 935 l 333 932 b 367 800 356 893 367 848 b 336 669 367 756 357 710 l 332 659 l 333 656 b 367 523 356 617 367 571 b 345 412 367 485 360 446 b 231 273 322 356 284 310 b -1 19 121 195 27 93 b -17 4 -4 11 -10 5 l -21 4 l -21 134 l -21 265 l -17 265 b 133 291 20 265 96 278 b 318 537 245 328 318 433 b 307 603 318 559 315 582 b 303 614 304 612 304 614 b 298 609 302 614 300 613 b 231 549 281 589 258 567 b -1 295 121 471 27 369 b -17 280 -4 287 -10 281 l -21 280 l -21 410 l -21 541 l -17 541 b 133 567 20 541 96 555 b 318 813 245 605 318 709 b 307 880 318 835 315 859 b 303 891 304 888 304 891 b 298 885 302 891 300 888 b 231 825 281 866 258 843 b -1 571 121 748 27 645 b -17 556 -4 563 -10 557 l -21 556 l -21 687 l -21 817 l -17 817 b 133 843 20 817 96 830 b 318 1089 245 881 318 985 b 307 1156 318 1111 315 1134 b 303 1167 304 1164 304 1167 b 298 1161 302 1167 300 1164 b 231 1102 281 1140 258 1120 b -1 848 121 1024 27 921 b -17 832 -4 839 -10 834 l -21 832 l -21 963 l -21 1093 l -17 1093 b 114 1113 12 1093 78 1103 b 313 1314 215 1142 289 1218 b 318 1364 317 1331 318 1347 b 255 1511 318 1422 295 1478 b 243 1532 247 1519 243 1525 b 259 1553 243 1540 250 1550 "},v59:{x_min:0,x_max:464.140625,ha:474,o:"m 0 0 l 0 347 l 76 347 l 153 347 l 153 0 l 153 -348 l 76 -348 l 0 -348 l 0 0 m 308 -1 l 308 347 l 386 347 l 464 347 l 464 -1 l 464 -348 l 386 -348 l 308 -348 l 308 -1 "},v5a:{x_min:-171.5,x_max:170.140625,ha:174,o:"m -6 566 b 0 567 -5 567 -2 567 b 14 556 6 567 12 563 b 92 285 14 555 50 433 b 170 13 166 33 170 19 b 168 13 170 13 170 13 b 161 1 168 8 167 4 l 159 0 l 122 0 l 84 0 l 81 1 b 21 195 76 5 78 -5 b -32 381 -8 297 -32 381 b -87 197 -32 381 -57 298 b -141 8 -115 94 -140 9 b -155 0 -142 2 -149 0 b -171 15 -163 0 -171 5 b -14 556 -171 18 -24 528 b -6 566 -14 560 -10 564 "},v5b:{x_min:-441,x_max:439.640625,ha:449,o:"m -428 -2 b -421 0 -427 -1 -424 0 b -406 -6 -416 0 -409 -2 b -400 -31 -401 -12 -400 -15 b -1 -352 -392 -215 -215 -352 b 58 -349 19 -352 38 -351 b 398 -31 250 -326 392 -192 b 404 -6 398 -15 400 -12 b 419 -1 408 -2 413 -1 b 439 -13 427 -1 435 -5 b 439 -29 439 -16 439 -22 b 434 -105 439 -48 438 -80 b 0 -489 397 -333 213 -489 b -68 -484 -23 -489 -44 -488 b -441 -36 -280 -452 -436 -263 b -441 -30 -441 -34 -441 -31 b -428 -2 -441 -11 -439 -5 m -13 -9 b -1 -8 -9 -8 -5 -8 b 50 -36 19 -8 39 -19 b 61 -72 57 -47 61 -59 b 50 -106 61 -84 57 -97 b -1 -134 39 -124 19 -134 b -46 -115 -17 -134 -34 -129 b -62 -72 -57 -102 -62 -87 b -13 -9 -62 -44 -44 -16 "},v5c:{x_min:0,x_max:447.8125,ha:457,o:"m 0 -87 l 0 0 l 223 0 l 447 0 l 447 -87 l 447 -174 l 223 -174 l 0 -174 l 0 -87 "},v5d:{x_min:-1.359375,x_max:592.078125,ha:604,o:"m 280 692 b 295 694 283 692 289 694 b 310 692 300 694 307 692 b 357 630 340 684 357 657 b 336 580 357 612 351 594 b 311 538 321 566 311 549 b 352 492 311 512 330 492 b 366 495 357 492 362 492 b 397 553 390 503 397 517 b 415 603 397 576 402 591 b 460 623 427 617 443 623 b 509 599 479 623 498 614 b 522 559 518 587 522 573 b 494 506 522 538 513 519 b 451 495 481 498 473 496 b 415 488 432 495 426 494 b 394 449 404 483 394 464 b 394 448 394 448 394 448 l 394 440 l 397 433 b 428 409 404 420 413 413 b 438 408 431 408 435 408 b 479 431 450 408 462 415 b 528 455 495 448 510 455 b 548 452 534 455 541 453 b 592 391 577 442 592 416 b 549 331 592 365 577 340 b 528 327 541 328 534 327 b 479 351 510 327 495 335 b 438 374 464 367 450 374 b 417 369 431 374 424 373 b 394 333 402 360 394 348 b 400 312 394 326 396 319 b 451 287 408 294 420 288 b 513 258 484 285 499 278 b 522 223 519 247 522 234 b 461 159 522 190 496 159 b 449 161 457 159 453 159 b 397 229 416 167 397 191 b 366 288 397 265 390 278 b 352 290 362 290 357 290 b 315 262 336 290 321 280 b 311 245 313 256 311 251 b 334 204 311 233 318 220 b 355 170 348 190 351 184 b 357 152 356 166 357 159 b 355 136 357 147 356 140 b 295 88 345 104 321 88 b 232 152 264 88 232 112 b 255 204 232 174 238 186 b 279 244 273 222 279 231 l 279 245 b 238 290 279 270 259 290 b 224 288 234 290 228 290 b 193 229 200 278 193 265 b 141 161 193 191 174 167 b 129 159 137 159 133 159 b 68 223 93 159 68 190 b 77 258 68 234 70 247 b 138 287 91 278 106 285 b 185 302 166 287 175 291 b 196 333 193 312 196 323 b 174 369 196 347 187 360 b 152 374 166 373 159 374 b 111 351 140 374 126 367 b 62 327 95 335 80 327 b 51 328 58 327 54 327 b -1 391 16 334 -1 363 b 53 455 -1 420 17 449 b 62 455 57 455 59 455 b 111 431 80 455 95 448 b 152 408 127 415 140 408 b 161 409 155 408 159 408 b 193 433 176 413 186 420 l 196 440 l 196 448 b 196 451 196 449 196 449 b 190 471 196 459 194 463 b 137 495 182 489 167 495 l 134 495 l 134 495 b 68 560 95 495 68 521 b 129 623 68 596 95 623 b 144 621 134 623 138 623 b 193 553 175 614 193 589 b 224 495 193 517 200 503 b 238 492 228 492 234 492 b 279 538 259 492 279 512 b 254 580 279 549 269 566 b 232 630 239 594 232 612 b 280 692 232 657 250 684 m 307 456 b 295 458 303 458 299 458 b 230 391 258 458 230 426 b 236 360 230 381 231 371 b 295 324 249 337 272 324 b 353 360 318 324 341 337 b 360 391 357 370 360 381 b 307 456 360 421 340 451 "},v60:{x_min:-590.71875,x_max:589.359375,ha:601,o:"m -367 173 b -362 174 -366 174 -364 174 b -351 173 -357 174 -353 173 b -262 86 -348 172 -328 151 b -176 0 -216 37 -176 0 b -107 84 -176 0 -145 37 b -31 174 -36 173 -38 172 b -25 174 -29 174 -28 174 b -16 173 -23 174 -19 173 b 72 86 -13 172 6 151 b 157 0 119 37 157 0 b 227 84 159 0 189 37 b 303 174 298 173 296 172 b 308 174 304 174 307 174 b 318 173 313 174 317 173 b 481 11 322 172 357 134 l 494 -1 l 522 34 b 560 76 553 72 555 74 b 567 77 563 77 564 77 b 589 56 579 77 589 68 b 586 48 589 54 588 51 b 411 -172 583 41 416 -166 b 397 -176 406 -174 401 -176 b 387 -174 393 -176 390 -176 b 299 -87 386 -173 366 -152 b 213 0 253 -38 213 0 b 144 -86 213 0 182 -38 b 68 -174 73 -174 74 -173 b 62 -176 66 -176 65 -176 b 53 -174 59 -176 55 -174 b -35 -87 50 -173 29 -152 b -121 0 -83 -38 -121 0 b -190 -86 -122 0 -152 -38 b -266 -174 -261 -174 -259 -173 b -272 -176 -268 -176 -270 -176 b -281 -174 -276 -176 -280 -174 b -371 -86 -284 -173 -304 -152 b -457 0 -417 -38 -457 0 l -457 0 b -477 -26 -457 0 -470 -16 b -548 -227 -524 -88 -548 -161 b -536 -303 -548 -254 -544 -280 b -533 -317 -534 -309 -533 -313 b -553 -338 -533 -330 -541 -338 b -577 -315 -566 -338 -571 -333 b -590 -227 -586 -287 -590 -258 b -518 -9 -590 -154 -564 -77 b -465 56 -509 2 -504 8 l -402 134 b -367 173 -375 169 -372 172 "},v62:{x_min:46.28125,x_max:669.671875,ha:563,o:"m 183 376 b 189 376 185 376 187 376 b 212 374 197 376 208 376 b 265 337 234 369 253 355 b 274 317 268 331 273 320 b 274 316 274 317 274 316 b 280 323 276 316 276 319 b 311 358 288 337 299 348 b 319 366 315 360 318 365 b 356 376 326 373 340 376 b 382 371 364 376 374 374 b 428 337 400 366 417 352 b 436 317 431 331 436 320 b 438 316 436 317 436 316 b 442 323 438 316 439 319 b 475 358 451 337 462 348 b 483 366 477 360 481 365 b 518 376 488 373 503 376 b 544 373 528 376 536 376 b 604 285 579 360 604 326 b 597 249 604 273 601 258 b 543 63 596 247 544 70 b 541 54 543 61 541 55 b 540 44 540 51 540 47 b 552 23 540 33 545 23 b 552 23 552 23 552 23 b 647 126 586 29 627 72 b 658 138 651 136 653 138 b 660 138 660 138 660 138 b 669 129 666 137 669 136 b 654 88 669 122 665 109 b 562 -12 631 43 602 9 l 549 -19 b 521 -27 540 -24 530 -27 b 447 30 490 -27 458 -4 b 443 58 445 38 443 48 b 450 93 443 72 446 84 b 504 278 453 97 504 272 b 507 288 506 283 506 287 b 509 298 507 292 509 295 b 491 326 509 310 502 320 b 487 327 490 327 488 327 b 479 324 484 327 483 326 b 441 270 462 316 443 288 b 435 249 441 265 436 254 b 398 127 434 248 419 195 b 362 4 379 61 362 5 b 328 -1 359 -1 362 -1 b 314 -1 323 -1 319 -1 b 302 -1 310 -1 306 -1 b 266 4 266 -1 269 -1 b 265 6 265 5 265 5 b 303 144 265 13 272 34 b 343 278 325 216 343 276 b 344 288 343 281 344 285 b 345 298 345 291 345 295 b 330 326 345 310 340 320 b 323 327 328 327 325 327 b 317 324 322 327 321 326 b 279 270 300 316 281 288 b 273 249 279 265 274 254 b 236 127 272 248 255 195 b 200 4 216 61 200 5 b 164 -1 197 -1 198 -1 b 151 -1 161 -1 156 -1 b 140 -1 147 -1 142 -1 b 103 4 104 -1 106 -1 b 103 6 103 5 103 5 b 141 144 103 13 108 34 b 181 278 161 216 179 276 b 182 288 181 281 181 285 b 183 298 182 291 183 295 b 168 324 183 310 178 320 b 160 327 166 326 163 327 b 141 320 156 327 151 324 b 69 230 112 305 85 272 b 57 215 65 217 62 215 b 55 215 57 215 55 215 b 46 224 49 215 46 217 b 59 260 46 231 50 242 b 151 363 81 306 112 341 b 161 369 155 365 160 367 b 183 376 166 371 174 374 "},v68:{x_min:-597.53125,x_max:596.171875,ha:608,o:"m -533 324 b -525 327 -530 326 -528 327 b -504 305 -514 327 -504 317 b -504 305 -504 305 -504 305 b -513 284 -504 299 -504 299 b -556 112 -541 226 -556 167 b -545 33 -556 84 -552 58 b -524 -20 -541 15 -532 -9 l -522 -23 l -491 15 l -413 111 b -355 174 -367 169 -363 174 b -351 174 -353 174 -352 174 b -254 86 -343 174 -348 179 b -168 -1 -208 37 -168 -1 b -100 84 -168 -1 -137 37 b -23 173 -28 173 -29 172 b -19 174 -21 174 -20 174 b -8 173 -14 174 -10 173 b 155 11 -5 172 43 123 l 166 -1 l 168 1 l 170 4 l 170 130 b 171 260 170 256 170 258 b 191 274 175 269 183 274 b 205 267 196 274 201 272 b 212 158 212 262 210 273 l 212 56 l 257 112 b 311 173 304 172 304 172 b 317 174 313 174 314 174 b 326 173 319 174 323 173 b 490 11 329 172 366 134 l 502 -1 l 530 34 b 568 76 560 72 563 74 b 575 77 570 77 573 77 b 596 56 586 77 596 68 b 594 48 596 54 596 51 b 417 -172 592 41 424 -166 b 405 -176 415 -174 409 -176 b 396 -174 401 -176 398 -176 b 307 -87 393 -173 372 -152 b 221 -1 259 -38 221 -1 b 216 -6 221 -1 219 -2 l 212 -12 l 212 -147 b 212 -210 212 -173 212 -194 b 205 -292 212 -297 210 -287 b 191 -299 201 -297 196 -299 b 172 -287 183 -299 175 -295 b 170 -174 171 -284 171 -284 l 170 -63 l 127 -117 b 73 -176 84 -170 80 -176 b 68 -176 72 -176 70 -176 b -27 -87 59 -174 65 -180 b -114 0 -74 -38 -112 0 b -182 -86 -114 0 -145 -38 b -258 -174 -253 -174 -253 -173 b -264 -176 -259 -176 -262 -176 b -274 -174 -268 -176 -272 -174 b -438 -11 -277 -173 -348 -102 l -449 0 l -479 -37 b -524 -80 -513 -80 -514 -80 l -524 -80 b -553 -52 -534 -80 -540 -74 b -597 109 -583 -8 -597 48 b -560 280 -597 165 -585 224 b -533 324 -548 310 -540 322 "},v6c:{x_min:-1.359375,x_max:193.28125,ha:197,o:"m 78 233 b 87 233 81 233 84 233 b 187 140 132 233 174 195 b 193 102 190 127 193 115 b 43 -113 193 22 136 -62 b 27 -119 36 -116 31 -119 b 19 -108 21 -119 19 -115 b 29 -97 19 -102 20 -101 b 102 13 73 -72 102 -27 b 92 51 102 26 98 40 l 91 54 l 84 54 b 8 104 53 54 21 74 b -1 142 1 116 -1 130 b 78 233 -1 187 31 227 "},v6d:{x_min:-590.71875,x_max:589.359375,ha:601,o:"m 544 335 b 553 337 548 337 551 337 b 575 313 563 337 570 330 b 589 226 583 285 589 256 b 517 8 589 152 563 76 b 464 -58 507 -4 503 -9 l 401 -136 b 362 -176 372 -172 370 -176 b 357 -176 360 -176 359 -176 b 261 -87 349 -174 355 -180 b 175 0 215 -38 175 0 b 106 -86 175 0 144 -38 b 29 -174 35 -174 36 -173 b 24 -176 28 -176 27 -176 b 14 -174 21 -176 17 -174 b -73 -87 12 -173 -8 -152 b -159 0 -121 -38 -159 0 b -228 -86 -160 0 -190 -38 b -304 -174 -299 -174 -298 -173 b -310 -176 -306 -176 -308 -176 b -319 -174 -314 -176 -318 -174 b -483 -12 -323 -173 -359 -137 l -495 0 l -524 -34 b -562 -77 -553 -73 -556 -76 b -568 -79 -564 -79 -566 -79 b -590 -58 -581 -79 -590 -69 b -588 -49 -590 -55 -589 -52 b -412 170 -585 -43 -417 165 b -398 174 -408 173 -402 174 b -389 173 -394 174 -392 174 b -300 86 -387 172 -366 151 b -215 -1 -254 37 -215 -1 b -145 84 -215 -1 -183 37 b -69 173 -74 173 -76 172 b -63 174 -68 174 -66 174 b -54 173 -61 174 -57 173 b 34 86 -51 172 -31 151 b 119 -1 81 37 119 -1 b 189 84 121 -1 151 37 b 265 173 259 173 258 172 b 270 174 266 174 269 174 b 280 173 274 174 279 173 b 370 84 283 172 303 151 b 455 -1 416 37 455 -1 l 455 -1 b 476 24 455 -1 469 15 b 547 226 522 87 547 159 b 534 302 547 252 543 278 b 532 317 533 308 532 313 b 544 335 532 326 536 333 "},v6f:{x_min:-80.3125,x_max:78.9375,ha:81,o:"m 63 191 b 69 192 65 192 66 192 b 77 188 72 192 76 191 b 78 183 78 187 78 186 b 74 158 78 179 77 172 l 66 115 b 9 -161 49 30 10 -158 b -10 -187 6 -172 -1 -181 b -34 -194 -17 -191 -25 -194 b -80 -147 -58 -194 -80 -174 b -80 -141 -80 -144 -80 -142 b 9 70 -80 -134 -73 -117 l 49 163 b 63 191 59 188 61 190 "},v70:{x_min:0,x_max:436.921875,ha:446,o:"m 213 190 b 217 191 215 191 216 191 b 231 184 223 191 228 188 b 249 154 240 167 246 159 b 419 18 292 91 348 45 b 436 -1 435 11 436 8 b 424 -16 436 -9 434 -13 b 308 -87 394 -26 340 -59 b 231 -186 276 -117 257 -142 b 219 -192 228 -191 225 -192 b 198 -174 209 -192 208 -191 b 47 -33 161 -113 110 -63 b 10 -16 34 -26 17 -19 b 0 -1 2 -13 0 -9 b 17 18 0 8 1 11 b 198 173 95 48 156 101 b 213 190 206 187 208 188 "},v72:{x_min:-423.3125,x_max:421.9375,ha:431,o:"m -262 197 b -247 197 -257 197 -253 197 b -118 162 -210 197 -163 184 b 40 45 -61 134 -13 98 b 277 -95 119 -33 200 -81 b 289 -97 281 -97 285 -97 b 378 0 332 -97 371 -55 b 378 11 378 4 378 6 b 302 83 378 55 345 83 b 242 66 283 83 262 77 b 208 56 231 59 219 56 b 148 120 175 56 148 81 b 201 186 148 151 164 172 b 261 198 220 194 240 198 b 420 45 341 198 411 136 b 421 22 421 37 421 29 b 245 -199 421 -93 338 -199 b 238 -198 243 -199 240 -199 b -44 -47 148 -194 50 -141 b -250 86 -114 22 -183 66 b -295 94 -270 91 -283 94 b -315 91 -302 94 -307 94 b -381 4 -356 81 -381 43 b -355 -56 -381 -18 -372 -40 b -298 -81 -338 -73 -319 -81 b -246 -68 -283 -81 -265 -77 b -212 -58 -234 -61 -223 -58 b -178 -69 -200 -58 -189 -62 b -151 -122 -160 -81 -151 -101 b -171 -167 -151 -138 -157 -155 b -239 -195 -185 -181 -213 -192 b -257 -197 -245 -197 -250 -197 b -423 -5 -352 -197 -423 -109 b -412 65 -423 16 -419 40 b -262 197 -389 137 -329 188 "},v74:{x_min:-206.890625,x_max:428.75,ha:438,o:"m 389 -351 b 394 -351 390 -351 393 -351 b 428 -385 413 -351 428 -367 b 428 -394 428 -388 428 -391 b 394 -428 426 -406 421 -410 l 332 -473 l 269 -516 l 205 -560 l 141 -603 l 77 -648 l 13 -692 l -50 -737 l -114 -780 l -145 -802 b -171 -813 -157 -810 -163 -813 b -175 -813 -172 -813 -174 -813 b -206 -777 -194 -811 -206 -795 b -202 -760 -206 -771 -205 -766 b -87 -675 -197 -752 -206 -757 l -34 -639 l 83 -557 l 145 -514 l 209 -470 l 272 -427 b 389 -351 375 -356 381 -352 "},v75:{x_min:-149.71875,x_max:148.359375,ha:151,o:"m -137 381 b -130 383 -134 383 -133 383 b -111 371 -122 383 -114 378 b -55 224 -110 370 -85 305 b 0 80 -25 145 -1 80 b 54 224 0 80 24 145 b 112 377 114 384 110 373 b 127 384 118 381 122 384 b 148 362 138 384 148 374 l 148 356 l 83 183 b 16 9 47 88 17 11 b -1 0 12 2 5 0 b -14 5 -5 0 -10 1 b -84 183 -19 9 -13 -6 l -149 356 l -149 362 b -137 381 -149 371 -145 378 "},v78:{x_min:0,x_max:193.28125,ha:197,o:"m 85 514 b 95 517 88 517 89 517 b 114 505 103 517 110 513 l 115 502 l 115 376 b 115 249 115 306 115 249 b 141 258 117 249 127 252 l 167 266 l 172 266 b 190 254 181 265 187 262 l 193 251 l 193 202 l 193 188 b 187 147 193 149 191 152 b 147 130 183 142 182 141 l 115 119 l 115 9 b 115 -99 115 -51 115 -99 b 141 -91 115 -99 127 -95 b 171 -81 166 -81 167 -81 l 171 -81 b 191 -94 181 -81 189 -87 b 193 -142 191 -97 193 -120 b 191 -195 193 -167 191 -194 b 125 -227 187 -205 187 -204 l 115 -230 l 115 -366 l 115 -503 l 114 -506 b 95 -519 110 -514 102 -519 b 74 -506 87 -519 78 -514 l 73 -503 l 73 -374 b 73 -245 73 -260 73 -245 b 73 -245 73 -245 73 -245 b 55 -252 72 -245 63 -249 l 32 -260 b 19 -263 27 -262 23 -263 b 4 -256 13 -263 8 -260 b 0 -215 0 -251 0 -254 b 0 -199 0 -210 0 -206 l 0 -152 l 1 -149 b 8 -140 2 -145 5 -141 b 42 -127 9 -140 24 -133 l 73 -116 l 73 -5 b 73 23 73 4 73 15 b 73 105 73 70 73 105 b 49 97 73 105 61 101 b 17 88 32 91 23 88 b 4 95 10 88 8 91 b 0 137 0 101 0 98 b 0 151 0 141 0 145 l 0 199 l 1 202 b 43 224 5 212 5 212 l 73 234 l 73 367 l 73 502 l 74 505 b 85 514 77 509 81 513 "},v79:{x_min:-1.359375,x_max:899.703125,ha:918,o:"m 307 349 b 332 351 315 351 323 351 b 443 340 367 351 408 347 b 741 47 607 306 720 195 b 744 0 743 31 744 16 b 660 -303 744 -90 713 -206 b 28 -755 534 -531 304 -695 b 14 -756 23 -755 19 -756 b -1 -741 4 -756 -1 -750 b 21 -720 -1 -731 1 -728 b 567 -56 337 -601 548 -344 b 568 -11 568 -41 568 -24 b 442 285 568 129 525 233 b 325 319 406 308 367 319 b 93 177 232 319 137 266 b 84 154 91 170 84 155 b 84 154 84 154 84 154 b 88 156 84 154 85 155 b 159 177 110 170 134 177 b 257 134 194 177 231 162 b 294 41 281 108 294 73 b 171 -97 294 -24 246 -90 b 156 -98 166 -97 161 -98 b 6 74 73 -98 6 -22 b 6 80 6 76 6 79 b 307 349 10 223 141 340 m 839 215 b 845 216 841 216 842 216 b 862 213 852 216 860 215 b 899 163 887 206 899 184 b 872 117 899 145 890 127 b 847 111 865 112 856 111 b 808 130 833 111 818 117 b 796 162 800 140 796 151 b 839 215 796 187 812 212 m 839 -112 b 845 -112 841 -112 842 -112 b 862 -115 852 -112 860 -113 b 899 -165 887 -122 899 -144 b 872 -210 899 -183 890 -201 b 847 -217 865 -215 856 -217 b 808 -198 833 -217 818 -210 b 796 -165 800 -188 796 -177 b 839 -112 796 -140 812 -116 "},v7a:{x_min:-1.359375,x_max:386.5625,ha:394,o:"m 249 535 b 257 537 251 537 253 537 b 276 524 266 537 273 533 l 277 521 l 279 419 l 279 316 l 304 323 b 337 328 319 326 330 328 b 353 316 347 328 349 324 b 355 266 355 315 355 290 b 353 215 355 241 355 217 b 319 198 349 206 347 205 b 279 187 284 190 279 188 b 279 156 279 187 279 174 b 279 136 279 151 279 144 l 279 84 l 289 87 l 330 98 b 367 105 352 102 362 105 b 378 101 372 105 375 104 b 386 61 385 95 386 94 b 386 40 386 55 386 48 l 386 -5 l 385 -8 b 374 -19 383 -12 378 -18 b 291 -40 372 -19 347 -26 b 279 -43 284 -41 279 -43 b 279 -83 279 -43 279 -59 b 279 -95 279 -87 279 -91 l 279 -145 l 304 -140 b 337 -133 321 -136 330 -133 b 349 -140 343 -133 347 -136 b 355 -181 355 -145 355 -142 l 355 -197 l 355 -210 b 349 -252 355 -249 355 -247 b 300 -269 345 -258 347 -258 b 280 -274 291 -272 281 -273 l 279 -274 l 277 -378 l 277 -483 l 276 -487 b 257 -499 273 -495 265 -499 b 238 -487 249 -499 242 -495 l 236 -483 l 236 -384 l 236 -285 l 235 -285 l 212 -291 l 170 -301 b 148 -308 159 -305 148 -306 b 147 -415 147 -308 147 -313 l 147 -523 l 145 -526 b 126 -538 141 -534 133 -538 b 106 -526 118 -538 110 -534 l 104 -523 l 104 -420 b 103 -317 104 -326 104 -317 b 103 -317 103 -317 103 -317 b 50 -330 92 -322 54 -330 b 31 -317 42 -330 35 -326 b 29 -267 29 -315 29 -315 l 29 -219 l 32 -216 b 92 -192 36 -206 36 -206 l 104 -190 l 104 -138 b 103 -87 104 -91 104 -87 b 103 -87 103 -87 103 -87 b 88 -91 103 -87 96 -88 l 49 -101 b 17 -106 32 -105 23 -106 b 6 -102 13 -106 10 -105 b -1 -62 0 -97 -1 -95 b 0 -41 -1 -56 0 -49 l 0 4 l 1 6 b 10 16 2 11 6 15 b 91 37 12 18 38 24 l 104 41 l 104 93 b 103 144 104 140 104 144 b 103 144 103 144 103 144 b 50 131 92 141 54 131 b 31 144 42 131 35 137 b 29 195 29 147 29 148 l 29 242 l 32 245 b 92 269 36 255 36 255 l 104 273 l 104 377 l 104 481 l 106 485 b 126 498 110 492 118 498 b 134 495 129 498 132 496 b 145 485 138 494 142 489 l 147 481 l 147 383 l 147 283 l 152 284 b 190 294 155 285 171 290 l 230 303 l 236 305 l 236 413 l 236 521 l 238 524 b 249 535 240 528 243 533 m 236 126 b 235 177 236 154 236 177 l 235 177 b 213 172 235 177 225 174 l 170 161 b 147 155 157 158 147 155 b 147 124 147 155 147 142 b 147 102 147 117 147 111 l 147 52 l 153 54 l 228 72 l 236 74 l 236 126 m 236 -105 b 235 -54 236 -65 236 -54 l 235 -54 b 231 -55 235 -54 234 -54 b 172 -69 227 -55 204 -62 l 149 -76 l 147 -76 l 147 -127 l 147 -179 l 152 -177 b 190 -167 155 -177 171 -173 l 230 -158 l 236 -156 l 236 -105 "},v7c:{x_min:0,x_max:300.8125,ha:307,o:"m 49 505 b 53 506 50 505 51 506 b 70 496 58 506 62 503 b 81 485 73 492 78 488 l 96 473 l 111 459 l 122 449 l 134 438 l 182 396 l 255 330 b 292 291 292 298 292 298 l 292 290 l 292 284 l 283 270 b 209 36 234 197 209 113 b 288 -170 209 -44 235 -119 b 299 -184 295 -179 299 -181 b 300 -191 300 -187 300 -188 b 285 -206 300 -199 294 -206 b 280 -206 283 -206 281 -206 b 247 -201 270 -202 259 -201 b 176 -222 223 -201 197 -208 b 114 -340 136 -249 114 -292 b 172 -471 114 -384 134 -433 b 185 -492 182 -481 185 -487 b 181 -502 185 -496 183 -499 b 171 -508 176 -505 174 -508 b 152 -498 166 -508 160 -503 b 0 -284 65 -428 12 -352 b 0 -260 0 -278 0 -270 b 1 -238 0 -252 0 -242 b 148 -140 16 -177 73 -140 b 209 -148 167 -140 189 -142 b 215 -149 212 -148 215 -149 b 215 -149 215 -149 215 -149 l 215 -149 b 201 -136 215 -148 209 -142 l 157 -97 l 96 -41 b 17 34 21 24 17 29 b 17 37 17 36 17 36 b 17 38 17 37 17 38 b 25 56 17 44 17 44 b 110 298 81 131 110 219 b 46 474 110 367 88 431 b 38 491 40 480 38 487 b 49 505 38 498 42 502 "},v7d:{x_min:-1.359375,x_max:436.921875,ha:446,o:"m 213 205 b 217 205 215 205 216 205 b 234 194 224 205 234 199 b 236 187 234 194 235 190 l 245 167 l 261 129 l 270 106 b 355 -61 294 54 329 -13 b 420 -163 381 -105 402 -138 b 436 -188 435 -184 436 -184 b 436 -191 436 -190 436 -190 b 421 -206 436 -201 431 -206 l 421 -206 l 416 -206 l 405 -201 b 217 -158 347 -172 283 -158 b 31 -201 153 -158 88 -172 l 20 -206 l 14 -206 l 14 -206 b 0 -191 5 -206 0 -201 b -1 -188 0 -190 -1 -190 b 14 -163 -1 -186 0 -184 b 95 -34 36 -136 72 -77 b 166 106 119 8 148 68 l 175 129 l 183 148 l 200 188 b 213 205 205 199 208 202 "},v7f:{x_min:0,x_max:367.5,ha:375,o:"m 0 124 l 0 187 l 61 187 l 122 187 l 122 138 l 122 91 l 153 61 l 183 30 l 213 61 l 243 91 l 243 138 l 243 187 l 306 187 l 367 187 l 367 124 l 367 61 l 321 61 l 274 61 l 243 30 l 213 0 l 243 -31 l 274 -62 l 321 -62 l 367 -62 l 367 -124 l 367 -188 l 306 -188 l 243 -188 l 243 -140 l 243 -93 l 213 -62 l 183 -31 l 153 -62 l 122 -93 l 122 -140 l 122 -188 l 61 -188 l 0 -188 l 0 -124 l 0 -62 l 46 -62 l 92 -62 l 123 -31 l 153 0 l 123 30 l 92 61 l 46 61 l 0 61 l 0 124 "},v80:{x_min:29.9375,x_max:420.578125,ha:371,o:"m 115 345 b 221 347 117 345 166 347 b 411 345 306 347 409 345 b 420 330 416 342 420 335 b 415 319 420 326 419 321 b 178 118 397 303 179 118 b 178 117 178 118 178 117 b 181 117 178 117 178 117 b 189 117 182 117 185 117 b 193 117 190 117 191 117 b 247 98 215 117 232 111 b 296 75 266 83 280 76 b 302 75 299 75 300 75 b 322 91 311 75 315 79 b 322 91 322 91 322 91 b 322 91 322 91 322 91 b 319 91 322 91 321 91 b 313 90 318 90 315 90 b 283 107 300 90 288 97 b 277 126 279 114 277 121 b 319 167 277 149 295 167 b 319 167 319 167 319 167 b 362 118 347 167 362 147 b 355 82 362 108 359 96 b 311 33 349 65 340 55 b 224 1 284 12 253 1 b 194 5 213 1 204 2 b 168 18 183 8 178 11 b 110 36 151 30 130 36 b 57 15 88 36 68 29 b 47 11 54 12 51 11 b 31 20 40 11 34 13 b 29 26 31 22 29 25 b 68 66 29 36 39 45 b 285 250 73 71 281 248 b 285 250 285 250 285 250 b 231 252 285 252 261 252 b 137 250 190 252 141 250 b 93 227 122 248 110 241 b 78 220 88 222 83 220 b 66 227 74 220 70 222 b 63 234 65 229 63 231 b 85 291 63 241 69 252 b 115 345 108 342 108 344 "},v81:{x_min:0,x_max:428.75,ha:438,o:"m 262 186 b 273 186 266 186 272 186 b 274 186 273 186 274 186 b 285 186 274 186 280 186 b 428 48 375 181 428 122 b 386 -68 428 12 416 -29 b 155 -187 329 -145 236 -187 b 12 -111 92 -187 38 -162 b 0 -51 4 -91 0 -72 b 262 186 0 58 122 179 m 366 131 b 352 134 362 133 357 134 b 219 81 321 134 269 115 b 47 -111 126 23 50 -62 b 47 -112 47 -111 47 -112 b 77 -136 47 -129 58 -136 b 264 -45 118 -136 194 -101 b 382 109 336 12 382 76 b 366 131 382 120 377 129 "},v83:{x_min:-1.359375,x_max:847.96875,ha:865,o:"m 488 1499 b 495 1500 490 1500 492 1500 b 541 1465 507 1500 521 1490 b 679 1078 622 1372 679 1210 b 677 1050 679 1068 677 1060 b 477 642 668 893 604 764 l 443 609 l 431 596 l 431 592 l 438 562 l 449 508 l 460 458 b 481 355 475 390 481 355 b 481 355 481 355 481 355 b 490 356 481 355 485 355 b 528 358 495 356 511 358 b 558 356 540 358 552 356 b 839 95 699 338 808 237 b 847 22 845 72 847 47 b 631 -303 847 -113 766 -242 b 620 -309 623 -308 620 -309 l 620 -310 b 631 -359 620 -310 626 -333 l 646 -435 l 660 -496 b 672 -588 668 -535 672 -563 b 664 -653 672 -610 669 -630 b 383 -875 630 -792 509 -875 b 201 -810 321 -875 257 -855 b 129 -680 151 -768 129 -730 b 274 -530 129 -592 200 -530 b 351 -553 300 -530 326 -538 b 412 -669 393 -582 412 -626 b 287 -805 412 -735 366 -800 l 279 -805 l 285 -809 b 383 -830 318 -823 351 -830 b 586 -718 464 -830 540 -789 b 626 -584 612 -678 626 -631 b 619 -528 626 -566 623 -548 b 612 -495 619 -526 616 -510 b 577 -324 590 -387 577 -324 b 577 -324 577 -324 577 -324 b 568 -326 575 -324 571 -324 b 528 -334 558 -328 537 -333 b 465 -338 506 -337 485 -338 b 24 -11 269 -338 87 -206 b -1 145 8 41 -1 93 b 96 442 -1 249 32 351 b 322 714 166 541 236 626 l 352 745 l 345 782 l 332 843 l 315 921 b 303 984 310 950 304 978 b 295 1082 298 1017 295 1049 b 413 1426 295 1208 336 1329 b 488 1499 436 1456 477 1496 m 549 1301 b 541 1301 547 1301 544 1301 b 411 1207 500 1301 447 1263 b 355 1004 374 1152 355 1079 b 359 942 355 984 356 963 b 371 881 362 927 363 917 l 385 818 b 392 782 389 799 392 784 l 392 782 b 434 828 393 782 424 816 b 607 1165 534 941 594 1060 b 608 1193 608 1175 608 1183 b 597 1270 608 1224 604 1254 b 549 1301 589 1286 571 1299 m 398 528 b 393 555 396 542 393 553 b 392 555 393 555 393 555 b 317 470 390 555 347 505 b 190 298 266 408 212 334 b 127 70 148 227 127 148 b 155 -77 127 19 137 -30 b 468 -303 209 -216 333 -303 b 519 -299 484 -303 502 -302 b 568 -284 541 -295 568 -287 l 568 -284 b 563 -263 568 -284 566 -274 l 534 -120 l 511 -13 l 496 61 l 480 133 b 469 187 472 176 469 187 b 468 188 469 187 469 188 b 416 162 462 188 430 172 b 337 13 364 126 337 69 b 413 -124 337 -40 363 -93 b 428 -144 424 -131 428 -137 b 428 -149 428 -145 428 -148 b 409 -166 426 -161 419 -166 b 394 -162 405 -166 400 -165 b 240 77 302 -122 240 -27 l 240 77 b 430 342 240 197 315 301 l 436 344 l 426 394 l 398 528 m 548 194 b 526 195 540 195 532 195 b 519 195 524 195 521 195 l 514 195 l 518 177 l 539 79 l 552 15 l 566 -48 l 594 -187 l 605 -240 b 612 -266 609 -254 611 -266 b 612 -266 612 -266 612 -266 b 641 -248 613 -266 630 -256 b 744 -98 692 -212 730 -156 b 751 -40 749 -79 751 -59 b 548 194 751 76 665 181 "},v84:{x_min:25.859375,x_max:164.6875,ha:168,o:"m 34 369 b 40 370 35 370 38 370 b 59 353 49 370 50 367 b 164 40 122 254 155 158 b 164 0 164 33 164 16 b 164 -40 164 -16 164 -34 b 59 -353 155 -158 122 -254 b 40 -371 53 -366 47 -371 b 34 -370 38 -371 36 -370 b 25 -358 28 -367 25 -363 b 31 -337 25 -352 27 -347 b 92 0 72 -234 92 -117 b 31 335 92 116 72 233 b 25 356 27 345 25 352 b 34 369 25 363 28 366 "},v86:{x_min:-571.671875,x_max:570.3125,ha:582,o:"m -386 173 b -381 174 -385 174 -383 174 b -370 173 -377 174 -372 173 b -281 86 -367 172 -347 151 b -196 0 -235 37 -196 0 b -126 84 -196 0 -164 37 b -50 174 -55 173 -57 172 b -44 174 -49 174 -47 174 b -35 173 -42 174 -38 173 b 53 86 -32 172 -12 151 b 138 0 100 37 138 0 b 208 84 140 0 170 37 b 284 174 279 173 277 172 b 289 174 285 174 288 174 b 299 173 294 174 298 173 b 462 11 303 172 338 134 l 475 -1 l 503 34 b 541 76 534 72 536 74 b 548 77 544 77 545 77 b 570 56 560 77 570 68 b 567 48 570 54 568 51 b 392 -172 564 41 397 -166 b 378 -176 387 -174 382 -176 b 368 -174 374 -176 371 -176 b 280 -87 367 -173 345 -152 b 194 0 234 -38 194 0 b 125 -86 194 0 163 -38 b 49 -174 54 -174 55 -173 b 43 -176 47 -176 46 -176 b 34 -174 40 -176 36 -174 b -54 -87 31 -173 10 -152 b -140 0 -102 -38 -140 0 b -209 -86 -141 0 -171 -38 b -285 -174 -280 -174 -279 -173 b -291 -176 -287 -176 -289 -176 b -300 -174 -295 -176 -299 -174 b -464 -12 -304 -173 -340 -137 l -476 0 l -504 -34 b -543 -77 -534 -73 -537 -76 b -549 -79 -545 -79 -547 -79 b -571 -58 -562 -79 -571 -69 b -568 -49 -571 -55 -570 -52 b -392 172 -566 -43 -396 167 b -386 173 -390 172 -387 173 "},v8a:{x_min:-170.140625,x_max:168.78125,ha:172,o:"m -160 567 b -122 567 -159 567 -149 567 l -87 567 l -84 566 b -74 553 -78 563 -77 560 b -20 366 -73 551 -49 466 b 31 186 8 267 31 186 b 85 371 31 186 55 269 b 140 559 114 473 138 557 b 153 567 141 564 148 567 b 168 559 159 567 166 564 b 168 555 168 557 168 557 b 92 281 168 548 159 513 b 14 13 50 134 14 13 b 0 0 14 6 6 0 b -17 15 -8 0 -17 8 b -93 283 -17 15 -51 136 b -170 552 -166 533 -170 548 b -170 553 -170 552 -170 552 b -160 567 -170 560 -167 564 "},v8b:{x_min:0,x_max:319.859375,ha:326,o:"m 149 508 b 159 509 152 509 155 509 b 186 494 170 509 181 503 b 190 440 190 487 190 488 l 190 430 l 190 377 l 242 377 l 251 377 b 303 373 298 377 296 377 b 319 345 314 367 319 356 b 304 319 319 335 314 324 b 250 315 296 315 299 315 l 242 315 l 190 315 l 190 262 l 190 252 b 186 198 190 204 190 205 b 159 183 179 188 170 183 b 132 198 148 183 138 188 b 127 252 127 205 127 204 l 127 262 l 127 315 l 76 315 l 68 315 b 14 319 20 315 21 315 b 0 347 4 324 0 335 b 14 373 0 356 4 367 b 68 377 21 377 20 377 l 76 377 l 127 377 l 127 430 l 127 440 b 132 494 127 488 127 487 b 149 508 136 501 142 505 "},v8c:{x_min:-330.75,x_max:329.390625,ha:336,o:"m -133 483 b -117 484 -127 484 -122 484 b 31 373 -51 484 9 440 b 35 348 34 365 35 356 b -25 285 35 313 10 285 b -87 331 -55 285 -76 302 b -167 402 -100 376 -133 402 b -191 398 -175 402 -183 401 b -227 341 -215 388 -227 369 b -225 320 -227 334 -227 327 b -13 74 -209 230 -125 133 b 6 65 -4 70 5 66 l 9 63 l 10 65 b 117 231 12 68 40 112 l 189 341 l 242 424 b 268 460 262 456 264 458 b 283 464 273 463 277 464 b 308 438 296 464 308 453 l 308 437 b 287 396 308 430 308 428 l 95 98 l 59 43 l 58 41 l 65 37 b 253 -156 151 -8 217 -77 b 281 -285 272 -199 281 -244 b 148 -481 281 -381 231 -463 b 115 -485 137 -484 126 -485 b -32 -376 51 -485 -9 -442 b -36 -349 -35 -366 -36 -358 b 25 -287 -36 -315 -12 -287 b 85 -333 54 -287 74 -302 b 166 -403 99 -377 133 -403 b 190 -399 174 -403 182 -402 b 225 -342 215 -390 225 -370 b 224 -322 225 -335 225 -328 b 12 -76 208 -231 125 -134 b -8 -66 2 -72 -6 -68 l -10 -65 l -12 -66 b -118 -231 -13 -68 -42 -113 l -190 -342 l -243 -426 b -269 -462 -264 -458 -265 -458 b -284 -466 -274 -464 -279 -466 b -310 -440 -298 -466 -310 -455 l -310 -438 b -288 -398 -310 -430 -308 -430 l -96 -99 l -59 -44 l -59 -43 l -66 -38 b -281 284 -198 33 -281 158 l -281 284 b -133 483 -281 392 -220 474 m 254 177 b 266 179 258 177 262 179 b 319 149 287 179 307 167 b 329 115 326 140 329 127 b 319 79 329 102 326 90 b 268 51 307 61 287 51 b 221 72 250 51 234 58 b 205 115 210 84 205 99 b 254 177 205 142 223 170 m -281 -54 b -269 -52 -277 -52 -273 -52 b -223 -73 -253 -52 -235 -59 b -206 -116 -212 -84 -206 -101 b -216 -151 -206 -129 -209 -141 b -269 -179 -228 -170 -249 -179 b -314 -159 -285 -179 -302 -173 b -330 -116 -325 -147 -330 -131 b -281 -54 -330 -88 -313 -61 "},v8d:{x_min:-1.359375,x_max:255.890625,ha:261,o:"m 118 514 b 127 517 121 517 122 517 b 147 505 136 517 142 513 l 148 502 l 148 403 b 148 306 148 351 148 306 b 174 315 149 306 160 310 l 200 324 l 205 323 b 223 312 213 323 220 319 l 225 308 l 225 260 b 225 245 225 255 225 249 b 220 204 225 208 224 209 b 179 188 216 199 215 199 l 148 177 l 148 124 l 148 70 l 189 84 b 236 98 219 94 230 98 b 247 94 240 98 243 97 b 255 52 254 88 255 87 b 255 33 255 47 255 40 l 254 -12 l 253 -15 b 249 -22 253 -18 250 -20 l 245 -24 l 196 -41 l 148 -58 l 148 -108 b 148 -158 148 -136 148 -158 b 174 -148 148 -158 160 -154 b 204 -140 198 -140 200 -140 l 204 -140 b 224 -152 213 -140 221 -145 b 225 -201 224 -155 225 -177 b 224 -254 225 -226 224 -251 b 157 -284 220 -262 220 -262 l 148 -288 l 148 -395 l 148 -503 l 147 -506 b 127 -519 142 -514 134 -519 b 107 -506 119 -519 111 -514 l 106 -503 l 106 -403 b 106 -303 106 -316 106 -303 b 104 -303 104 -303 104 -303 b 88 -310 104 -303 96 -306 l 63 -319 b 51 -322 59 -320 55 -322 b 36 -315 46 -322 40 -319 b 31 -273 32 -309 31 -312 b 31 -258 31 -269 31 -263 l 31 -210 l 34 -206 b 40 -198 35 -204 38 -199 b 74 -186 42 -197 57 -191 l 106 -173 l 106 -123 b 106 -97 106 -112 106 -104 b 106 -72 106 -76 106 -72 b 104 -72 106 -72 106 -72 b 20 -99 89 -79 23 -99 b 0 -84 10 -99 2 -93 b -1 -37 0 -81 -1 -59 b 0 11 -1 -15 0 9 b 58 40 4 22 2 22 l 106 56 l 106 109 b 106 123 106 115 106 119 b 106 162 106 147 106 162 b 81 155 106 162 93 159 b 50 147 65 149 55 147 b 36 152 43 147 40 148 b 31 194 32 158 31 156 b 31 209 31 198 31 204 l 31 256 l 34 260 b 76 281 38 269 38 269 l 106 292 l 106 396 l 106 502 l 107 505 b 118 514 110 509 114 513 "},v8f:{x_min:-21.78125,x_max:362.0625,ha:369,o:"m 302 1031 b 308 1032 304 1032 307 1032 b 330 1016 318 1032 325 1027 b 362 867 351 970 362 920 b 340 738 362 824 353 780 l 336 727 l 340 717 b 362 591 355 677 362 634 b 257 323 362 496 325 401 b 204 272 243 306 227 290 b 20 56 129 206 66 133 b -1 18 12 44 0 22 b -19 4 -4 9 -12 4 l -21 4 l -21 140 l -21 276 l -12 277 b 167 333 61 288 127 309 b 319 598 262 388 319 491 b 311 664 319 620 317 642 l 310 673 l 304 664 b 204 548 279 620 250 587 b 20 333 129 483 66 409 b -1 292 12 320 0 298 b -19 280 -4 285 -12 280 l -21 280 l -21 416 l -21 552 l -12 553 b 167 609 61 564 127 585 b 319 874 264 666 319 770 b 294 992 319 914 311 954 b 288 1011 288 1004 288 1007 b 302 1031 288 1021 294 1028 "},v90:{x_min:-171.5,x_max:483.1875,ha:493,o:"m -8 631 b -1 632 -6 632 -4 632 b 19 620 8 632 16 628 b 20 495 20 616 20 616 b 20 373 20 427 20 373 b 115 410 20 373 63 390 l 210 448 l 210 531 b 212 620 210 614 210 616 b 231 632 215 628 223 632 b 246 627 236 632 242 631 b 251 541 251 620 251 628 l 251 463 l 315 489 b 387 514 368 509 381 514 b 393 513 390 514 392 514 b 406 494 402 510 406 502 b 397 476 406 487 404 480 b 323 446 396 474 363 462 l 251 417 l 251 283 l 251 148 l 254 151 b 370 199 291 183 332 199 b 415 191 385 199 400 197 b 483 84 458 176 483 134 b 461 0 483 58 476 29 b 332 -142 439 -40 411 -72 l 255 -215 b 231 -229 240 -229 239 -229 b 216 -223 224 -229 220 -227 b 210 -158 210 -217 210 -223 b 210 -120 210 -148 210 -136 l 210 -29 l 205 -34 b 100 -142 182 -65 159 -88 l 23 -215 b -1 -229 9 -229 6 -229 b -19 -217 -9 -229 -16 -224 l -20 -215 l -21 48 l -21 310 l -83 287 b -152 262 -133 266 -145 262 b -157 263 -153 262 -155 262 b -171 283 -166 266 -171 274 b -161 301 -171 290 -167 297 b -91 328 -160 302 -129 315 l -21 356 l -21 487 l -20 617 l -19 621 b -8 631 -17 626 -12 630 m 210 288 b 210 401 210 351 210 401 b 114 365 209 401 167 384 l 20 327 l 20 238 l 20 148 l 21 151 b 140 199 59 183 102 199 b 206 180 164 199 187 192 l 209 177 b 209 177 209 177 209 177 b 210 288 210 177 210 199 m 110 131 b 96 133 106 133 100 133 b 89 133 93 133 91 133 b 24 87 63 129 40 113 l 20 80 l 20 -37 l 20 -156 l 23 -152 b 144 81 96 -72 144 20 l 144 83 b 110 131 144 113 134 126 m 341 131 b 328 133 337 133 332 133 b 322 133 326 133 323 133 b 257 87 296 129 273 113 l 251 80 l 251 -37 l 251 -156 l 255 -152 b 375 81 328 -72 375 20 l 375 83 b 341 131 375 113 367 126 "},v92:{x_min:0,x_max:598.890625,ha:611,o:"m 62 181 b 77 183 66 183 72 183 b 91 181 83 183 88 183 b 202 131 100 180 106 177 l 299 87 l 394 131 b 517 183 499 181 502 183 b 519 183 517 183 518 183 b 598 104 567 183 598 144 b 577 49 598 84 592 65 b 518 15 567 38 563 37 b 484 0 499 6 484 0 b 518 -16 484 -1 499 -8 b 577 -51 563 -38 567 -40 b 598 -105 592 -66 598 -86 b 519 -184 598 -145 567 -184 b 517 -184 518 -184 517 -184 b 394 -133 502 -184 499 -183 l 299 -88 l 202 -133 b 81 -184 99 -183 95 -184 b 77 -184 80 -184 78 -184 b 0 -105 29 -184 0 -145 b 20 -51 0 -86 5 -66 b 80 -16 29 -40 34 -38 b 114 -1 98 -8 114 -1 b 80 15 114 0 98 6 b 20 49 34 37 29 38 b 0 104 6 65 0 84 b 62 181 0 140 23 174 m 88 134 b 74 136 85 134 80 136 b 68 134 72 136 69 136 b 46 104 54 130 46 117 b 55 81 46 95 49 88 b 149 34 59 76 53 80 b 224 -1 190 15 224 0 b 144 -38 224 -1 187 -18 b 54 -84 59 -79 58 -79 b 46 -105 49 -90 46 -98 b 76 -137 46 -122 58 -137 b 78 -137 77 -137 77 -137 b 194 -86 87 -137 76 -141 b 298 -36 250 -58 298 -36 b 298 -36 298 -36 298 -36 b 402 -84 299 -36 345 -58 b 518 -137 522 -141 510 -137 b 521 -137 519 -137 519 -137 b 551 -105 539 -137 551 -122 b 541 -83 551 -98 548 -90 b 447 -36 537 -77 544 -81 b 374 -1 406 -16 374 -1 b 447 34 374 0 406 15 b 541 81 544 80 537 76 b 551 104 548 88 551 97 b 521 136 551 120 539 136 b 518 136 519 136 519 136 b 517 136 518 136 517 136 l 517 136 b 402 83 511 136 511 136 b 298 34 345 56 299 34 b 298 34 298 34 298 34 b 194 84 298 34 250 56 b 88 134 137 111 89 133 "},v93:{x_min:0,x_max:438.28125,ha:447,o:"m 212 205 b 219 205 213 205 216 205 b 239 183 228 205 231 204 b 421 -163 298 40 363 -83 b 438 -191 434 -180 438 -186 b 436 -197 438 -192 438 -195 b 424 -206 434 -204 431 -206 b 406 -201 420 -206 415 -205 b 216 -156 347 -172 281 -156 b 23 -205 148 -156 80 -173 b 14 -206 20 -206 17 -206 b 0 -191 6 -206 0 -201 b 6 -176 0 -187 1 -183 b 202 192 63 -104 142 45 b 212 205 205 199 208 202 m 264 48 l 249 81 l 243 94 l 242 91 b 89 -126 208 36 137 -66 b 81 -138 85 -133 81 -138 b 81 -138 81 -138 81 -138 b 81 -138 81 -138 81 -138 b 95 -133 81 -138 87 -136 b 280 -94 156 -108 221 -94 b 334 -98 299 -94 317 -95 b 343 -99 338 -99 343 -99 b 343 -99 343 -99 343 -99 b 338 -94 343 -99 341 -97 b 264 48 318 -58 287 1 "},v94:{x_min:-149.71875,x_max:148.359375,ha:151,o:"m -9 215 b 0 217 -6 217 -4 217 b 19 205 8 217 14 213 b 20 142 20 202 20 201 l 20 84 l 23 84 b 144 -27 81 74 129 30 b 148 -66 147 -40 148 -54 b 36 -213 148 -134 103 -197 b 0 -219 24 -217 12 -219 b -145 -104 -68 -219 -129 -173 b -149 -68 -148 -91 -149 -79 b -24 84 -149 6 -98 74 l -21 84 l -21 142 b -19 205 -20 201 -20 202 b -9 215 -17 209 -13 213 m -21 -15 b -23 41 -21 37 -21 41 b -23 41 -23 41 -23 41 b -76 11 -35 40 -62 26 b -108 -65 -98 -11 -108 -38 b -1 -176 -108 -122 -65 -176 b 107 -65 63 -176 107 -122 b 74 11 107 -38 96 -11 b 20 41 61 26 32 41 b 20 -15 20 41 20 15 b 19 -74 20 -72 20 -72 b 0 -87 14 -83 6 -87 b -19 -74 -8 -87 -16 -83 b -21 -15 -20 -72 -20 -72 "},v95:{x_min:0,x_max:406.96875,ha:415,o:"m 55 181 b 70 183 61 183 66 183 b 111 170 85 183 99 179 b 160 130 115 167 137 149 l 202 95 l 245 130 b 319 181 299 176 302 179 b 334 183 325 183 330 183 b 406 109 375 183 406 148 b 401 81 406 99 405 91 b 348 24 394 65 390 59 b 318 -1 332 11 318 0 b 348 -26 318 -1 332 -12 b 401 -83 390 -61 394 -66 b 406 -111 405 -93 406 -101 b 334 -184 406 -149 375 -184 b 319 -183 330 -184 325 -184 b 245 -131 302 -180 299 -177 l 202 -97 l 160 -131 b 85 -183 107 -177 103 -180 b 70 -184 80 -184 76 -184 b 0 -111 31 -184 0 -149 b 4 -83 0 -101 1 -93 b 58 -26 10 -66 16 -61 b 88 -1 74 -12 88 -1 b 58 24 88 0 74 11 b 10 69 23 54 17 59 b 0 109 2 81 0 95 b 55 181 0 142 21 173 m 83 133 b 72 136 78 136 76 136 b 57 131 66 136 61 134 b 46 109 49 126 46 117 b 50 93 46 104 47 98 b 107 45 51 91 77 70 b 160 0 137 20 160 0 b 107 -47 160 -1 137 -22 b 50 -94 77 -72 51 -93 b 46 -111 47 -99 46 -105 b 59 -134 46 -120 50 -130 b 72 -137 62 -136 68 -137 b 83 -136 76 -137 80 -136 b 144 -84 84 -134 107 -116 b 202 -36 176 -58 202 -36 b 261 -84 202 -36 230 -58 b 323 -136 299 -116 321 -134 b 334 -137 326 -136 330 -137 b 345 -134 338 -137 343 -136 b 360 -111 355 -130 360 -120 b 355 -94 360 -105 359 -99 b 299 -47 353 -93 329 -72 b 245 0 269 -22 245 -1 b 299 45 245 0 269 20 b 355 93 329 70 353 91 b 360 109 359 98 360 104 b 345 133 360 119 355 129 b 334 136 343 134 338 136 b 323 134 330 136 326 134 b 261 83 321 133 299 115 b 202 34 230 56 202 34 b 144 83 202 34 176 56 b 83 133 106 115 84 133 "},v97:{x_min:-228.671875,x_max:227.3125,ha:232,o:"m -217 487 l -213 488 l 0 488 l 212 488 l 216 487 b 225 476 220 484 224 480 l 227 473 l 227 244 l 227 15 l 225 12 b 206 0 223 4 215 0 b 197 1 204 0 200 0 b 187 12 193 4 189 6 l 186 15 l 186 138 l 186 262 l -1 262 l -187 262 l -187 138 l -187 15 l -189 12 b -208 0 -193 4 -200 0 b -227 12 -216 0 -223 4 l -228 15 l -228 244 l -228 473 l -227 476 b -217 487 -225 480 -221 484 "},v9a:{x_min:-21.78125,x_max:367.5,ha:375,o:"m 230 1031 b 238 1032 232 1032 235 1032 b 259 1014 245 1032 251 1027 b 367 662 330 906 367 782 b 364 602 367 641 367 621 b 232 317 352 488 304 384 b 57 120 155 245 103 187 b -1 18 31 84 6 40 b -19 4 -4 11 -12 4 l -21 4 l -21 159 l -21 315 l -16 315 b 96 335 10 315 62 324 b 315 695 227 380 315 527 b 313 738 315 709 314 724 b 224 991 304 825 273 916 b 216 1013 219 999 216 1007 b 230 1031 216 1021 220 1028 "},v9b:{x_min:-24.5,x_max:313.0625,ha:319,o:"m -24 -133 l -24 -5 l -20 -5 b -1 -19 -12 -5 -4 -11 b 142 -213 13 -61 74 -144 b 258 -376 196 -269 230 -315 b 313 -605 295 -449 313 -528 b 292 -742 313 -652 306 -699 b 288 -752 289 -748 288 -752 b 288 -752 288 -752 288 -752 b 292 -764 289 -753 291 -757 b 313 -907 306 -811 313 -860 b 292 -1045 313 -954 306 -1002 b 288 -1054 289 -1050 288 -1054 b 288 -1054 288 -1054 288 -1054 b 292 -1067 289 -1054 291 -1060 b 313 -1210 306 -1113 313 -1161 b 292 -1346 313 -1257 306 -1304 b 288 -1357 289 -1353 288 -1357 b 288 -1357 288 -1357 288 -1357 b 292 -1368 289 -1357 291 -1363 b 313 -1512 306 -1415 313 -1464 b 292 -1648 313 -1560 306 -1605 b 288 -1660 289 -1654 288 -1660 b 288 -1660 288 -1660 288 -1660 b 292 -1671 289 -1660 291 -1665 b 313 -1814 306 -1719 313 -1766 b 250 -2040 313 -1897 291 -1977 b 232 -2062 238 -2057 236 -2059 b 221 -2065 230 -2063 225 -2065 b 200 -2045 210 -2065 201 -2057 b 200 -2043 200 -2044 200 -2044 b 208 -2026 200 -2037 202 -2034 b 269 -1826 249 -1966 269 -1897 b 153 -1544 269 -1726 230 -1625 b -9 -1472 115 -1506 58 -1481 b -21 -1471 -14 -1471 -19 -1471 l -24 -1471 l -24 -1343 l -24 -1215 l -20 -1215 b -1 -1229 -12 -1215 -4 -1221 b 142 -1424 13 -1270 74 -1353 b 257 -1582 196 -1478 228 -1524 b 264 -1594 261 -1589 264 -1594 l 264 -1594 b 265 -1582 264 -1594 264 -1589 b 270 -1525 268 -1562 270 -1544 b 153 -1243 270 -1424 228 -1321 b -9 -1170 115 -1203 58 -1178 b -21 -1168 -14 -1170 -19 -1168 l -24 -1168 l -24 -1041 l -24 -913 l -20 -913 b -1 -927 -12 -913 -4 -918 b 142 -1121 13 -967 74 -1050 b 257 -1281 196 -1175 228 -1221 b 264 -1292 261 -1286 264 -1292 l 264 -1292 b 265 -1279 264 -1292 264 -1286 b 270 -1222 268 -1261 270 -1242 b 153 -941 270 -1121 228 -1018 b -9 -867 115 -900 58 -875 b -21 -866 -14 -867 -19 -866 l -24 -866 l -24 -738 l -24 -610 l -20 -610 b -1 -624 -12 -610 -4 -616 b 142 -818 13 -664 74 -749 b 257 -978 196 -873 228 -918 b 264 -989 261 -984 264 -989 l 264 -989 b 265 -977 264 -989 264 -984 b 270 -920 268 -959 270 -939 b 153 -638 270 -818 228 -716 b -9 -564 115 -598 58 -573 b -21 -563 -14 -564 -19 -563 l -24 -563 l -24 -435 l -24 -308 l -20 -308 b -1 -322 -12 -308 -4 -313 b 142 -516 13 -363 74 -446 b 257 -675 196 -571 228 -616 b 264 -687 261 -681 264 -687 l 264 -687 b 265 -674 264 -687 264 -681 b 270 -617 268 -656 270 -637 b 153 -335 270 -516 228 -413 b -9 -262 115 -295 58 -270 b -21 -260 -14 -262 -19 -260 l -24 -260 l -24 -133 "},v9c:{x_min:-166.0625,x_max:-25.859375,ha:0,o:"m -49 369 b -42 370 -46 369 -44 370 b -27 360 -36 370 -29 366 b -25 355 -27 359 -25 358 b -32 335 -25 351 -28 347 b -92 52 -66 248 -87 159 b -93 -1 -93 43 -93 20 b -92 -54 -93 -23 -93 -45 b -32 -337 -85 -162 -66 -251 b -25 -355 -27 -349 -25 -352 b -42 -371 -25 -365 -32 -371 b -61 -353 -50 -371 -51 -369 b -163 -63 -119 -262 -153 -165 b -166 -1 -166 -37 -166 -31 b -163 62 -166 30 -166 36 b -61 352 -153 163 -119 260 b -49 369 -54 365 -51 366 "},v9e:{x_min:0,x_max:607.0625,ha:619,o:"m 243 631 b 250 632 246 632 249 632 b 270 620 259 632 268 628 l 272 616 l 272 201 l 272 -212 l 270 -216 b 251 -229 268 -224 259 -229 b 227 -215 243 -229 240 -229 l 151 -142 b 32 -16 81 -80 53 -49 b 0 84 9 18 0 52 b 111 199 0 149 42 199 b 137 197 119 199 127 198 b 228 151 168 191 197 177 l 231 148 l 231 383 b 232 620 231 616 231 616 b 243 631 234 624 238 630 m 168 131 b 152 133 163 133 157 133 b 107 102 130 133 111 120 b 106 86 107 97 106 91 b 111 41 106 73 108 56 b 227 -152 125 -13 171 -90 l 231 -156 l 231 -37 l 231 80 l 225 87 b 168 131 210 111 190 126 m 347 631 b 353 632 348 632 351 632 b 374 620 363 632 371 628 b 375 383 375 616 375 616 l 375 148 l 377 151 b 492 199 415 183 454 199 b 537 191 507 199 522 197 b 607 84 582 176 607 134 b 583 0 607 58 598 29 b 455 -142 562 -40 533 -72 l 378 -215 b 355 -229 364 -229 362 -229 b 334 -216 345 -229 337 -224 l 333 -212 l 333 201 l 333 616 l 334 620 b 347 631 337 624 341 630 m 465 131 b 451 133 461 133 455 133 b 445 133 449 133 446 133 b 379 87 419 129 396 113 l 375 80 l 375 -37 l 375 -156 l 378 -152 b 499 81 451 -72 499 20 l 499 83 b 465 131 499 113 490 126 "},va3:{x_min:58.53125,x_max:228.671875,ha:294,o:"m 138 371 b 142 373 140 371 141 373 b 178 342 149 373 156 366 b 228 251 217 297 228 278 b 228 244 228 248 228 247 b 176 147 227 212 212 184 b 123 73 152 122 132 93 b 121 62 122 70 121 66 b 145 13 121 48 129 31 b 153 -2 151 6 153 1 b 149 -9 153 -5 152 -6 b 144 -11 148 -11 145 -11 b 129 -1 140 -11 136 -8 b 61 87 89 37 68 68 b 58 113 59 95 58 105 b 110 215 58 144 74 177 b 163 287 134 240 155 269 b 166 299 166 291 166 295 b 141 348 166 313 157 330 b 133 360 134 356 133 358 b 133 363 133 362 133 362 b 138 371 133 367 136 370 "},va5:{x_min:0,x_max:349.8125,ha:357,o:"m 88 302 b 103 303 93 302 98 303 b 202 224 149 303 191 270 b 205 199 204 216 205 208 b 178 129 205 173 196 147 l 175 126 l 182 127 b 307 249 236 142 284 190 b 313 259 308 254 311 258 b 329 267 317 265 323 267 b 349 247 340 267 349 259 b 201 -263 349 242 204 -258 b 182 -273 197 -270 190 -273 b 163 -260 174 -273 166 -269 b 161 -256 161 -259 161 -258 b 217 -59 161 -248 170 -220 b 272 129 247 43 272 127 b 272 129 272 129 272 129 b 264 122 272 129 268 126 b 140 80 227 94 183 80 b 36 115 102 80 65 91 b 0 194 10 136 0 165 b 88 302 0 244 32 292 "},va9:{x_min:-24.5,x_max:314.421875,ha:321,o:"m -24 -145 l -24 -5 l -20 -5 b 0 -23 -9 -5 -2 -12 b 27 -87 4 -38 14 -66 b 138 -220 53 -136 88 -177 b 235 -328 179 -255 208 -288 b 314 -592 287 -409 314 -501 b 292 -732 314 -639 307 -687 l 289 -742 l 294 -756 b 314 -896 307 -802 314 -849 b 292 -1035 314 -943 307 -991 l 289 -1045 l 294 -1057 b 314 -1197 307 -1104 314 -1152 b 292 -1338 314 -1246 307 -1292 l 289 -1347 l 294 -1360 b 314 -1500 307 -1407 314 -1454 b 273 -1689 314 -1565 300 -1628 b 250 -1712 265 -1710 261 -1712 b 228 -1691 236 -1712 228 -1704 l 228 -1685 l 234 -1675 b 270 -1507 258 -1621 270 -1564 b 98 -1193 270 -1381 209 -1261 b 40 -1174 76 -1179 58 -1174 b -10 -1189 24 -1174 8 -1178 b -20 -1192 -14 -1192 -16 -1192 l -24 -1192 l -24 -1052 l -24 -913 l -20 -913 b 0 -931 -9 -913 -2 -920 b 27 -995 4 -946 14 -974 b 138 -1128 53 -1043 88 -1085 b 257 -1275 190 -1172 228 -1220 b 262 -1283 259 -1279 262 -1283 l 262 -1283 b 269 -1249 264 -1282 268 -1260 b 270 -1206 270 -1233 270 -1220 b 98 -891 270 -1075 206 -957 b 40 -871 76 -877 58 -871 b -10 -886 24 -871 8 -875 b -20 -889 -14 -889 -16 -889 l -24 -889 l -24 -749 l -24 -610 l -20 -610 b 0 -628 -9 -610 -2 -617 b 27 -692 4 -644 14 -671 b 138 -825 53 -741 88 -782 b 257 -973 190 -870 228 -917 b 262 -981 259 -977 262 -981 l 262 -981 b 269 -946 264 -979 268 -957 b 270 -903 270 -931 270 -917 b 98 -588 270 -774 206 -655 b 40 -569 76 -574 58 -569 b -10 -584 24 -569 8 -574 b -20 -587 -14 -587 -16 -587 l -24 -587 l -24 -448 l -24 -308 l -20 -308 b 0 -326 -9 -308 -2 -315 b 27 -390 4 -341 14 -369 b 138 -523 53 -438 88 -480 b 257 -670 190 -567 228 -614 b 262 -678 259 -674 262 -678 b 262 -678 262 -678 262 -678 b 269 -644 264 -677 268 -656 b 270 -601 270 -628 270 -614 b 98 -285 270 -471 206 -352 b 40 -266 76 -273 58 -266 b -10 -281 24 -266 8 -272 b -20 -284 -14 -284 -16 -284 l -24 -284 l -24 -145 "},vaa:{x_min:-1.359375,x_max:752.703125,ha:768,o:"m 490 985 b 504 986 495 986 500 986 b 604 907 551 986 593 954 b 607 884 607 900 607 892 b 581 813 607 857 597 831 l 578 810 l 583 811 b 710 932 638 827 687 873 b 714 943 711 936 713 942 b 730 952 720 949 725 952 b 752 931 741 952 752 943 b 200 -946 752 927 204 -941 b 182 -957 197 -953 190 -957 b 163 -945 174 -957 166 -953 b 161 -939 161 -942 161 -942 b 217 -743 161 -931 170 -904 b 272 -555 247 -639 272 -555 b 272 -555 272 -555 272 -555 b 264 -560 272 -555 268 -557 b 140 -603 227 -589 182 -603 b 36 -567 102 -603 65 -592 b -1 -487 12 -548 -1 -517 b 17 -427 -1 -466 5 -445 b 103 -380 38 -395 70 -380 b 191 -433 137 -380 172 -398 b 205 -484 201 -448 205 -466 b 178 -553 205 -509 196 -535 l 175 -557 l 182 -555 b 307 -435 236 -539 284 -494 b 372 -213 308 -430 372 -215 b 372 -213 372 -213 372 -213 b 364 -219 372 -213 368 -216 b 240 -262 328 -247 283 -262 b 137 -226 202 -262 166 -249 b 99 -145 112 -206 99 -176 b 118 -84 99 -124 106 -104 b 204 -38 138 -54 171 -38 b 292 -91 238 -38 273 -56 b 306 -141 302 -106 306 -124 b 279 -212 306 -167 296 -194 l 276 -215 l 281 -213 b 408 -93 336 -198 385 -151 b 473 129 409 -88 473 127 b 473 129 473 129 473 129 b 465 122 473 129 469 126 b 341 80 428 94 383 80 b 236 115 303 80 266 91 b 200 195 213 136 200 165 b 217 256 200 217 206 238 b 304 303 239 287 272 303 b 393 249 338 303 374 285 b 406 199 402 234 406 217 b 379 129 406 173 397 148 l 377 126 l 382 127 b 509 248 436 142 485 190 b 574 470 510 254 574 469 b 574 470 574 470 574 470 b 566 464 574 470 570 467 b 442 421 529 435 484 421 b 337 458 404 421 367 433 b 300 538 314 477 300 508 b 318 598 300 559 306 580 b 404 645 340 630 372 645 b 494 592 439 645 475 627 b 507 541 502 577 507 559 b 480 471 507 516 498 489 l 477 467 l 483 470 b 608 589 537 485 586 531 b 675 811 611 595 675 810 b 675 811 675 811 675 811 b 666 806 675 811 671 809 b 543 763 628 777 585 763 b 438 799 504 763 468 775 b 401 878 412 820 401 849 b 490 985 401 928 434 977 "},vab:{x_min:0,x_max:272.21875,ha:278,o:"m 243 631 b 250 632 246 632 249 632 b 270 620 259 632 268 628 l 272 616 l 272 201 l 272 -212 l 270 -216 b 251 -229 268 -224 259 -229 b 227 -215 243 -229 240 -229 l 151 -142 b 32 -16 81 -80 53 -49 b 0 84 9 18 0 52 b 111 199 0 149 42 199 b 137 197 119 199 127 198 b 228 151 168 191 197 177 l 231 148 l 231 383 b 232 620 231 616 231 616 b 243 631 234 624 238 630 m 168 131 b 152 133 163 133 157 133 b 107 102 130 133 111 120 b 106 86 107 97 106 91 b 111 41 106 73 108 56 b 227 -152 125 -13 171 -90 l 231 -156 l 231 -37 l 231 80 l 225 87 b 168 131 210 111 190 126 "},vad:{x_min:0,x_max:873.828125,ha:892,o:"m 0 0 l 0 703 l 81 703 l 164 703 l 164 0 l 164 -705 l 81 -705 l 0 -705 l 0 0 m 225 0 l 225 703 l 246 703 l 268 703 l 268 366 l 268 30 l 274 36 b 314 79 284 44 302 63 b 413 302 357 137 392 213 b 432 327 419 324 421 327 b 449 306 443 327 447 322 b 611 115 457 195 529 115 b 651 122 624 115 638 117 b 728 316 705 140 724 188 b 729 388 728 342 729 366 b 671 635 729 533 711 602 b 581 662 649 652 616 662 b 477 637 545 662 510 653 l 475 635 l 477 634 b 503 627 488 632 495 631 b 545 556 532 612 545 584 b 491 480 545 524 526 491 b 465 474 481 476 473 474 b 379 563 417 474 379 516 b 389 602 379 576 382 588 b 541 691 409 641 479 681 b 582 694 555 692 568 694 b 865 462 714 694 834 598 b 873 392 871 440 873 416 b 865 317 873 367 871 341 b 639 84 839 194 748 101 b 612 83 630 83 620 83 b 511 116 577 83 543 94 b 504 120 509 119 506 120 b 504 120 504 120 504 120 b 469 59 504 120 488 93 l 432 -1 l 469 -61 b 504 -122 488 -94 504 -122 b 504 -122 504 -122 504 -122 b 511 -117 506 -122 509 -120 b 612 -84 543 -95 577 -84 b 665 -91 630 -84 647 -87 b 869 -338 771 -122 850 -216 b 873 -392 872 -356 873 -374 b 798 -595 873 -469 847 -539 b 581 -695 741 -662 660 -695 b 406 -626 517 -695 454 -671 b 381 -563 389 -607 381 -585 b 465 -477 381 -519 413 -477 b 545 -559 514 -477 545 -519 b 503 -628 545 -587 532 -613 b 477 -635 495 -632 488 -634 l 475 -637 l 477 -638 b 581 -663 510 -655 545 -663 b 671 -637 616 -663 649 -653 b 729 -391 711 -603 729 -534 b 728 -317 729 -367 728 -344 b 623 -117 722 -173 698 -124 b 611 -116 619 -116 615 -116 b 449 -308 528 -116 457 -198 b 432 -328 447 -323 443 -328 b 413 -303 421 -328 419 -326 b 314 -80 392 -215 357 -138 b 274 -37 302 -65 284 -45 l 268 -31 l 268 -367 l 268 -705 l 246 -705 l 225 -705 l 225 0 "},vb1:{x_min:78.9375,x_max:485.921875,ha:417,o:"m 362 378 b 378 380 367 380 372 380 b 472 348 415 380 453 367 b 485 315 481 338 485 327 b 462 273 485 298 477 281 b 439 267 454 269 446 267 b 398 290 424 267 409 274 b 344 319 385 309 364 319 b 281 269 315 319 289 301 b 279 262 280 266 279 262 b 276 256 279 260 277 258 b 274 249 276 254 274 251 b 238 127 273 248 257 192 b 201 4 217 61 201 5 b 166 -1 198 -1 200 -1 b 153 -1 163 -1 157 -1 b 141 -1 148 -1 144 -1 b 104 4 106 -1 107 -1 b 104 6 104 5 104 5 b 142 144 104 13 110 34 b 182 278 164 219 181 276 b 183 288 182 281 182 285 b 185 302 185 292 185 298 b 164 330 185 317 176 328 b 159 330 163 330 161 330 b 102 302 140 330 119 320 b 91 294 95 295 93 294 b 88 294 91 294 89 294 b 78 303 83 294 78 298 b 81 312 78 306 78 309 b 200 373 106 347 160 373 b 215 371 205 373 209 371 b 266 335 235 367 254 353 b 269 331 268 333 269 331 b 269 331 269 331 269 331 b 273 335 269 331 270 334 b 362 378 298 359 330 376 "},vb3:{x_min:0,x_max:227.3125,ha:232,o:"m 91 213 b 100 215 93 215 96 215 b 227 58 167 215 224 144 b 227 52 227 56 227 54 b 61 -201 227 -43 164 -138 b 29 -216 44 -212 36 -216 b 23 -210 27 -216 24 -213 b 21 -205 21 -208 21 -206 b 34 -192 21 -201 25 -197 b 122 -55 89 -161 122 -106 b 104 6 122 -33 117 -12 l 103 9 l 96 9 b 4 79 57 9 17 38 b 0 112 1 90 0 101 b 91 213 0 163 36 209 "},vb4:{x_min:-597.53125,x_max:596.171875,ha:608,o:"m -533 324 b -525 327 -530 326 -528 327 b -504 305 -514 327 -504 317 b -504 305 -504 305 -504 305 b -513 284 -504 299 -504 299 b -556 112 -541 226 -556 167 b -545 33 -556 84 -552 58 b -524 -20 -541 15 -532 -9 l -522 -23 l -491 15 l -413 111 b -355 174 -367 169 -363 174 b -351 174 -353 174 -352 174 b -254 86 -343 174 -348 179 b -168 -1 -208 37 -168 -1 b -100 84 -168 -1 -137 37 b -23 173 -28 173 -29 172 b -19 174 -21 174 -20 174 b -8 173 -14 174 -10 173 b 80 86 -5 172 13 151 b 166 -1 127 37 166 -1 b 235 84 166 -1 197 37 b 311 173 306 173 304 172 b 317 174 313 174 314 174 b 326 173 319 174 323 173 b 490 11 329 172 366 134 l 502 -1 l 530 34 b 568 76 560 72 563 74 b 575 77 570 77 573 77 b 596 56 586 77 596 68 b 594 48 596 54 596 51 b 417 -172 592 41 424 -166 b 405 -176 415 -174 409 -176 b 396 -174 401 -176 398 -176 b 307 -87 393 -173 372 -152 b 221 -1 259 -38 221 -1 b 152 -86 221 -1 190 -38 b 76 -176 81 -174 83 -173 b 70 -176 74 -176 73 -176 b 61 -174 66 -176 62 -174 b -27 -87 58 -173 38 -152 b -114 -1 -74 -38 -112 -1 b -182 -86 -114 -1 -145 -38 b -258 -176 -253 -174 -253 -173 b -264 -176 -259 -176 -262 -176 b -274 -174 -268 -176 -272 -174 b -438 -11 -277 -173 -348 -102 l -449 0 l -479 -37 b -524 -80 -513 -80 -514 -80 l -524 -80 b -553 -52 -534 -80 -540 -74 b -597 109 -583 -8 -597 48 b -560 280 -597 165 -585 224 b -533 324 -548 310 -540 322 "},vb6:{x_min:0,x_max:556.6875,ha:568,o:"m 289 545 b 298 546 292 545 295 546 b 318 533 306 546 315 541 b 319 428 319 530 319 528 l 319 327 l 334 327 b 526 223 412 326 485 285 b 543 172 537 206 543 190 b 447 76 543 122 503 76 b 445 76 446 76 446 76 b 359 165 394 77 359 119 b 368 205 359 179 362 192 b 441 251 382 233 412 251 b 455 249 446 251 451 251 b 460 248 458 249 460 248 b 460 248 460 248 460 248 b 454 254 460 249 458 251 b 334 295 419 280 378 294 l 319 295 l 319 4 l 319 -287 l 321 -285 b 328 -285 322 -285 325 -285 b 524 -99 424 -277 507 -198 b 541 -79 526 -84 530 -79 b 556 -97 551 -79 556 -84 b 548 -133 556 -105 553 -117 b 334 -317 521 -233 434 -306 b 322 -319 329 -317 323 -317 l 319 -319 l 319 -424 b 319 -471 319 -444 319 -459 b 313 -541 319 -544 318 -535 b 298 -548 308 -545 303 -548 b 279 -534 289 -548 281 -542 b 277 -424 277 -531 277 -530 l 277 -317 l 273 -317 b 13 -95 153 -305 51 -217 b 0 2 4 -62 0 -29 b 182 295 0 126 66 238 b 274 324 210 309 249 320 l 277 324 l 277 427 b 279 533 277 528 277 530 b 289 545 281 538 285 542 m 277 2 b 277 291 277 161 277 291 b 268 288 277 291 273 290 b 144 1 179 265 144 184 b 276 -284 144 -199 175 -267 l 277 -285 l 277 2 "},vb7:{x_min:-176.9375,x_max:251.8125,ha:257,o:"m -8 631 b -1 632 -6 632 -4 632 b 19 620 8 632 16 628 b 20 503 20 616 20 614 b 20 391 20 442 20 391 b 84 424 20 391 49 406 l 147 456 l 152 456 b 153 456 153 456 153 456 b 175 435 166 456 175 446 b 172 427 175 433 174 430 b 92 380 170 420 172 421 l 20 342 l 20 245 l 20 148 l 21 151 b 137 199 59 183 99 199 b 182 191 152 199 167 197 b 251 84 227 176 251 134 b 228 0 251 58 243 29 b 100 -142 206 -40 178 -72 l 23 -215 b 0 -229 9 -229 6 -229 b -20 -216 -9 -229 -17 -224 b -21 54 -21 -212 -21 -212 b -21 322 -21 201 -21 322 b -85 290 -21 322 -50 308 l -148 256 l -153 256 b -155 256 -155 256 -155 256 b -176 277 -167 256 -176 266 b -174 285 -176 280 -175 283 b -93 333 -171 294 -174 292 l -21 370 l -21 494 b -20 620 -21 616 -21 616 b -8 631 -17 624 -13 630 m 110 131 b 96 133 106 133 100 133 b 89 133 93 133 91 133 b 24 87 63 129 40 113 l 20 80 l 20 -37 l 20 -156 l 23 -152 b 144 81 96 -72 144 20 l 144 83 b 110 131 144 113 134 126 "},vb9:{x_min:-122.5,x_max:121.140625,ha:124,o:"m -16 145 b 0 147 -10 147 -5 147 b 121 -1 66 147 121 77 b 114 -49 121 -16 118 -33 b -1 -148 95 -112 47 -148 b -85 -106 -31 -148 -61 -134 b -122 -1 -110 -76 -122 -38 b -16 145 -122 68 -81 134 m 12 111 b 0 113 8 113 4 113 b -68 22 -29 113 -61 73 b -70 0 -69 15 -70 6 b -13 -113 -70 -49 -47 -98 b -1 -115 -9 -115 -5 -115 b 63 -40 24 -115 53 -83 b 68 -1 66 -27 68 -15 b 12 111 68 48 46 97 "},vba:{x_min:-118.421875,x_max:597.53125,ha:381,o:"m 460 574 b 464 574 461 574 462 574 b 488 574 470 574 481 574 b 500 573 491 574 498 574 b 594 503 543 570 588 538 b 597 488 596 498 597 494 b 528 417 597 449 564 417 b 502 423 519 417 510 419 b 465 481 477 434 465 458 b 488 528 465 499 472 516 b 490 530 490 530 490 530 b 490 530 490 530 490 530 b 468 517 488 530 475 523 b 349 340 419 485 377 420 b 347 330 348 334 347 330 b 383 328 347 328 363 328 b 428 326 423 328 424 328 b 442 302 438 320 442 312 b 430 281 442 294 438 285 b 385 276 424 277 426 276 l 377 276 l 332 276 l 330 269 b 178 -117 303 126 250 -9 b 1 -249 129 -194 69 -237 b -20 -251 -6 -251 -13 -251 b -114 -187 -65 -251 -100 -227 b -118 -156 -117 -177 -118 -166 b -51 -84 -118 -116 -91 -84 b -31 -87 -46 -84 -39 -86 b 16 -152 0 -95 16 -124 b -12 -205 16 -173 8 -194 b -16 -208 -14 -206 -16 -208 b -14 -208 -16 -208 -14 -208 b -9 -206 -14 -208 -12 -208 b 74 -124 23 -197 54 -166 b 172 224 98 -79 125 22 b 185 276 178 252 183 274 b 185 276 185 276 185 276 b 141 276 185 276 181 276 b 91 280 96 276 96 276 b 77 302 83 285 77 294 b 91 326 77 312 83 320 b 148 328 95 328 96 328 l 198 330 l 202 341 b 460 574 249 473 351 566 "},vbf:{x_min:-53.078125,x_max:513.140625,ha:485,o:"m 185 383 b 196 384 187 383 191 384 b 277 334 230 384 259 365 b 288 301 281 324 288 306 b 288 297 288 298 288 297 b 294 302 289 297 291 299 b 394 370 323 338 367 367 b 404 371 398 370 401 371 b 510 272 453 371 498 328 b 513 237 513 262 513 251 b 507 172 513 217 511 192 b 326 -34 487 59 412 -26 b 314 -36 322 -36 318 -36 b 274 -24 298 -36 283 -31 l 265 -16 b 224 44 246 -1 232 20 b 223 49 224 47 223 49 b 223 49 223 49 223 49 b 149 -197 221 48 149 -194 b 149 -198 149 -197 149 -198 b 170 -210 149 -202 155 -205 b 187 -215 174 -210 175 -212 b 204 -231 201 -219 204 -222 b 197 -245 204 -240 202 -242 l 194 -248 l 76 -248 l -42 -248 l -46 -245 b -53 -231 -51 -242 -53 -240 b -35 -215 -53 -222 -49 -217 b -13 -210 -21 -212 -20 -212 b -6 -208 -10 -209 -8 -208 b 0 -206 -6 -208 -2 -206 b 25 -188 13 -201 21 -195 b 163 280 28 -183 163 276 b 166 291 163 283 164 287 b 167 302 167 295 167 299 b 155 324 167 315 161 324 b 155 324 155 324 155 324 b 65 230 125 322 85 280 b 53 215 61 217 58 215 b 51 215 53 215 51 215 b 42 224 46 215 42 217 b 57 263 42 231 47 244 b 140 360 77 305 104 337 b 152 370 144 365 149 369 b 185 383 157 376 172 381 m 374 306 b 366 308 371 308 368 308 b 300 273 348 308 321 294 b 284 254 288 262 287 259 b 280 242 283 249 281 245 b 257 169 279 240 270 213 l 236 98 l 236 93 b 251 48 238 77 243 61 b 279 27 258 37 272 27 b 281 27 279 27 280 27 b 291 31 281 27 287 30 b 396 170 334 52 378 109 b 406 247 402 197 406 224 b 401 277 406 259 405 270 b 374 306 397 290 383 303 "},vc3:{x_min:-10.890625,x_max:299.4375,ha:294,o:"m 136 460 b 142 462 137 462 140 462 b 166 449 152 462 161 456 b 171 428 168 446 168 445 b 288 131 194 322 238 209 b 298 115 295 120 296 117 b 299 106 298 112 299 109 b 273 81 299 91 287 81 b 255 86 268 81 261 83 b 155 116 225 104 183 116 l 152 116 l 149 108 b 141 83 148 102 144 91 b 134 48 137 69 134 58 b 149 9 134 34 140 24 b 153 -1 152 5 153 1 b 149 -9 153 -5 152 -6 b 144 -11 148 -11 147 -11 b 122 2 138 -11 133 -6 b 95 61 104 20 95 38 b 107 108 95 74 99 90 b 108 113 107 111 108 112 b 107 113 108 113 108 113 b 102 113 106 113 104 113 b 31 86 76 108 53 98 b 14 80 24 81 20 80 b -10 106 0 80 -10 91 b 0 131 -10 115 -9 116 b 115 430 49 209 91 317 b 136 460 119 451 123 456 "},vd0:{x_min:-10.890625,x_max:299.4375,ha:294,o:"m 44 174 b 51 174 47 174 49 174 b 68 173 55 174 61 174 l 287 112 l 551 40 b 615 20 617 22 609 23 b 626 0 622 16 626 8 b 615 -22 626 -9 622 -18 b 613 -23 613 -23 613 -23 b 613 -23 613 -23 613 -23 b 287 -113 613 -24 597 -29 l 68 -174 b 53 -176 61 -176 57 -176 b 39 -172 47 -176 43 -174 b 27 -151 31 -167 27 -159 b 39 -129 27 -141 31 -133 b 230 -74 43 -124 20 -131 l 370 -36 l 468 -9 b 498 0 484 -4 498 -1 b 468 8 498 0 484 2 l 370 34 l 230 73 b 40 126 28 129 43 124 b 27 149 31 131 27 140 b 44 174 27 161 34 170 m 205 110 l 205 300 b 205 330 245 330 245 300 l 245 300 l 245 -300 b 245 -330 205 -330 205 -300 l 205 -300 l 205 110 l 345 90 m 345 90 l 345 330 b 345 360 385 360 385 330 l 385 330 l 385 -270 b 385 -300 345 -300 345 -270 l 345 -270 l 345 90 "},vd1:{x_min:-20,x_max:320,ha:257,o:"m -8 200 b -8 210 8 200 16 200 l 20 148 -199 l 23 -615 b 0 -629 9 -629 6 -629 l -21 -612 l -21 -201 l -21 216 l -20 200 m 16 200 l 310 0 l 240 0 l 16 140 l 16 -120 l 240 0 l 310 0 l 16 -200 "},vd2:{x_min:0,x_max:430.75,ha:386,o:"m 0 200 l 0 -200 l 430 -200 l 430 200 l 0 200 "},vd3:{x_min:0,x_max:430.75,ha:386,o:"m 0 200 l 0 -200 l 430 -200 l 430 200 l 0 200 l 50 150 l 380 150 l 380 -150 l 50 -150 l 50 150 "},vd4:{x_min:0,x_max:430.75,ha:360,o:"m 0 150 l 0 -150 l 430 -150 l 430 150 l 0 150 "},vd5:{x_min:0,x_max:430.75,ha:360,o:"m 0 150 l 0 -150 l 430 -150 l 430 150 l 0 150 l 50 100 l 380 100 l 380 -100 l 50 -100 l 50 100"},vd6:{x_min:0,x_max:430.75,ha:360,o:"m -146 537 b -138 538 -143 538 -141 538 b -118 525 -129 538 -121 533 b -117 390 -117 522 -117 521 b -115 259 -117 268 -117 259 b -115 259 -115 259 -115 259 b -59 272 -104 263 -62 272 b -39 259 -50 272 -42 267 b -37 209 -38 257 -37 233 b -39 159 -37 185 -38 162 b -85 138 -43 149 -44 149 l -117 131 l -117 21 b -115 -88 -117 -80 -117 -88 b -115 -88 -115 -88 -115 -88 b -59 -75 -104 -84 -62 -75 b -44 -81 -52 -75 -48 -77 b -38 -124 -38 -87 -38 -85 b -38 -138 -38 -124 -38 -138 b -38 -152 -38 -138 -38 -152 b -44 -195 -38 -191 -38 -190 b -85 -209 -48 -200 -48 -200 l -117 -217 l -117 -349 b -118 -486 -117 -481 -117 -482 b -138 -499 -121 -494 -129 -499 b -153 -493 -143 -499 -149 -497 b -159 -415 -158 -487 -159 -496 b -159 -355 -159 -398 -159 -379 b -159 -227 -159 -284 -159 -227 b -205 -238 -159 -227 -180 -232 b -250 -249 -230 -244 -250 -249 b -251 -386 -251 -249 -251 -311 b -252 -525 -251 -521 -251 -522 b -272 -538 -255 -534 -264 -538 b -287 -532 -277 -538 -283 -536 b -293 -452 -292 -527 -293 -536 b -293 -391 -293 -436 -293 -415 b -294 -260 -293 -269 -293 -260 b -294 -260 -294 -260 -294 -260 b -348 -272 -306 -264 -345 -272 b -368 -259 -357 -272 -365 -267 b -369 -209 -369 -257 -369 -233 b -368 -159 -369 -185 -369 -162 b -323 -139 -364 -149 -362 -148 l -293 -131 l -293 -22 b -294 87 -293 80 -293 87 b -294 87 -294 87 -294 87 b -348 75 -306 84 -345 75 b -368 88 -357 75 -365 80 b -369 138 -369 91 -369 114 b -368 188 -369 162 -369 186 b -323 209 -364 198 -362 199 l -293 216 l -293 349 b -292 486 -293 481 -293 482 b -272 499 -288 494 -280 499 b -257 493 -266 499 -261 497 b -251 414 -251 487 -251 496 b -251 354 -251 398 -251 378 b -251 226 -251 284 -251 226 b -205 238 -250 226 -230 231 b -159 249 -180 244 -159 249 b -159 385 -159 249 -159 310 b -157 525 -159 521 -159 522 b -146 537 -156 530 -151 535 z m -159 11 b -159 120 -159 98 -159 120 l -159 120 b -175 116 -160 120 -167 119 b -221 105 -184 114 -204 109 l -251 98 l -251 -12 b -251 -121 -251 -72 -251 -121 b -205 -110 -250 -121 -230 -116 b -159 -99 -180 -104 -159 -99 b -159 11 -159 -99 -159 -49 z m 89 517 b 97 519 92 518 94 519 b 117 505 106 519 114 513 b 119 376 119 502 119 501 l 119 249 l 145 258 b 176 267 169 266 172 267 b 177 267 176 267 177 267 b 196 255 186 267 192 263 l 197 252 l 197 205 b 197 181 197 195 197 187 b 193 149 197 153 197 153 b 152 131 190 144 187 143 l 119 120 l 119 10 b 119 -100 119 -62 119 -100 b 145 -91 120 -100 131 -96 b 173 -82 159 -86 171 -82 b 176 -81 174 -81 175 -81 b 196 -94 185 -81 193 -87 b 198 -151 197 -97 198 -125 b 197 -194 198 -172 197 -192 b 153 -218 193 -203 192 -204 l 119 -230 l 119 -367 l 118 -504 l 117 -507 b 97 -519 113 -514 105 -519 b 82 -512 92 -519 87 -517 b 76 -434 77 -507 76 -516 b 76 -374 76 -418 76 -398 b 76 -245 76 -303 76 -245 b 52 -254 76 -245 65 -249 b 19 -263 34 -260 25 -263 b 6 -257 13 -263 10 -261 b 0 -214 0 -251 0 -253 b 0 -200 0 -210 0 -205 b 0 -188 0 -196 0 -192 b 6 -143 0 -147 0 -149 b 46 -126 10 -139 10 -139 l 76 -115 l 76 -5 b 76 106 76 56 76 106 b 51 98 76 106 64 102 b 18 89 34 92 25 89 b 6 95 13 89 10 91 b 0 139 0 101 0 99 b 0 153 0 143 0 148 b 0 179 0 163 0 172 b 44 225 0 215 3 211 l 76 236 l 76 369 b 78 505 76 501 76 502 b 89 517 80 510 85 515 z "},vd7:{x_min:0,x_max:430.75,ha:360,o:"m 283 633 b 291 634 286 634 289 634 b 311 621 300 634 308 629 b 313 505 313 618 313 617 b 313 393 313 443 313 393 b 378 425 313 393 343 407 l 443 458 l 448 458 b 449 458 449 458 449 458 b 471 437 462 458 471 448 b 469 429 471 434 470 432 b 387 382 466 421 469 423 l 313 344 l 313 247 l 313 150 l 315 152 b 433 201 353 184 394 201 b 479 193 448 201 464 198 b 549 86 524 177 549 135 b 526 1 549 59 541 29 b 395 -143 504 -39 475 -71 b 316 -214 351 -182 341 -191 b 292 -229 302 -228 300 -229 b 272 -216 283 -229 275 -224 b 271 55 271 -212 271 -212 b 270 323 271 203 270 323 b 205 291 270 323 241 308 l 140 258 l 135 258 b 134 258 135 258 134 258 b 112 279 121 258 112 267 b 114 287 112 281 113 284 b 196 334 117 295 114 293 l 271 371 l 271 495 b 272 621 271 617 271 618 b 283 633 274 626 279 631 z m 404 133 b 391 134 400 134 395 134 b 384 134 388 134 386 134 b 318 88 358 130 335 114 l 313 81 l 313 -37 l 313 -156 l 316 -152 b 439 83 391 -71 439 22 l 439 84 b 404 133 439 115 430 128 z m -8 633 l -8 633 b 0 634 -6 634 -3 634 b 20 621 8 634 17 629 b 21 384 21 618 21 617 l 21 150 l 24 152 b 141 201 62 184 102 201 b 187 193 157 201 172 198 b 257 86 232 177 257 135 b 234 1 257 59 250 29 b 103 -143 212 -39 183 -71 b 24 -214 60 -182 49 -191 b 0 -229 10 -228 8 -229 b -20 -216 -9 -229 -17 -224 l -21 -212 l -21 203 l -21 618 l -20 621 b -8 633 -18 626 -13 631 z m 113 133 l 113 133 b 99 134 109 134 103 134 b 93 134 97 134 94 134 b 26 88 66 130 43 114 l 21 81 l 21 -37 l 21 -156 l 25 -152 b 148 83 99 -71 148 22 l 148 84 b 113 133 148 115 138 128 z "}},cssFontWeight:"normal",ascender:1903,underlinePosition:-125,cssFontStyle:"normal",boundingBox:{yMin:-2065.375,xMin:-695.53125,yMax:1901.578125,xMax:1159.671875},resolution:1e3,descender:-2066,familyName:"VexFlow-18",lineHeight:4093,underlineThickness:50};function w(e,t,n,i,r,a){var s,o,u,l=0;function c(){return t+e[l++]*i}function h(){return n+e[l++]*r}for(;l<e.length;)switch(s=e[l++]){case"m":case"l":a[s](c(),h());break;case"q":o=c(),u=h(),a.q(c(),h(),o,u);break;case"b":o=c(),u=h(),a.b(c(),h(),c(),h(),o,u)}}var P=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","Glyph"),a.code=e,a.point=i,a.options={cache:!0,font:M},a.metrics=null,a.x_shift=0,a.y_shift=0,a.originShift={x:0,y:0},r?a.setOptions(r):a.reset(),a}return y(n,[{key:"setOptions",value:function(e){i.Merge(this.options,e),this.reset()}},{key:"setPoint",value:function(e){return this.point=e,this}},{key:"setStave",value:function(e){return this.stave=e,this}},{key:"setXShift",value:function(e){return this.x_shift=e,this}},{key:"setYShift",value:function(e){return this.y_shift=e,this}},{key:"reset",value:function(){this.scale=72*this.point/(100*this.options.font.resolution),this.metrics=n.loadMetrics(this.options.font,this.code,this.options.cache),this.bbox=n.getOutlineBoundingBox(this.metrics.outline,this.scale,0,0)}},{key:"getMetrics",value:function(){if(!this.metrics)throw new i.RuntimeError("BadGlyph","Glyph ".concat(this.code," is not initialized."));return{x_min:this.metrics.x_min*this.scale,x_max:this.metrics.x_max*this.scale,width:this.bbox.getW(),height:this.bbox.getH()}}},{key:"setOriginX",value:function(e){var t=this.bbox,n=(e-Math.abs(t.getX()/t.getW()))*t.getW();this.originShift.x=-n}},{key:"setOriginY",value:function(e){var t=this.bbox,n=(e-Math.abs(t.getY()/t.getH()))*t.getH();this.originShift.y=-n}},{key:"setOrigin",value:function(e,t){this.setOriginX(e),this.setOriginY(t)}},{key:"render",value:function(e,t,r){if(!this.metrics)throw new i.RuntimeError("BadGlyph","Glyph ".concat(this.code," is not initialized."));var a=this.metrics.outline,s=this.scale;this.setRendered(),this.applyStyle(e),n.renderOutline(e,a,s,t+this.originShift.x,r+this.originShift.y),this.restoreStyle(e)}},{key:"renderToStave",value:function(e){if(this.checkContext(),!this.metrics)throw new i.RuntimeError("BadGlyph","Glyph ".concat(this.code," is not initialized."));if(!this.stave)throw new i.RuntimeError("GlyphError","No valid stave");var t=this.metrics.outline,r=this.scale;this.setRendered(),this.applyStyle(),n.renderOutline(this.context,t,r,e+this.x_shift,this.stave.getYForGlyphs()+this.y_shift),this.restoreStyle()}}],[{key:"loadMetrics",value:function(e,t,n){var r=e.glyphs[t];if(!r)throw new i.RERR("BadGlyph","Glyph ".concat(t," does not exist in font."));var a,s=r.x_min,o=r.x_max,u=r.ha;if(r.o)return n?r.cached_outline?a=r.cached_outline:(a=r.o.split(" "),r.cached_outline=a):(r.cached_outline&&delete r.cached_outline,a=r.o.split(" ")),{x_min:s,x_max:o,ha:u,outline:a};throw new i.RERR("BadGlyph","Glyph ".concat(t," has no outline defined."))}},{key:"renderGlyph",value:function(e,t,i,r,a,s){var o=72*r/(100*M.resolution),u=n.loadMetrics(M,a,!s);n.renderOutline(e,u.outline,o,t,i)}},{key:"renderOutline",value:function(e,t,n,i,r){e.beginPath(),e.moveTo(i,r),w(t,i,r,n,-n,{m:e.moveTo.bind(e),l:e.lineTo.bind(e),q:e.quadraticCurveTo.bind(e),b:e.bezierCurveTo.bind(e)}),e.fill()}},{key:"getOutlineBoundingBox",value:function(e,t,n,i){var r=new E;return w(e,n,i,t,-t,{m:r.addPoint.bind(r),l:r.addPoint.bind(r),q:r.addQuadraticCurve.bind(r),b:r.addBezierCurve.bind(r)}),new k(r.x1,r.y1,r.width(),r.height())}}]),n}(_),T={STEM_WIDTH:1.5,STEM_HEIGHT:35,STAVE_LINE_THICKNESS:1,RESOLUTION:16384,DEFAULT_NOTATION_FONT_SCALE:39,DEFAULT_TABLATURE_FONT_SCALE:39,SLASH_NOTEHEAD_WIDTH:15,TEXT_HEIGHT_OFFSET_HACK:1,IsKerned:!0,clefProperties:function(e){if(!e)throw new i.RERR("BadArgument","Invalid clef: "+e);var t=T.clefProperties.values[e];if(!t)throw new i.RERR("BadArgument","Invalid clef: "+e);return t}};T.clefProperties.values={treble:{line_shift:0},bass:{line_shift:6},tenor:{line_shift:4},alto:{line_shift:3},soprano:{line_shift:1},percussion:{line_shift:0},"mezzo-soprano":{line_shift:2},"baritone-c":{line_shift:5},"baritone-f":{line_shift:5},subbass:{line_shift:7},french:{line_shift:-1}},T.keyProperties=function(e,t,n){void 0===t&&(t="treble");var r={octave_shift:0};"object"==typeof n&&i.Merge(r,n);var a=e.split("/");if(a.length<2)throw new i.RERR("BadArguments","Key must have note + octave and an optional glyph: ".concat(e));var s=a[0].toUpperCase(),o=T.keyProperties.note_values[s];if(!o)throw new i.RERR("BadArguments","Invalid key name: "+s);o.octave&&(a[1]=o.octave);var u=parseInt(a[1],10),l=(7*(u+=-1*r.octave_shift)-28+o.index)/2,c=0;(l+=T.clefProperties(t).line_shift)<=0&&2*l%2==0&&(c=1),l>=6&&2*l%2==0&&(c=-1);var h=void 0!==o.int_val?12*u+o.int_val:null,d=o.code,f=o.shift_right,p={};if(a.length>2&&a[2]){var v=a[2].toUpperCase();p=T.keyProperties.customNoteHeads[v]||{}}return m({key:s,octave:u,line:l,int_value:h,accidental:o.accidental,code:d,stroke:c,shift_right:f,displaced:!1},p)},T.keyProperties.note_values={C:{index:0,int_val:0,accidental:null},CN:{index:0,int_val:0,accidental:"n"},"C#":{index:0,int_val:1,accidental:"#"},"C##":{index:0,int_val:2,accidental:"##"},CB:{index:0,int_val:-1,accidental:"b"},CBB:{index:0,int_val:-2,accidental:"bb"},D:{index:1,int_val:2,accidental:null},DN:{index:1,int_val:2,accidental:"n"},"D#":{index:1,int_val:3,accidental:"#"},"D##":{index:1,int_val:4,accidental:"##"},DB:{index:1,int_val:1,accidental:"b"},DBB:{index:1,int_val:0,accidental:"bb"},E:{index:2,int_val:4,accidental:null},EN:{index:2,int_val:4,accidental:"n"},"E#":{index:2,int_val:5,accidental:"#"},"E##":{index:2,int_val:6,accidental:"##"},EB:{index:2,int_val:3,accidental:"b"},EBB:{index:2,int_val:2,accidental:"bb"},F:{index:3,int_val:5,accidental:null},FN:{index:3,int_val:5,accidental:"n"},"F#":{index:3,int_val:6,accidental:"#"},"F##":{index:3,int_val:7,accidental:"##"},FB:{index:3,int_val:4,accidental:"b"},FBB:{index:3,int_val:3,accidental:"bb"},G:{index:4,int_val:7,accidental:null},GN:{index:4,int_val:7,accidental:"n"},"G#":{index:4,int_val:8,accidental:"#"},"G##":{index:4,int_val:9,accidental:"##"},GB:{index:4,int_val:6,accidental:"b"},GBB:{index:4,int_val:5,accidental:"bb"},A:{index:5,int_val:9,accidental:null},AN:{index:5,int_val:9,accidental:"n"},"A#":{index:5,int_val:10,accidental:"#"},"A##":{index:5,int_val:11,accidental:"##"},AB:{index:5,int_val:8,accidental:"b"},ABB:{index:5,int_val:7,accidental:"bb"},B:{index:6,int_val:11,accidental:null},BN:{index:6,int_val:11,accidental:"n"},"B#":{index:6,int_val:12,accidental:"#"},"B##":{index:6,int_val:13,accidental:"##"},BB:{index:6,int_val:10,accidental:"b"},BBB:{index:6,int_val:9,accidental:"bb"},R:{index:6,int_val:9,rest:!0},X:{index:6,accidental:"",octave:4,code:"v3e",shift_right:5.5}},T.keyProperties.customNoteHeads={D0:{code:"v27",shift_right:0,stem_up_x_offset:0,stem_down_x_offset:0,stem_up_y_offset:-1,stem_down_y_offset:0},D1:{code:"v2d",shift_right:-.5},D2:{code:"v22",shift_right:-.5},D3:{code:"v70",shift_right:-.5},T0:{code:"v49",shift_right:-2,stem_up_y_offset:-4,stem_down_y_offset:4},T1:{code:"v93",shift_right:.5,stem_up_y_offset:-4,stem_down_y_offset:4},T2:{code:"v40",shift_right:.5,stem_up_y_offset:-4,stem_down_y_offset:4},T3:{code:"v7d",shift_right:.5,stem_up_y_offset:-4,stem_down_y_offset:4},X0:{code:"v92",stem_up_x_offset:-2,stem_down_x_offset:0,stem_up_y_offset:4,stem_down_y_offset:4},X1:{code:"v95",shift_right:-.5,stem_up_y_offset:4,stem_down_y_offset:4},X2:{code:"v3e",shift_right:.5,stem_up_y_offset:4,stem_down_y_offset:4},X3:{code:"v3b",shift_right:0,stem_up_x_offset:-1.2,stem_down_x_offset:0,stem_up_y_offset:-1,stem_down_y_offset:2},S1:{code:"vd3",shift_right:0},S2:{code:"vd2",shift_right:0},R1:{code:"vd5",shift_right:0},R2:{code:"vd4",shift_right:0}},T.integerToNote=function(e){if(void 0===e)throw new i.RERR("BadArguments","Undefined integer for integerToNote");if(e<-2)throw new i.RERR("BadArguments","integerToNote requires integer > -2: ".concat(e));var t=T.integerToNote.table[e];if(!t)throw new i.RERR("BadArguments","Unknown note value for integer: ".concat(e));return t},T.integerToNote.table={0:"C",1:"C#",2:"D",3:"D#",4:"E",5:"F",6:"F#",7:"G",8:"G#",9:"A",10:"A#",11:"B"},T.tabToGlyph=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=null,i=0,r=0;if("X"===e.toString().toUpperCase()){var a=new P("v7f",T.DEFAULT_TABLATURE_FONT_SCALE).getMetrics();n="v7f",i=a.width,r=-a.height/2}else i=T.textWidth(e.toString());return{text:e,code:n,getWidth:function(){return i*t},shift_y:r}},T.textWidth=function(e){return 7*e.toString().length},T.articulationCodes=function(e){return T.articulationCodes.articulations[e]},T.articulationCodes.articulations={"a.":{code:"v23",between_lines:!0},av:{code:"v28",between_lines:!0},"a>":{code:"v42",between_lines:!0},"a-":{code:"v25",between_lines:!0},"a^":{code:"va",between_lines:!1},"a+":{code:"v8b",between_lines:!1},ao:{code:"v94",between_lines:!1},ah:{code:"vb9",between_lines:!1},"a@a":{code:"v43",between_lines:!1},"a@u":{code:"v5b",between_lines:!1},"a|":{code:"v75",between_lines:!1},am:{code:"v97",between_lines:!1},"a,":{code:"vb3",between_lines:!1}},T.accidentalCodes=function(e){return T.accidentalCodes.accidentals[e]},T.accidentalCodes.accidentals={"#":{code:"v18",parenRightPaddingAdjustment:-1},"##":{code:"v7f",parenRightPaddingAdjustment:-1},b:{code:"v44",parenRightPaddingAdjustment:-2},bb:{code:"v26",parenRightPaddingAdjustment:-2},n:{code:"v4e",parenRightPaddingAdjustment:-1},"{":{code:"v9c",parenRightPaddingAdjustment:-1},"}":{code:"v84",parenRightPaddingAdjustment:-1},db:{code:"v9e",parenRightPaddingAdjustment:-1},d:{code:"vab",parenRightPaddingAdjustment:0},bbs:{code:"v90",parenRightPaddingAdjustment:-1},"++":{code:"v51",parenRightPaddingAdjustment:-1},"+":{code:"v78",parenRightPaddingAdjustment:-1},"+-":{code:"v8d",parenRightPaddingAdjustment:-1},"++-":{code:"v7a",parenRightPaddingAdjustment:-1},bs:{code:"vb7",parenRightPaddingAdjustment:-1},bss:{code:"v39",parenRightPaddingAdjustment:-1},o:{code:"vd0",parenRightPaddingAdjustment:-1},k:{code:"vd1",parenRightPaddingAdjustment:-1},ashs:{code:"vd6",parenRightPaddingAdjustment:-1},afhf:{code:"vd7",parenRightPaddingAdjustment:-1}},T.accidentalColumnsTable={1:{a:[1],b:[1]},2:{a:[1,2]},3:{a:[1,3,2],b:[1,2,1],second_on_bottom:[1,2,3]},4:{a:[1,3,4,2],b:[1,2,3,1],spaced_out_tetrachord:[1,2,1,2]},5:{a:[1,3,5,4,2],b:[1,2,4,3,1],spaced_out_pentachord:[1,2,3,2,1],very_spaced_out_pentachord:[1,2,1,2,1]},6:{a:[1,3,5,6,4,2],b:[1,2,4,5,3,1],spaced_out_hexachord:[1,3,2,1,3,2],very_spaced_out_hexachord:[1,2,1,2,1,2]}},T.ornamentCodes=function(e){return T.ornamentCodes.ornaments[e]},T.ornamentCodes.ornaments={mordent:{code:"v1e"},mordent_inverted:{code:"v45"},turn:{code:"v72"},turn_inverted:{code:"v33"},tr:{code:"v1f"},upprall:{code:"v60"},downprall:{code:"vb4"},prallup:{code:"v6d"},pralldown:{code:"v2c"},upmordent:{code:"v29"},downmordent:{code:"v68"},lineprall:{code:"v20"},prallprall:{code:"v86"}},T.keySignature=function(e){var t=T.keySignature.keySpecs[e];if(!t)throw new i.RERR("BadKeySignature","Bad key signature spec: '".concat(e,"'"));if(!t.acc)return[];for(var n=T.keySignature.accidentalList(t.acc),r=[],a=0;a<t.num;++a){var s=n[a];r.push({type:t.acc,line:s})}return r},T.keySignature.keySpecs={C:{acc:null,num:0},Am:{acc:null,num:0},F:{acc:"b",num:1},Dm:{acc:"b",num:1},Bb:{acc:"b",num:2},Gm:{acc:"b",num:2},Eb:{acc:"b",num:3},Cm:{acc:"b",num:3},Ab:{acc:"b",num:4},Fm:{acc:"b",num:4},Db:{acc:"b",num:5},Bbm:{acc:"b",num:5},Gb:{acc:"b",num:6},Ebm:{acc:"b",num:6},Cb:{acc:"b",num:7},Abm:{acc:"b",num:7},G:{acc:"#",num:1},Em:{acc:"#",num:1},D:{acc:"#",num:2},Bm:{acc:"#",num:2},A:{acc:"#",num:3},"F#m":{acc:"#",num:3},E:{acc:"#",num:4},"C#m":{acc:"#",num:4},B:{acc:"#",num:5},"G#m":{acc:"#",num:5},"F#":{acc:"#",num:6},"D#m":{acc:"#",num:6},"C#":{acc:"#",num:7},"A#m":{acc:"#",num:7}},T.unicode={sharp:String.fromCharCode(parseInt("266F",16)),flat:String.fromCharCode(parseInt("266D",16)),natural:String.fromCharCode(parseInt("266E",16)),triangle:String.fromCharCode(parseInt("25B3",16)),"o-with-slash":String.fromCharCode(parseInt("00F8",16)),degrees:String.fromCharCode(parseInt("00B0",16)),circle:String.fromCharCode(parseInt("25CB",16))},T.keySignature.accidentalList=function(e){return{b:[2,.5,2.5,1,3,1.5,3.5],"#":[0,1.5,-.5,1,2.5,.5,2]}[e]},T.parseNoteDurationString=function(e){if("string"!=typeof e)return null;var t=/(\d*\/?\d+|[a-z])(d*)([nrhms]|$)/.exec(e);if(!t)return null;var n=t[1],i=t[2].length,r=t[3];return 0===r.length&&(r="n"),{duration:n,dots:i,type:r}},T.parseNoteStruct=function(e){var t=e.duration,n=T.parseNoteDurationString(t);if(!n)return null;var i=T.durationToTicks(n.duration);if(null==i)return null;var r=e.type,a=[];if(r){if(!T.getGlyphProps.validTypes[r])return null}else r=n.type||"n",void 0!==e.keys&&e.keys.forEach((function(e,t){var n=e.split("/");n&&3===n.length&&(a[t]=n[2])}));var s=e.dots?e.dots:n.dots;if("number"!=typeof s)return null;for(var o=i,u=0;u<s;u++){if(o<=1)return null;i+=o/=2}return{duration:n.duration,type:r,customTypes:a,dots:s,ticks:i}},T.sanitizeDuration=function(e){var t=T.durationAliases[e];if(void 0!==t&&(e=t),void 0===T.durationToTicks.durations[e])throw new i.RERR("BadArguments","The provided duration is not valid: ".concat(e));return e},T.durationToFraction=function(e){return(new a).parse(T.sanitizeDuration(e))},T.durationToNumber=function(e){return T.durationToFraction(e).value()},T.durationToTicks=function(e){e=T.sanitizeDuration(e);var t=T.durationToTicks.durations[e];return void 0===t?null:t},T.durationToTicks.durations={"1/2":2*T.RESOLUTION,1:T.RESOLUTION/1,2:T.RESOLUTION/2,4:T.RESOLUTION/4,8:T.RESOLUTION/8,16:T.RESOLUTION/16,32:T.RESOLUTION/32,64:T.RESOLUTION/64,128:T.RESOLUTION/128,256:T.RESOLUTION/256},T.durationAliases={w:"1",h:"2",q:"4",b:"256"},T.getGlyphProps=function(e,t){e=T.sanitizeDuration(e);var n=T.getGlyphProps.duration_codes[e];if(void 0===n)return null;t||(t="n");var i=n.type[t];if(void 0===i){var r=T.keyProperties.customNoteHeads[t.toUpperCase()];if(void 0===r)return null;i=m({code_head:r.code},r)}return m(m({},n.common),i)},T.getGlyphProps.validTypes={n:{name:"note"},r:{name:"rest"},h:{name:"harmonic"},m:{name:"muted"},s:{name:"slash"}},T.getGlyphProps.duration_codes={"1/2":{common:{getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"v53",e).getMetrics().width},stem:!1,stem_offset:0,flag:!1,stem_up_extension:-T.STEM_HEIGHT,stem_down_extension:-T.STEM_HEIGHT,tabnote_stem_up_extension:-T.STEM_HEIGHT,tabnote_stem_down_extension:-T.STEM_HEIGHT,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"v53"},h:{code_head:"v59"},m:{code_head:"vf",stem_offset:0},r:{code_head:"v31",rest:!0,position:"B/5",dot_shiftY:.5},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},1:{common:{getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"v1d",e).getMetrics().width},stem:!1,stem_offset:0,flag:!1,stem_up_extension:-T.STEM_HEIGHT,stem_down_extension:-T.STEM_HEIGHT,tabnote_stem_up_extension:-T.STEM_HEIGHT,tabnote_stem_down_extension:-T.STEM_HEIGHT,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"v1d"},h:{code_head:"v46"},m:{code_head:"v92",stem_offset:-3},r:{code_head:"v5c",rest:!0,position:"D/5",dot_shiftY:.5},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},2:{common:{getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"v81",e).getMetrics().width},stem:!0,stem_offset:0,flag:!1,stem_up_extension:0,stem_down_extension:0,tabnote_stem_up_extension:0,tabnote_stem_down_extension:0,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"v81"},h:{code_head:"v2d"},m:{code_head:"v95",stem_offset:-3},r:{code_head:"vc",stem:!1,rest:!0,position:"B/4",dot_shiftY:-.5},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},4:{common:{getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!1,stem_up_extension:0,stem_down_extension:0,tabnote_stem_up_extension:0,tabnote_stem_down_extension:0,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e",stem_offset:-3},r:{code_head:"v7c",stem:!1,rest:!0,position:"B/4",dot_shiftY:-.5,line_above:1.5,line_below:1.5},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},8:{common:{getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!0,beam_count:1,code_flag_upstem:"v54",code_flag_downstem:"v9a",stem_up_extension:0,stem_down_extension:0,tabnote_stem_up_extension:0,tabnote_stem_down_extension:0,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e"},r:{code_head:"va5",stem:!1,flag:!1,rest:!0,position:"B/4",dot_shiftY:-.5,line_above:1,line_below:1},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},16:{common:{beam_count:2,getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!0,code_flag_upstem:"v3f",code_flag_downstem:"v8f",stem_up_extension:0,stem_down_extension:0,tabnote_stem_up_extension:0,tabnote_stem_down_extension:0,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e"},r:{code_head:"v3c",stem:!1,flag:!1,rest:!0,position:"B/4",dot_shiftY:-.5,line_above:1,line_below:2},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},32:{common:{beam_count:3,getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!0,code_flag_upstem:"v47",code_flag_downstem:"v2a",stem_up_extension:9,stem_down_extension:9,tabnote_stem_up_extension:8,tabnote_stem_down_extension:5,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e"},r:{code_head:"v55",stem:!1,flag:!1,rest:!0,position:"B/4",dot_shiftY:-1.5,line_above:2,line_below:2},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},64:{common:{beam_count:4,getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!0,code_flag_upstem:"va9",code_flag_downstem:"v58",stem_up_extension:13,stem_down_extension:13,tabnote_stem_up_extension:12,tabnote_stem_down_extension:9,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e"},r:{code_head:"v38",stem:!1,flag:!1,rest:!0,position:"B/4",dot_shiftY:-1.5,line_above:2,line_below:3},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}},128:{common:{beam_count:5,getWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.DEFAULT_NOTATION_FONT_SCALE;return new P(this.code_head||"vb",e).getMetrics().width},stem:!0,stem_offset:0,flag:!0,code_flag_upstem:"v9b",code_flag_downstem:"v30",stem_up_extension:22,stem_down_extension:22,tabnote_stem_up_extension:21,tabnote_stem_down_extension:18,dot_shiftY:0,line_above:0,line_below:0},type:{n:{code_head:"vb"},h:{code_head:"v22"},m:{code_head:"v3e"},r:{code_head:"vaa",stem:!1,flag:!1,rest:!0,position:"B/4",dot_shiftY:1.5,line_above:3,line_below:3},s:{getWidth:function(){return T.SLASH_NOTEHEAD_WIDTH},position:"B/4"}}}},T.smufl={},T.smufl.to_code_points={bracketTop:"v1b",bracketBottom:"v10",barlineTick:"v6f",segno:"v8c",coda:"v4d",gClef:"v83",cClef:"vad",fClef:"v79",unpitchedPercussionClef1:"v59","6stringTabClef":"v2f",timeSig0:"v0",timeSig1:"v1",timeSig2:"v2",timeSig3:"v3",timeSig4:"v4",timeSig5:"v5",timeSig6:"v6",timeSig7:"v7",timeSig8:"v8",timeSig9:"v9",timeSigCommon:"v41",timeSigCutCommon:"vb6",noteheadDoubleWhole:"v53",noteheadWhole:"v1d",noteheadHalf:"v81",noteheadBlack:"vb",noteheadXWhole:"v92",noteheadXHalf:"v95",noteheadXBlack:"v3e",noteheadCircleX:"v3b",noteheadTriangleUpWhole:"v49",noteheadTriangleUpHalf:"v93",noteheadTriangleUpBlack:"v40",noteheadDiamondWhole:"v46",noteheadDiamondHalf:"v2d",noteheadDiamondBlack:"v22",augmentationDot:"v23",tremolo1:"v74",flag8thUp:"v54",flag8thDown:"v9a",flag16thUp:"v3f",flag16thDown:"v8f",flag32ndUp:"v47",flag32ndDown:"v2a",flag64thUp:"va9",flag64thDown:"v58",flag128thUp:"v9b",flag128thDown:"v30",accidentalFlat:"v44",accidentalNatural:"v4e",accidentalSharp:"v18",accidentalDoubleSharp:"v7f",accidentalDoubleFlat:"v26",accidentalParensLeft:"v9c",accidentalParensRight:"v84",accidentalQuarterToneFlatStein:"vab",accidentalThreeQuarterTonesFlatZimmermann:"v9e",accidentalQuarterToneSharpStein:"v78",accidentalThreeQuarterTonesSharpStein:"v51",accidentalBuyukMucennebFlat:"v39",accidentalBakiyeFlat:"vb7",accidentalKomaSharp:"v51",accidentalKucukMucennebSharp:"v8d",accidentalKoron:"vd1",accidentalSori:"vd0",articAccentAbove:"v42",articAccentBelow:"v42",articTenutoAbove:"v25",articTenutoBelow:"v25",articStaccatoAbove:"v23",articStaccatoBelow:"v23",articStaccatissimoAbove:"v28",articMarcatoAbove:"va",fermataAbove:"v43",fermataBelow:"v5b",breathMarkComma:"v6c",breathMarkUpbow:"v8a",caesura:"v34",caesuraCurved:"v4b",restMaxima:"v59",restDoubleWhole:"v31",restWhole:"v5c",restHalf:"vc",restQuarter:"v7c",rest8th:"va5",rest16th:"v3c",rest32nd:"v55",rest64th:"v38",rest128th:"vaa",dynamicPiano:"vbf",dynamicMezzo:"v62",dynamicForte:"vba",dynamicRinforzando:"vba",dynamicSforzando:"v4a",dynamicZ:"v80",ornamentTrill:"v1f",ornamentTurn:"v72",ornamentTurnSlash:"v33",ornamentMordent:"v45",ornamentMordentInverted:"v1e",ornamentTremblement:"v86",ornamentPrecompAppoggTrill:"v20",ornamentPrecompSlideTrillDAnglebert:"v60",ornamentPrecompSlideTrillBach:"v29",ornamentPrecompTrillSuffixDandrieu:"v6d",ornamentPrecompDoubleCadenceUpperPrefix:"vb4",ornamentPrecompDoubleCadenceUpperPrefixTurn:"v68",ornamentPrecompTrillLowerSuffix:"v2c",stringsDownBow:"v94",stringsUpBow:"v75",stringsHarmonic:"vb9",pluckedSnapPizzicatoAbove:"v94",pluckedLeftHandPizzicato:"v8b",keyboardPedalPed:"v36",keyboardPedalUp:"v5d",pictChokeCymbal:"vb3",wiggleArpeggiatoUp:"va3",arrowheadBlackUp:"vc3",arrowheadBlackDown:"v52"},T.TIME4_4={num_beats:4,beat_value:4,resolution:T.RESOLUTION};var C=function(){function e(t){g(this,e),this.vexFlowCanvasContext=t,t.canvas?this.canvas=t.canvas:this.canvas={width:e.WIDTH,height:e.HEIGHT}}return y(e,[{key:"clear",value:function(){this.vexFlowCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"openGroup",value:function(){}},{key:"closeGroup",value:function(){}},{key:"add",value:function(){}},{key:"setFont",value:function(e,t,n){return this.vexFlowCanvasContext.font=(n||"")+" "+t+"pt "+e,this}},{key:"setRawFont",value:function(e){return this.vexFlowCanvasContext.font=e,this}},{key:"setFillStyle",value:function(e){return this.vexFlowCanvasContext.fillStyle=e,this}},{key:"setBackgroundFillStyle",value:function(e){return this.background_fillStyle=e,this}},{key:"setStrokeStyle",value:function(e){return this.vexFlowCanvasContext.strokeStyle=e,this}},{key:"setShadowColor",value:function(e){return this.vexFlowCanvasContext.shadowColor=e,this}},{key:"setShadowBlur",value:function(e){return this.vexFlowCanvasContext.shadowBlur=e,this}},{key:"setLineWidth",value:function(e){return this.vexFlowCanvasContext.lineWidth=e,this}},{key:"setLineCap",value:function(e){return this.vexFlowCanvasContext.lineCap=e,this}},{key:"setLineDash",value:function(e){return this.vexFlowCanvasContext.lineDash=e,this}},{key:"scale",value:function(e,t){return this.vexFlowCanvasContext.scale(parseFloat(e),parseFloat(t))}},{key:"resize",value:function(e,t){var n,i;return n=this.SanitizeCanvasDims(parseInt(e,10),parseInt(t,10)),e=(i=x(n,2))[0],t=i[1],this.vexFlowCanvasContext.resize(e,t)}},{key:"rect",value:function(e,t,n,i){return this.vexFlowCanvasContext.rect(e,t,n,i)}},{key:"fillRect",value:function(e,t,n,i){return this.vexFlowCanvasContext.fillRect(e,t,n,i)}},{key:"clearRect",value:function(e,t,n,i){return this.vexFlowCanvasContext.clearRect(e,t,n,i)}},{key:"beginPath",value:function(){return this.vexFlowCanvasContext.beginPath()}},{key:"moveTo",value:function(e,t){return this.vexFlowCanvasContext.moveTo(e,t)}},{key:"lineTo",value:function(e,t){return this.vexFlowCanvasContext.lineTo(e,t)}},{key:"bezierCurveTo",value:function(e,t,n,i,r,a){return this.vexFlowCanvasContext.bezierCurveTo(e,t,n,i,r,a)}},{key:"quadraticCurveTo",value:function(e,t,n,i){return this.vexFlowCanvasContext.quadraticCurveTo(e,t,n,i)}},{key:"arc",value:function(e,t,n,i,r,a){return this.vexFlowCanvasContext.arc(e,t,n,i,r,a)}},{key:"glow",value:function(){return this.vexFlowCanvasContext.glow()}},{key:"fill",value:function(){return this.vexFlowCanvasContext.fill()}},{key:"stroke",value:function(){return this.vexFlowCanvasContext.stroke()}},{key:"closePath",value:function(){return this.vexFlowCanvasContext.closePath()}},{key:"measureText",value:function(e){return this.vexFlowCanvasContext.measureText(e)}},{key:"fillText",value:function(e,t,n){return this.vexFlowCanvasContext.fillText(e,t,n)}},{key:"save",value:function(){return this.vexFlowCanvasContext.save()}},{key:"restore",value:function(){return this.vexFlowCanvasContext.restore()}}],[{key:"WIDTH",get:function(){return 600}},{key:"HEIGHT",get:function(){return 400}},{key:"CANVAS_BROWSER_SIZE_LIMIT",get:function(){return 32767}},{key:"SanitizeCanvasDims",value:function(e,t){return Math.max(e,t)>this.CANVAS_BROWSER_SIZE_LIMIT&&(i.W("Canvas dimensions exceed browser limit. Cropping to "+this.CANVAS_BROWSER_SIZE_LIMIT),e>this.CANVAS_BROWSER_SIZE_LIMIT&&(e=this.CANVAS_BROWSER_SIZE_LIMIT),t>this.CANVAS_BROWSER_SIZE_LIMIT&&(t=this.CANVAS_BROWSER_SIZE_LIMIT)),[e,t]}}]),e}(),I=function(){function e(t){g(this,e),this.element=t,this.paper=Raphael(t),this.path="",this.pen={x:0,y:0},this.lineWidth=1,this.state={scale:{x:1,y:1},font_family:"Arial",font_size:8,font_weight:800},this.attributes={"stroke-width":.3,fill:"black",stroke:"black",font:"10pt Arial"},this.background_attributes={"stroke-width":0,fill:"white",stroke:"white",font:"10pt Arial"},this.shadow_attributes={width:0,color:"black"},this.state_stack=[]}return y(e,[{key:"openGroup",value:function(){}},{key:"closeGroup",value:function(){}},{key:"add",value:function(){}},{key:"setFont",value:function(e,t,n){return this.state.font_family=e,this.state.font_size=t,this.state.font_weight=n,this.attributes.font=(this.state.font_weight||"")+" "+this.state.font_size*this.state.scale.x+"pt "+this.state.font_family,this}},{key:"setRawFont",value:function(e){return this.attributes.font=e,this}},{key:"setFillStyle",value:function(e){return this.attributes.fill=e,this}},{key:"setBackgroundFillStyle",value:function(e){return this.background_attributes.fill=e,this.background_attributes.stroke=e,this}},{key:"setStrokeStyle",value:function(e){return this.attributes.stroke=e,this}},{key:"setShadowColor",value:function(e){return this.shadow_attributes.color=e,this}},{key:"setShadowBlur",value:function(e){return this.shadow_attributes.width=e,this}},{key:"setLineWidth",value:function(e){this.attributes["stroke-width"]=e,this.lineWidth=e}},{key:"setLineDash",value:function(){return this}},{key:"setLineCap",value:function(){return this}},{key:"scale",value:function(e,t){return this.state.scale={x:e,y:t},this.attributes.transform="S"+e+","+t+",0,0",this.attributes.scale=e+","+t+",0,0",this.attributes.font=this.state.font_size*this.state.scale.x+"pt "+this.state.font_family,this.background_attributes.transform="S"+e+","+t+",0,0",this.background_attributes.font=this.state.font_size*this.state.scale.x+"pt "+this.state.font_family,this}},{key:"clear",value:function(){this.paper.clear()}},{key:"resize",value:function(e,t){return this.element.style.width=e,this.paper.setSize(e,t),this}},{key:"setViewBox",value:function(e){this.paper.canvas.setAttribute("viewBox",e)}},{key:"rect",value:function(e,t,n,i){return i<0&&(t+=i,i=-i),this.paper.rect(e,t,n-.5,i-.5).attr(this.attributes).attr("fill","none").attr("stroke-width",this.lineWidth),this}},{key:"fillRect",value:function(e,t,n,i){return i<0&&(t+=i,i=-i),this.paper.rect(e,t,n-.5,i-.5).attr(this.attributes),this}},{key:"clearRect",value:function(e,t,n,i){return i<0&&(t+=i,i=-i),this.paper.rect(e,t,n-.5,i-.5).attr(this.background_attributes),this}},{key:"beginPath",value:function(){return this.path="",this.pen.x=0,this.pen.y=0,this}},{key:"moveTo",value:function(e,t){return this.path+="M"+e+","+t,this.pen.x=e,this.pen.y=t,this}},{key:"lineTo",value:function(e,t){return this.path+="L"+e+","+t,this.pen.x=e,this.pen.y=t,this}},{key:"bezierCurveTo",value:function(e,t,n,i,r,a){return this.path+="C"+e+","+t+","+n+","+i+","+r+","+a,this.pen.x=r,this.pen.y=a,this}},{key:"quadraticCurveTo",value:function(e,t,n,i){return this.path+="Q"+e+","+t+","+n+","+i,this.pen.x=n,this.pen.y=i,this}},{key:"arc",value:function(e,t,n,i,r,a){function s(e){for(;e<0;)e+=2*Math.PI;for(;e>2*Math.PI;)e-=2*Math.PI;return e}if((i=s(i))>(r=s(r))){var o=i;i=r,r=o,a=!a}var u=r-i;return u>Math.PI?(this.arcHelper(e,t,n,i,i+u/2,a),this.arcHelper(e,t,n,i+u/2,r,a)):this.arcHelper(e,t,n,i,r,a),this}},{key:"arcHelper",value:function(e,t,n,i,r,a){var s=e+n*Math.cos(i),o=t+n*Math.sin(i),u=e+n*Math.cos(r),l=t+n*Math.sin(r),c=0,h=0;a?(h=1,r-i<Math.PI&&(c=1)):r-i>Math.PI&&(c=1),this.path+="M"+s+","+o+",A"+n+","+n+",0,"+c+","+h+","+u+","+l+"M"+this.pen.x+","+this.pen.y}},{key:"glow",value:function(){var e=this.paper.set();if(this.shadow_attributes.width>0)for(var t=this.shadow_attributes,n=t.width/2,i=1;i<=n;i++)e.push(this.paper.path(this.path).attr({stroke:t.color,"stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/n*i).toFixed(3),opacity:+((t.opacity||.3)/n).toFixed(3),transform:this.attributes.transform,scale:this.attributes.scale}));return e}},{key:"fill",value:function(){var e=this.paper.path(this.path).attr(this.attributes).attr("stroke-width",0);return this.glow(e),this}},{key:"stroke",value:function(){var e=this.lineWidth*(this.state.scale.x+this.state.scale.y)/2,t=this.paper.path(this.path).attr(this.attributes).attr("fill","none").attr("stroke-width",e);return this.glow(t),this}},{key:"closePath",value:function(){return this.path+="Z",this}},{key:"measureText",value:function(e){var t=this.paper.text(0,0,e).attr(this.attributes).attr("fill","none").attr("stroke","none"),n=t.getBBox();return t.remove(),{width:n.width,height:n.height}}},{key:"fillText",value:function(e,t,n){return this.paper.text(t+this.measureText(e).width/2,n-this.state.font_size/(2.25*this.state.scale.y),e).attr(this.attributes),this}},{key:"save",value:function(){return this.state_stack.push({state:{font_family:this.state.font_family},attributes:{font:this.attributes.font,fill:this.attributes.fill,stroke:this.attributes.stroke,"stroke-width":this.attributes["stroke-width"]},shadow_attributes:{width:this.shadow_attributes.width,color:this.shadow_attributes.color}}),this}},{key:"restore",value:function(){var e=this.state_stack.pop();return this.state.font_family=e.state.font_family,this.attributes.font=e.attributes.font,this.attributes.fill=e.attributes.fill,this.attributes.stroke=e.attributes.stroke,this.attributes["stroke-width"]=e.attributes["stroke-width"],this.shadow_attributes.width=e.shadow_attributes.width,this.shadow_attributes.color=e.shadow_attributes.color,this}}]),e}(),A={path:{x:!0,y:!0,width:!0,height:!0},rect:{},text:{width:!0,height:!0}},L={"font-family":!0,"font-weight":!0,"font-style":!0,"font-size":!0};i.Merge(A.rect,L),i.Merge(A.path,L);var O=function(){function e(t){g(this,e),this.element=t,this.svgNS="http://www.w3.org/2000/svg";var n=this.create("svg");this.element.appendChild(n),this.svg=n,this.groups=[this.svg],this.parent=this.svg,this.path="",this.pen={x:NaN,y:NaN},this.lineWidth=1,this.state={scale:{x:1,y:1},"font-family":"Arial","font-size":"8pt","font-weight":"normal"},this.attributes={"stroke-width":.3,fill:"black",stroke:"black","stroke-dasharray":"none","font-family":"Arial","font-size":"10pt","font-weight":"normal","font-style":"normal"},this.background_attributes={"stroke-width":0,fill:"white",stroke:"white","stroke-dasharray":"none","font-family":"Arial","font-size":"10pt","font-weight":"normal","font-style":"normal"},this.shadow_attributes={width:0,color:"black"},this.state_stack=[],this.iePolyfill()}return y(e,[{key:"create",value:function(e){return document.createElementNS(this.svgNS,e)}},{key:"openGroup",value:function(e,t,n){var r=this.create("g");return this.groups.push(r),this.parent.appendChild(r),this.parent=r,e&&r.setAttribute("class",i.Prefix(e)),t&&r.setAttribute("id",i.Prefix(t)),n&&n.pointerBBox&&r.setAttribute("pointer-events","bounding-box"),r}},{key:"closeGroup",value:function(){this.groups.pop(),this.parent=this.groups[this.groups.length-1]}},{key:"add",value:function(e){this.parent.appendChild(e)}},{key:"iePolyfill",value:function(){"undefined"!=typeof navigator&&(this.ie=/MSIE 9/i.test(navigator.userAgent)||/MSIE 10/i.test(navigator.userAgent)||/rv:11\.0/i.test(navigator.userAgent)||/Trident/i.test(navigator.userAgent))}},{key:"setFont",value:function(e,t,n){var r=!1,a=!1,s="normal";"string"==typeof n&&(-1!==n.indexOf("italic")&&(n=n.replace(/italic/g,""),a=!0),-1!==n.indexOf("bold")&&(n=n.replace(/bold/g,""),r=!0),n=n.replace(/ /g,""));var o={"font-family":e,"font-size":t+"pt","font-weight":n=void 0===(n=r?"bold":n)||""===n?"normal":n,"font-style":s=a?"italic":s};return this.fontSize=Number(t),i.Merge(this.attributes,o),i.Merge(this.state,o),this}},{key:"setRawFont",value:function(e){var t=(e=e.trim()).split(" ");return this.attributes["font-family"]=t[1],this.state["font-family"]=t[1],this.attributes["font-size"]=t[0],this.state["font-size"]=t[0],this.fontSize=Number(t[0].match(/\d+/)),this}},{key:"setFillStyle",value:function(e){return this.attributes.fill=e,this}},{key:"setBackgroundFillStyle",value:function(e){return this.background_attributes.fill=e,this.background_attributes.stroke=e,this}},{key:"setStrokeStyle",value:function(e){return this.attributes.stroke=e,this}},{key:"setShadowColor",value:function(e){return this.shadow_attributes.color=e,this}},{key:"setShadowBlur",value:function(e){return this.shadow_attributes.width=e,this}},{key:"setLineWidth",value:function(e){this.attributes["stroke-width"]=e,this.lineWidth=e}},{key:"setLineDash",value:function(e){if("[object Array]"===Object.prototype.toString.call(e))return e=e.join(", "),this.attributes["stroke-dasharray"]=e,this;throw new i.RERR("ArgumentError","lineDash must be an array of integers.")}},{key:"setLineCap",value:function(e){return this.attributes["stroke-linecap"]=e,this}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.element.style.width=e;var n={width:e,height:t};return this.applyAttributes(this.svg,n),this.scale(this.state.scale.x,this.state.scale.y),this}},{key:"scale",value:function(e,t){this.state.scale={x:e,y:t};var n=this.width/e,i=this.height/t;return this.setViewBox(0,0,n,i),this}},{key:"setViewBox",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var i=t[0];this.svg.setAttribute("viewBox",i)}else{var r=t[0]+" "+t[1]+" "+t[2]+" "+t[3];this.svg.setAttribute("viewBox",r)}}},{key:"applyAttributes",value:function(e,t){var n=A[e.nodeName];return Object.keys(t).forEach((function(i){n&&n[i]||e.setAttributeNS(null,i,t[i])})),e}},{key:"clear",value:function(){for(;this.svg.lastChild;)this.svg.removeChild(this.svg.lastChild);this.scale(this.state.scale.x,this.state.scale.y)}},{key:"rect",value:function(e,t,n,r,a){r<0&&(t+=r,r*=-1);var s=this.create("rect");return void 0===a&&(a={fill:"none","stroke-width":this.lineWidth,stroke:this.attributes.stroke}),i.Merge(a,{x:e,y:t,width:n,height:r}),this.applyAttributes(s,a),this.add(s),this}},{key:"fillRect",value:function(e,t,n,i){return i<0&&(t+=i,i*=-1),this.rect(e,t,n,i,this.attributes),this}},{key:"clearRect",value:function(e,t,n,i){return this.rect(e,t,n,i,this.background_attributes),this}},{key:"beginPath",value:function(){return this.path="",this.pen.x=NaN,this.pen.y=NaN,this}},{key:"moveTo",value:function(e,t){return this.path+="M"+e+" "+t,this.pen.x=e,this.pen.y=t,this}},{key:"lineTo",value:function(e,t){return this.path+="L"+e+" "+t,this.pen.x=e,this.pen.y=t,this}},{key:"bezierCurveTo",value:function(e,t,n,i,r,a){return this.path+="C"+e+" "+t+","+n+" "+i+","+r+" "+a,this.pen.x=r,this.pen.y=a,this}},{key:"quadraticCurveTo",value:function(e,t,n,i){return this.path+="Q"+e+" "+t+","+n+" "+i,this.pen.x=n,this.pen.y=i,this}},{key:"arc",value:function(e,t,n,i,r,a){function s(e){for(;e<0;)e+=2*Math.PI;for(;e>2*Math.PI;)e-=2*Math.PI;return e}if((i=s(i))>(r=s(r))){var o=i;i=r,r=o,a=!a}var u=r-i;return u>Math.PI?(this.arcHelper(e,t,n,i,i+u/2,a),this.arcHelper(e,t,n,i+u/2,r,a)):this.arcHelper(e,t,n,i,r,a),this}},{key:"arcHelper",value:function(e,t,n,i,r,a){var s=e+n*Math.cos(i),o=t+n*Math.sin(i),u=e+n*Math.cos(r),l=t+n*Math.sin(r),c=0,h=0;a?(h=1,r-i<Math.PI&&(c=1)):r-i>Math.PI&&(c=1),this.path+="M"+s+" "+o+" A"+n+" "+n+" 0 "+c+" "+h+" "+u+" "+l,isNaN(this.pen.x)||isNaN(this.pen.y)||(this.peth+="M"+this.pen.x+" "+this.pen.y)}},{key:"closePath",value:function(){return this.path+="Z",this}},{key:"glow",value:function(){if(this.shadow_attributes.width>0)for(var e=this.shadow_attributes,t=e.width/2,n=1;n<=t;n++){var i={stroke:e.color,"stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(.4*e.width/t*n).toFixed(3),opacity:+((e.opacity||.3)/t).toFixed(3)},r=this.create("path");i.d=this.path,this.applyAttributes(r,i),this.add(r)}return this}},{key:"fill",value:function(e){this.glow();var t=this.create("path"),n=e;return void 0===e?(i.Merge(e={},this.attributes),e.stroke="none",n=e):(n=e,i.Merge(n,this.attributes),e.class&&(n.class=e.class),e.id&&(n.id=e.id)),e.d=this.path,this.applyAttributes(t,e),this.add(t),this}},{key:"stroke",value:function(e){this.glow();var t=this.create("path"),n={};return i.Merge(n,this.attributes),e&&i.Merge(n,e),n.fill="none",n["stroke-width"]=this.lineWidth,n.d=this.path,this.applyAttributes(t,n),this.add(t),this}},{key:"measureText",value:function(e){var t=this.create("text");if("function"!=typeof t.getBBox)return{x:0,y:0,width:0,height:0};t.textContent=e,this.applyAttributes(t,this.attributes),this.svg.appendChild(t);var n=t.getBBox();return this.ie&&""!==e&&"italic"===this.attributes["font-style"]&&(n=this.ieMeasureTextFix(n,e)),this.svg.removeChild(t),n}},{key:"ieMeasureTextFix",value:function(e){var t=1.196*Number(this.fontSize)+1.9598,n=e.width-t,i=e.height-1.5;return{x:e.x,y:e.y,width:n,height:i}}},{key:"fillText",value:function(e,t,n){if(e&&!(e.length<=0)){var r={};i.Merge(r,this.attributes),r.stroke="none",r.x=t,r.y=n;var a=this.create("text");a.textContent=e,this.applyAttributes(a,r),this.add(a)}}},{key:"save",value:function(){return this.state_stack.push({state:{"font-family":this.state["font-family"],"font-weight":this.state["font-weight"],"font-style":this.state["font-style"],"font-size":this.state["font-size"],scale:this.state.scale},attributes:{"font-family":this.attributes["font-family"],"font-weight":this.attributes["font-weight"],"font-style":this.attributes["font-style"],"font-size":this.attributes["font-size"],fill:this.attributes.fill,stroke:this.attributes.stroke,"stroke-width":this.attributes["stroke-width"],"stroke-dasharray":this.attributes["stroke-dasharray"]},shadow_attributes:{width:this.shadow_attributes.width,color:this.shadow_attributes.color},lineWidth:this.lineWidth}),this}},{key:"restore",value:function(){var e=this.state_stack.pop();return this.state["font-family"]=e.state["font-family"],this.state["font-weight"]=e.state["font-weight"],this.state["font-style"]=e.state["font-style"],this.state["font-size"]=e.state["font-size"],this.state.scale=e.state.scale,this.attributes["font-family"]=e.attributes["font-family"],this.attributes["font-weight"]=e.attributes["font-weight"],this.attributes["font-style"]=e.attributes["font-style"],this.attributes["font-size"]=e.attributes["font-size"],this.attributes.fill=e.attributes.fill,this.attributes.stroke=e.attributes.stroke,this.attributes["stroke-width"]=e.attributes["stroke-width"],this.attributes["stroke-dasharray"]=e.attributes["stroke-dasharray"],this.shadow_attributes.width=e.shadow_attributes.width,this.shadow_attributes.color=e.shadow_attributes.color,this.lineWidth=e.lineWidth,this}}]),e}(),R=null,N=function(){function e(t,n){if(g(this,e),this.elementId=t,!this.elementId)throw new i.RERR("BadArgument","Invalid id for renderer.");if(this.element=document.getElementById(t),this.element||(this.element=t),this.ctx=null,this.paper=null,this.backend=n,this.backend===e.Backends.CANVAS){if(!this.element.getContext)throw new i.RERR("BadElement","Can't get canvas context from element: ".concat(t));this.ctx=e.bolsterCanvasContext(this.element.getContext("2d",{willReadFrequently:!0}))}else if(this.backend===e.Backends.RAPHAEL)this.ctx=new I(this.element);else{if(this.backend!==e.Backends.SVG)throw new i.RERR("InvalidBackend","No support for backend: ".concat(this.backend));this.ctx=new O(this.element)}}return y(e,[{key:"resize",value:function(t,n){if(this.backend===e.Backends.CANVAS){if(!this.element.getContext)throw new i.RERR("BadElement","Can't get canvas context from element: ".concat(this.elementId));var r=C.SanitizeCanvasDims(t,n),a=x(r,2);t=a[0],n=a[1];var s=window.devicePixelRatio||1;this.element.width=t*s,this.element.height=n*s,this.element.style.width=t+"px",this.element.style.height=n+"px",this.ctx=e.bolsterCanvasContext(this.element.getContext("2d",{willReadFrequently:!0})),this.ctx.scale(s,s)}else this.ctx.resize(t,n);return this}},{key:"getContext",value:function(){return this.ctx}}],[{key:"Backends",get:function(){return{CANVAS:1,RAPHAEL:2,SVG:3,VML:4}}},{key:"LineEndType",get:function(){return{NONE:1,UP:2,DOWN:3}}},{key:"USE_CANVAS_PROXY",get:function(){return!1}},{key:"lastContext",get:function(){return R},set:function(e){R=e}},{key:"buildContext",value:function(t,n,i,r,a){var s=new e(t,n);i&&r&&s.resize(i,r),a||(a="#FFF");var o=s.getContext();return o.setBackgroundFillStyle(a),e.lastContext=o,o}},{key:"getCanvasContext",value:function(t,n,i,r){return e.buildContext(t,e.Backends.CANVAS,n,i,r)}},{key:"getRaphaelContext",value:function(t,n,i,r){return e.buildContext(t,e.Backends.RAPHAEL,n,i,r)}},{key:"getSVGContext",value:function(t,n,i,r){return e.buildContext(t,e.Backends.SVG,n,i,r)}},{key:"bolsterCanvasContext",value:function(t){return e.USE_CANVAS_PROXY?new C(t):(t.vexFlowCanvasContext=t,["clear","setFont","setRawFont","setFillStyle","setBackgroundFillStyle","setStrokeStyle","setShadowColor","setShadowBlur","setLineWidth","setLineCap","setLineDash","openGroup","closeGroup","getGroup"].forEach((function(e){t[e]=t[e]||C.prototype[e]})),t)}},{key:"drawDashedLine",value:function(e,t,n,i,r,a){e.beginPath();var s=i-t,o=r-n,u=Math.atan2(o,s),l=t,c=n;e.moveTo(t,n);for(var h=0,d=!0;!(s<0?l<=i:l>=i)||!(o<0?c<=r:c>=r);){var f=a[h++%a.length],p=l+Math.cos(u)*f;l=s<0?Math.max(i,p):Math.min(i,p);var m=c+Math.sin(u)*f;c=o<0?Math.max(r,m):Math.min(r,m),d?e.lineTo(l,c):e.moveTo(l,c),d=!d}e.closePath(),e.stroke()}}]),e}(),B=function(e){h(n,e);var t=d(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g(this,n),(e=t.call(this)).setAttribute("type","Stem"),e.x_begin=i.x_begin||0,e.x_end=i.x_end||0,e.y_top=i.y_top||0,e.y_bottom=i.y_bottom||0,e.stem_extension=i.stem_extension||0,e.stem_direction=i.stem_direction||0,e.hide=i.hide||!1,e.isStemlet=i.isStemlet||!1,e.stemletHeight=i.stemletHeight||0,e.renderHeightAdjustment=0,e.setOptions(i),e}return y(n,[{key:"setOptions",value:function(e){this.stem_up_y_offset=e.stem_up_y_offset||0,this.stem_down_y_offset=e.stem_down_y_offset||0}},{key:"setNoteHeadXBounds",value:function(e,t){return this.x_begin=e,this.x_end=t,this}},{key:"setDirection",value:function(e){this.stem_direction=e}},{key:"setExtension",value:function(e){this.stem_extension=e}},{key:"getExtension",value:function(){return this.stem_extension}},{key:"setYBounds",value:function(e,t){this.y_top=e,this.y_bottom=t}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getHeight",value:function(){var e=this.stem_direction===n.UP?this.stem_up_y_offset:this.stem_down_y_offset;return(this.y_bottom-this.y_top)*this.stem_direction+(n.HEIGHT-e+this.stem_extension)*this.stem_direction}},{key:"getBoundingBox",value:function(){throw new i.RERR("NotImplemented","getBoundingBox() not implemented.")}},{key:"getExtents",value:function(){var e=this.stem_direction===n.UP,t=[this.y_top,this.y_bottom],i=n.HEIGHT+this.stem_extension,r=(e?Math.min:Math.max).apply(void 0,t),a=(e?Math.max:Math.min).apply(void 0,t);return{topY:r+i*-this.stem_direction,baseY:a}}},{key:"setVisibility",value:function(e){return this.hide=!e,this}},{key:"setStemlet",value:function(e,t){return this.isStemlet=e,this.stemletHeight=t,this}},{key:"draw",value:function(){if(this.setRendered(),!this.hide){var e,t,r=this.checkContext(),a=this.stem_direction;a===n.DOWN?(e=this.x_begin,t=this.y_top+this.stem_down_y_offset):(e=this.x_end,t=this.y_bottom-this.stem_up_y_offset);var s=this.getHeight();!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Stem",t)}("Rendering stem - ","Top Y: ",this.y_top,"Bottom Y: ",this.y_bottom);var o=this.isStemlet?s-this.stemletHeight*this.stem_direction:0;if(r.save(),this.applyStyle(r),r.beginPath(),r.setLineWidth(n.WIDTH),r.moveTo(e,t-o),r.lineTo(e,t-s-this.renderHeightAdjustment*a),r.svg){var u={class:i.Prefix("stem")};this.id&&(u.id=this.id),r.stroke(u)}else r.stroke();this.restoreStyle(r),r.restore()}}}],[{key:"CATEGORY",get:function(){return"stem"}},{key:"UP",get:function(){return 1}},{key:"DOWN",get:function(){return-1}},{key:"WIDTH",get:function(){return T.STEM_WIDTH}},{key:"HEIGHT",get:function(){return T.STEM_HEIGHT}}]),n}(_),D=function(e){h(n,e);var t=d(n);function n(e,r){var a;if(g(this,n),(a=t.call(this)).setAttribute("type","Tuplet"),!e||!e.length)throw new i.RuntimeError("BadArguments","No notes provided for tuplet.");return a.options=i.Merge({},r),a.notes=e,a.num_notes="num_notes"in a.options?a.options.num_notes:e.length,a.options.beats_occupied&&a.beatsOccupiedDeprecationWarning(),a.notes_occupied=a.options.notes_occupied||a.options.beats_occupied||2,"bracketed"in a.options?a.bracketed=a.options.bracketed:a.bracketed=e.some((function(e){return null===e.beam})),a.ratioed="ratioed"in a.options?a.options.ratioed:Math.abs(a.notes_occupied-a.num_notes)>1,a.point=28,a.y_pos=16,a.x_pos=100,a.width=200,a.location=a.options.location||n.LOCATION_TOP,Te.AlignRestsToNotes(e,!0,!0),a.resolveGlyphs(),a.attach(),s(a)}return y(n,[{key:"attach",value:function(){for(var e=0;e<this.notes.length;e++)this.notes[e].setTuplet(this)}},{key:"detach",value:function(){for(var e=0;e<this.notes.length;e++)this.notes[e].resetTuplet(this)}},{key:"setBracketed",value:function(e){return this.bracketed=!!e,this}},{key:"setRatioed",value:function(e){return this.ratioed=!!e,this}},{key:"setTupletLocation",value:function(e){if(e){if(e!==n.LOCATION_TOP&&e!==n.LOCATION_BOTTOM)throw new i.RERR("BadArgument","Invalid tuplet location: "+e)}else e=n.LOCATION_TOP;return this.location=e,this}},{key:"getNotes",value:function(){return this.notes}},{key:"getNoteCount",value:function(){return this.num_notes}},{key:"beatsOccupiedDeprecationWarning",value:function(){var e=["beats_occupied has been deprecated as an ","option for tuplets. Please use notes_occupied ","instead. Calls to getBeatsOccupied and ","setBeatsOccupied should now be routed to ","getNotesOccupied and setNotesOccupied instead"].join("");console&&console.warn?console.warn(e):console&&console.log(e)}},{key:"getBeatsOccupied",value:function(){return this.beatsOccupiedDeprecationWarning(),this.getNotesOccupied()}},{key:"setBeatsOccupied",value:function(e){return this.beatsOccupiedDeprecationWarning(),this.setNotesOccupied(e)}},{key:"getNotesOccupied",value:function(){return this.notes_occupied}},{key:"setNotesOccupied",value:function(e){this.detach(),this.notes_occupied=e,this.resolveGlyphs(),this.attach()}},{key:"resolveGlyphs",value:function(){this.numerator_glyphs=[];for(var e=this.num_notes;e>=1;)this.numerator_glyphs.unshift(new P("v"+e%10,this.point)),e=parseInt(e/10,10);for(this.denom_glyphs=[],e=this.notes_occupied;e>=1;)this.denom_glyphs.unshift(new P("v"+e%10,this.point)),e=parseInt(e/10,10)}},{key:"getNestedTupletCount",value:function(){var e=this.location,t=this.notes[0],n=r(t,e),i=r(t,e);function r(e,t){return e.tupletStack.filter((function(e){return e.location===t})).length}return this.notes.forEach((function(t){var a=r(t,e);n=a>n?a:n,i=a<i?a:i})),n-i}},{key:"getYPosition",value:function(){var e,t=this.getNestedTupletCount()*n.NESTING_OFFSET*-this.location,i=this.options.y_offset||0,r=this.notes[0];if(this.location===n.LOCATION_TOP){e=r.getStave().getYForLine(0)-15;for(var a=0;a<this.notes.length;++a){var s=this.notes[a].getStemDirection()===B.UP?this.notes[a].getStemExtents().topY-10:this.notes[a].getStemExtents().baseY-20;s<e&&(e=s)}}else{e=r.getStave().getYForLine(4)+20;for(var o=0;o<this.notes.length;++o){var u=this.notes[o].getStemDirection()===B.UP?this.notes[o].getStemExtents().baseY+20:this.notes[o].getStemExtents().topY+10;u>e&&(e=u)}}return e+t+i}},{key:"draw",value:function(){var e=this;this.checkContext(),this.setRendered();var t=this.notes[0],i=this.notes[this.notes.length-1];this.bracketed?(this.x_pos=t.getTieLeftX()-5,this.width=i.getTieRightX()-this.x_pos+5):(this.x_pos=t.getStemX(),this.width=i.getStemX()-this.x_pos),this.y_pos=this.getYPosition();var r=function(e,t){return e+t.getMetrics().width},a=this.numerator_glyphs.reduce(r,0);this.ratioed&&(a=this.denom_glyphs.reduce(r,a),a+=.32*this.point);var s=this.x_pos+this.width/2-a/2;if(this.bracketed){var o=this.width/2-a/2-5;o>0&&(this.context.fillRect(this.x_pos,this.y_pos,o,1),this.context.fillRect(this.x_pos+this.width/2+a/2+5,this.y_pos,o,1),this.context.fillRect(this.x_pos,this.y_pos+(this.location===n.LOCATION_BOTTOM),1,10*this.location),this.context.fillRect(this.x_pos+this.width,this.y_pos+(this.location===n.LOCATION_BOTTOM),1,10*this.location))}if(!1!==this.RenderTupletNumber){var u=0;this.numerator_glyphs.forEach((function(t){t.render(e.context,s+u,e.y_pos+e.point/3-2),u+=t.getMetrics().width}))}if(this.ratioed){var l=s+x_offset+.16*this.point,c=.06*this.point;this.context.beginPath(),this.context.arc(l,this.y_pos-.08*this.point,c,0,2*Math.PI,!0),this.context.closePath(),this.context.fill(),this.context.beginPath(),this.context.arc(l,this.y_pos+.12*this.point,c,0,2*Math.PI,!0),this.context.closePath(),this.context.fill(),x_offset+=.32*this.point,this.denom_glyphs.forEach((function(t){t.render(e.context,s+x_offset,e.y_pos+e.point/3-2),x_offset+=t.getMetrics().width}))}}}],[{key:"LOCATION_TOP",get:function(){return 1}},{key:"LOCATION_BOTTOM",get:function(){return-1}},{key:"NESTING_OFFSET",get:function(){return 15}}]),n}(_);function F(e){var t=0;return e.forEach((function(e){e.keyProps&&e.keyProps.forEach((function(e){t+=e.line-3}))})),t>=0?B.DOWN:B.UP}var j="L",V="B",G=function(e){h(n,e);var t=d(n);function n(e,r){var a,o,u;if(g(this,n),(a=t.call(this)).setAttribute("type","Beam"),!e||e===[])throw new i.RuntimeError("BadArguments","No notes provided for beam.");if(1===e.length)throw new i.RuntimeError("BadArguments","Too few notes for beam.");if(a.ticks=e[0].getIntrinsicTicks(),a.ticks>=T.durationToTicks("4"))throw new i.RuntimeError("BadArguments","Beams can only be applied to notes shorter than a quarter note.");for(a.stem_direction=B.UP,o=0;o<e.length;++o)if((u=e[o]).hasStem()){a.stem_direction=u.getStemDirection();break}var l=a.stem_direction;if(r&&"stavenotes"===e[0].getCategory())l=F(e);else if(r&&"tabnotes"===e[0].getCategory()){var h=e.reduce((function(e,t){return e+t.stem_direction}),0);l=h>-1?B.UP:B.DOWN}for(o=0;o<e.length;++o)u=e[o],r&&(u.setStemDirection(l),a.stem_direction=l),u.setBeam(c(a));return a.postFormatted=!1,a.notes=e,a.beam_count=a.getBeamCount(),a.break_on_indices=[],a.render_options={beam_width:5,max_slope:.25,min_slope:-.25,slope_iterations:20,slope_cost:100,show_stemlets:!1,stemlet_extension:7,partial_beam_length:10,flat_beams:!1,min_flat_beam_offset:15},s(a)}return y(n,[{key:"getNotes",value:function(){return this.notes}},{key:"getBeamCount",value:function(){return this.notes.map((function(e){return e.getGlyph().beam_count})).reduce((function(e,t){return t>e?t:e}))}},{key:"breakSecondaryAt",value:function(e){return this.break_on_indices=e,this}},{key:"getSlopeY",value:function(e,t,n,i){return n+(e-t)*i}},{key:"calculateSlope",value:function(){for(var e=this.notes,t=this.stem_direction,n=this.render_options,i=n.max_slope,r=n.min_slope,a=n.slope_iterations,s=n.slope_cost,o=e[0],u=function(e,t){var n=e.getStemExtents().topY,i=e.getStemX();return(t.getStemExtents().topY-n)/(t.getStemX()-i)}(o,e[e.length-1]),l=(i-r)/a,c=Number.MAX_VALUE,h=0,d=0,f=r;f<=i;f+=l){for(var p=0,m=0,v=1;v<e.length;++v){var g=e[v],y=this.getSlopeY(g.getStemX(),o.getStemX(),o.getStemExtents().topY,f)+m,b=g.getStemExtents().topY;if(b*t<y*t){var S=Math.abs(b-y);m+=S*-t,p+=S*v}else p+=(b-y)*t}var x=u/2,_=s*Math.abs(x-f)+Math.abs(p);_<c&&(c=_,h=f,d=m)}this.slope=h,this.y_shift=d}},{key:"calculateFlatSlope",value:function(){for(var e=this.notes,t=this.stem_direction,n=this.render_options,i=n.beam_width,r=n.min_flat_beam_offset,a=n.flat_beam_offset,s=0,o=0,u=0,l=0,c=0;c<e.length;c++){var h=e[c],d=h.getStemExtents().topY;s+=d,t===B.DOWN&&l<d?(l=d,o=Math.max.apply(Math,S(h.getYs())),u=h.getBeamCount()):t===B.UP&&(0===l||l>d)&&(l=d,o=Math.min.apply(Math,S(h.getYs())),u=h.getBeamCount())}var f=s/e.length,p=r+u*(1.5*i),m=o+p*-t;t===B.DOWN&&f<m?f=o+p:t===B.UP&&f>m&&(f=o-p),a+this.render_options.flat_beam_offset_per_beam>0?(t===B.DOWN&&f>a&&!this.render_options.flat_beams||t===B.UP&&f<a&&!this.render_options.flat_beams)&&(this.render_options.flat_beam_offset=f):this.render_options.flat_beam_offset=f,this.slope=0,this.y_shift=0}},{key:"getBeamYToDraw",value:function(){var e=this.notes[0].getStemExtents().topY;if(this.render_options.flat_beams&&this.render_options.flat_beam_offset+this.render_options.flat_beam_offset_per_beam>0){var t=this.render_options.flat_beam_offset;this.render_options.flat_beam_offset_per_beam&&(t+=this.render_options.flat_beam_offset_per_beam*this.getBeamCount());var n,i=this.notes[0].note_heads[0].y,r=this.stem_direction>0?Math.min:Math.max,a=b(this.notes);try{for(a.s();!(n=a.n()).done;){var s,o=n.value,u=b(o.note_heads);try{for(u.s();!(s=u.n()).done;)i=r(i,s.value.y)}catch(l){u.e(l)}finally{u.f()}}}catch(l){a.e(l)}finally{a.f()}e=i+t*-this.stem_direction}return e}},{key:"applyStemExtensions",value:function(){for(var e=this.notes,t=this.slope,n=this.y_shift,i=this.stem_direction,r=this.beam_count,a=this.render_options,s=a.show_stemlets,o=a.stemlet_extension,u=a.beam_width,l=e[0],c=this.getBeamYToDraw(),h=l.getStemX(),d=0;d<e.length;++d){var f=e[d],p=f.getStemX(),m=f.getStemExtents().topY,v=this.getSlopeY(p,h,c,t)+n,g=f.getStem().getExtension(),y=i===B.UP?m-v:v-m;if(f.stem.setExtension(g+y),f.stem.renderHeightAdjustment=-B.WIDTH/2,f.isRest()&&s){var b=(r-1)*u*1.5+u;f.stem.setVisibility(!0).setStemlet(!0,b+o)}}}},{key:"lookupBeamDirection",value:function(e,t,n,i){if("4"===e)return j;var r=""+T.durationToNumber(e)/2,a=t<T.durationToTicks(r),s=i<T.durationToTicks(r),o=n<T.durationToTicks(r);return a&&s&&o?V:a&&!s&&o?j:!a&&s&&o?"R":this.lookupBeamDirection(r,t,n,i)}},{key:"getBeamLines",value:function(e){for(var t=T.durationToTicks(e),n=[],i=!1,r=null,a=this.render_options.partial_beam_length,s=!1,o=0,u=0;u<this.notes.length;++u){var l=this.notes[u];o+=l.ticks.value();var c=!1;parseInt(e,10)>=8&&(c=-1!==this.break_on_indices.indexOf(u),this.render_options.secondary_break_ticks&&o>=this.render_options.secondary_break_ticks&&(o=0,c=!0));var h=l.getIntrinsicTicks()<t,d=l.getStemX()-B.WIDTH/2,f=this.notes[u-1],p=this.notes[u+1],m=p&&p.getIntrinsicTicks()<t,v=f&&f.getIntrinsicTicks()<t,g=f&&p&&h&&!v&&!m;if(h)if(i)(r=n[n.length-1]).end=d,c&&(i=!1,p&&!m&&null===r.end&&(r.end=r.start-a));else{if(r={start:d,end:null,start_note:l},i=!0,g){var y=f.getIntrinsicTicks(),b=p.getIntrinsicTicks(),S=l.getIntrinsicTicks(),x=this.lookupBeamDirection(e,y,S,b);[j,V].includes(x)?r.end=r.start-a:r.end=r.start+a}else m?c&&(r.end=r.start-a,i=!1):r.end=(s||0===u)&&p?r.start+a:r.start-a;n.push(r)}else i=!1;s=c}var _=n[n.length-1];return _&&null===_.end&&(_.end=_.start-a),n}},{key:"drawStems",value:function(){var e=this;this.notes.forEach((function(t){t.getStem()&&(e.context.openGroup("stem",t.getAttribute("id")+"-stem"),t.getStem().setContext(e.context).draw(),e.context.closeGroup())}),this)}},{key:"drawBeamLines",value:function(){this.checkContext();var e,t=["4","8","16","32","64"],n=this.notes[0],i=this.getBeamYToDraw(),r=n.getStemX(),a=this.render_options.beam_width*this.stem_direction,s={},o=b(this.notes);try{for(o.s();!(e=o.n()).done;)s[e.value.getAttribute("id")]=0}catch(x){o.e(x)}finally{o.f()}for(var u=0;u<t.length;++u){for(var l=t[u],c=this.getBeamLines(l),h=0;h<c.length;++h){var d=c[h],f=d.start,p=d.start_note.getAttribute("id"),m=s[p];s[p]++;var v=this.getSlopeY(f,r,i,this.slope),g=d.end,y=this.getSlopeY(g,r,i,this.slope),S=p;this.context.openGroup("beam","".concat(S,"-beam").concat(m)),this.context.beginPath(),this.context.moveTo(f,v),this.context.lineTo(f,v+a),this.context.lineTo(g+1,y+a),this.context.lineTo(g+1,y),this.context.closePath(),this.context.fill(),this.context.closeGroup()}i+=1.5*a}}},{key:"preFormat",value:function(){return this}},{key:"postFormat",value:function(){this.postFormatted||("tabnotes"===this.notes[0].getCategory()||this.render_options.flat_beams?this.calculateFlatSlope():this.calculateSlope(),this.applyStemExtensions(),this.postFormatted=!0)}},{key:"draw",value:function(){this.checkContext(),this.setRendered(),this.unbeamable||(this.postFormatted||this.postFormat(),this.drawStems(),this.applyStyle(),this.drawBeamLines(),this.restoreStyle())}}],[{key:"getDefaultBeamGroups",value:function(e){e&&"c"!==e||(e="4/4");var t={"1/2":["1/2"],"2/2":["1/2"],"3/2":["1/2"],"4/2":["1/2"],"1/4":["1/4"],"2/4":["1/4"],"3/4":["1/4"],"4/4":["1/4"],"1/8":["1/8"],"2/8":["2/8"],"3/8":["3/8"],"4/8":["2/8"],"1/16":["1/16"],"2/16":["2/16"],"3/16":["3/16"],"4/16":["2/16"]}[e];if(void 0!==t)return t.map((function(e){return(new a).parse(e)}));var n=parseInt(e.split("/")[0],10),i=parseInt(e.split("/")[1],10);return n%3==0?[new a(3,i)]:i>4?[new a(2,i)]:i<=4?[new a(1,i)]:[new a(1,4)]}},{key:"applyAndGetBeams",value:function(e,t,i){return n.generateBeams(e.getTickables(),{groups:i,stem_direction:t})}},{key:"generateBeams",value:function(e,t){t||(t={}),t.groups&&t.groups.length||(t.groups=[new a(2,8)]);var r=t.groups.map((function(e){if(!e.multiply)throw new i.RuntimeError("InvalidBeamGroups","The beam groups must be an array of Vex.Flow.Fractions");return e.clone().multiply(T.RESOLUTION,1)})),s=e,o=0,u=[],l=[];function c(){r.length-1>o?o+=1:o=0}!function(){var e=[];s.forEach((function(t){if(e=[],t.shouldIgnoreTicks())return u.push(l),void(l=e);l.push(t);var n=r[o].clone(),i=l.reduce((function(e,t){return t.getTicks().clone().add(e)}),new a(0,1)),s=T.durationToNumber(t.duration)<8;s&&t.tuplet&&(n.numerator*=2),i.greaterThan(n)?(s||e.push(l.pop()),u.push(l),l=e,c()):i.equals(n)&&(u.push(l),l=e,c())})),l.length>0&&u.push(l)}(),function(){var e=[];u.forEach((function(n){var i=[];n.forEach((function(n,r,a){var s=0===r||r===a.length-1,o=a[r-1],u=!t.beam_rests&&n.isRest(),l=t.beam_rests&&t.beam_middle_only&&n.isRest()&&s,c=!1;if(t.maintain_stem_directions&&o&&!n.isRest()&&!o.isRest()){var h=o.getStemDirection();c=n.getStemDirection()!==h}var d=parseInt(n.duration,10)<8;u||l||c||d?(i.length>0&&e.push(i),i=c?[n]:[]):i.push(n)})),i.length>0&&e.push(i)})),u=e}(),u.forEach((function(e){var n;if(t.maintain_stem_directions){var i=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(!n.isRest())return n}return!1}(e);n=i?i.getStemDirection():B.UP}else n=t.stem_direction?t.stem_direction:F(e);!function(e,t){e.forEach((function(e){e.setStemDirection(t)}))}(e,n)}));var h=u.filter((function(e){if(e.length>1){var t=!0;return e.forEach((function(e){e.getIntrinsicTicks()>=T.durationToTicks("4")&&(t=!1)})),t}return!1})),d=function(){var e=[];return u.forEach((function(t){var n=null;t.forEach((function(t){t.tuplet&&n!==t.tuplet&&(n=t.tuplet,e.push(n))}))})),e}(),f=[];return h.forEach((function(e){var i=new n(e);t.show_stemlets&&(i.render_options.show_stemlets=!0),t.secondary_breaks&&(i.render_options.secondary_break_ticks=T.durationToTicks(t.secondary_breaks)),!0===t.flat_beams&&(i.render_options.flat_beams=!0,i.render_options.flat_beam_offset=t.flat_beam_offset),f.push(i)})),d.forEach((function(e){var t=e.notes[0].stem_direction===B.DOWN?D.LOCATION_BOTTOM:D.LOCATION_TOP;e.setTupletLocation(t);for(var n=!1,i=0;i<e.notes.length;i++)if(null===e.notes[i].beam){n=!0;break}e.setBracketed(n)})),f}}]),n}(_),W=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this)).setAttribute("type","Voice"),"string"==typeof e){var o=e.match(/(\d+)\/(\d+)/);o&&(e={num_beats:o[1],beat_value:o[2],resolution:T.RESOLUTION})}return r.time=i.Merge({num_beats:4,beat_value:4,resolution:T.RESOLUTION},e),r.totalTicks=new a(r.time.num_beats*(r.time.resolution/r.time.beat_value),1),r.resolutionMultiplier=1,r.tickables=[],r.ticksUsed=new a(0,1),r.smallestTickCount=r.totalTicks.clone(),r.largestTickWidth=0,r.stave=null,r.mode=n.Mode.STRICT,r.voiceGroup=null,s(r)}return y(n,[{key:"getTotalTicks",value:function(){return this.totalTicks}},{key:"getTicksUsed",value:function(){return this.ticksUsed}},{key:"getLargestTickWidth",value:function(){return this.largestTickWidth}},{key:"getSmallestTickCount",value:function(){return this.smallestTickCount}},{key:"getTickables",value:function(){return this.tickables}},{key:"getMode",value:function(){return this.mode}},{key:"setMode",value:function(e){return this.mode=e,this}},{key:"getResolutionMultiplier",value:function(){return this.resolutionMultiplier}},{key:"getActualResolution",value:function(){return this.resolutionMultiplier*this.time.resolution}},{key:"setStave",value:function(e){return this.stave=e,this.boundingBox=null,this}},{key:"getBoundingBox",value:function(){var e,t,n,r;if(!this.boundingBox){if(!this.stave)throw new i.RERR("NoStave","Can't get bounding box without stave.");for(e=this.stave,t=null,r=0;r<this.tickables.length;++r)this.tickables[r].setStave(e),(n=this.tickables[r].getBoundingBox())&&(t=t?t.mergeWith(n):n);this.boundingBox=t}return this.boundingBox}},{key:"getVoiceGroup",value:function(){if(!this.voiceGroup)throw new i.RERR("NoVoiceGroup","No voice group for voice.");return this.voiceGroup}},{key:"setVoiceGroup",value:function(e){return this.voiceGroup=e,this}},{key:"setStrict",value:function(e){return this.mode=e?n.Mode.STRICT:n.Mode.SOFT,this}},{key:"isComplete",value:function(){return this.mode!==n.Mode.STRICT&&this.mode!==n.Mode.FULL||this.ticksUsed.equals(this.totalTicks)}},{key:"addTickable",value:function(e){if(!e.shouldIgnoreTicks()){var t=e.getTicks();if(this.ticksUsed.add(t),(this.mode===n.Mode.STRICT||this.mode===n.Mode.FULL)&&this.ticksUsed.greaterThan(this.totalTicks))throw this.ticksUsed.subtract(t),new i.RERR("BadArgument","Too many ticks.");t.lessThan(this.smallestTickCount)&&(this.smallestTickCount=t.clone()),this.resolutionMultiplier=this.ticksUsed.denominator,this.totalTicks.add(0,this.ticksUsed.denominator)}return this.tickables.push(e),e.setVoice(this),this}},{key:"addTickables",value:function(e){for(var t=0;t<e.length;++t)this.addTickable(e[t]);return this}},{key:"preFormat",value:function(){var e=this;return this.preFormatted||(this.tickables.forEach((function(t){t.getStave()||t.setStave(e.stave)})),this.preFormatted=!0),this}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stave;this.setRendered();for(var n=null,r=0;r<this.tickables.length;++r){var a=this.tickables[r];if(t&&a.setStave(t),!a.getStave())throw new i.RuntimeError("MissingStave","The voice cannot draw tickables without staves.");if(0===r&&(n=a.getBoundingBox()),r>0&&n){var s=a.getBoundingBox();s&&n.mergeWith(s)}a.setContext(e),a.drawWithStyle()}this.boundingBox=n}}],[{key:"Mode",get:function(){return{STRICT:1,SOFT:2,FULL:3}}}]),n}(_);function U(e,t,n,r,a){if(t!==z.type.BOLD_DOUBLE_LEFT&&t!==z.type.BOLD_DOUBLE_RIGHT)throw new i.RERR("InvalidConnector","A REPEAT_BEGIN or REPEAT_END type must be provided.");var s=3,o=3.5;t===z.type.BOLD_DOUBLE_RIGHT&&(s=-5,o=3),e.fillRect(n+s,r,1,a-r),e.fillRect(n-2,r,o,a-r)}var z=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this)).setAttribute("type","StaveConnector"),r.thickness=T.STAVE_LINE_THICKNESS,r.width=3,r.top_stave=e,r.bottom_stave=i,r.type=n.type.DOUBLE,r.font={family:"times",size:16,weight:"normal"},r.x_shift=0,r.texts=[],r}return y(n,[{key:"setType",value:function(e){return(e="string"==typeof e?n.typeString[e]:e)>=n.type.SINGLE_RIGHT&&e<=n.type.NONE&&(this.type=e),this}},{key:"setText",value:function(e,t){return this.texts.push({content:e,options:i.Merge({shift_x:0,shift_y:0},t)}),this}},{key:"setFont",value:function(e){i.Merge(this.font,e)}},{key:"setXShift",value:function(e){if("number"!=typeof e)throw i.RERR("InvalidType","x_shift must be a Number");return this.x_shift=e,this}},{key:"draw",value:function(){var e=this.checkContext();this.setRendered();var t=this.top_stave.getYForLine(0),r=this.bottom_stave.getYForLine(this.bottom_stave.getNumLines()-1)+this.thickness,a=this.width,s=this.top_stave.getX();(this.type===n.type.SINGLE_RIGHT||this.type===n.type.BOLD_DOUBLE_RIGHT||this.type===n.type.THIN_DOUBLE)&&(s=this.top_stave.getX()+this.top_stave.width);var o=r-t;switch(this.type){case n.type.SINGLE:case n.type.SINGLE_LEFT:case n.type.SINGLE_RIGHT:a=1;break;case n.type.DOUBLE:s-=this.width+2;break;case n.type.BRACE:a=12;var u=this.top_stave.getX()-2+this.x_shift,l=t,c=u,h=r,d=u-a,f=l+o/2,p=d-.9*a,m=l+.2*o,v=u+1.1*a,g=f-.135*o,y=v,b=f+.135*o,S=p,x=h-.2*o,_=d-a,E=x,k=u+.4*a,M=f+.135*o,w=k,T=f-.135*o,C=_,I=m;e.beginPath(),e.moveTo(u,l),e.bezierCurveTo(p,m,v,g,d,f),e.bezierCurveTo(y,b,S,x,c,h),e.bezierCurveTo(_,E,k,M,d,f),e.bezierCurveTo(w,T,C,I,u,l),e.fill(),e.stroke();break;case n.type.BRACKET:o=(r+=4)-(t-=4),P.renderGlyph(e,s-5,t-3,40,"v1b",!0),P.renderGlyph(e,s-5,r+3,40,"v10",!0),s-=this.width+2;break;case n.type.BOLD_DOUBLE_LEFT:U(e,this.type,s+this.x_shift,t,r);break;case n.type.BOLD_DOUBLE_RIGHT:U(e,this.type,s,t,r);break;case n.type.THIN_DOUBLE:a=1;break;case n.type.NONE:break;default:throw new i.RERR("InvalidType","The provided StaveConnector.type (".concat(this.type,") is invalid"))}this.type!==n.type.BRACE&&this.type!==n.type.BOLD_DOUBLE_LEFT&&this.type!==n.type.BOLD_DOUBLE_RIGHT&&this.type!==n.type.NONE&&e.fillRect(s,t,a,o),this.type===n.type.THIN_DOUBLE&&e.fillRect(s-3,t,a,o),e.save(),e.lineWidth=2,e.setFont(this.font.family,this.font.size,this.font.weight);for(var A=0;A<this.texts.length;A++){var L=this.texts[A],O=e.measureText(""+L.content).width,R=this.top_stave.getX()-O-24+L.options.shift_x,N=(this.top_stave.getYForLine(0)+this.bottom_stave.getBottomLineY())/2+L.options.shift_y;e.fillText(""+L.content,R,N+4)}e.restore()}}],[{key:"type",get:function(){return{SINGLE_RIGHT:0,SINGLE_LEFT:1,SINGLE:1,DOUBLE:2,BRACE:3,BRACKET:4,BOLD_DOUBLE_LEFT:5,BOLD_DOUBLE_RIGHT:6,THIN_DOUBLE:7,NONE:8}}},{key:"typeString",get:function(){return{singleRight:n.type.SINGLE_RIGHT,singleLeft:n.type.SINGLE_LEFT,single:n.type.SINGLE,double:n.type.DOUBLE,brace:n.type.BRACE,bracket:n.type.BRACKET,boldDoubleLeft:n.type.BOLD_DOUBLE_LEFT,boldDoubleRight:n.type.BOLD_DOUBLE_RIGHT,thinDouble:n.type.THIN_DOUBLE,none:n.type.NONE}}}]),n}(_),H=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","Tickable"),e.ticks=new a(0,1),e.intrinsicTicks=0,e.tickMultiplier=new a(1,1),e.width=0,e.x_shift=0,e.voice=null,e.tickContext=null,e.modifierContext=null,e.modifiers=[],e.preFormatted=!1,e.postFormatted=!1,e.tuplet=null,e.tupletStack=[],e.align_center=!1,e.center_x_shift=0,e.ignore_ticks=!1,e.formatterMetrics={freedom:{left:0,right:0},duration:"",iterations:0,space:{used:0,mean:0,deviation:0}},e}return y(n,[{key:"reset",value:function(){return this}},{key:"getTicks",value:function(){return this.ticks}},{key:"shouldIgnoreTicks",value:function(){return this.ignore_ticks}},{key:"getWidth",value:function(){return this.width}},{key:"getFormatterMetrics",value:function(){return this.formatterMetrics}},{key:"setXShift",value:function(e){this.x_shift=e}},{key:"getCenterXShift",value:function(){return this.isCenterAligned()?this.center_x_shift:0}},{key:"isCenterAligned",value:function(){return this.align_center}},{key:"setCenterAlignment",value:function(e){return this.align_center=e,this}},{key:"getVoice",value:function(){if(!this.voice)throw new i.RERR("NoVoice","Tickable has no voice.");return this.voice}},{key:"setVoice",value:function(e){this.voice=e}},{key:"getTuplet",value:function(){return this.tuplet}},{key:"resetTuplet",value:function(e){var t,n;if(e){var i=this.tupletStack.indexOf(e);return-1!==i&&(this.tupletStack.splice(i,1),t=e.getNoteCount(),n=e.getNotesOccupied(),this.applyTickMultiplier(t,n)),this}for(;this.tupletStack.length;)t=(e=this.tupletStack.pop()).getNoteCount(),n=e.getNotesOccupied(),this.applyTickMultiplier(t,n);return this}},{key:"setTuplet",value:function(e){if(e){this.tupletStack.push(e);var t=e.getNoteCount(),n=e.getNotesOccupied();this.applyTickMultiplier(n,t)}return this.tuplet=e,this}},{key:"addToModifierContext",value:function(e){this.modifierContext=e,this.preFormatted=!1}},{key:"addModifier",value:function(e){return this.modifiers.push(e),this.preFormatted=!1,this}},{key:"getModifiers",value:function(){return this.modifiers}},{key:"setTickContext",value:function(e){this.tickContext=e,this.preFormatted=!1}},{key:"preFormat",value:function(){this.preFormatted||(this.width=0,this.modifierContext&&(this.modifierContext.preFormat(),this.width+=this.modifierContext.getWidth()))}},{key:"postFormat",value:function(){return this.postFormatted||(this.postFormatted=!0),this}},{key:"getIntrinsicTicks",value:function(){return this.intrinsicTicks}},{key:"setIntrinsicTicks",value:function(e){this.intrinsicTicks=e,this.ticks=this.tickMultiplier.clone().multiply(this.intrinsicTicks)}},{key:"getTickMultiplier",value:function(){return this.tickMultiplier}},{key:"applyTickMultiplier",value:function(e,t){this.tickMultiplier.multiply(e,t),this.ticks=this.tickMultiplier.clone().multiply(this.intrinsicTicks)}},{key:"setDuration",value:function(e){var t=e.numerator*(T.RESOLUTION/e.denominator);this.ticks=this.tickMultiplier.clone().multiply(t),this.intrinsicTicks=this.ticks.value()}}]),n}(_),X=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this)).setAttribute("type","Note"),!e)throw new i.RuntimeError("BadArguments","Note must have valid initialization data to identify duration and type.");var a=T.parseNoteStruct(e);if(!a)throw new i.RuntimeError("BadArguments","Invalid note initialization object: ".concat(JSON.stringify(e)));if(r.duration=a.duration,r.dots=a.dots,r.noteType=a.type,r.customTypes=a.customTypes,e.duration_override?r.setDuration(e.duration_override):r.setIntrinsicTicks(a.ticks),r.modifiers=[],r.glyph=T.getGlyphProps(r.duration,r.noteType),r.customGlyphs=r.customTypes.map((function(e){return T.getGlyphProps(r.duration,e)})),r.positions&&("object"!=typeof r.positions||!r.positions.length))throw new i.RuntimeError("BadArguments","Note keys must be array type.");return r.playNote=null,r.tickContext=null,r.modifierContext=null,r.ignore_ticks=!1,r.width=0,r.extraLeftPx=0,r.extraRightPx=0,r.x_shift=0,r.left_modPx=0,r.right_modPx=0,r.voice=null,r.preFormatted=!1,r.ys=[],e.align_center&&r.setCenterAlignment(e.align_center),r.stave=null,r.render_options={annotation_spacing:5,stave_padding:n.STAVEPADDING},s(r)}return y(n,[{key:"getPlayNote",value:function(){return this.playNote}},{key:"setPlayNote",value:function(e){return this.playNote=e,this}},{key:"isRest",value:function(){return!1}},{key:"addStroke",value:function(e,t){return t.setNote(this),t.setIndex(e),this.modifiers.push(t),this.setPreFormatted(!1),this}},{key:"getStave",value:function(){return this.stave}},{key:"setStave",value:function(e){return this.stave=e,this.setYs([e.getYForLine(0)]),this.context=this.stave.context,this}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setContext",value:function(e){return this.context=e,this}},{key:"getExtraLeftPx",value:function(){return this.extraLeftPx}},{key:"getExtraRightPx",value:function(){return this.extraRightPx}},{key:"setExtraLeftPx",value:function(e){return this.extraLeftPx=e,this}},{key:"setExtraRightPx",value:function(e){return this.extraRightPx=e,this}},{key:"shouldIgnoreTicks",value:function(){return this.ignore_ticks}},{key:"getLineNumber",value:function(){return 0}},{key:"getLineForRest",value:function(){return 0}},{key:"getGlyph",value:function(){return this.glyph}},{key:"getGlyphWidth",value:function(){return this.glyph.getWidth(this.render_options.glyph_font_scale)}},{key:"setYs",value:function(e){return this.ys=e,this}},{key:"getYs",value:function(){if(0===this.ys.length)throw new i.RERR("NoYValues","No Y-values calculated for this note.");return this.ys}},{key:"getYForTopText",value:function(e){if(!this.stave)throw new i.RERR("NoStave","No stave attached to this note.");return this.stave.getYForTopText(e)}},{key:"getBoundingBox",value:function(){return null}},{key:"getVoice",value:function(){if(!this.voice)throw new i.RERR("NoVoice","Note has no voice.");return this.voice}},{key:"setVoice",value:function(e){return this.voice=e,this.preFormatted=!1,this}},{key:"getTickContext",value:function(){return this.tickContext}},{key:"setTickContext",value:function(e){return this.tickContext=e,this.preFormatted=!1,this}},{key:"getDuration",value:function(){return this.duration}},{key:"isDotted",value:function(){return this.dots>0}},{key:"hasStem",value:function(){return!1}},{key:"getDots",value:function(){return this.dots}},{key:"getNoteType",value:function(){return this.noteType}},{key:"setBeam",value:function(){return this}},{key:"setModifierContext",value:function(e){return this.modifierContext=e,this}},{key:"addModifier",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.setNote(this),e.setIndex(t),this.modifiers.push(e),this.setPreFormatted(!1),this}},{key:"getModifierStartXY",value:function(){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call GetModifierStartXY on an unformatted note");return{x:this.getAbsoluteX(),y:this.ys[0]}}},{key:"getMetrics",value:function(){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call getMetrics on an unformatted note.");var e=0,t=0;null!=this.modifierContext&&(e=this.modifierContext.state.left_shift,t=this.modifierContext.state.right_shift);var n=this.getWidth();return{width:n,noteWidth:n-e-t-this.extraLeftPx-this.extraRightPx,left_shift:this.x_shift,modLeftPx:e,modRightPx:t,extraLeftPx:this.extraLeftPx,extraRightPx:this.extraRightPx}}},{key:"setWidth",value:function(e){this.width=e}},{key:"getWidth",value:function(){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call GetWidth on an unformatted note.");return this.width+(this.modifierContext?this.modifierContext.getWidth():0)}},{key:"setXShift",value:function(e){return this.x_shift=e,this}},{key:"getXShift",value:function(){return this.x_shift}},{key:"getX",value:function(){if(!this.tickContext)throw new i.RERR("NoTickContext","Note needs a TickContext assigned for an X-Value");return this.tickContext.getX()+this.x_shift}},{key:"getAbsoluteX",value:function(){if(!this.tickContext)throw new i.RERR("NoTickContext","Note needs a TickContext assigned for an X-Value");var e=this.tickContext.getX();return this.stave&&(e+=this.stave.getNoteStartX()+this.render_options.stave_padding),this.isCenterAligned()&&(e+=this.getCenterXShift()),e}},{key:"setPreFormatted",value:function(e){if(this.preFormatted=e,this.preFormatted){var t=this.tickContext.getExtraPx();this.left_modPx=Math.max(this.left_modPx,t.left),this.right_modPx=Math.max(this.right_modPx,t.right)}}}],[{key:"CATEGORY",get:function(){return"note"}},{key:"STAVEPADDING",get:function(){return 12}},{key:"plotMetrics",value:function(e,t,n){var r=t.getMetrics(),a=t.getAbsoluteX()-r.modLeftPx-r.extraLeftPx,s=t.getAbsoluteX()-r.extraLeftPx,o=t.getAbsoluteX(),u=t.getAbsoluteX()+r.noteWidth,l=t.getAbsoluteX()+r.noteWidth+r.extraRightPx,c=t.getAbsoluteX()+r.noteWidth+r.extraRightPx+r.modRightPx,h=c+t.getFormatterMetrics().freedom.right,d=c-a;e.save(),e.setFont("Arial",8,""),e.fillText(Math.round(d)+"px",a+t.getXShift(),n);var f=n+7;function p(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f;e.beginPath(),e.setStrokeStyle(r),e.setFillStyle(r),e.setLineWidth(3),e.moveTo(n+t.getXShift(),a),e.lineTo(i+t.getXShift(),a),e.stroke()}p(a,s,"red"),p(s,o,"#999"),p(o,u,"green"),p(u,l,"#999"),p(l,c,"red"),p(c,h,"#DD0"),p(a-t.getXShift(),a,"#BBB"),i.drawDot(e,o+t.getXShift(),f,"blue");var m=t.getFormatterMetrics();if(m.iterations>0){var v=m.space.deviation,g=v>=0?"+":"";e.setFillStyle("red"),e.fillText(g+Math.round(v),o+t.getXShift(),n-10)}e.restore()}}]),n}(H),Y=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this,e)).setAttribute("type","NoteHead"),r.index=e.index,r.x=e.x||0,r.y=e.y||0,r.note_type=e.note_type,r.duration=e.duration,r.displaced=e.displaced||!1,r.stem_direction=e.stem_direction||Q.STEM_UP,r.line=e.line,r.glyph=T.getGlyphProps(r.duration,r.note_type),!r.glyph)throw new i.RuntimeError("BadArguments","No glyph found for duration '".concat(r.duration,"' and type '").concat(r.note_type,"'"));return r.glyph_code=r.glyph.code_head,r.x_shift=e.x_shift||0,e.custom_glyph_code&&(r.custom_glyph=!0,r.glyph_code=e.custom_glyph_code,r.stem_up_x_offset=e.stem_up_x_offset||0,r.stem_down_x_offset=e.stem_down_x_offset||0),r.style=e.style,r.slashed=e.slashed,i.Merge(r.render_options,{glyph_font_scale:e.glyph_font_scale||T.DEFAULT_NOTATION_FONT_SCALE,stroke_px:3}),r.setWidth(r.glyph.getWidth(r.render_options.glyph_font_scale)),s(r)}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getWidth",value:function(){return this.width}},{key:"isDisplaced",value:function(){return!0===this.displaced}},{key:"getGlyph",value:function(){return this.glyph}},{key:"setX",value:function(e){return this.x=e,this}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){return this.y=e,this}},{key:"getLine",value:function(){return this.line}},{key:"setLine",value:function(e){return this.line=e,this}},{key:"getAbsoluteX",value:function(){var e=this.preFormatted?o(u(n.prototype),"getAbsoluteX",this).call(this):this.x,t=B.WIDTH/2;return e+(this.displaced?(this.width-t)*this.stem_direction:0)}},{key:"getBoundingBox",value:function(){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call getBoundingBox on an unformatted note.");var e=this.stave.getSpacingBetweenLines(),t=e/2,n=this.y-t;return new T.BoundingBox(this.getAbsoluteX(),n,this.width,e)}},{key:"setStave",value:function(e){var t=this.getLine();return this.stave=e,this.setY(e.getYForNote(t)),this.context=this.stave.context,this}},{key:"preFormat",value:function(){if(this.preFormatted)return this;var e=this.getWidth()+this.extraLeftPx+this.extraRightPx;return this.setWidth(e),this.setPreFormatted(!0),this}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e=this.context,t=this.getAbsoluteX();this.custom_glyph&&(t+=this.stem_direction===B.UP?this.stem_up_x_offset:this.stem_down_x_offset);var r=this.y;!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.NoteHead",t)}("Drawing note head '",this.note_type,this.duration,"' at",t,r);var a=this.stem_direction,s=this.render_options.glyph_font_scale;if(this.style&&this.applyStyle(e),"s"===this.note_type){var o=this.stave.getSpacingBetweenLines();!function(e,t,n,i,r,a){var s=T.SLASH_NOTEHEAD_WIDTH;e.save(),e.setLineWidth(T.STEM_WIDTH);var o=!1;if(T.durationToNumber(t)>2&&(o=!0),o||(n-=T.STEM_WIDTH/2*r),e.beginPath(),e.moveTo(n,i+a),e.lineTo(n,i+1),e.lineTo(n+s,i-a),e.lineTo(n+s,i),e.lineTo(n,i+a),e.closePath(),o?e.fill():e.stroke(),T.durationToFraction(t).equals(.5))for(var u=[-3,-1,s+1,s+3],l=0;l<u.length;l++)e.beginPath(),e.moveTo(n+u[l],i-10),e.lineTo(n+u[l],i+11),e.stroke();e.restore()}(e,this.duration,t,r,a,o)}else P.renderGlyph(e,t,r,s,this.glyph_code);this.style&&this.restoreStyle(e)}}],[{key:"CATEGORY",get:function(){return"notehead"}}]),n}(X),K=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this,e)).setAttribute("type","StemmableNote"),i.stem=null,i.stemExtensionOverride=null,i.beam=null,i.renderFlag=!0,i}return y(n,[{key:"getStem",value:function(){return this.stem}},{key:"setStem",value:function(e){return this.stem=e,this}},{key:"buildStem",value:function(){var e=new B;return this.setStem(e),this}},{key:"buildFlag",value:function(){var e=this.glyph,t=null===this.beam&&this.renderFlag;if(e&&e.flag&&t){var n=this.getStemDirection()===B.DOWN?e.code_flag_downstem:e.code_flag_upstem;this.flag=new P(n,this.render_options.glyph_font_scale)}}},{key:"getTopGlyph",value:function(){return this.getStemDirection()===B.DOWN?this.customGlyphs[this.customGlyphs.length-1]:this.customGlyphs[0]}},{key:"getStemLength",value:function(){return B.HEIGHT+this.getStemExtension()}},{key:"getBeamCount",value:function(){var e=this.getGlyph();return e?e.beam_count:0}},{key:"getStemMinumumLength",value:function(){var e=T.durationToFraction(this.duration).value()<=1?0:20;switch(this.duration){case"8":null==this.beam&&(e=35);break;case"16":e=null==this.beam?35:25;break;case"32":e=null==this.beam?45:35;break;case"64":e=null==this.beam?50:40;break;case"128":e=null==this.beam?55:45}return e}},{key:"getStemDirection",value:function(){return this.stem_direction}},{key:"setStemDirection",value:function(e){if(e||(e=B.UP),e!==B.UP&&e!==B.DOWN)throw new i.RERR("BadArgument","Invalid stem direction: ".concat(e));if(this.stem_direction=e,this.stem){this.stem.setDirection(e),this.stem.setExtension(this.getStemExtension());var t=this.getTopGlyph()||this.getGlyph();this.stem.setOptions({stem_up_y_offset:t.stem_up_y_offset,stem_down_y_offset:t.stem_down_y_offset})}return this.reset(),this.flag&&this.renderFlag&&this.buildFlag(),this.beam=null,this.preFormatted&&this.preFormat(),this}},{key:"getStemX",value:function(){var e=this.getAbsoluteX()+this.x_shift,t=this.getAbsoluteX()+this.x_shift+this.getGlyphWidth();return this.stem_direction===B.DOWN?e:t}},{key:"getCenterGlyphX",value:function(){return this.getAbsoluteX()+this.x_shift+this.getGlyphWidth()/2}},{key:"getStemExtension",value:function(){var e=this.getGlyph();return null!=this.stemExtensionOverride?this.stemExtensionOverride:e?1===this.getStemDirection()?e.stem_up_extension:e.stem_down_extension:0}},{key:"setStemLength",value:function(e){return this.stemExtensionOverride=e-B.HEIGHT,this}},{key:"getStemExtents",value:function(){return this.stem.getExtents()}},{key:"setBeam",value:function(e){return this.beam=e,this}},{key:"getYForTopText",value:function(e){var t=this.getStemExtents();return this.hasStem()?Math.min(this.stave.getYForTopText(e),t.topY-this.render_options.annotation_spacing*(e+1)):this.stave.getYForTopText(e)}},{key:"getYForBottomText",value:function(e){var t=this.getStemExtents();return this.hasStem()?Math.max(this.stave.getYForTopText(e),t.baseY+this.render_options.annotation_spacing*e):this.stave.getYForBottomText(e)}},{key:"hasFlag",value:function(){return this.renderFlag&&T.getGlyphProps(this.duration).flag&&!this.beam}},{key:"postFormat",value:function(){return this.beam&&this.beam.postFormat(),this.postFormatted=!0,this}},{key:"drawStem",value:function(e){this.checkContext(),this.setRendered(),this.setStem(new B(e)),this.stem.setContext(this.context).draw()}}]),n}(X),q=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","Modifier"),e.width=0,e.note=null,e.index=null,e.text_line=0,e.position=n.Position.LEFT,e.modifier_context=null,e.x_shift=0,e.y_shift=0,e.spacingFromNextModifier=0,e}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getWidth",value:function(){return this.width}},{key:"setWidth",value:function(e){return this.width=e,this}},{key:"getNote",value:function(){return this.note}},{key:"setNote",value:function(e){return this.note=e,this}},{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return this.index=e,this}},{key:"getModifierContext",value:function(){return this.modifier_context}},{key:"setModifierContext",value:function(e){return this.modifier_context=e,this}},{key:"getPosition",value:function(){return this.position}},{key:"setPosition",value:function(e){return this.position="string"==typeof e?n.PositionString[e]:e,this}},{key:"setTextLine",value:function(e){return this.text_line=e,this}},{key:"setYShift",value:function(e){return this.y_shift=e,this}},{key:"setSpacingFromNextModifier",value:function(e){this.spacingFromNextModifier=e}},{key:"getSpacingFromNextModifier",value:function(){return this.spacingFromNextModifier}},{key:"setXShift",value:function(e){this.x_shift=0,this.position===n.Position.LEFT?this.x_shift-=e:this.x_shift+=e}},{key:"getXShift",value:function(){return this.x_shift}},{key:"draw",value:function(){throw this.checkContext(),new i.RERR("MethodNotImplemented","draw() not implemented for this modifier.")}},{key:"alignSubNotesWithNote",value:function(e,t){var n=t.getTickContext(),i=n.getExtraPx(),r=n.getX()-i.left-i.extraLeft+this.getSpacingFromNextModifier();e.forEach((function(e){var n=e.getTickContext();e.setStave(t.stave),n.setXOffset(r)}))}}],[{key:"CATEGORY",get:function(){return"none"}},{key:"Position",get:function(){return{LEFT:1,RIGHT:2,ABOVE:3,BELOW:4}}},{key:"PositionString",get:function(){return{above:n.Position.ABOVE,below:n.Position.BELOW,left:n.Position.LEFT,right:n.Position.RIGHT}}}]),n}(_),Z=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","Dot"),e.note=null,e.index=null,e.position=q.Position.RIGHT,e.radius=2,e.setWidth(5),e.dot_shiftY=0,e}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setNote",value:function(e){this.note=e,"gracenotes"===this.note.getCategory()&&(this.radius*=.5,this.setWidth(3))}},{key:"setDotShiftY",value:function(e){return this.dot_shiftY=e,this}},{key:"draw",value:function(){if(this.checkContext(),this.setRendered(),!this.note||null===this.index)throw new i.RERR("NoAttachedNote","Can't draw dot without a note and index.");var e=this.note.stave.options.spacing_between_lines_px,t=this.note.getModifierStartXY(this.position,this.index,{forceFlagRight:!0});"tabnotes"===this.note.getCategory()&&(t.y=this.note.getStemExtents().baseY);var n=t.x+this.x_shift+this.width-this.radius,r=t.y+this.y_shift+this.dot_shiftY*e,a=this.context;a.beginPath(),a.arc(n,r,this.radius,0,2*Math.PI,!1),a.fill()}}],[{key:"CATEGORY",get:function(){return"dots"}},{key:"format",value:function(e,t){var n=t.right_shift;if(!e||0===e.length)return!1;for(var i=[],r={},a=0;a<e.length;++a){var s=e[a],o=s.getNote(),u=void 0,l=void 0;"function"==typeof o.getKeyProps?l=(u=o.getKeyProps()[s.getIndex()]).displaced?o.getExtraRightPx():0:(u={line:.5},l=0);var c=o.getAttribute("id");i.push({line:u.line,note:o,note_id:c,dot:s}),r[c]=Math.max(r[c]||l,l)}i.sort((function(e,t){return t.line-e.line}));for(var h=n,d=0,f=null,p=null,m=null,v=0,g=0;g<i.length;++g){var y=i[g],b=y.dot,S=y.note,x=y.note_id,_=y.line;_===f&&S===p||(h=r[x]),S.isRest()||_===f||(.5===Math.abs(_%1)?v=0:(v=.5,null==p||p.isRest()||f-_!=.5?_+v===m&&(v=-.5):v=-.5)),S.isRest()?b.dot_shiftY+=-v:b.dot_shiftY=-v,m=_+v,b.setXShift(h),d=(h+=b.getWidth()+1)>d?h:d,f=_,p=S}return t.right_shift+=d,!0}}]),n}(q);function J(e,t,n){var i=(t.isrest?0:1)*n;e.line+=i,e.maxLine+=i,e.minLine+=i,e.note.setKeyLine(0,e.note.getKeyLine(0)+i)}var Q=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this,e)).setAttribute("type","StaveNote"),r.keys=e.keys,r.clef=e.clef,r.octave_shift=e.octave_shift,r.beam=null,r.glyph=T.getGlyphProps(r.duration,r.noteType),!r.glyph)throw new i.RuntimeError("BadArguments","Invalid note initialization data (No glyph found): ".concat(JSON.stringify(e)));return r.displaced=!1,r.dot_shiftY=0,r.addDotsCount=0,r.keyProps=[],r.use_default_head_x=!1,r.note_heads=[],r.modifiers=[],i.Merge(r.render_options,{glyph_font_scale:e.glyph_font_scale||T.DEFAULT_NOTATION_FONT_SCALE,stroke_px:e.stroke_px||n.DEFAULT_LEDGER_LINE_OFFSET}),r.calculateKeyProps(),r.buildStem(),e.auto_stem?r.autoStem():r.setStemDirection(e.stem_direction),r.reset(),r.buildFlag(),s(r)}return y(n,[{key:"reset",value:function(){var e=this;o(u(n.prototype),"reset",this).call(this);var t=this.note_heads.map((function(e){return e.getStyle()})),i=[];this.note_heads.forEach((function(e){return i.push(e.note_type)})),this.buildNoteHeads(),this.note_heads.forEach((function(e,n){e.setStyle(t[n]),i[n]&&(e.note_type=i[n])})),this.stave&&this.note_heads.forEach((function(t){return t.setStave(e.stave)})),this.calcExtraPx()}},{key:"setBeam",value:function(e){return this.beam=e,this.calcExtraPx(),this}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"buildStem",value:function(){this.setStem(new B({hide:!!this.isRest()})),this.stem.id=i.Prefix("".concat(this.getAttribute("id"),"-stem"))}},{key:"buildNoteHeads",value:function(){this.note_heads=[];var e,t,n,i=this.getStemDirection(),r=this.getKeys(),a=null,s=null,o=!1;i===B.UP?(e=0,t=r.length,n=1):i===B.DOWN&&(e=r.length-1,t=-1,n=-1);for(var u=e;u!==t;u+=n){var l=this.keyProps[u],c=l.line;null===a?a=c:0===(s=Math.abs(a-c))||.5===s?o=!o:(o=!1,this.use_default_head_x=!0),a=c;var h=new Y({duration:this.duration,note_type:this.noteType,displaced:o,stem_direction:i,custom_glyph_code:l.code,glyph_font_scale:this.render_options.glyph_font_scale,x_shift:l.shift_right,stem_up_x_offset:l.stem_up_x_offset,stem_down_x_offset:l.stem_down_x_offset,line:l.line});this.note_heads[u]=h}}},{key:"autoStem",value:function(){this.minLine=this.keyProps[0].line,this.maxLine=this.keyProps[this.keyProps.length-1].line;var e=(this.minLine+this.maxLine)/2<3?B.UP:B.DOWN;this.setStemDirection(e)}},{key:"calculateKeyProps",value:function(){for(var e=null,t=0;t<this.keys.length;++t){var n=this.keys[t];this.glyph.rest&&(this.glyph.position=n);var r={octave_shift:this.octave_shift||0},a=T.keyProperties(n,this.clef,r);if(!a)throw new i.RuntimeError("BadArguments","Invalid key for note properties: ".concat(n));"R"===a.key&&("1"===this.duration||"w"===this.duration?a.line=4:a.line=3);var s=a.line;null===e?e=s:.5===Math.abs(e-s)&&(this.displaced=!0,a.displaced=!0,this.keyProps.length>0&&(this.keyProps[t-1].displaced=!0)),e=s,this.keyProps.push(a)}e=-1/0,this.keyProps.forEach((function(t){t.line<e&&i.W("Unsorted keys in note will be sorted. See https://github.com/0xfe/vexflow/issues/104 for details."),e=t.line})),this.keyProps.sort((function(e,t){return e.line-t.line}))}},{key:"getBoundingBox",value:function(){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call getBoundingBox on an unformatted note.");var e=this.getMetrics(),t=e.width,n=e.modLeftPx,r=e.extraLeftPx,a=this.getAbsoluteX()-n-r,s=0,o=0,u=this.getStave().getSpacingBetweenLines()/2,l=2*u;if(this.isRest()){var c=this.ys[0],h=T.durationToFraction(this.duration);h.equals(1)||h.equals(2)?(s=c-u,o=c+u):(s=c-this.glyph.line_above*l,o=c+this.glyph.line_below*l)}else if(this.glyph.stem){var d=this.getStemExtents();d.baseY+=u*this.stem_direction,s=Math.min(d.topY,d.baseY),o=Math.max(d.topY,d.baseY)}else{s=null,o=null;for(var f=0;f<this.ys.length;++f){var p=this.ys[f];0===f?(s=p,o=p):(s=Math.min(p,s),o=Math.max(p,o))}s-=u,o+=u}return new k(a,s,t,o-s)}},{key:"getLineNumber",value:function(e){if(!this.keyProps.length)throw new i.RERR("NoKeyProps","Can't get bottom note line, because note is not initialized properly.");for(var t=this.keyProps[0].line,n=0;n<this.keyProps.length;n++){var r=this.keyProps[n].line;e?r>t&&(t=r):r<t&&(t=r)}return t}},{key:"isRest",value:function(){return this.glyph.rest}},{key:"isChord",value:function(){return!this.isRest()&&this.keys.length>1}},{key:"hasStem",value:function(){return this.glyph.stem}},{key:"hasFlag",value:function(){return o(u(n.prototype),"hasFlag",this).call(this)&&!this.isRest()&&this.renderFlag}},{key:"getStemX",value:function(){return"r"===this.noteType?this.getCenterGlyphX():o(u(n.prototype),"getStemX",this).call(this)+B.WIDTH/(2*-this.getStemDirection())}},{key:"getYForTopText",value:function(e){var t=this.getStemExtents();return Math.min(this.stave.getYForTopText(e),t.topY-this.render_options.annotation_spacing*(e+1))}},{key:"getYForBottomText",value:function(e){var t=this.getStemExtents();return Math.max(this.stave.getYForTopText(e),t.baseY+this.render_options.annotation_spacing*e)}},{key:"setStave",value:function(e){o(u(n.prototype),"setStave",this).call(this,e);var t=this.note_heads.map((function(t){return t.setStave(e),t.getY()}));if(this.setYs(t),this.stem){var i=this.getNoteHeadBounds(),r=i.y_top,a=i.y_bottom;this.stem.setYBounds(r,a)}return this}},{key:"getKeys",value:function(){return this.keys}},{key:"getKeyProps",value:function(){return this.keyProps}},{key:"isDisplaced",value:function(){return this.displaced}},{key:"setNoteDisplaced",value:function(e){return this.displaced=e,this}},{key:"getTieRightX",value:function(){var e=this.getAbsoluteX();return e+=this.getGlyphWidth()+this.x_shift+this.extraRightPx,this.modifierContext&&(e+=this.modifierContext.getExtraRightPx()),e}},{key:"getTieLeftX",value:function(){var e=this.getAbsoluteX();return e+=this.x_shift-this.extraLeftPx}},{key:"getLineForRest",value:function(){var e=this.keyProps[0].line;if(this.keyProps.length>1){var t=this.keyProps[this.keyProps.length-1].line,n=Math.max(e,t),r=Math.min(e,t);e=i.MidLine(n,r)}return e}},{key:"getModifierStartXY",value:function(e,t,n){if(n=n||{},!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call GetModifierStartXY on an unformatted note");if(0===this.ys.length)throw new i.RERR("NoYValues","No Y-Values calculated for this note.");var r=q.Position,a=r.ABOVE,s=r.BELOW,o=r.LEFT,u=r.RIGHT,l=0;return e===o?l=-2:e===u?(l=this.getGlyphWidth()+this.x_shift+2,this.stem_direction===B.UP&&this.hasFlag()&&(n.forceFlagRight||function(e,t){return t===(e.getStemDirection()===B.UP?e.keyProps.length-1:0)}(this,t))&&(l+=this.flag.getMetrics().width)):e!==s&&e!==a||(l=this.getGlyphWidth()/2),{x:this.getAbsoluteX()+l,y:this.ys[t]}}},{key:"setStyle",value:function(e){o(u(n.prototype),"setStyle",this).call(this,e),this.note_heads.forEach((function(t){return t.setStyle(e)})),this.stem&&this.stem.setStyle(e)}},{key:"setStemStyle",value:function(e){this.stem&&this.getStem().setStyle(e)}},{key:"getStemStyle",value:function(){return this.stem.getStyle()}},{key:"setLedgerLineStyle",value:function(e){this.ledgerLineStyle=e}},{key:"getLedgerLineStyle",value:function(){return this.ledgerLineStyle}},{key:"setFlagStyle",value:function(e){this.flagStyle=e}},{key:"getFlagStyle",value:function(){return this.flagStyle}},{key:"setKeyStyle",value:function(e,t){return this.note_heads[e].setStyle(t),this}},{key:"setKeyLine",value:function(e,t){return this.keyProps[e].line=t,this.reset(),this}},{key:"getKeyLine",value:function(e){return this.keyProps[e].line}},{key:"addToModifierContext",value:function(e){this.setModifierContext(e);for(var t=0;t<this.modifiers.length;++t)this.modifierContext.addModifier(this.modifiers[t]);return this.modifierContext.addModifier(this),this.setPreFormatted(!1),this}},{key:"addModifier",value:function(e,t){return t.setNote(this),t.setIndex(e),this.modifiers.push(t),this.setPreFormatted(!1),this}},{key:"addAccidental",value:function(e,t){return this.addModifier(e,t)}},{key:"addArticulation",value:function(e,t){return this.addModifier(e,t)}},{key:"addAnnotation",value:function(e,t){return this.addModifier(e,t)}},{key:"addDot",value:function(e){var t=new Z;return t.setDotShiftY(this.glyph.dot_shiftY),this.addDotsCount++,this.addModifier(e,t)}},{key:"addDotToAll",value:function(){for(var e=0;e<this.keys.length;++e)this.addDot(e);return this}},{key:"getAccidentals",value:function(){return this.modifierContext.getModifiers("accidentals")}},{key:"getDots",value:function(){return this.modifierContext.getModifiers("dots")}},{key:"getVoiceShiftWidth",value:function(){return this.getGlyphWidth()*(this.displaced?2:1)}},{key:"calcExtraPx",value:function(){this.setExtraLeftPx(this.displaced&&this.stem_direction===B.DOWN?this.getGlyphWidth():0),this.setExtraRightPx(!this.hasFlag()&&this.displaced&&this.stem_direction===B.UP?this.getGlyphWidth():0)}},{key:"preFormat",value:function(){if(!this.preFormatted){this.modifierContext&&this.modifierContext.preFormat();var e=this.getGlyphWidth()+this.extraLeftPx+this.extraRightPx;this.renderFlag&&this.glyph.flag&&null===this.beam&&this.stem_direction===B.UP&&(e+=this.getGlyphWidth()),this.setWidth(e),this.setPreFormatted(!0)}}},{key:"getNoteHeadBounds",value:function(){var e=null,t=null,n=null,i=null,r=this.stave.getNumLines(),a=1,s=!1,o=!1,u=r,l=a;return this.note_heads.forEach((function(c){var h=c.getLine(),d=c.getY();(null===e||d<e)&&(e=d),(null===t||d>t)&&(t=d),null===i&&c.isDisplaced()&&(i=c.getAbsoluteX()),null!==n||c.isDisplaced()||(n=c.getAbsoluteX()),r=h>r?h:r,a=h<a?h:a,c.isDisplaced()?(s=!1===s?h:Math.max(h,s),o=!1===o?h:Math.min(h,o)):(u=Math.max(h,u),l=Math.min(h,l))}),this),{y_top:e,y_bottom:t,displaced_x:i,non_displaced_x:n,highest_line:r,lowest_line:a,highest_displaced_line:s,lowest_displaced_line:o,highest_non_displaced_line:u,lowest_non_displaced_line:l}}},{key:"getNoteHeadBeginX",value:function(){return this.getAbsoluteX()+this.x_shift}},{key:"getNoteHeadEndX",value:function(){return this.getNoteHeadBeginX()+this.getGlyphWidth()}},{key:"drawLedgerLines",value:function(){var e=this.stave,t=this.glyph,n=this.render_options.stroke_px,r=this.context,a=t.getWidth()+2*n,s=2*(t.getWidth()+n)-B.WIDTH/2;if(!this.isRest()){if(!r)throw new i.RERR("NoCanvasContext","Can't draw without a canvas context.");var o=this.getNoteHeadBounds(),u=o.highest_line,l=o.lowest_line,c=o.highest_displaced_line,h=o.highest_non_displaced_line,d=o.lowest_displaced_line,f=o.lowest_non_displaced_line,p=o.displaced_x,v=o.non_displaced_x,g=Math.min(p,v),y=function(e,t,i){var o;o=i&&t?g-n:t?v-n:p-n;var u=t&&i?s:a;r.beginPath(),r.moveTo(o,e),r.lineTo(o+u,e),r.stroke()},b=m(m({},e.getStyle()||{}),this.getLedgerLineStyle()||{});this.applyStyle(r,b);for(var S=6;S<=u;++S){var x=null!==v&&S<=h,_=null!==p&&S<=c;y(e.getYForNote(S),x,_)}for(var E=0;E>=l;--E){var k=null!==v&&E>=f,M=null!==p&&E>=d;y(e.getYForNote(E),k,M)}this.restoreStyle(r,b)}}},{key:"drawModifiers",value:function(){if(!this.context)throw new i.RERR("NoCanvasContext","Can't draw without a canvas context.");var e=this.context;e.openGroup("modifiers");for(var t=0;t<this.modifiers.length;t++){var n=this.modifiers[t],r=this.note_heads[n.getIndex()],a=r.getStyle();r.applyStyle(e,a),n.setContext(e),n.drawWithStyle(),r.restoreStyle(e,a)}e.closeGroup()}},{key:"drawFlag",value:function(){var e=this.stem,t=this.beam,n=this.context;if(!n)throw new i.RERR("NoCanvasContext","Can't draw without a canvas context.");var r=null===t&&this.renderFlag;if(this.getGlyph().flag&&r){var a=this.getNoteHeadBounds(),s=a.y_top,o=a.y_bottom,u=e.getHeight(),l=this.getStemX(),c=this.getStemDirection()===B.DOWN?s-u+2:o-u-2;n.openGroup("flag",null,{pointerBBox:!0}),this.applyStyle(n,this.getFlagStyle()||!1),this.flag.render(n,l,c),this.restoreStyle(n,this.getFlagStyle()||!1),n.closeGroup()}}},{key:"drawNoteHeads",value:function(){var e=this;this.note_heads.forEach((function(t){e.context.openGroup("notehead",null,{pointerBBox:!0}),t.setContext(e.context).draw(),e.context.closeGroup()}))}},{key:"drawStem",value:function(e){if(!this.context)throw new i.RERR("NoCanvasContext","Can't draw without a canvas context.");e&&this.setStem(new B(e)),this.stem.id=i.Prefix("".concat(this.getAttribute("id"),"-stem")),this.stem&&(this.context.openGroup("stem",null,{pointerBBox:!0}),this.stem.setContext(this.context).draw(),this.context.closeGroup())}},{key:"draw",value:function(){if(!this.context)throw new i.RERR("NoCanvasContext","Can't draw without a canvas context.");if(!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");if(0===this.ys.length)throw new i.RERR("NoYValues","Can't draw note without Y values.");var e=this.getNoteHeadBeginX(),t=this.hasStem()&&!this.beam;if(this.note_heads.forEach((function(t){return t.setX(e)})),this.stem){var r=this.getStemX();this.stem.setNoteHeadXBounds(r,r)}!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.StaveNote",t)}("Rendering ",this.isChord()?"chord :":"note :",this.keys),this.drawLedgerLines(),this.applyStyle(),this.setAttribute("el",this.context.openGroup("stavenote",this.getAttribute("id"))),this.context.openGroup("note",null,{pointerBBox:!0}),t&&this.drawStem(),this.drawNoteHeads(),this.drawFlag(),this.context.closeGroup(),this.drawModifiers(),this.context.closeGroup(),this.restoreStyle(),this.setRendered()}}],[{key:"CATEGORY",get:function(){return"stavenotes"}},{key:"STEM_UP",get:function(){return B.UP}},{key:"STEM_DOWN",get:function(){return B.DOWN}},{key:"DEFAULT_LEDGER_LINE_OFFSET",get:function(){return 3}},{key:"format",value:function(e,t){if(!e||e.length<2)return!1;for(var n=[],r=e[0].stagger_same_whole_notes,a=0;a<e.length;a++){var s=e[a].getKeyProps(),o=s[0].line,u=s[s.length-1].line,l=e[a].getStemDirection(),c=e[a].getStemLength()/10,h=e[a].getStemMinumumLength()/10,d=void 0;e[a].isRest()?(d=o+e[a].glyph.line_above,u=o-e[a].glyph.line_below):(d=1===l?s[s.length-1].line+c:s[s.length-1].line,u=1===l?s[0].line:s[0].line-c),n.push({line:s[0].line,maxLine:d,minLine:u,isrest:e[a].isRest(),stemDirection:l,stemMax:c,stemMin:h,voice_shift:e[a].getVoiceShiftWidth(),is_displaced:e[a].isDisplaced(),note:e[a]})}var f=n.length,p=n[0],m=f>2?n[1]:null,v=f>2?n[2]:n[1];2===f&&-1===p.stemDirection&&1===v.stemDirection&&(p=n[1],v=n[0]);var g,y=Math.max(p.voice_shift,v.voice_shift),S=0;if(2===f){var x=p.stemDirection===v.stemDirection?0:.5;if(p.stemDirection===v.stemDirection&&p.minLine<=v.maxLine&&(p.isrest||(g=Math.abs(p.line-(v.maxLine+.5)),g=Math.max(g,p.stemMin),p.minLine=p.line-g,p.note.setStemLength(10*g))),p.minLine<=v.maxLine+x)if(p.isrest)J(p,v,1);else if(v.isrest)J(v,p,-1);else{S=y;var _=Math.abs(p.line-v.line),E=0,k=0;"h"===p.note.duration?E++:"w"===p.note.duration&&k++,"h"===v.note.duration?E++:"w"===v.note.duration&&k++;var M=1===E||1===k||p.note.dots!==v.note.dots;if(r&&(M=M||2===k),0===_&&M){if(v.note.setXShift(S),p.note.dots>0){var w,P=0,T=b(p.note.modifiers);try{for(T.s();!(w=T.n()).done;){var C=w.value;if(C instanceof Z&&(P++,C.setYShift(-10*(v.maxLine-p.line+1)),P===p.note.dots))break}}catch(I){T.e(I)}finally{T.f()}}}else _<1&&_>0?v.note.setXShift(S):p.note.voice!==v.note.voice&&p.stemDirection===v.stemDirection&&(p.line>v.line?1===p.stemDirection?v.note.renderFlag=!1:p.note.renderFlag=!1:v.line>p.line?1===v.stemDirection?p.note.renderFlag=!1:v.note.renderFlag=!1:1===v.stemDirection&&(v.stemDirection=-1,v.note.setStemDirection(-1)))}return!0}return null!==m&&m.minLine<v.maxLine+.5&&(m.isrest||(g=Math.abs(m.line-(v.maxLine+.5)),g=Math.max(g,m.stemMin),m.minLine=m.line-g,m.note.setStemLength(10*g))),m.isrest&&!p.isrest&&!v.isrest&&(p.minLine<=m.maxLine||m.minLine<=v.maxLine)?(m.maxLine-m.minLine<p.minLine-v.maxLine?function(e,t,n){var r=e.line-i.MidLine(t.minLine,n.maxLine);e.note.setKeyLine(0,e.note.getKeyLine(0)-r),e.line-=r,e.maxLine-=r,e.minLine-=r}(m,p,v):(S=y+3,m.note.setXShift(S)),!0):p.isrest&&m.isrest&&v.isrest?(J(p,m,1),J(v,m,-1),!0):(m.isrest&&p.isrest&&m.minLine<=v.maxLine&&J(m,v,1),m.isrest&&v.isrest&&p.minLine<=m.maxLine&&J(m,p,-1),p.isrest&&p.minLine<=m.maxLine&&J(p,m,1),v.isrest&&m.minLine<=v.maxLine&&J(v,m,-1),(!p.isrest&&!m.isrest&&p.minLine<=m.maxLine+.5||!m.isrest&&!v.isrest&&m.minLine<=v.maxLine)&&(S=y+3,m.note.setXShift(S)),!0)}},{key:"formatByY",value:function(e,t){for(var n=!0,r=0;r<e.length;r++)n=n&&null!=e[r].getStave();if(!n)throw new i.RERR("Stave Missing","All notes must have a stave - Vex.Flow.ModifierContext.formatMultiVoice!");for(var a=0,s=0;s<e.length-1;s++){var o=e[s],u=e[s+1];o.maxLine<u.maxLine&&(o=e[s+1],u=e[s]);var l=o.getKeyProps(),c=u.getKeyProps(),h=.5,d=o.getStave().getYForLine(5-l[0].line+h);u.getStave().getYForLine(5-c[c.length-1].line-h)-d<0&&o.voice===u.voice&&(a=o.getVoiceShiftWidth()+2,u.setXShift(a))}t.right_shift+=a}},{key:"postFormat",value:function(e){return!!e&&(e.forEach((function(e){return e.postFormat()})),!0)}}]),n}(K),$=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","FretHandFinger"),i.note=null,i.index=null,i.finger=e,i.width=7,i.position=q.Position.LEFT,i.x_shift=0,i.y_shift=0,i.x_offset=0,i.y_offset=0,i.font={family:"sans-serif",size:9,weight:"bold"},i}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setFretHandFinger",value:function(e){return this.finger=e,this}},{key:"setOffsetX",value:function(e){return this.x_offset=e,this}},{key:"setOffsetY",value:function(e){return this.y_offset=e,this}},{key:"draw",value:function(){if(this.checkContext(),!this.note||null==this.index)throw new i.RERR("NoAttachedNote","Can't draw string number without a note and index.");this.setRendered();var e=this.context,t=this.note.getModifierStartXY(this.position,this.index),n=t.x+this.x_shift+this.x_offset,r=t.y+this.y_shift+this.y_offset+5;switch(this.position){case q.Position.ABOVE:n-=4,r-=12;break;case q.Position.BELOW:n-=2,r+=10;break;case q.Position.LEFT:n-=this.width;break;case q.Position.RIGHT:n+=1;break;default:throw new i.RERR("InvalidPostion","The position ".concat(this.position," does not exist"))}e.save(),e.setFont(this.font.family,this.font.size,this.font.weight),e.fillText(""+this.finger,n,r),e.restore()}}],[{key:"CATEGORY",get:function(){return"frethandfinger"}},{key:"format",value:function(e,t){var n=t.left_shift,i=t.right_shift;if(!e||0===e.length)return!1;for(var r=[],a=null,s=0,o=0,u=0;u<e.length;++u){var l=e[u],c=l.getNote(),h=l.getPosition(),d=c.getKeyProps()[l.getIndex()];if(c!==a){for(var f=0;f<c.keys.length;++f){var p=c.getKeyProps()[f];0===n&&(s=p.displaced?c.getExtraLeftPx():s),0===i&&(o=p.displaced?c.getExtraRightPx():o)}a=c}r.push({note:c,num:l,pos:h,line:d.line,shiftL:s,shiftR:o})}r.sort((function(e,t){return t.line-e.line}));for(var m=0,v=0,g=0,y=0,b=null,S=null,x=0;x<r.length;++x){var _=0,E=r[x],k=E.note,M=E.pos,w=E.num,P=E.line,T=E.shiftL,C=E.shiftR;P===b&&k===S||(m=n+T,v=i+C);var I=w.getWidth()+1;M===q.Position.LEFT?(w.setXShift(n+m),g=(_=n+I)>g?_:g):M===q.Position.RIGHT&&(w.setXShift(v),y=(_=o+I)>y?_:y),b=P,S=k}return t.left_shift+=g,t.right_shift+=y,!0}}]),n}(q),ee=function(){function e(){g(this,e)}return y(e,[{key:"isValidNoteValue",value:function(t){return!(null==t||t<0||t>=e.NUM_TONES)}},{key:"isValidIntervalValue",value:function(e){return this.isValidNoteValue(e)}},{key:"getNoteParts",value:function(e){if(!e||e.length<1)throw new i.RERR("BadArguments","Invalid note name: "+e);if(e.length>3)throw new i.RERR("BadArguments","Invalid note name: "+e);var t=e.toLowerCase(),n=/^([cdefgab])(b|bb|n|#|##)?$/.exec(t);if(null!=n)return{root:n[1],accidental:n[2]};throw new i.RERR("BadArguments","Invalid note name: "+e)}},{key:"getKeyParts",value:function(e){if(!e||e.length<1)throw new i.RERR("BadArguments","Invalid key: "+e);var t=e.toLowerCase(),n=/^([cdefgab])(b|#)?(mel|harm|m|M)?$/.exec(t);if(null!=n){var r=n[1],a=n[2],s=n[3];return s||(s="M"),{root:r,accidental:a,type:s}}throw new i.RERR("BadArguments","Invalid key: ".concat(e))}},{key:"getNoteValue",value:function(t){var n=e.noteValues[t];if(null==n)throw new i.RERR("BadArguments","Invalid note name: ".concat(t));return n.int_val}},{key:"getIntervalValue",value:function(t){var n=e.intervals[t];if(null==n)throw new i.RERR("BadArguments","Invalid interval name: ".concat(t));return n}},{key:"getCanonicalNoteName",value:function(t){if(!this.isValidNoteValue(t))throw new i.RERR("BadArguments","Invalid note value: ".concat(t));return e.canonical_notes[t]}},{key:"getCanonicalIntervalName",value:function(t){if(!this.isValidIntervalValue(t))throw new i.RERR("BadArguments","Invalid interval value: ".concat(t));return e.diatonic_intervals[t]}},{key:"getRelativeNoteValue",value:function(t,n,r){if(null==r&&(r=1),1!==r&&-1!==r)throw new i.RERR("BadArguments","Invalid direction: ".concat(r));var a=(t+r*n)%e.NUM_TONES;return a<0&&(a+=e.NUM_TONES),a}},{key:"getRelativeNoteName",value:function(t,n){var r=this.getNoteParts(t),a=this.getNoteValue(r.root),s=n-a;if(Math.abs(s)>e.NUM_TONES-3){var o=1;s>0&&(o=-1);var u=(n+1+(a+1))%e.NUM_TONES*o;if(Math.abs(u)>2)throw new i.RERR("BadArguments","Notes not related: ".concat(t,", ").concat(n,")"));s=u}if(Math.abs(s)>2)throw new i.RERR("BadArguments","Notes not related: ".concat(t,", ").concat(n,")"));var l=r.root;if(s>0)for(var c=1;c<=s;++c)l+="#";else if(s<0)for(var h=-1;h>=s;--h)l+="b";return l}},{key:"getScaleTones",value:function(e,t){for(var n=[e],i=e,r=0;r<t.length;r+=1)(i=this.getRelativeNoteValue(i,t[r]))!==e&&n.push(i);return n}},{key:"getIntervalBetween",value:function(t,n,r){if(null==r&&(r=1),1!==r&&-1!==r)throw new i.RERR("BadArguments","Invalid direction: ".concat(r));if(!this.isValidNoteValue(t)||!this.isValidNoteValue(n))throw new i.RERR("BadArguments","Invalid notes: ".concat(t,", ").concat(n));var a=1===r?n-t:t-n;return a<0&&(a+=e.NUM_TONES),a}},{key:"createScaleMap",value:function(t){var n=this.getKeyParts(t),r=e.scaleTypes[n.type],a=n.root;if(n.accidental&&(a+=n.accidental),!r)throw new i.RERR("BadArguments","Unsupported key type: "+t);for(var s=this.getScaleTones(this.getNoteValue(a),r),o=e.root_indices[n.root],u={},l=0;l<e.roots.length;++l){var c=(o+l)%e.roots.length,h=e.roots[c],d=this.getRelativeNoteName(h,s[l]);1===d.length&&(d+="n"),u[h]=d}return u}}],[{key:"NUM_TONES",get:function(){return 12}},{key:"roots",get:function(){return["c","d","e","f","g","a","b"]}},{key:"root_values",get:function(){return[0,2,4,5,7,9,11]}},{key:"root_indices",get:function(){return{c:0,d:1,e:2,f:3,g:4,a:5,b:6}}},{key:"canonical_notes",get:function(){return["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"]}},{key:"diatonic_intervals",get:function(){return["unison","m2","M2","m3","M3","p4","dim5","p5","m6","M6","b7","M7","octave"]}},{key:"diatonic_accidentals",get:function(){return{unison:{note:0,accidental:0},m2:{note:1,accidental:-1},M2:{note:1,accidental:0},m3:{note:2,accidental:-1},M3:{note:2,accidental:0},p4:{note:3,accidental:0},dim5:{note:4,accidental:-1},p5:{note:4,accidental:0},m6:{note:5,accidental:-1},M6:{note:5,accidental:0},b7:{note:6,accidental:-1},M7:{note:6,accidental:0},octave:{note:7,accidental:0}}}},{key:"intervals",get:function(){return{u:0,unison:0,m2:1,b2:1,min2:1,S:1,H:1,2:2,M2:2,maj2:2,T:2,W:2,m3:3,b3:3,min3:3,M3:4,3:4,maj3:4,4:5,p4:5,"#4":6,b5:6,aug4:6,dim5:6,5:7,p5:7,"#5":8,b6:8,aug5:8,6:9,M6:9,maj6:9,b7:10,m7:10,min7:10,dom7:10,M7:11,maj7:11,8:12,octave:12}}},{key:"scales",get:function(){return{major:[2,2,1,2,2,2,1],dorian:[2,1,2,2,2,1,2],mixolydian:[2,2,1,2,2,1,2],minor:[2,1,2,2,1,2,2]}}},{key:"scaleTypes",get:function(){return{M:e.scales.major,m:e.scales.minor}}},{key:"accidentals",get:function(){return["bb","b","n","#","##"]}},{key:"noteValues",get:function(){return{c:{root_index:0,int_val:0},cn:{root_index:0,int_val:0},"c#":{root_index:0,int_val:1},"c##":{root_index:0,int_val:2},cb:{root_index:0,int_val:11},cbb:{root_index:0,int_val:10},d:{root_index:1,int_val:2},dn:{root_index:1,int_val:2},"d#":{root_index:1,int_val:3},"d##":{root_index:1,int_val:4},db:{root_index:1,int_val:1},dbb:{root_index:1,int_val:0},e:{root_index:2,int_val:4},en:{root_index:2,int_val:4},"e#":{root_index:2,int_val:5},"e##":{root_index:2,int_val:6},eb:{root_index:2,int_val:3},ebb:{root_index:2,int_val:2},f:{root_index:3,int_val:5},fn:{root_index:3,int_val:5},"f#":{root_index:3,int_val:6},"f##":{root_index:3,int_val:7},fb:{root_index:3,int_val:4},fbb:{root_index:3,int_val:3},g:{root_index:4,int_val:7},gn:{root_index:4,int_val:7},"g#":{root_index:4,int_val:8},"g##":{root_index:4,int_val:9},gb:{root_index:4,int_val:6},gbb:{root_index:4,int_val:5},a:{root_index:5,int_val:9},an:{root_index:5,int_val:9},"a#":{root_index:5,int_val:10},"a##":{root_index:5,int_val:11},ab:{root_index:5,int_val:8},abb:{root_index:5,int_val:7},b:{root_index:6,int_val:11},bn:{root_index:6,int_val:11},"b#":{root_index:6,int_val:0},"b##":{root_index:6,int_val:1},bb:{root_index:6,int_val:10},bbb:{root_index:6,int_val:9}}}}]),e}();function te(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ie.DEBUG&&i.L("Vex.Flow.Accidental",t)}var ne=function(e){return e.getMetrics().width},ie=function(e){h(n,e);var t=d(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(g(this,n),(e=t.call(this)).setAttribute("type","Accidental"),te("New accidental: ",r),e.note=null,e.index=null,e.type=r,e.position=q.Position.LEFT,e.render_options={font_scale:38,stroke_px:3,parenLeftPadding:2,parenRightPadding:2},e.accidental=T.accidentalCodes(e.type),!e.accidental)throw new i.RERR("ArgumentError","Unknown accidental type: ".concat(r));return e.cautionary=!1,e.parenLeft=null,e.parenRight=null,e.reset(),s(e)}return y(n,[{key:"reset",value:function(){var e=this.render_options.font_scale;this.glyph=new P(this.accidental.code,e),this.glyph.setOriginX(1),this.cautionary&&(this.parenLeft=new P(T.accidentalCodes("{").code,e),this.parenRight=new P(T.accidentalCodes("}").code,e),this.parenLeft.setOriginX(1),this.parenRight.setOriginX(1))}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getWidth",value:function(){var e=this.cautionary?ne(this.parenLeft)+ne(this.parenRight)+this.render_options.parenLeftPadding+this.render_options.parenRightPadding:0;return ne(this.glyph)+e}},{key:"setNote",value:function(e){if(!e)throw new i.RERR("ArgumentError","Bad note value: ".concat(e));this.note=e,"gracenotes"===this.note.getCategory()&&(this.render_options.font_scale=25,this.reset())}},{key:"setAsCautionary",value:function(){return this.cautionary=!0,this.render_options.font_scale=28,this.reset(),this}},{key:"draw",value:function(){var e=this.context,t=this.type,n=this.position,r=this.note,a=this.index,s=this.cautionary,o=this.x_shift,u=this.y_shift,l=this.glyph,c=this.parenLeft,h=this.parenRight,d=this.render_options,f=d.parenLeftPadding,p=d.parenRightPadding;if(this.checkContext(),!r||null==a)throw new i.RERR("NoAttachedNote","Can't draw accidental without a note and index.");var m=r.getModifierStartXY(n,a),v=m.x+o,g=m.y+u;te("Rendering: ",t,v,g),s?(h.render(e,v,g),v-=ne(h),v-=p,v-=this.accidental.parenRightPaddingAdjustment,l.render(e,v,g),v-=ne(l),v-=f,c.render(e,v,g)):l.render(e,v,g),this.setRendered()}}],[{key:"CATEGORY",get:function(){return"accidentals"}},{key:"format",value:function(e,t){var n=this,i=t.left_shift+1;if(e&&0!==e.length){for(var r=[],a=null,s=0,o=0;o<e.length;++o){var u=e[o],l=u.getNote(),c=l.getStave(),h=l.getKeyProps()[u.getIndex()];if(l!==a){for(var d=0;d<l.keys.length;++d)s=l.getKeyProps()[d].displaced?l.getExtraLeftPx():s;a=l}if(null!==c){var f=c.options.spacing_between_lines_px,p=c.getYForLine(h.line),m=Math.round(p/f*2)/2;r.push({y:p,line:m,shift:s,acc:u,lineSpace:f})}else r.push({line:h.line,shift:s,acc:u})}r.sort((function(e,t){return t.line-e.line}));for(var v=[],g=0,y=null,b=0;b<r.length;b++){var _=r[b];null!==y&&y===_.line||v.push({line:_.line,flatLine:!0,dblSharpLine:!0,numAcc:0,width:0}),"b"!==_.acc.type&&"bb"!==_.acc.type&&(v[v.length-1].flatLine=!1),"##"!==_.acc.type&&(v[v.length-1].dblSharpLine=!1),v[v.length-1].numAcc++,v[v.length-1].width+=_.acc.getWidth()+3,g=_.shift>g?_.shift:g,y=_.line}for(var E=0,k=function(e){for(var t=!1,i=e,r=e;r+1<v.length&&!t;)n.checkCollision(v[r],v[r+1])?r++:t=!0;var a=function(e){return v[i+e]},s=function(e){return e.map(a)},o=function(t,n){var i=s([t,n]).map((function(e){return e.line})),r=x(i,2),a=r[0],o=r[1];return M=e,a-o},u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(s).every((function(e){return!n.checkCollision.apply(n,S(e))}))},l=r-i+1,c=void 0,h=void 0,d=n.checkCollision(v[i],v[r])?"a":"b";switch(l){case 3:"a"===d&&.5===o(1,2)&&.5!==o(0,1)&&(d="second_on_bottom");break;case 4:u([0,2],[1,3])&&(d="spaced_out_tetrachord");break;case 5:"b"===d&&u([1,3])&&(d="spaced_out_pentachord",u([0,2],[2,4])&&(d="very_spaced_out_pentachord"));break;case 6:u([0,3],[1,4],[2,5])&&(d="spaced_out_hexachord"),u([0,2],[2,4],[1,3],[3,5])&&(d="very_spaced_out_hexachord")}if(l>=7){for(var f=2,p=!0;!0===p;){p=!1;for(var m=0;m+f<v.length;m++)if(n.checkCollision(v[m],v[m+f])){p=!0,f++;break}}for(c=e;c<=r;c++)h=(c-e)%f+1,v[c].column=h,E=E>h?E:h}else for(c=e;c<=r;c++)h=T.accidentalColumnsTable[l][d][c-e],v[c].column=h,E=E>h?E:h;M=e=r},M=0;M<v.length;M++)k(M);for(var w=[],P=[],C=0;C<=E;C++)w[C]=0,P[C]=0;w[0]=g+i,P[0]=g+i,v.forEach((function(e){e.width>w[e.column]&&(w[e.column]=e.width)}));for(var I=1;I<w.length;I++)P[I]=w[I]+P[I-1];var A=P[P.length-1],L=0;v.forEach((function(e){for(var t=0,n=L+e.numAcc;L<n;L++){var i=P[e.column-1]+t;r[L].acc.setXShift(i),t+=r[L].acc.getWidth()+3,te("Line, accCount, shift: ",e.line,L,i)}})),t.left_shift+=A}}},{key:"checkCollision",value:function(e,t){var n=t.line-e.line,i=3;n>0?(i=t.flatLine||t.dblSharpLine?2.5:3,e.dblSharpLine&&(n-=.5)):(i=e.flatLine||e.dblSharpLine?2.5:3,t.dblSharpLine&&(n-=.5));var r=Math.abs(n)<i;return te("Line_1, Line_2, Collision: ",e.line,t.line,r),r}},{key:"applyAccidentals",value:function(e,t){var i=[],r={};e.forEach((function(e){var t=new a(0,1);e.getTickables().forEach((function(e){if(!e.shouldIgnoreTicks()){var n=r[t.value()];n?n.push(e):(i.push(t.value()),r[t.value()]=[e]),t.add(e.getTicks())}}))}));var s=new ee;t||(t="C");var o=s.createScaleMap(t);i.forEach((function(e){var t=r[e],i=[],a=function e(t){t.isRest()||t.shouldIgnoreTicks()||(t.keys.forEach((function(e,r){var a=s.getNoteParts(e.split("/")[0]),u=a.accidental||"n",l=a.root+u,c=o[a.root]===l,h=i.indexOf(l)>-1;if(!c||c&&h){o[a.root]=l;var d=new n(u);t.addAccidental(r,d),i.push(l)}})),t.getModifiers().forEach((function(t){"gracenotegroups"===t.getCategory()&&t.getGraceNotes().forEach(e)})))};t.forEach(a)}))}}]),n}(q),re=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),s(i,((i=t.call(this)).setAttribute("type","NoteSubGroup"),i.note=null,i.index=null,i.position=q.Position.LEFT,i.subNotes=e,i.subNotes.forEach((function(e){e.ignore_ticks=!1})),i.width=0,i.preFormatted=!1,i.formatter=new Te,i.voice=new W({num_beats:4,beat_value:4,resolution:T.RESOLUTION}).setStrict(!1),i.voice.addTickables(i.subNotes),c(i)))}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"preFormat",value:function(){this.preFormatted||(this.formatter.joinVoices([this.voice]).format([this.voice],0),this.setWidth(this.formatter.getMinTotalWidth()),this.preFormatted=!0)}},{key:"setNote",value:function(e){this.note=e}},{key:"setWidth",value:function(e){this.width=e}},{key:"getWidth",value:function(){return this.width}},{key:"draw",value:function(){var e=this;this.checkContext();var t=this.getNote();if(!t||null===this.index)throw new i.RuntimeError("NoAttachedNote","Can't draw notes without a parent note and parent note index.");this.setRendered(),this.alignSubNotesWithNote(this.subNotes,t),this.subNotes.forEach((function(t){return t.setContext(e.context).drawWithStyle()}))}}],[{key:"CATEGORY",get:function(){return"notesubgroup"}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;for(var n=0,i=0;i<e.length;++i){var r=e[i];r.preFormat(),n+=r.getWidth()}return t.left_shift+=n,!0}}]),n}(q),ae=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this)).setAttribute("type","StaveTie"),r.notes=e,r.context=null,r.text=i,r.direction=null,r.render_options={cp1:8,cp2:12,text_shift_x:0,first_x_shift:0,last_x_shift:0,y_shift:7,tie_spacing:0,font:{family:"Arial",size:10,style:""}},r.font=r.render_options.font,r.setNotes(e),r}return y(n,[{key:"setFont",value:function(e){return this.font=e,this}},{key:"setDirection",value:function(e){return this.direction=e,this}},{key:"setNotes",value:function(e){if(!e.first_note&&!e.last_note)throw new i.RuntimeError("BadArguments","Tie needs to have either first_note or last_note set.");if(e.first_indices||(e.first_indices=[0]),e.last_indices||(e.last_indices=[0]),e.first_indices.length!==e.last_indices.length)throw new i.RuntimeError("BadArguments","Tied notes must have similar index sizes");return this.first_note=e.first_note,this.first_indices=e.first_indices,this.last_note=e.last_note,this.last_indices=e.last_indices,this}},{key:"isPartial",value:function(){return!this.first_note||!this.last_note}},{key:"renderTie",value:function(e){if(0===e.first_ys.length||0===e.last_ys.length)throw new i.RERR("BadArguments","No Y-values to render");var t=this.context,n=this.render_options.cp1,r=this.render_options.cp2;Math.abs(e.last_x_px-e.first_x_px)<10&&(n=2,r=8);for(var a=this.render_options.first_x_shift,s=this.render_options.last_x_shift,o=this.render_options.y_shift*e.direction,u=0;u<this.first_indices.length;++u){var l=(e.last_x_px+s+(e.first_x_px+a))/2,c=e.first_ys[this.first_indices[u]]+o,h=e.last_ys[this.last_indices[u]]+o;if(isNaN(c)||isNaN(h))throw new i.RERR("BadArguments","Bad indices for tie rendering.");var d=(c+h)/2+n*e.direction,f=(c+h)/2+r*e.direction,p=void 0;this.first_note&&(p=this.first_note.getAttribute("id")+"-tie"),this.setAttribute("el",t.openGroup("stavetie",p)),t.beginPath(),t.moveTo(e.first_x_px+a,c),t.quadraticCurveTo(l,d,e.last_x_px+s,h),t.quadraticCurveTo(l,f,e.first_x_px+a,c),t.closePath(),t.fill(),t.closeGroup()}}},{key:"renderText",value:function(e,t){if(this.text){var n=(e+t)/2;n-=this.context.measureText(this.text).width/2,this.context.save(),this.context.setFont(this.font.family,this.font.size,this.font.style),this.context.fillText(this.text,n+this.render_options.text_shift_x,(this.first_note||this.last_note).getStave().getYForTopText()-1),this.context.restore()}}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e,t,n,i,r,a=this.first_note,s=this.last_note;return a?(e=a.getTieRightX()+this.render_options.tie_spacing,r=a.getStemDirection(),n=a.getYs()):(e=s.getStave().getTieStartX(),n=s.getYs(),this.first_indices=this.last_indices),s?(t=s.getTieLeftX()+this.render_options.tie_spacing,r=s.getStemDirection(),i=s.getYs()):(t=a.getStave().getTieEndX(),i=a.getYs(),this.last_indices=this.first_indices),this.direction&&(r=this.direction),this.renderTie({first_x_px:e,last_x_px:t,first_ys:n,last_ys:i,direction:r}),this.renderText(e,t),!0}}]),n}(_),se=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this,e,i)).setAttribute("type","TabTie"),r.render_options.cp1=9,r.render_options.cp2=11,r.render_options.y_shift=3,r.setNotes(e),r}return y(n,[{key:"draw",value:function(){this.checkContext(),this.setRendered();var e,t,n,i,r=this.first_note,a=this.last_note;return r?(e=r.getTieRightX()+this.render_options.tie_spacing,n=r.getYs()):(e=a.getStave().getTieStartX(),n=a.getYs(),this.first_indices=this.last_indices),a?(t=a.getTieLeftX()+this.render_options.tie_spacing,i=a.getYs()):(t=r.getStave().getTieEndX(),i=r.getYs(),this.last_indices=this.first_indices),this.renderTie({first_x_px:e,last_x_px:t,first_ys:n,last_ys:i,direction:-1}),this.renderText(e,t),!0}}],[{key:"createHammeron",value:function(e){return new n(e,"H")}},{key:"createPulloff",value:function(e){return new n(e,"P")}}]),n}(ae),oe=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),s(r,((r=t.call(this)).setAttribute("type","GraceNoteGroup"),r.note=null,r.index=null,r.position=q.Position.LEFT,r.grace_notes=e,r.width=0,r.preFormatted=!1,r.show_slur=i,r.slur=null,r.formatter=new Te,r.voice=new W({num_beats:4,beat_value:4,resolution:T.RESOLUTION}).setStrict(!1),r.render_options={slur_y_shift:0},r.beams=[],r.voice.addTickables(r.grace_notes),c(r)))}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"preFormat",value:function(){this.preFormatted||(this.formatter.joinVoices([this.voice]).format([this.voice],0),this.setWidth(this.formatter.getMinTotalWidth()),this.preFormatted=!0)}},{key:"beamNotes",value:function(e){if((e=e||this.grace_notes).length>1){var t=new G(e);t.render_options.beam_width=3,t.render_options.partial_beam_length=4,this.beams.push(t)}return this}},{key:"setNote",value:function(e){this.note=e}},{key:"setWidth",value:function(e){this.width=e}},{key:"getWidth",value:function(){return this.width}},{key:"getGraceNotes",value:function(){return this.grace_notes}},{key:"draw",value:function(){var e=this;this.checkContext();var t=this.getNote();if(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.GraceNoteGroup",t)}("Drawing grace note group for:",t),!t||null===this.index)throw new i.RuntimeError("NoAttachedNote","Can't draw grace note without a parent note and parent note index.");if(this.setRendered(),this.alignSubNotesWithNote(this.getGraceNotes(),t),this.grace_notes.forEach((function(t){t.setContext(e.context).draw()})),this.beams.forEach((function(t){t.setContext(e.context).draw()})),this.show_slur){var r=this.getNote().getCategory()===Q.CATEGORY,a=r?ae:se;this.slur=new a({last_note:this.grace_notes[0],first_note:t,first_indices:[0],last_indices:[0]}),this.slur.render_options.cp2=12,this.slur.render_options.y_shift=(r?7:5)+this.render_options.slur_y_shift,this.slur.setContext(this.context).draw()}}}],[{key:"CATEGORY",get:function(){return"gracenotegroups"}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;for(var n=[],i=null,r=0,a=0;a<e.length;++a){var s=e[a],o=s.getNote(),u=o.getCategory()===Q.CATEGORY,l=0;if(u&&null!==s.spacing&&void 0!==s.spacing&&(l=s.spacing),u&&o!==i){for(var c=0;c<o.keys.length;++c)r=o.getKeyProps()[c].displaced?o.getExtraLeftPx():r;i=o}n.push({shift:r,gracenote_group:s,spacing:l})}for(var h,d=n[0].shift,f=0;f<n.length;++f){var p=n[f].gracenote_group;p.preFormat(),h=p.getWidth()+n[f].spacing,d=Math.max(h,d)}for(var m=0;m<n.length;++m){var v=n[m].gracenote_group;h=v.getWidth()+n[m].spacing,v.setSpacingFromNextModifier(d-Math.min(h,d))}return t.left_shift+=d,!0}}]),n}(q),ue=function(e){h(n,e);var t=d(n);function n(e,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","Stroke"),a.note=null,a.options=i.Merge({},r),a.all_voices=!("all_voices"in a.options)||a.options.all_voices,a.note_end=null,a.index=null,a.type=e,a.position=q.Position.LEFT,a.render_options={font_scale:38,stroke_px:3,stroke_spacing:10},a.font={family:"serif",size:10,weight:"bold italic"},a.setXShift(0),a.setWidth(10),a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getPosition",value:function(){return this.position}},{key:"addEndNote",value:function(e){return this.note_end=e,this}},{key:"draw",value:function(){if(this.checkContext(),this.setRendered(),!this.note||null==this.index)throw new i.RERR("NoAttachedNote","Can't draw stroke without a note and index.");for(var e,t,r,a,s,o=this.note.getModifierStartXY(this.position,this.index),u=this.note.getYs(),l=o.y,c=o.y,h=o.x-5,d=this.note.stave.options.spacing_between_lines_px,f=this.getModifierContext().getModifiers(this.note.getCategory()),p=0;p<f.length;p++){u=f[p].getYs();for(var m=0;m<u.length;m++)(this.note===f[p]||this.all_voices)&&(l=i.Min(l,u[m]),c=i.Max(c,u[m]))}switch(this.type){case n.Type.BRUSH_DOWN:e="vc3",t=-3,r=l-d/2+10,c+=d/2;break;case n.Type.BRUSH_UP:e="v11",t=.5,r=c+d/2,l-=d/2;break;case n.Type.ROLL_DOWN:case n.Type.RASQUEDO_DOWN:e="vc3",t=-3,a=this.x_shift+t-2,this.note instanceof Q?(r=(l+=1.5*d)-d,s=(c+=(c-l)%2!=0?.5*d:d)+d+2):(r=(l+=1.5*d)-.75*d,s=(c+=d)+.25*d);break;case n.Type.ROLL_UP:case n.Type.RASQUEDO_UP:e="v52",t=-4,a=this.x_shift+t-1,this.note instanceof Q?(r=d/2,(c-(l+=.5*d))%2==0&&(c+=d/2),r=c+.5*d,s=l-1.25*d):(r=(c+=.5*d)+.25*d,s=(l+=.25*d)-d);break;case n.Type.ARPEGGIO_DIRECTIONLESS:l+=.5*d,c+=d;break;default:throw new i.RERR("InvalidType","The stroke type ".concat(this.type," does not exist"))}if(this.type===n.Type.BRUSH_DOWN||this.type===n.Type.BRUSH_UP)this.context.fillRect(h+this.x_shift,l,1,c-l);else if(this.note instanceof Q)for(var v=l;v<=c;v+=d)P.renderGlyph(this.context,h+this.x_shift-4,v,this.render_options.font_scale,"va3");else{var g;for(g=l;g<=c;g+=10)P.renderGlyph(this.context,h+this.x_shift-4,g,this.render_options.font_scale,"va3");this.type===n.Type.RASQUEDO_DOWN&&(s=g+.25*d)}this.type!==n.Type.ARPEGGIO_DIRECTIONLESS&&(P.renderGlyph(this.context,h+this.x_shift+t,r,this.render_options.font_scale,e),this.type!==n.Type.RASQUEDO_DOWN&&this.type!==n.Type.RASQUEDO_UP||(this.context.save(),this.context.setFont(this.font.family,this.font.size,this.font.weight),this.context.fillText("R",h+a,s),this.context.restore()))}}],[{key:"CATEGORY",get:function(){return"strokes"}},{key:"Type",get:function(){return{BRUSH_DOWN:1,BRUSH_UP:2,ROLL_DOWN:3,ROLL_UP:4,RASQUEDO_DOWN:5,RASQUEDO_UP:6,ARPEGGIO_DIRECTIONLESS:7}}},{key:"format",value:function(e,t){var n=t.left_shift;if(!e||0===e.length)return this;var i=e.map((function(e){var t=e.getNote();if(t instanceof Q){var n=t.getKeyProps()[e.getIndex()];return{line:n.line,shift:n.displaced?t.getExtraLeftPx():0,stroke:e}}return{line:t.getPositions()[e.getIndex()].str,shift:0,stroke:e}})),r=n,a=i.reduce((function(e,t){var n=t.stroke,i=t.shift;return n.setXShift(r+i),Math.max(n.getWidth()+0,e)}),0);return t.left_shift+=a,!0}}]),n}(q),le=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","StringNumber"),i.note=null,i.last_note=null,i.index=null,i.string_number=e,i.setWidth(20),i.position=q.Position.ABOVE,i.x_shift=0,i.y_shift=0,i.x_offset=0,i.y_offset=0,i.dashed=!0,i.leg=N.LineEndType.NONE,i.radius=8,i.font={family:"sans-serif",size:10,weight:"bold"},i}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getNote",value:function(){return this.note}},{key:"setNote",value:function(e){return this.note=e,this}},{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return this.index=e,this}},{key:"setLineEndType",value:function(e){return e>=N.LineEndType.NONE&&e<=N.LineEndType.DOWN&&(this.leg=e),this}},{key:"setStringNumber",value:function(e){return this.string_number=e,this}},{key:"setOffsetX",value:function(e){return this.x_offset=e,this}},{key:"setOffsetY",value:function(e){return this.y_offset=e,this}},{key:"setLastNote",value:function(e){return this.last_note=e,this}},{key:"setDashed",value:function(e){return this.dashed=e,this}},{key:"draw",value:function(){var e=this.checkContext();if(!this.note||null==this.index)throw new i.RERR("NoAttachedNote","Can't draw string number without a note and index.");this.setRendered();var t=this.note.stave.options.spacing_between_lines_px,n=this.note.getModifierStartXY(this.position,this.index),r=n.x+this.x_shift+this.x_offset,a=n.y+this.y_shift+this.y_offset;switch(this.position){case q.Position.ABOVE:case q.Position.BELOW:var s=this.note.getStemExtents(),o=s.topY,u=s.baseY+2;this.note.stem_direction===Q.STEM_DOWN&&(o=s.baseY,u=s.topY-2),a=this.position===q.Position.ABOVE?this.note.hasStem()?o-1.75*t:n.y-1.75*t:this.note.hasStem()?u+1.5*t:n.y+1.75*t,a+=this.y_shift+this.y_offset;break;case q.Position.LEFT:r-=this.radius/2+5;break;case q.Position.RIGHT:r+=this.radius/2+6;break;default:throw new i.RERR("InvalidPosition","The position ".concat(this.position," is invalid"))}e.save(),e.beginPath(),e.arc(r,a,this.radius,0,2*Math.PI,!1),e.lineWidth=1.5,e.stroke(),e.setFont(this.font.family,this.font.size,this.font.weight);var l=r-e.measureText(this.string_number).width/2;if(e.fillText(""+this.string_number,l,a+4.5),null!=this.last_note){var c,h,d=this.last_note.getStemX()-this.note.getX()+5;switch(e.strokeStyle="#000000",e.lineCap="round",e.lineWidth=.6,this.dashed?N.drawDashedLine(e,r+10,a,r+d,a,[3,3]):N.drawDashedLine(e,r+10,a,r+d,a,[3,0]),this.leg){case N.LineEndType.UP:c=-10,h=this.dashed?[3,3]:[3,0],N.drawDashedLine(e,r+d,a,r+d,a+c,h);break;case N.LineEndType.DOWN:c=10,h=this.dashed?[3,3]:[3,0],N.drawDashedLine(e,r+d,a,r+d,a+c,h)}}e.restore()}}],[{key:"CATEGORY",get:function(){return"stringnumber"}},{key:"format",value:function(e,t){var n=t.left_shift,i=t.right_shift;if(!e||0===e.length)return this;var r,a,s,o,u,l=[],c=null,h=0,d=0;for(r=0;r<e.length;++r)for(s=(a=e[r]).getNote(),r=0;r<e.length;++r){s=(a=e[r]).getNote(),o=a.getPosition();var f=s.getKeyProps()[a.getIndex()];if(s!==c){for(var p=0;p<s.keys.length;++p)u=s.getKeyProps()[p],0===n&&(h=u.displaced?s.getExtraLeftPx():h),0===i&&(d=u.displaced?s.getExtraRightPx():d);c=s}l.push({pos:o,note:s,num:a,line:f.line,shiftL:h,shiftR:d})}l.sort((function(e,t){return t.line-e.line}));var m=0,v=0,g=0,y=null,b=null;for(r=0;r<l.length;++r){var S=0;s=l[r].note,o=l[r].pos,a=l[r].num;var x=l[r].line,_=(l[r].shiftL,l[r].shiftR);x===y&&s===b||(m=i+_);var E=a.getWidth()+1;o===q.Position.LEFT?(a.setXShift(n),v=(S=h+E)>v?S:v):o===q.Position.RIGHT&&(a.setXShift(m),g=(S+=E)>g?S:g),y=x,b=s}return t.left_shift+=v,t.right_shift+=g,!0}}]),n}(q),ce=q.Position,he=ce.ABOVE,de=ce.BELOW,fe=function(e,t){return.5*e(t/.5)},pe=function(e,t){return t===he?e<=5:e>=1},me=function(e,t){return pe(e,t)?t===he?Math.ceil:Math.floor:Math.round},ve=function(e){var t=e.getCategory();return"stavenotes"===t||"gracenotes"===t},ge=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this)).setAttribute("type","Articulation"),r.note=null,r.index=null,r.type=e,r.position=de,r.render_options={font_scale:38},r.articulation=T.articulationCodes(r.type),!r.articulation)throw new i.RERR("ArgumentError","Articulation not found: ".concat(r.type));return r.glyph=new P(r.articulation.code,r.render_options.font_scale),r.setWidth(r.glyph.getMetrics().width),s(r)}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"draw",value:function(){var e,t=this.note,r=this.index,a=this.position,s=this.glyph,o=this.articulation.between_lines,u=this.text_line,l=this.context;if(this.checkContext(),!t||null==r)throw new i.RERR("NoAttachedNote","Can't draw Articulation without a note and index.");this.setRendered();var c=t.getStave(),h=c.getSpacingBetweenLines(),d="tabnotes"===t.getCategory(),f=t.getModifierStartXY(a,r).x,m=!o||d,v=function(e,t){var n=t===he&&e.getStemDirection()===B.UP||t===de&&e.getStemDirection()===B.DOWN;return ve(e)?e.hasStem()&&n?.5:1:e.hasStem()&&n?1:0}(t,a),g=(e={},p(e,he,(function(){s.setOrigin(.5,1);var e=function(e,t){var n=e.getStave(),r=e.getStemDirection(),a=e.getStemExtents(),s=a.topY,o=a.baseY;if(ve(e))return e.hasStem()?r===B.UP?s:o:Math.min.apply(Math,S(e.getYs()));if("tabnotes"===e.getCategory())return e.hasStem()&&r===B.UP?s:n.getYForTopText(t);throw new i.RERR("UnknownCategory","Only can get the top and bottom ys of stavenotes and tabnotes")}(t,u)-(u+v)*h;return m?Math.min(c.getYForTopText(n.INITIAL_OFFSET),e):e})),p(e,de,(function(){s.setOrigin(.5,0);var e=function(e,t){var n=e.getStave(),r=e.getStemDirection(),a=e.getStemExtents(),s=a.topY,o=a.baseY;if(ve(e))return e.hasStem()?r===B.UP?o:s:Math.max.apply(Math,S(e.getYs()));if("tabnotes"===e.getCategory())return e.hasStem()?r===B.UP?n.getYForBottomText(t):s:n.getYForBottomText(t);throw new i.RERR("UnknownCategory","Only can get the top and bottom ys of stavenotes and tabnotes")}(t,u)+(u+v)*h;return m?Math.max(c.getYForBottomText(n.INITIAL_OFFSET),e):e})),e)[a]();if(this.y_shift&&(g+=this.y_shift),!d){var y=a===he?-1:1,b=d?t.positions[r].str:t.getKeyProps()[r].line,x=(t.getYs()[r]-g)/h+b,_=function(e,t,n,i){var r=fe(me(t,n),t);return e&&pe(r,n)&&r%1==0?r+.5*-i:r}(o,x,a,y);pe(_,a)&&s.setOrigin(.5,.5),g+=Math.abs(_-x)*h*y}!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Articulation",t)}("Rendering articulation at (x: ".concat(f,", y: ").concat(g,")")),s.render(l,f,g)}}],[{key:"CATEGORY",get:function(){return"articulations"}},{key:"INITIAL_OFFSET",get:function(){return-.5}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;var n=function(e,t,n){return fe(me(t,n),e.glyph.getMetrics().height/10+.5)};e.filter((function(e){return e.getPosition()===he})).forEach((function(e){e.setTextLine(t.top_text_line),t.top_text_line+=n(e,t.top_text_line,he)})),e.filter((function(e){return e.getPosition()===de})).forEach((function(e){e.setTextLine(t.text_line),t.text_line+=n(e,t.text_line,de)}));var i=e.map((function(e){return e.getWidth()})).reduce((function(e,t){return Math.max(t,e)}));return t.left_shift+=i/2,t.right_shift+=i/2,!0}},{key:"easyScoreHook",value:function(e,t,n){var i=e.articulations;if(i){var r={staccato:"a.",tenuto:"a-"};i.split(",").map((function(e){return e.trim().split(".")})).map((function(e){var t=x(e,2),i=t[0],a=t[1],s={type:r[i]};return a&&(s.position=q.PositionString[a]),n.getFactory().Articulation(s)})).map((function(e){return t.addModifier(0,e)}))}}}]),n}(q),ye=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","TickContext"),e.currentTick=new a(0,1),e.maxTicks=new a(0,1),e.minTicks=null,e.padding=3,e.x=0,e.xBase=0,e.xOffset=0,e.tickables=[],e.notePx=0,e.extraLeftPx=0,e.extraRightPx=0,e.tContexts=[],e}return y(n,[{key:"getX",value:function(){return this.x}},{key:"setX",value:function(e){return this.x=e,this.xBase=e,this.xOffset=0,this}},{key:"getXBase",value:function(){return this.xBase}},{key:"setXBase",value:function(e){this.xBase=e,this.x=e+this.xOffset}},{key:"getXOffset",value:function(){return this.xOffset}},{key:"setXOffset",value:function(e){this.xOffset=e,this.x=this.xBase+e}},{key:"getWidth",value:function(){return this.width+2*this.padding}},{key:"setPadding",value:function(e){return this.padding=e,this}},{key:"getMaxTicks",value:function(){return this.maxTicks}},{key:"getMinTicks",value:function(){return this.minTicks}},{key:"getTickables",value:function(){return this.tickables}},{key:"getCenterAlignedTickables",value:function(){return this.tickables.filter((function(e){return e.isCenterAligned()}))}},{key:"getMetrics",value:function(){return{width:this.width,notePx:this.notePx,extraLeftPx:this.extraLeftPx,extraRightPx:this.extraRightPx}}},{key:"getCurrentTick",value:function(){return this.currentTick}},{key:"setCurrentTick",value:function(e){this.currentTick=e,this.preFormatted=!1}},{key:"getExtraPx",value:function(){for(var e=0,t=0,n=0,i=0,r=0;r<this.tickables.length;r++){n=Math.max(this.tickables[r].extraLeftPx||0,n),i=Math.max(this.tickables[r].extraRightPx||0,i);var a=this.tickables[r].modifierContext;a&&null!=a&&(e=Math.max(e,a.state.left_shift),t=Math.max(t,a.state.right_shift))}return{left:e,right:t,extraLeft:n,extraRight:i}}},{key:"addTickable",value:function(e){if(!e)throw new i.RERR("BadArgument","Invalid tickable added.");if(!e.shouldIgnoreTicks()){this.ignore_ticks=!1;var t=e.getTicks();t.greaterThan(this.maxTicks)&&(this.maxTicks=t.clone()),(null==this.minTicks||t.lessThan(this.minTicks))&&(this.minTicks=t.clone())}return e.setTickContext(this),this.tickables.push(e),this.preFormatted=!1,this}},{key:"preFormat",value:function(){if(this.preFormatted)return this;for(var e=0;e<this.tickables.length;++e){var t=this.tickables[e];t.preFormat();var n=t.getMetrics();this.extraLeftPx=Math.max(this.extraLeftPx,n.extraLeftPx+n.modLeftPx),this.extraRightPx=Math.max(this.extraRightPx,n.extraRightPx+n.modRightPx),this.notePx=Math.max(this.notePx,n.noteWidth),this.width=this.notePx+this.extraLeftPx+this.extraRightPx}return this}},{key:"postFormat",value:function(){return this.postFormatted||(this.postFormatted=!0),this}}],[{key:"getNextContext",value:function(e){var t=e.tContexts,n=t.indexOf(e);return t[n+1]}}]),n}(H),be=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this)).setAttribute("type","Ornament"),r.note=null,r.index=null,r.type=e,r.position=q.Position.ABOVE,r.delayed=!1,r.accidentalUpper=null,r.accidentalLower=null,r.render_options={font_scale:38,accidentalLowerPadding:3,accidentalUpperPadding:3},r.ornament=T.ornamentCodes(r.type),!r.ornament)throw new i.RERR("ArgumentError","Ornament not found: '".concat(r.type,"'"));return r.glyph=new P(r.ornament.code,r.render_options.font_scale),r.glyph.setOrigin(.5,1),s(r)}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setDelayed",value:function(e){return this.delayed=e,this}},{key:"setUpperAccidental",value:function(e){var t=this.render_options.font_scale/1.3;return this.accidentalUpper=new P(T.accidentalCodes(e).code,t),this.accidentalUpper.setOrigin(.5,1),this}},{key:"setLowerAccidental",value:function(e){var t=this.render_options.font_scale/1.3;return this.accidentalLower=new P(T.accidentalCodes(e).code,t),this.accidentalLower.setOrigin(.5,1),this}},{key:"draw",value:function(){if(this.checkContext(),!this.note||null==this.index)throw new i.RERR("NoAttachedNote","Can't draw Ornament without a note and index.");this.setRendered();var e=this.context,t=this.note.getStemDirection(),r=this.note.getStave(),a=this.note.getStem().getExtents(),s=t===Q.STEM_DOWN?a.baseY:a.topY;"tabnotes"===this.note.getCategory()&&(this.note.hasStem()?t===Q.STEM_DOWN&&(s=r.getYForTopText(this.text_line)):s=r.getYForTopText(this.text_line));var o=t===Q.STEM_DOWN,u=r.getSpacingBetweenLines(),l=1;!o&&this.note.beam&&(l+=.5);var c=s-u*(this.text_line+l),h=this.note.getModifierStartXY(this.position,this.index).x,d=Math.min(r.getYForTopText(this.text_line),c);if(d+=this.y_shift,this.delayed){var f=0;if(void 0!==this.delayXShift)f=this.delayXShift;else{f+=this.glyph.getMetrics().width/2;var p=ye.getNextContext(this.note.getTickContext());f+=p?.5*(p.getX()-h):.5*(r.x+r.width-h),this.delayXShift=f}h+=f}!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Ornament",t)}("Rendering ornament: ",this.ornament,h,d),this.accidentalLower&&(this.accidentalLower.render(e,h,d),d-=this.accidentalLower.getMetrics().height,d-=this.render_options.accidentalLowerPadding),this.glyph.render(e,h,d),d-=this.glyph.getMetrics().height,this.accidentalUpper&&(d-=this.render_options.accidentalUpperPadding,this.accidentalUpper.render(e,h,d))}}],[{key:"CATEGORY",get:function(){return"ornaments"}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;for(var n=0,i=0;i<e.length;++i){var r=e[i],a=2;n=Math.max(r.getWidth(),n),r.getPosition()===q.Position.ABOVE?(r.setTextLine(t.top_text_line),t.top_text_line+=a):(r.setTextLine(t.text_line),t.text_line+=a)}return t.left_shift+=n/2,t.right_shift+=n/2,!0}}]),n}(q),Se=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","Annotation"),i.note=null,i.index=null,i.text=e,i.justification=n.Justify.CENTER,i.vert_justification=n.VerticalJustify.TOP,i.font={family:"Arial",size:10,weight:""},i.setWidth(T.textWidth(e)),i}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setFont",value:function(e,t,n){return this.font={family:e,size:t,weight:n},this}},{key:"setVerticalJustification",value:function(e){return this.vert_justification="string"==typeof e?n.VerticalJustifyString[e]:e,this}},{key:"getJustification",value:function(){return this.justification}},{key:"setJustification",value:function(e){return this.justification="string"==typeof e?n.JustifyString[e]:e,this}},{key:"draw",value:function(){if(this.checkContext(),!this.note)throw new i.RERR("NoNoteForAnnotation","Can't draw text annotation without an attached note.");this.setRendered();var e=this.note.getModifierStartXY(q.Position.ABOVE,this.index);this.context.save(),this.context.setFont(this.font.family,this.font.size,this.font.weight);var t,r,a,s,o=this.context.measureText(this.text).width,u=this.context.measureText("m").width;t=this.justification===n.Justify.LEFT?e.x:this.justification===n.Justify.RIGHT?e.x-o:this.justification===n.Justify.CENTER?e.x-o/2:this.note.getStemX()-o/2;var l=this.note.hasStem(),c=this.note.getStave();if(l&&(a=this.note.getStem().getExtents(),s=c.getSpacingBetweenLines()),this.vert_justification===n.VerticalJustify.BOTTOM){if(r=c.getYForBottomText(this.text_line+T.TEXT_HEIGHT_OFFSET_HACK),l){var h=1===this.note.getStemDirection()?a.baseY:a.topY;r=Math.max(r,h+s*(this.text_line+2))}}else if(this.vert_justification===n.VerticalJustify.CENTER){var d=this.note.getYForTopText(this.text_line)-1;r=d+(c.getYForBottomText(this.text_line)-d)/2+u/2}else if(this.vert_justification===n.VerticalJustify.TOP)r=Math.min(c.getYForTopText(this.text_line),this.note.getYs()[0]-10),l&&(r=Math.min(r,a.topY-5-s*this.text_line));else{var f=this.note.getStemExtents();r=f.topY+(f.baseY-f.topY)/2+u/2}!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Annotation",t)}("Rendering annotation: ",this.text,t,r),this.context.fillText(this.text,t,r),this.context.restore()}}],[{key:"CATEGORY",get:function(){return"annotations"}},{key:"Justify",get:function(){return{LEFT:1,CENTER:2,RIGHT:3,CENTER_STEM:4}}},{key:"JustifyString",get:function(){return{left:n.Justify.LEFT,right:n.Justify.RIGHT,center:n.Justify.CENTER,centerStem:n.Justify.CENTER_STEM}}},{key:"VerticalJustify",get:function(){return{TOP:1,CENTER:2,BOTTOM:3,CENTER_STEM:4}}},{key:"VerticalJustifyString",get:function(){return{above:n.VerticalJustify.TOP,top:n.VerticalJustify.TOP,below:n.VerticalJustify.BOTTOM,bottom:n.VerticalJustify.BOTTOM,center:n.VerticalJustify.CENTER,centerStem:n.VerticalJustify.CENTER_STEM}}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;for(var n=0,i=0;i<e.length;++i){var r=e[i];n=Math.max(r.getWidth(),n),r.getPosition()===q.Position.ABOVE?(r.setTextLine(t.top_text_line),t.top_text_line++):(r.setTextLine(t.text_line),t.text_line++)}return t.left_shift+=n/2,t.right_shift+=n/2,!0}}]),n}(q),xe=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","Bend"),a.text=e,a.x_shift=0,a.release=i||!1,a.font="10pt Arial",a.render_options={line_width:1.5,line_style:"#777777",bend_width:8,release_width:8},r?a.phrase=r:(a.phrase=[{type:n.UP,text:a.text}],a.release&&a.phrase.push({type:n.DOWN,text:""})),a.updateWidth(),a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setXShift",value:function(e){this.x_shift=e,this.updateWidth()}},{key:"setFont",value:function(e){return this.font=e,this}},{key:"getText",value:function(){return this.text}},{key:"updateWidth",value:function(){var e=this;function t(t){return e.context?e.context.measureText(t).width:T.textWidth(t)}for(var r=0,a=0;a<this.phrase.length;++a){var s=this.phrase[a];if("width"in s)r+=s.width;else{var o=s.type===n.UP?this.render_options.bend_width:this.render_options.release_width;s.width=i.Max(o,t(s.text))+3,s.draw_width=s.width/2,r+=s.width}}return this.setWidth(r+this.x_shift),this}},{key:"draw",value:function(){if(this.checkContext(),!this.note||null==this.index)throw new i.RERR("NoNoteForBend","Can't draw bend without a note or index.");this.setRendered();var e=this.note.getModifierStartXY(q.Position.RIGHT,this.index);e.x+=3,e.y+=.5;var t=this.x_shift,r=this.context,a=this.note.getStave().getYForTopText(this.text_line)+3,s=this.note.getStave().getYForTopText(this.text_line)-1,o=this;function u(e,t,n,i){var a=e+n,s=t;r.save(),r.beginPath(),r.setLineWidth(o.render_options.line_width),r.setStrokeStyle(o.render_options.line_style),r.setFillStyle(o.render_options.line_style),r.moveTo(e,t),r.quadraticCurveTo(a,s,e+n,i),r.stroke(),r.restore()}function l(e,t,n,i){r.save(),r.beginPath(),r.setLineWidth(o.render_options.line_width),r.setStrokeStyle(o.render_options.line_style),r.setFillStyle(o.render_options.line_style),r.moveTo(e,i),r.quadraticCurveTo(e+n,i,e+n,t),r.stroke(),r.restore()}function c(e,t,n){var i=n||1;r.beginPath(),r.moveTo(e,t),r.lineTo(e-4,t+4*i),r.lineTo(e+4,t+4*i),r.closePath(),r.fill()}function h(e,t){r.save(),r.setRawFont(o.font);var n=e-r.measureText(t).width/2;r.fillText(t,n,s),r.restore()}for(var d=null,f=0,p=0;p<this.phrase.length;++p){var m=this.phrase[p];0===p&&(m.draw_width+=t),f=m.draw_width+(d?d.draw_width:0)-(1===p?t:0),m.type===n.UP&&(d&&d.type===n.UP&&c(e.x,a),u(e.x,e.y,f,a)),m.type===n.DOWN&&(d&&d.type===n.UP&&l(e.x,e.y,f,a),d&&d.type===n.DOWN&&(c(e.x,e.y,-1),l(e.x,e.y,f,a)),null===d&&(f=m.draw_width,l(e.x,e.y,f,a))),h(e.x+f,m.text),(d=m).x=e.x,e.x+=f}d.type===n.UP?c(d.x+f,a):d.type===n.DOWN&&c(d.x+f,e.y,-1)}}],[{key:"CATEGORY",get:function(){return"bends"}},{key:"UP",get:function(){return 0}},{key:"DOWN",get:function(){return 1}},{key:"format",value:function(e,t){if(!e||0===e.length)return!1;for(var n=0,i=t.top_text_line,r=0;r<e.length;++r){var a=e[r];a.setXShift(n),n=a.getWidth(),a.setTextLine(i)}return t.right_shift+=n,t.top_text_line+=1,!0}}]),n}(q),_e=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","Vibrato"),e.position=q.Position.RIGHT,e.render_options={harsh:!1,vibrato_width:20,wave_height:6,wave_width:4,wave_girth:2},e.setVibratoWidth(e.render_options.vibrato_width),e}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setHarsh",value:function(e){return this.render_options.harsh=e,this}},{key:"setVibratoWidth",value:function(e){return this.render_options.vibrato_width=e,this.setWidth(e),this}},{key:"draw",value:function(){var e=this.checkContext();if(!this.note)throw new i.RERR("NoNoteForVibrato","Can't draw vibrato without an attached note.");this.setRendered();var t=this.note.getModifierStartXY(q.Position.RIGHT,this.index).x+this.x_shift,r=this.note.getYForTopText(this.text_line)+2;n.renderVibrato(e,t,r,this.render_options)}}],[{key:"CATEGORY",get:function(){return"vibratos"}},{key:"format",value:function(e,t,n){if(!e||0===e.length)return!1;var i=t.top_text_line,r=0,a=t.right_shift-7,s=n.getModifiers(xe.CATEGORY);s&&s.length>0&&i--;for(var o=0;o<e.length;++o){var u=e[o];u.setXShift(a),u.setTextLine(i),a+=r+=u.getWidth()}return t.right_shift+=r,t.top_text_line+=1,!0}},{key:"renderVibrato",value:function(e,t,n,i){var r,a=i.harsh,s=i.vibrato_width,o=i.wave_width,u=i.wave_girth,l=i.wave_height,c=s/o;if(e.beginPath(),a){for(e.moveTo(t,n+u+1),r=0;r<c/2;++r)e.lineTo(t+o,n-l/2),t+=o,e.lineTo(t+o,n+l/2),t+=o;for(r=0;r<c/2;++r)e.lineTo(t-o,n-l/2+u+1),t-=o,e.lineTo(t-o,n+l/2+u+1),t-=o;e.fill()}else{for(e.moveTo(t,n+u),r=0;r<c/2;++r)e.quadraticCurveTo(t+o/2,n-l/2,t+o,n),t+=o,e.quadraticCurveTo(t+o/2,n+l/2,t+o,n),t+=o;for(r=0;r<c/2;++r)e.quadraticCurveTo(t-o/2,n+l/2+u,t-o,n+u),t-=o,e.quadraticCurveTo(t-o/2,n-l/2+u,t-o,n+u),t-=o;e.fill()}}}]),n}(q);function Ee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ke.DEBUG&&i.L("Vex.Flow.ModifierContext",t)}var ke=function(){function e(){g(this,e),this.modifiers={},this.preFormatted=!1,this.postFormatted=!1,this.width=0,this.spacing=0,this.state={left_shift:0,right_shift:0,text_line:0,top_text_line:0},this.PREFORMAT=[Q,Z,$,ie,ue,oe,re,le,ge,be,Se,xe,_e],this.POSTFORMAT=[Q]}return y(e,[{key:"addModifier",value:function(e){var t=e.getCategory();return this.modifiers[t]||(this.modifiers[t]=[]),this.modifiers[t].push(e),e.setModifierContext(this),this.preFormatted=!1,this}},{key:"getModifiers",value:function(e){return this.modifiers[e]}},{key:"getWidth",value:function(){return this.width}},{key:"getExtraLeftPx",value:function(){return this.state.left_shift}},{key:"getExtraRightPx",value:function(){return this.state.right_shift}},{key:"getState",value:function(){return this.state}},{key:"getMetrics",value:function(){if(!this.formatted)throw new i.RERR("UnformattedModifier","Unformatted modifier has no metrics.");return{width:this.state.left_shift+this.state.right_shift+this.spacing,spacing:this.spacing,extra_left_px:this.state.left_shift,extra_right_px:this.state.right_shift}}},{key:"preFormat",value:function(){var e=this;this.preFormatted||(this.PREFORMAT.forEach((function(t){Ee("Preformatting ModifierContext: ",t.CATEGORY),t.format(e.getModifiers(t.CATEGORY),e.state,e)})),this.width=this.state.left_shift+this.state.right_shift,this.preFormatted=!0)}},{key:"postFormat",value:function(){var e=this;this.postFormatted||this.POSTFORMAT.forEach((function(t){Ee("Postformatting ModifierContext: ",t.CATEGORY),t.postFormat(e.getModifiers(t.CATEGORY),e)}))}}]),e}();function Me(e,t,n,r){var a=t;for(n+=1;n<e.length;n+=1){var s=e[n];if(!s.isRest()&&!s.shouldIgnoreTicks()){a=s.getLineForRest();break}}if(r&&t!==a){var o=Math.max(t,a),u=Math.min(t,a);a=i.MidLine(o,u)}return a}function we(e,t,n){if(!e||!e.length)throw new i.RERR("BadArgument","No voices to format");e[0].getTotalTicks();var r=e.reduce((function(e,t){if(t.getMode()===W.Mode.STRICT&&!t.isComplete())throw new i.RERR("IncompleteVoice","Voice does not have enough notes.");return Math.max(e,a.LCM(e,t.getResolutionMultiplier()))}),1),s={},o=[],u=[];return e.forEach((function(e){var i=new a(0,r);e.getTickables().forEach((function(e){var r=i.numerator;if(!s[r]){var a=new t;u.push(a),s[r]=a}n(e,s[r]),o.push(r),i.add(e.getTicks())}))})),{map:s,array:u,list:i.SortAndUnique(o,(function(e,t){return e-t}),(function(e,t){return e===t})),resolutionMultiplier:r}}var Pe,Te=function(){function e(){g(this,e),this.minTotalWidth=0,this.hasMinTotalWidth=!1,this.totalTicks=new a(0,1),this.tickContexts=null,this.modiferContexts=null,this.contextGaps={total:0,gaps:[]},this.voices=[]}return y(e,[{key:"alignRests",value:function(t,n){if(!t||!t.length)throw new i.RERR("BadArgument","No voices to format rests");t.forEach((function(t){return e.AlignRestsToNotes(t.getTickables(),n)}))}},{key:"preCalculateMinTotalWidth",value:function(e){if(this.hasMinTotalWidth)return this.minTotalWidth;if(!this.tickContexts){if(!e)throw new i.RERR("BadArgument","'voices' required to run preCalculateMinTotalWidth");this.createTickContexts(e)}var t=this.tickContexts,n=t.list,r=t.map;return this.minTotalWidth=n.map((function(e){var t=r[e];return t.preFormat(),t.getWidth()})).reduce((function(e,t){return e+t}),0),this.hasMinTotalWidth=!0,this.minTotalWidth}},{key:"getMinTotalWidth",value:function(){if(!this.hasMinTotalWidth)throw new i.RERR("NoMinTotalWidth","Call 'preCalculateMinTotalWidth' or 'preFormat' before calling 'getMinTotalWidth'");return this.minTotalWidth}},{key:"createModifierContexts",value:function(e){var t=we(e,ke,(function(e,t){return e.addToModifierContext(t)}));return this.modiferContexts=t,t}},{key:"createTickContexts",value:function(e){var t=we(e,ye,(function(e,t){return t.addTickable(e)}));return t.array.forEach((function(e){e.tContexts=t.array})),this.totalTicks=e[0].getTicksUsed().clone(),this.tickContexts=t,t}},{key:"preFormat",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=this.tickContexts,s=a.list,o=a.map,u=a.resolutionMultiplier;i&&r&&i.forEach((function(e){return e.setStave(r).preFormat()}));var l=0,c=0,h=t/2;if(this.minTotalWidth=0,s.forEach((function(t){var i=o[t];n&&i.setContext(n),i.preFormat();var r=i.getWidth();e.minTotalWidth+=r;var a=i.getMetrics();l=l+c+a.extraLeftPx,i.setX(l),c=r-a.extraLeftPx})),this.minTotalWidth=l+c,this.hasMinTotalWidth=!0,!(t<=0)){var d=(t-this.minTotalWidth)/(this.totalTicks.value()*u),f=0;s.forEach((function(e,t){var n=s[t-1]||0,i=o[e];f+=(e-n)*d,i.setX(i.getX()+f),i.getCenterAlignedTickables().forEach((function(e){e.center_x_shift=h-i.getX()}))})),1!==s.length&&(this.justifyWidth=t,this.lossHistory=[],this.evaluate())}}},{key:"evaluate",value:function(){var e=this,t=this.justifyWidth;this.contextGaps={total:0,gaps:[]},this.tickContexts.list.forEach((function(t,n){if(0!==n){var i=e.tickContexts.list[n-1],r=e.tickContexts.map[i],a=e.tickContexts.map[t],s=r.getMetrics(),o=r.getX()+s.width,u=a.getX(),l=u-o;e.contextGaps.total+=l,e.contextGaps.gaps.push({x1:o,x2:u}),a.getFormatterMetrics().freedom.left=l,r.getFormatterMetrics().freedom.right=l}}));var n=this.durationStats={};this.voices.forEach((function(e){e.getTickables().forEach((function(e,i,r){var a=e.getTicks().clone().simplify().toString(),s=e.getMetrics(),o=e.getFormatterMetrics(),u=e.getX()+s.noteWidth+s.modRightPx+s.extraRightPx,l=0;if(i<r.length-1){var c=r[i+1],h=c.getMetrics();l=c.getX()-h.modLeftPx-h.extraLeftPx-u,o.space.used=c.getX()-e.getX(),c.getFormatterMetrics().freedom.left=l}else l=t-u,o.space.used=t-e.getX();o.freedom.right=l,function(e,t){var i=n[e];void 0===i?n[e]={mean:t,count:1}:(i.count+=1,i.mean=(i.mean+t)/2)}(a,o.space.used)}))}));var i=0;return this.voices.forEach((function(e){e.getTickables().forEach((function(e){var t=e.getTicks().clone().simplify().toString(),r=e.getFormatterMetrics();r.iterations+=1,r.space.deviation=r.space.used-n[t].mean,r.duration=t,r.space.mean=n[t].mean,i+=Math.pow(n[t].mean,2)}))})),this.totalCost=Math.sqrt(i),this.lossHistory.push(this.totalCost),this}},{key:"tune",value:function(){var e=this,t=0;return this.tickContexts.list.forEach((function(n,i,r){var a=e.tickContexts.map[n],s=i>0?e.tickContexts.map[r[i-1]]:null,o=i<r.length-1?e.tickContexts.map[r[i+1]]:null;!function(e,t,n,i){e.setX(e.getX()+i),e.getFormatterMetrics().freedom.left+=i,e.getFormatterMetrics().freedom.right-=i,t&&(t.getFormatterMetrics().freedom.right+=i),n&&(n.getFormatterMetrics().freedom.left-=i)}(a,s,o,t);var u=-a.getTickables().map((function(e){return e.getFormatterMetrics().space.deviation})).reduce((function(e,t){return e+t}));u>0?t=-Math.min(a.getFormatterMetrics().freedom.right,Math.abs(u)):u<0&&(t=o?Math.min(o.getFormatterMetrics().freedom.right,Math.abs(u)):0);var l=Math.min(5,Math.abs(t));t=t>0?l:-l})),this.evaluate()}},{key:"postFormat",value:function(){var e=function(e){return e.list.forEach((function(t){return e.map[t].postFormat()}))};return e(this.modiferContexts),e(this.tickContexts),this}},{key:"joinVoices",value:function(e){return this.createModifierContexts(e),this.hasMinTotalWidth=!1,this}},{key:"format",value:function(e,t,n){var r={align_rests:!1,context:null,stave:null};return i.Merge(r,n),this.voices=e,this.alignRests(e,r.align_rests),this.createTickContexts(e),this.preFormat(t,r.context,e,r.stave),r.stave&&this.postFormat(),this}},{key:"formatToStave",value:function(t,n,r){var a=n.getNoteEndX()-n.getNoteStartX()-10;!function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.DEBUG&&i.L("Vex.Flow.Formatter",n)}("Formatting voices to width: ",a);var s={context:n.getContext()};return i.Merge(s,r),this.format(t,a,s)}}],[{key:"SimpleFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paddingBetween,i=void 0===n?10:n;e.reduce((function(e,t){t.addToModifierContext(new ke);var n=(new ye).addTickable(t).preFormat(),r=n.getExtraPx();return n.setX(e+r.left),e+n.getWidth()+r.right+i}),t)}},{key:"plotDebugging",value:function(e,t,n,i,r){var a=n+X.STAVEPADDING,s=t.contextGaps;e.save(),e.setFont("Arial",8,""),s.gaps.forEach((function(t){var n,s,o;n=a+t.x1,s=a+t.x2,o="#aaa",e.beginPath(),e.setStrokeStyle(o),e.setFillStyle(o),e.setLineWidth(1),e.fillRect(n,i,s-n,r-i),e.fillText(Math.round(t.x2-t.x1),a+t.x1,r+12)})),e.fillText(Math.round(s.total)+"px",a-20,r+12),e.setFillStyle("red"),e.fillText("Loss: "+t.lossHistory.map((function(e){return Math.round(e)})),a-20,r+22),e.restore()}},{key:"FormatAndDraw",value:function(t,n,r,a){var s={auto_beam:!1,align_rests:!1};"object"==typeof a?i.Merge(s,a):"boolean"==typeof a&&(s.auto_beam=a);var o=new W(T.TIME4_4).setMode(W.Mode.SOFT).addTickables(r),u=s.auto_beam?G.applyAndGetBeams(o):[];return(new e).joinVoices([o],{align_rests:s.align_rests}).formatToStave([o],n,{align_rests:s.align_rests,stave:n}),o.setStave(n).draw(t,n),u.forEach((function(e){return e.setContext(t).draw()})),o.getBoundingBox()}},{key:"FormatAndDrawTab",value:function(t,n,r,a,s,o,u){var l={auto_beam:o,align_rests:!1};"object"==typeof u?i.Merge(l,u):"boolean"==typeof u&&(l.auto_beam=u);var c=new W(T.TIME4_4).setMode(W.Mode.SOFT).addTickables(s),h=new W(T.TIME4_4).setMode(W.Mode.SOFT).addTickables(a),d=l.auto_beam?G.applyAndGetBeams(c):[];(new e).joinVoices([c],{align_rests:l.align_rests}).joinVoices([h]).formatToStave([c,h],r,{align_rests:l.align_rests}),c.draw(t,r),h.draw(t,n),d.forEach((function(e){return e.setContext(t).draw()})),new z(r,n).setContext(t).draw()}},{key:"AlignRestsToNotes",value:function(e,t,n){return e.forEach((function(i,r){if(i instanceof Q&&i.isRest()){if(i.tuplet&&!n)return;var a=i.getGlyph().position.toUpperCase();if("R/4"!==a&&"B/4"!==a)return;if(t||null!=i.beam){var s=i.getKeyProps()[0];if(0===r)s.line=Me(e,s.line,r,!1),i.setKeyLine(0,s.line);else if(r>0&&r<e.length){var o;e[r-1].isRest()?(o=e[r-1].getKeyProps()[0].line,s.line=o):(o=e[r-1].getLineForRest(),s.line=Me(e,o,r,!0)),i.setKeyLine(0,s.line)}}}})),this}}]),e}(),Ce=function(e){h(n,e);var t=d(n);function n(){var e;return g(this,n),(e=t.call(this)).setAttribute("type","StaveModifier"),e.padding=10,e.position=n.Position.ABOVE,e.layoutMetrics=null,e}return y(n,[{key:"getPosition",value:function(){return this.position}},{key:"setPosition",value:function(e){return this.position=e,this}},{key:"getStave",value:function(){return this.stave}},{key:"setStave",value:function(e){return this.stave=e,this}},{key:"getWidth",value:function(){return this.width}},{key:"setWidth",value:function(e){return this.width=e,this}},{key:"getX",value:function(){return this.x}},{key:"setX",value:function(e){return this.x=e,this}},{key:"getCategory",value:function(){return""}},{key:"makeSpacer",value:function(e){return{getContext:function(){return!0},setStave:function(){},renderToStave:function(){},getMetrics:function(){return{width:e}}}}},{key:"placeGlyphOnLine",value:function(e,t,n){e.setYShift(t.getYForLine(n)-t.getYForGlyphs())}},{key:"getPadding",value:function(e){return void 0!==e&&e<2?0:this.padding}},{key:"setPadding",value:function(e){return this.padding=e,this}},{key:"setLayoutMetrics",value:function(e){return this.layoutMetrics=e,this}},{key:"getLayoutMetrics",value:function(){return this.layoutMetrics}}],[{key:"Position",get:function(){return{LEFT:1,RIGHT:2,ABOVE:3,BELOW:4,BEGIN:5,END:6}}}]),n}(_),Ie=function(e){h(n,e);var t=d(n);function n(e){var i;g(this,n),(i=t.call(this)).setAttribute("type","Barline"),i.thickness=T.STAVE_LINE_THICKNESS;var r=n.type;return i.widths={},i.widths[r.SINGLE]=5,i.widths[r.DOUBLE]=5,i.widths[r.END]=5,i.widths[r.REPEAT_BEGIN]=5,i.widths[r.REPEAT_END]=5,i.widths[r.REPEAT_BOTH]=5,i.widths[r.NONE]=5,i.paddings={},i.paddings[r.SINGLE]=0,i.paddings[r.DOUBLE]=0,i.paddings[r.END]=0,i.paddings[r.REPEAT_BEGIN]=15,i.paddings[r.REPEAT_END]=15,i.paddings[r.REPEAT_BOTH]=15,i.paddings[r.NONE]=0,i.layoutMetricsMap={},i.layoutMetricsMap[r.SINGLE]={xMin:0,xMax:1,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.DOUBLE]={xMin:-3,xMax:1,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.END]={xMin:-5,xMax:1,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.REPEAT_END]={xMin:-10,xMax:1,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.REPEAT_BEGIN]={xMin:-2,xMax:10,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.REPEAT_BOTH]={xMin:-10,xMax:10,paddingLeft:5,paddingRight:5},i.layoutMetricsMap[r.NONE]={xMin:0,xMax:0,paddingLeft:5,paddingRight:5},i.setPosition(Ce.Position.BEGIN),i.setType(e),i}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getType",value:function(){return this.type}},{key:"setType",value:function(e){return this.type="string"==typeof e?n.typeString[e]:e,this.setWidth(this.widths[this.type]),this.setPadding(this.paddings[this.type]),this.setLayoutMetrics(this.layoutMetricsMap[this.type]),this}},{key:"draw",value:function(e){switch(e.checkContext(),this.setRendered(),this.type){case n.type.SINGLE:this.drawVerticalBar(e,this.x,!1);break;case n.type.DOUBLE:this.drawVerticalBar(e,this.x,!0);break;case n.type.END:this.drawVerticalEndBar(e,this.x);break;case n.type.REPEAT_BEGIN:this.drawRepeatBar(e,this.x,!0),e.getX()!==this.x&&this.drawVerticalBar(e,e.getX());break;case n.type.REPEAT_END:this.drawRepeatBar(e,this.x,!1);break;case n.type.REPEAT_BOTH:this.drawRepeatBar(e,this.x,!1),this.drawRepeatBar(e,this.x,!0)}}},{key:"drawVerticalBar",value:function(e,t,n){e.checkContext();var i=e.getTopLineTopY(),r=e.getBottomLineBottomY();n&&e.context.fillRect(t-3,i,1,r-i),e.context.fillRect(t,i,1,r-i)}},{key:"drawVerticalEndBar",value:function(e,t){e.checkContext();var n=e.getTopLineTopY(),i=e.getBottomLineBottomY();e.context.fillRect(t-5,n,1,i-n),e.context.fillRect(t-2,n,3,i-n)}},{key:"drawRepeatBar",value:function(e,t,n){e.checkContext();var i=e.getTopLineTopY(),r=e.getBottomLineBottomY(),a=3;n||(a=-5),e.context.fillRect(t+a,i,1,r-i),e.context.fillRect(t-2,i,3,r-i),n?a+=4:a-=4;var s=t+a+1,o=(e.getNumLines()-1)*e.getSpacingBetweenLines(),u=i+(o=o/2-e.getSpacingBetweenLines()/2)+1;e.context.beginPath(),e.context.arc(s,u,2,0,2*Math.PI,!1),e.context.fill(),u+=e.getSpacingBetweenLines(),e.context.beginPath(),e.context.arc(s,u,2,0,2*Math.PI,!1),e.context.fill()}}],[{key:"CATEGORY",get:function(){return"barlines"}},{key:"type",get:function(){return{SINGLE:1,DOUBLE:2,END:3,REPEAT_BEGIN:4,REPEAT_END:5,REPEAT_BOTH:6,NONE:7}}},{key:"typeString",get:function(){return{single:n.type.SINGLE,double:n.type.DOUBLE,end:n.type.END,repeatBegin:n.type.REPEAT_BEGIN,repeatEnd:n.type.REPEAT_END,repeatBoth:n.type.REPEAT_BOTH,none:n.type.NONE}}}]),n}(Ce),Ae=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","Repetition"),a.symbol_type=e,a.x=i,a.x_shift=0,a.y_shift=r,a.font={family:"times",size:12,weight:"bold italic"},a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setShiftX",value:function(e){return this.x_shift=e,this}},{key:"setShiftY",value:function(e){return this.y_shift=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"draw",value:function(e,t){switch(this.setRendered(),this.symbol_type){case n.type.CODA_RIGHT:this.drawCodaFixed(e,t+e.width);break;case n.type.CODA_LEFT:this.drawSymbolText(e,t,"Coda",!0);break;case n.type.SEGNO_LEFT:this.drawSignoFixed(e,t);break;case n.type.SEGNO_RIGHT:this.drawSignoFixed(e,t+e.width);break;case n.type.DC:this.drawSymbolText(e,t,"D.C.",!1);break;case n.type.DC_AL_CODA:this.drawSymbolText(e,t,"D.C. al",!0);break;case n.type.DC_AL_FINE:this.drawSymbolText(e,t,"D.C. al Fine",!1);break;case n.type.DS:this.drawSymbolText(e,t,"D.S.",!1);break;case n.type.DS_AL_CODA:this.drawSymbolText(e,t,"D.S. al",!0);break;case n.type.DS_AL_FINE:this.drawSymbolText(e,t,"D.S. al Fine",!1);break;case n.type.FINE:this.drawSymbolText(e,t,"Fine",!1);break;case n.type.TO_CODA:this.drawSymbolText(e,t,"To",!0)}return this}},{key:"drawCodaFixed",value:function(e,t){var n=e.getYForTopText(e.options.num_lines)+this.y_shift;return P.renderGlyph(e.context,this.x+t+this.x_shift,n+25,40,"v4d",!0),this}},{key:"drawSignoFixed",value:function(e,t){var n=e.getYForTopText(e.options.num_lines)+this.y_shift;return P.renderGlyph(e.context,this.x+t+this.x_shift,n+25,30,"v8c",!0),this}},{key:"drawSymbolText",value:function(e,t,i,r){var a=e.checkContext();a.save(),a.setFont(this.font.family,this.font.size,this.font.weight);var s=0+this.x_shift,o=t+this.x_shift;this.symbol_type===n.type.CODA_LEFT?o=(s=this.x+e.options.vertical_bar_width)+a.measureText(i).width+12:(this.x_shift=-(s+a.measureText(i).width+12+e.options.vertical_bar_width+12),o=(s=this.x+this.x_shift+e.options.vertical_bar_width)+a.measureText(i).width+12);var u=e.getYForTopText(e.options.num_lines)+this.y_shift+25;return r&&P.renderGlyph(a,o,u,40,"v4d",!0),a.fillText(i,s,u+5),a.restore(),this}}],[{key:"CATEGORY",get:function(){return"repetitions"}},{key:"type",get:function(){return{NONE:1,CODA_LEFT:2,CODA_RIGHT:3,SEGNO_LEFT:4,SEGNO_RIGHT:5,DC:6,DC_AL_CODA:7,DC_AL_FINE:8,DS:9,DS_AL_CODA:10,DS_AL_FINE:11,FINE:12,TO_CODA:13}}}]),n}(Ce),Le=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","StaveSection"),a.setWidth(16),a.section=e,a.x=i,a.shift_x=0,a.shift_y=r,a.font={family:"sans-serif",size:12,weight:"bold"},a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setStaveSection",value:function(e){return this.section=e,this}},{key:"setShiftX",value:function(e){return this.shift_x=e,this}},{key:"setShiftY",value:function(e){return this.shift_y=e,this}},{key:"draw",value:function(e,t){var n=e.checkContext();this.setRendered(),n.save(),n.lineWidth=2,n.setFont(this.font.family,this.font.size,this.font.weight);var i=n.measureText(""+this.section),r=i.width,a=i.height;!a&&i.emHeightAscent>=0&&(a=i.emHeightAscent+2),a||(a=i.fontBoundingBoxAscent+3);var s=r+6;s<18&&(s=18);var o=a+this.font.size/10,u=e.getYForTopText(3)+19-1.15*o+this.shift_y,l=this.x+t;return n.beginPath(),n.lineWidth=2,n.rect(l,u+a/4,s,o),n.stroke(),l+=(s-r)/2,n.fillText(""+this.section,l,u+o),n.restore(),this}}],[{key:"CATEGORY",get:function(){return"stavesection"}}]),n}(Ce),Oe=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","StaveTempo"),a.tempo=e,a.position=q.Position.ABOVE,a.x=i,a.shift_x=10,a.shift_y=r,a.font={family:"times",size:14,weight:"bold"},a.render_options={glyph_font_scale:30},a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setTempo",value:function(e){return this.tempo=e,this}},{key:"setShiftX",value:function(e){return this.shift_x=e,this}},{key:"setShiftY",value:function(e){return this.shift_y=e,this}},{key:"draw",value:function(e,t){var n=e.checkContext();this.setRendered();var i=this.render_options,r=i.glyph_font_scale/38,a=this.tempo.name,s=this.tempo.duration,o=this.tempo.dots,u=this.tempo.bpm,l=this.font,c=this.x+this.shift_x+t,h=e.getYForTopText(1)+this.shift_y;if(n.save(),a&&(n.setFont(l.family,l.size,l.weight),n.fillText(a,c,h),c+=n.measureText(a).width),s&&u){n.setFont(l.family,l.size,"normal"),a&&(c+=n.measureText(" ").width,n.fillText("(",c,h),c+=n.measureText("(").width);var d=T.getGlyphProps(s);if(c+=3*r,P.renderGlyph(n,c,h,i.glyph_font_scale,d.code_head),c+=d.getWidth()*r,d.stem){var f=30;d.beam_count&&(f+=3*(d.beam_count-1));var p=h-(f*=r);n.fillRect(c-r,p,r,f),d.flag&&(P.renderGlyph(n,c,p,i.glyph_font_scale,d.code_flag_upstem),o||(c+=6*r))}for(var m=0;m<o;m++)c+=6*r,n.beginPath(),n.arc(c,h+2*r,2*r,0,2*Math.PI,!1),n.fill();n.fillText(" = "+u+(a?")":""),c+3*r,h)}return n.restore(),this}}],[{key:"CATEGORY",get:function(){return"stavetempo"}}]),n}(Ce),Re=function(e){h(n,e);var t=d(n);function n(e){var r;if(g(this,n),(r=t.call(this,e)).setAttribute("type","TextNote"),r.text=e.text,r.superscript=e.superscript,r.subscript=e.subscript,r.glyph_type=e.glyph,r.glyph=null,r.font={family:"Arial",size:12,weight:""},e.font&&(r.font=e.font),r.glyph_type){var a=n.GLYPHS[r.glyph_type];if(!a)throw new i.RERR("Invalid glyph type: "+r.glyph_type);r.glyph=new P(a.code,a.point,{cache:!1}),a.width?r.setWidth(a.width):r.setWidth(r.glyph.getMetrics().width),r.glyph_struct=a}else r.setWidth(T.textWidth(r.text));return r.line=e.line||0,r.smooth=e.smooth||!1,r.ignore_ticks=e.ignore_ticks||!1,r.justification=n.Justification.LEFT,s(r)}return y(n,[{key:"setJustification",value:function(e){return this.justification=e,this}},{key:"setLine",value:function(e){return this.line=e,this}},{key:"preFormat",value:function(){this.checkContext(),this.preFormatted||(this.smooth?this.setWidth(0):this.glyph||this.setWidth(this.context.measureText(this.text).width),this.justification===n.Justification.CENTER?this.extraLeftPx=this.width/2:this.justification===n.Justification.RIGHT&&(this.extraLeftPx=this.width),this.setPreFormatted(!0))}},{key:"draw",value:function(){if(this.checkContext(),!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");this.setRendered();var e,t=this.context,r=this.getAbsoluteX();if(this.justification===n.Justification.CENTER?r-=this.getWidth()/2:this.justification===n.Justification.RIGHT&&(r-=this.getWidth()),this.glyph)e=this.stave.getYForLine(this.line+-3),this.glyph.render(this.context,r+this.glyph_struct.x_shift,e+this.glyph_struct.y_shift);else{e=this.stave.getYForLine(this.line+-3),this.applyStyle(t),t.setFont(this.font.family,this.font.size,this.font.weight),t.fillText(this.text,r,e);var a=t.measureText("M").width,s=t.measureText(this.text).width;this.superscript&&(t.setFont(this.font.family,this.font.size/1.3,this.font.weight),t.fillText(this.superscript,r+s+2,e-a/2.2)),this.subscript&&(t.setFont(this.font.family,this.font.size/1.3,this.font.weight),t.fillText(this.subscript,r+s+2,e+a/2.2-1)),this.restoreStyle(t)}}}],[{key:"Justification",get:function(){return{LEFT:1,CENTER:2,RIGHT:3}}},{key:"GLYPHS",get:function(){return{segno:{code:"v8c",point:40,x_shift:0,y_shift:-10},tr:{code:"v1f",point:40,x_shift:0,y_shift:0},mordent_upper:{code:"v1e",point:40,x_shift:0,y_shift:0},mordent_lower:{code:"v45",point:40,x_shift:0,y_shift:0},f:{code:"vba",point:40,x_shift:0,y_shift:0},p:{code:"vbf",point:40,x_shift:0,y_shift:0},m:{code:"v62",point:40,x_shift:0,y_shift:0},s:{code:"v4a",point:40,x_shift:0,y_shift:0},z:{code:"v80",point:40,x_shift:0,y_shift:0},coda:{code:"v4d",point:40,x_shift:0,y_shift:-8},pedal_open:{code:"v36",point:40,x_shift:0,y_shift:0},pedal_close:{code:"v5d",point:40,x_shift:0,y_shift:3},caesura_straight:{code:"v34",point:40,x_shift:0,y_shift:2},caesura_curved:{code:"v4b",point:40,x_shift:0,y_shift:2},breath:{code:"v6c",point:40,x_shift:0,y_shift:0},tick:{code:"v6f",point:50,x_shift:0,y_shift:0},turn:{code:"v72",point:40,x_shift:0,y_shift:0},turn_inverted:{code:"v33",point:40,x_shift:0,y_shift:0},mordent:{code:"v1e",point:40,x_shift:0,y_shift:0}}}}]),n}(X),Ne=function(e){h(n,e);var t=d(n);function n(e,r,a){var s;return g(this,n),(s=t.call(this)).setAttribute("type","StaveText"),s.setWidth(16),s.text=e,s.position=r,s.options={shift_x:0,shift_y:0,justification:Re.Justification.CENTER},i.Merge(s.options,a),s.font={family:"times",size:16,weight:"normal"},s}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setStaveText",value:function(e){return this.text=e,this}},{key:"setShiftX",value:function(e){return this.shift_x=e,this}},{key:"setShiftY",value:function(e){return this.shift_y=e,this}},{key:"setFont",value:function(e){i.Merge(this.font,e)}},{key:"setText",value:function(e){this.text=e}},{key:"draw",value:function(e){var t=e.checkContext();this.setRendered(),t.save(),t.lineWidth=2,t.setFont(this.font.family,this.font.size,this.font.weight);var n,r,a=t.measureText(""+this.text).width,s=Ce.Position,o=Re.Justification;switch(this.position){case s.LEFT:case s.RIGHT:r=(e.getYForLine(0)+e.getBottomLineY())/2+this.options.shift_y,n=this.position===s.LEFT?e.getX()-a-24+this.options.shift_x:e.getX()+e.getWidth()+24+this.options.shift_x;break;case s.ABOVE:case s.BELOW:n=e.getX()+this.options.shift_x,this.options.justification===o.CENTER?n+=e.getWidth()/2-a/2:this.options.justification===o.RIGHT&&(n+=e.getWidth()-a),r=this.position===s.ABOVE?e.getYForTopText(2)+this.options.shift_y:e.getYForBottomText(2)+this.options.shift_y;break;default:throw new i.RERR("InvalidPosition","Value Must be in Modifier.Position.")}return t.fillText(""+this.text,n,r+4),t.restore(),this}}],[{key:"CATEGORY",get:function(){return"stavetext"}}]),n}(Ce),Be=function(e){h(n,e);var t=d(n);function n(e,r,a){var s;return g(this,n),(s=t.call(this)).setAttribute("type","Clef"),s.setPosition(Ce.Position.BEGIN),s.setType(e,r,a),s.setWidth(n.sizes[s.size].width),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Clef",t)}("Creating clef:",e),s}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setType",value:function(e,t,i){if(this.type=e,this.clef=n.types[e],this.size=void 0===t?"default":t,this.clef.point=n.sizes[this.size].point,this.glyph=new P(this.clef.code,this.clef.point),void 0!==i){var r=n.annotations[i];this.annotation={code:r.code,point:r.sizes[this.size].point,line:r.sizes[this.size].attachments[this.type].line,x_shift:r.sizes[this.size].attachments[this.type].x_shift},this.attachment=new P(this.annotation.code,this.annotation.point),this.attachment.metrics.x_max=0,this.attachment.setXShift(this.annotation.x_shift)}else this.annotation=void 0;return this}},{key:"getWidth",value:function(){if("tab"===this.type&&!this.stave)throw new i.RERR("ClefError","Can't get width without stave.");return this.width}},{key:"setStave",value:function(e){if(this.stave=e,"tab"!==this.type)return this;var t,n,r=this.stave.getOptions().num_lines;switch(r){case 8:t=55,n=14;break;case 7:t=47,n=8;break;case 6:t=40,n=1;break;case 5:t=30,n=-6;break;case 4:t=23,n=-12;break;default:throw new i.RERR("ClefError","Invalid number of lines: ".concat(r))}return this.glyph.setPoint(t),this.glyph.setYShift(n),this}},{key:"draw",value:function(){if(!this.x)throw new i.RERR("ClefError","Can't draw clef without x.");if(!this.stave)throw new i.RERR("ClefError","Can't draw clef without stave.");this.setRendered(),this.glyph.setStave(this.stave),this.glyph.setContext(this.stave.context),void 0!==this.clef.line&&this.placeGlyphOnLine(this.glyph,this.stave,this.clef.line),this.stave.context.openGroup("clef"),this.glyph.renderToStave(this.x),void 0!==this.annotation&&(this.placeGlyphOnLine(this.attachment,this.stave,this.annotation.line),this.attachment.setStave(this.stave),this.attachment.setContext(this.stave.context),this.attachment.renderToStave(this.x)),this.stave.context.closeGroup()}}],[{key:"CATEGORY",get:function(){return"clefs"}},{key:"types",get:function(){return{treble:{code:"v83",line:3},bass:{code:"v79",line:1},alto:{code:"vad",line:2},tenor:{code:"vad",line:1},percussion:{code:"v59",line:2},soprano:{code:"vad",line:4},"mezzo-soprano":{code:"vad",line:3},"baritone-c":{code:"vad",line:0},"baritone-f":{code:"v79",line:2},subbass:{code:"v79",line:0},french:{code:"v83",line:4},tab:{code:"v2f"}}}},{key:"sizes",get:function(){return{default:{point:40,width:26},small:{point:32,width:20}}}},{key:"annotations",get:function(){return{"8va":{code:"v8",sizes:{default:{point:20,attachments:{treble:{line:-1.2,x_shift:11}}},small:{point:18,attachments:{treble:{line:-.4,x_shift:8}}}}},"8vb":{code:"v8",sizes:{default:{point:20,attachments:{treble:{line:6.3,x_shift:10},bass:{line:4,x_shift:1}}},small:{point:18,attachments:{treble:{line:5.8,x_shift:6},bass:{line:3.5,x_shift:.5}}}}}}}}]),n}(Ce),De=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","KeySignature"),a.setKeySig(e,i,r),a.setPosition(Ce.Position.BEGIN),a.glyphFontScale=38,a.glyphs=[],a.xPositions=[],a.paddingForced=!1,a}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"convertToGlyph",value:function(e,t){var i=T.accidentalCodes(e.type),r=new P(i.code,this.glyphFontScale),a=1;if("n"===e.type&&t){var s=n.accidentalSpacing[t.type];s&&(a=t.line>=e.line?s.above:s.below)}this.placeGlyphOnLine(r,this.stave,e.line),this.glyphs.push(r);var o=this.xPositions[this.xPositions.length-1],u=r.getMetrics().width+a;this.xPositions.push(o+u),this.width+=u}},{key:"cancelKey",value:function(e){return this.formatted=!1,this.cancelKeySpec=e,this}},{key:"convertToCancelAccList",value:function(e){var t=T.keySignature(e),n=this.accList.length>0&&t.length>0&&t[0].type!==this.accList[0].type,i=n?t.length:t.length-this.accList.length;if(!(i<1)){for(var r=[],a=0;a<i;a++){var s=a;n||(s=t.length-i+a);var o=t[s];r.push({type:"n",line:o.line})}return this.accList=r.concat(this.accList),{accList:r,type:t[0].type}}}},{key:"addToStave",value:function(e){return this.paddingForced=!0,e.addModifier(this),this}},{key:"convertAccLines",value:function(e,t){var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.accList,a=0;switch(e){case"soprano":"#"===t?n=[2.5,.5,2,0,1.5,-.5,1]:a=-1;break;case"mezzo-soprano":"b"===t?n=[0,2,.5,2.5,1,3,1.5]:a=1.5;break;case"alto":a=.5;break;case"tenor":"#"===t?n=[3,1,2.5,.5,2,0,1.5]:a=-.5;break;case"baritone-f":case"baritone-c":"b"===t?n=[.5,2.5,1,3,1.5,3.5,2]:a=2;break;case"bass":case"french":a=1}if(void 0!==n)for(i=0;i<r.length;++i)r[i].line=n[i];else if(0!==a)for(i=0;i<r.length;++i)r[i].line+=a}},{key:"getPadding",value:function(e){return this.formatted||this.format(),0===this.glyphs.length||!this.paddingForced&&e<2?0:this.padding}},{key:"getWidth",value:function(){return this.formatted||this.format(),this.width}},{key:"setKeySig",value:function(e,t,n){return this.formatted=!1,this.keySpec=e,this.cancelKeySpec=t,this.alterKeySpec=n,this}},{key:"alterKey",value:function(e){return this.formatted=!1,this.alterKeySpec=e,this}},{key:"convertToAlterAccList",value:function(e){for(var t=Math.min(e.length,this.accList.length),n=0;n<t;++n)e[n]&&(this.accList[n].type=e[n])}},{key:"format",value:function(){if(!this.stave)throw new i.RERR("KeySignatureError","Can't draw key signature without stave.");this.width=0,this.glyphs=[],this.xPositions=[0],this.accList=T.keySignature(this.keySpec);var e,t=this.accList,n=t.length>0?t[0].type:null;if(this.cancelKeySpec&&(e=this.convertToCancelAccList(this.cancelKeySpec)),this.alterKeySpec&&this.convertToAlterAccList(this.alterKeySpec),this.accList.length>0){var r=(this.position===Ce.Position.END?this.stave.endClef:this.stave.clef)||this.stave.clef;e&&this.convertAccLines(r,e.type,e.accList),this.convertAccLines(r,n,t);for(var a=0;a<this.accList.length;++a)this.convertToGlyph(this.accList[a],this.accList[a+1])}this.formatted=!0}},{key:"draw",value:function(){if(!this.x)throw new i.RERR("KeySignatureError","Can't draw key signature without x.");if(!this.stave)throw new i.RERR("KeySignatureError","Can't draw key signature without stave.");if(this.formatted||this.format(),this.setRendered(),this.glyphs.length>0){this.stave.context.openGroup("keysignature");for(var e=0;e<this.glyphs.length;e++){var t=this.glyphs[e],n=this.x+this.xPositions[e];t.setStave(this.stave),t.setContext(this.stave.context),t.renderToStave(n)}this.stave.context.closeGroup()}}}],[{key:"CATEGORY",get:function(){return"keysignatures"}},{key:"accidentalSpacing",get:function(){return{"#":{above:6,below:4},b:{above:4,below:7},n:{above:4,below:1},"##":{above:6,below:4},bb:{above:4,below:7},db:{above:4,below:7},d:{above:4,below:7},bbs:{above:4,below:7},"++":{above:6,below:4},"+":{above:6,below:4},"+-":{above:6,below:4},"++-":{above:6,below:4},bs:{above:4,below:10},bss:{above:4,below:10}}}}]),n}(Ce),Fe=function(e){h(n,e);var t=d(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(g(this,n),(e=t.call(this)).setAttribute("type","TimeSignature"),e.validate_args=a,null===i)return s(e);var o=r;return e.point=40,e.topLine=2,e.bottomLine=4,e.setPosition(Ce.Position.BEGIN),e.setTimeSig(i),e.setWidth(e.timeSig.glyph.getMetrics().width),e.setPadding(o),s(e)}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"parseTimeSpec",value:function(e){if("C"===e||"C|"===e){var t=n.glyphs[e],r=t.line,a=t.code,s=t.point;return{line:r,num:!1,glyph:new P(a,s)}}this.validate_args&&function(e){var t=e.split("/").filter((function(e){return""!==e}));if(2!==t.length)throw new i.RERR("BadTimeSignature","Invalid time spec: ".concat(e,'. Must be in the form "<numerator>/<denominator>"'));t.forEach((function(t){if(isNaN(Number(t)))throw new i.RERR("BadTimeSignature","Invalid time spec: ".concat(e,". Must contain two valid numbers."))}))}(e);var o=e.split("/").map((function(e){return e.split("")})),u=x(o,2),l=u[0],c=u[1];return{num:!0,glyph:this.makeTimeSignatureGlyph(l,c)}}},{key:"makeTimeSignatureGlyph",value:function(e,t){var n=new P("v0",this.point);n.topGlyphs=[],n.botGlyphs=[];for(var i=0,r=0;r<e.length;++r){var a=e[r],s=new P("v"+a,this.point);n.topGlyphs.push(s),i+=s.getMetrics().width}for(var o=0,u=0;u<t.length;++u){var l=t[u],c=new P("v"+l,this.point);n.botGlyphs.push(c),o+=c.getMetrics().width}var h=i>o?i:o,d=n.getMetrics().x_min;n.getMetrics=function(){return{x_min:d,x_max:d+h,width:h}};var f=(h-i)/2,p=(h-o)/2,m=this;return n.renderToStave=function(e){for(var t=e+f,n=0;n<this.topGlyphs.length;++n){var i=this.topGlyphs[n];P.renderOutline(this.context,i.metrics.outline,i.scale,t+i.x_shift,this.stave.getYForLine(m.topLine)),t+=i.getMetrics().width}t=e+p;for(var r=0;r<this.botGlyphs.length;++r){var a=this.botGlyphs[r];m.placeGlyphOnLine(a,this.stave,a.line),P.renderOutline(this.context,a.metrics.outline,a.scale,t+a.x_shift,this.stave.getYForLine(m.bottomLine)),t+=a.getMetrics().width}},n}},{key:"getTimeSig",value:function(){return this.timeSig}},{key:"setTimeSig",value:function(e){return this.timeSig=this.parseTimeSpec(e),this}},{key:"draw",value:function(){if(!this.x)throw new i.RERR("TimeSignatureError","Can't draw time signature without x.");if(!this.stave)throw new i.RERR("TimeSignatureError","Can't draw time signature without stave.");this.setRendered(),this.timeSig.glyph.setStave(this.stave),this.timeSig.glyph.setContext(this.stave.context),this.placeGlyphOnLine(this.timeSig.glyph,this.stave,this.timeSig.line),this.stave.context.save(),this.fillStyle&&this.stave.context.setFillStyle(this.fillStyle),this.stave.context.openGroup("timesignature"),this.timeSig.glyph.renderToStave(this.x),this.stave.context.closeGroup("timesignature"),this.stave.context.restore()}}],[{key:"CATEGORY",get:function(){return"timesignatures"}},{key:"glyphs",get:function(){return{C:{code:"v41",point:40,line:2},"C|":{code:"vb6",point:40,line:2}}}}]),n}(Ce),je=function(e){h(n,e);var t=d(n);function n(e,i,r,a){var s;return g(this,n),(s=t.call(this)).setAttribute("type","Volta"),s.volta=e,s.x=r,s.y_shift=a,s.number=i,s.font={family:"sans-serif",size:9,weight:"bold"},s}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setShiftY",value:function(e){return this.y_shift=e,this}},{key:"draw",value:function(e,t){var i=e.checkContext();this.setRendered();var r=e.width-t,a=e.getYForTopText(e.options.num_lines)+this.y_shift,s=1.5*e.options.spacing_between_lines_px;switch(this.volta){case n.type.BEGIN:i.fillRect(this.x+t,a,1,s);break;case n.type.END:r-=5,i.fillRect(this.x+t+r,a,1,s);break;case n.type.BEGIN_END:r-=3,i.fillRect(this.x+t,a,1,s),i.fillRect(this.x+t+r,a,1,s)}return this.volta!==n.type.BEGIN&&this.volta!==n.type.BEGIN_END||(i.save(),i.setFont(this.font.family,this.font.size,this.font.weight),i.fillText(this.number,this.x+t+5,a+15),i.restore()),i.fillRect(this.x+t,a,r,1),this}}],[{key:"CATEGORY",get:function(){return"voltas"}},{key:"type",get:function(){return{NONE:1,BEGIN:2,MID:3,END:4,BEGIN_END:5}}}]),n}(Ce),Ve=function(e){h(n,e);var t=d(n);function n(e,r,a,s){var o;g(this,n),(o=t.call(this)).setAttribute("type","Stave"),o.x=e,o.y=r,o.width=a,o.formatted=!1,o.setStartX(e+5),o.end_x=e+a,o.modifiers=[],o.measure=0,o.clef="treble",o.endClef=void 0,o.font={family:"sans-serif",size:8,weight:""},o.options={vertical_bar_width:10,glyph_spacing_px:10,num_lines:5,fill_style:"#999999",left_bar:!0,right_bar:!0,spacing_between_lines_px:10,space_above_staff_ln:4,space_below_staff_ln:4,top_text_position:1},o.bounds={x:o.x,y:o.y,w:o.width,h:0},i.Merge(o.options,s),o.resetLines();var u=Ie.type;return o.addModifier(new Ie(o.options.left_bar?u.SINGLE:u.NONE)),o.addEndModifier(new Ie(o.options.right_bar?u.SINGLE:u.NONE)),o}return y(n,[{key:"space",value:function(e){return this.options.spacing_between_lines_px*e}},{key:"resetLines",value:function(){this.options.line_config=[];for(var e=0;e<this.options.num_lines;e++)this.options.line_config.push({visible:!0});this.height=(this.options.num_lines+this.options.space_above_staff_ln)*this.options.spacing_between_lines_px,this.options.bottom_text_position=this.options.num_lines}},{key:"getOptions",value:function(){return this.options}},{key:"setNoteStartX",value:function(e){this.formatted||this.format(),this.setStartX(e);var t=this.modifiers[0];return t.setX(this.start_x-t.getWidth()),this}},{key:"setStartX",value:function(e){this.start_x=e}},{key:"getNoteStartX",value:function(){return this.formatted||this.format(),this.start_x}},{key:"getNoteEndX",value:function(){return this.formatted||this.format(),this.end_x}},{key:"getTieStartX",value:function(){return this.start_x}},{key:"getTieEndX",value:function(){return this.x+this.width}},{key:"getX",value:function(){return this.x}},{key:"getNumLines",value:function(){return this.options.num_lines}},{key:"setNumLines",value:function(e){return this.options.num_lines=parseInt(e,10),this.resetLines(),this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"getTopLineTopY",value:function(){return this.getYForLine(0)-T.STAVE_LINE_THICKNESS/2}},{key:"getBottomLineBottomY",value:function(){return this.getYForLine(this.getNumLines()-1)+T.STAVE_LINE_THICKNESS/2}},{key:"setX",value:function(e){var t=e-this.x;this.formatted=!1,this.x=e,this.start_x+=t,this.end_x+=t;for(var n=0;n<this.modifiers.length;n++){var i=this.modifiers[n];void 0!==i.x&&(i.x+=t)}return this}},{key:"setWidth",value:function(e){return this.formatted=!1,this.width=e,this.end_x=this.x+e,this}},{key:"getWidth",value:function(){return this.width}},{key:"getStyle",value:function(){return m({fillStyle:this.options.fill_style,strokeStyle:this.options.fill_style,lineWidth:T.STAVE_LINE_THICKNESS},this.style||{})}},{key:"setMeasure",value:function(e){return this.measure=e,this}},{key:"getModifierXShift",value:function(){if("number"!=typeof(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0))throw new i.RERR("InvalidIndex","Must be of number type");if(this.formatted||this.format(),1===this.getModifiers(Ce.Position.BEGIN).length)return 0;var e=this.start_x-this.x,t=this.modifiers[0];return t.getType()===Ie.type.REPEAT_BEGIN&&e>t.getWidth()&&(e-=t.getWidth()),e}},{key:"setRepetitionTypeLeft",value:function(e,t){return this.modifiers.push(new Ae(e,this.x,t)),this}},{key:"setRepetitionTypeRight",value:function(e,t){return this.modifiers.push(new Ae(e,this.x,t)),this}},{key:"setVoltaType",value:function(e,t,n){return this.modifiers.push(new je(e,t,this.x,n)),this}},{key:"setSection",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=new Le(e,this.x+n,t);return r.font.size=i,this.modifiers.push(r),this}},{key:"setTempo",value:function(e,t){return this.modifiers.push(new Oe(e,this.x,t)),this}},{key:"setText",value:function(e,t,n){return this.modifiers.push(new Ne(e,t,n)),this}},{key:"getHeight",value:function(){return this.height}},{key:"getSpacingBetweenLines",value:function(){return this.options.spacing_between_lines_px}},{key:"getBoundingBox",value:function(){return new k(this.x,this.y,this.width,this.getBottomY()-this.y)}},{key:"getBottomY",value:function(){var e=this.options,t=e.spacing_between_lines_px;return this.getYForLine(e.num_lines)+e.space_below_staff_ln*t}},{key:"getBottomLineY",value:function(){return this.getYForLine(this.options.num_lines)}},{key:"getYForLine",value:function(e){var t=this.options,n=t.spacing_between_lines_px,i=t.space_above_staff_ln;return this.y+e*n+i*n}},{key:"getLineForY",value:function(e){var t=this.options,n=t.spacing_between_lines_px,i=t.space_above_staff_ln;return(e-this.y)/n-i}},{key:"getYForTopText",value:function(e){var t=e||0;return this.getYForLine(-t-this.options.top_text_position)}},{key:"getYForBottomText",value:function(e){var t=e||0;return this.getYForLine(this.options.bottom_text_position+t)}},{key:"getYForNote",value:function(e){var t=this.options,n=t.spacing_between_lines_px,i=t.space_above_staff_ln;return this.y+i*n+5*n-e*n}},{key:"getYForGlyphs",value:function(){return this.getYForLine(3)}},{key:"addModifier",value:function(e,t){return void 0!==t&&e.setPosition(t),e.setStave(this),this.formatted=!1,this.modifiers.push(e),this}},{key:"addEndModifier",value:function(e){return this.addModifier(e,Ce.Position.END),this}},{key:"setBegBarType",value:function(e){var t=Ie.type,n=t.SINGLE,i=t.REPEAT_BEGIN,r=t.NONE;return e!==n&&e!==i&&e!==r||(this.modifiers[0].setType(e),this.formatted=!1),this}},{key:"setEndBarType",value:function(e){return e!==Ie.type.REPEAT_BEGIN&&(this.modifiers[1].setType(e),this.formatted=!1),this}},{key:"setClef",value:function(e,t,n,i){void 0===i&&(i=Ce.Position.BEGIN),i===Ce.Position.END?this.endClef=e:this.clef=e;var r=this.getModifiers(i,Be.CATEGORY);return 0===r.length?this.addClef(e,t,n,i):r[0].setType(e,t,n),this}},{key:"setEndClef",value:function(e,t,n){return this.setClef(e,t,n,Ce.Position.END),this}},{key:"setKeySignature",value:function(e,t,n){void 0===n&&(n=Ce.Position.BEGIN);var i=this.getModifiers(n,De.CATEGORY);return 0===i.length?this.addKeySignature(e,t,n):i[0].setKeySig(e,t),this}},{key:"setEndKeySignature",value:function(e,t){return this.setKeySignature(e,t,Ce.Position.END),this}},{key:"setTimeSignature",value:function(e,t,n){void 0===n&&(n=Ce.Position.BEGIN);var i=this.getModifiers(n,Fe.CATEGORY);return 0===i.length?this.addTimeSignature(e,t,n):i[0].setTimeSig(e),this}},{key:"setEndTimeSignature",value:function(e,t){return this.setTimeSignature(e,t,Ce.Position.END),this}},{key:"addKeySignature",value:function(e,t,n){return void 0===n&&(n=Ce.Position.BEGIN),this.addModifier(new De(e,t).setPosition(n),n),this}},{key:"addClef",value:function(e,t,n,i){return void 0===i||i===Ce.Position.BEGIN?this.clef=e:i===Ce.Position.END&&(this.endClef=e),this.addModifier(new Be(e,t,n),i),this}},{key:"addEndClef",value:function(e,t,n){return this.addClef(e,t,n,Ce.Position.END),this}},{key:"addTimeSignature",value:function(e,t,n){return this.addModifier(new Fe(e,t),n),this}},{key:"addEndTimeSignature",value:function(e,t){return this.addTimeSignature(e,t,Ce.Position.END),this}},{key:"addTrebleGlyph",value:function(){return this.addClef("treble"),this}},{key:"getModifiers",value:function(e,t){return void 0===e&&void 0===t?this.modifiers:this.modifiers.filter((function(n){return!(void 0!==e&&e!==n.getPosition()||void 0!==t&&t!==n.getCategory())}))}},{key:"sortByCategory",value:function(e,t){for(var n=e.length-1;n>=0;n--)for(var i=0;i<n;i++)if(t[e[i].getCategory()]>t[e[i+1].getCategory()]){var r=e[i];e[i]=e[i+1],e[i+1]=r}}},{key:"format",value:function(){var e,t,n,i=this.modifiers[0],r=this.modifiers[1],a=this.getModifiers(Ce.Position.BEGIN),s=this.getModifiers(Ce.Position.END);this.sortByCategory(a,{barlines:0,clefs:1,keysignatures:2,timesignatures:3}),this.sortByCategory(s,{timesignatures:0,keysignatures:1,barlines:2,clefs:3}),a.length>1&&i.getType()===Ie.type.REPEAT_BEGIN&&(a.push(a.splice(0,1)[0]),a.splice(0,0,new Ie(Ie.type.SINGLE))),s.indexOf(r)>0&&s.splice(0,0,new Ie(Ie.type.NONE));for(var o=0,u=this.x,l=0;l<a.length;l++)t=(n=a[l]).getPadding(l+o),e=n.getWidth(),isNaN(e)&&(n.setWidth(10),e=10),u+=t,n.setX(u),u+=e,t+e===0&&o--;this.setStartX(u),u=this.x+this.width;for(var c={left:0,right:0,paddingRight:0,paddingLeft:0},h=0,d=0;d<s.length;d++){h="barlines"===(n=s[d]).getCategory()?d:h,c.right=0,c.left=0,c.paddingRight=0,c.paddingLeft=0;var f=n.getLayoutMetrics();f?(0!==d&&(c.right=f.xMax||0,c.paddingRight=f.paddingRight||0),c.left=-f.xMin||0,c.paddingLeft=f.paddingLeft||0,d===s.length-1&&(c.paddingLeft=0)):(c.paddingRight=n.getPadding(d-h)||0,0!==d&&(c.right=n.getWidth()||0),0===d&&(c.left=n.getWidth()||0)),u-=c.paddingRight,u-=c.right,n.setX(u),u-=c.left,u-=c.paddingLeft}this.end_x=1===s.length?this.x+this.width:u,this.formatted=!0}},{key:"draw",value:function(){this.checkContext(),this.setRendered(),this.formatted||this.format();for(var e,t=this.options.num_lines,n=this.width,i=this.x,r=0;r<t;r++)e=this.getYForLine(r),this.applyStyle(),this.options.line_config[r].visible&&(this.context.beginPath(),this.context.moveTo(i,e),this.context.lineTo(i+n,e),this.context.stroke()),this.restoreStyle();for(var a=0;a<this.modifiers.length;a++)"function"==typeof this.modifiers[a].draw&&(this.modifiers[a].applyStyle(this.context),this.modifiers[a].draw(this,this.getModifierXShift(a)),this.modifiers[a].restoreStyle(this.context));if(this.measure>0){this.context.save(),this.context.setFont(this.font.family,this.font.size,this.font.weight);var s=this.context.measureText(""+this.measure).width;e=this.getYForTopText(0)+3,this.context.fillText(""+this.measure,this.x-s/2,e),this.context.restore()}return this}},{key:"drawVertical",value:function(e,t){this.drawVerticalFixed(this.x+e,t)}},{key:"drawVerticalFixed",value:function(e,t){this.checkContext();var n=this.getYForLine(0),i=this.getYForLine(this.options.num_lines-1);t&&this.context.fillRect(e-3,n,1,i-n+1),this.context.fillRect(e,n,1,i-n+1)}},{key:"drawVerticalBar",value:function(e){this.drawVerticalBarFixed(this.x+e,!1)}},{key:"drawVerticalBarFixed",value:function(e){this.checkContext();var t=this.getYForLine(0),n=this.getYForLine(this.options.num_lines-1);this.context.fillRect(e,t,1,n-t+1)}},{key:"getConfigForLines",value:function(){return this.options.line_config}},{key:"setConfigForLine",value:function(e,t){if(e>=this.options.num_lines||e<0)throw new i.RERR("StaveConfigError","The line number must be within the range of the number of lines in the Stave.");if(void 0===t.visible)throw new i.RERR("StaveConfigError","The line configuration object is missing the 'visible' property.");if("boolean"!=typeof t.visible)throw new i.RERR("StaveConfigError","The line configuration objects 'visible' property must be true or false.");return this.options.line_config[e]=t,this}},{key:"setConfigForLines",value:function(e){if(e.length!==this.options.num_lines)throw new i.RERR("StaveConfigError","The length of the lines configuration array must match the number of lines in the Stave");for(var t in e)e[t]||(e[t]=this.options.line_config[t]),i.Merge(this.options.line_config[t],e[t]);return this.options.line_config=e,this}}]),n}(_),Ge=function(e){h(n,e);var t=d(n);function n(e,r,a,s){var o;g(this,n);var u={spacing_between_lines_px:13,num_lines:6,top_text_position:1};return i.Merge(u,s),(o=t.call(this,e,r,a,u)).setAttribute("type","TabStave"),o}return y(n,[{key:"getYForGlyphs",value:function(){return this.getYForLine(2.5)}},{key:"addTabGlyph",value:function(){return this.addClef("tab"),this}}]),n}(Ve),We=function(e){h(n,e);var t=d(n);function n(e,r){var a;if(g(this,n),(a=t.call(this,e)).setAttribute("type","TabNote"),a.ghost=!1,a.positions=e.positions,i.Merge(a.render_options,{glyph_font_scale:T.DEFAULT_TABLATURE_FONT_SCALE,draw_stem:r,draw_dots:r,draw_stem_through_stave:!1,y_shift:0,scale:1,font:"10pt Arial"}),a.glyph=T.getGlyphProps(a.duration,a.noteType),!a.glyph)throw new i.RuntimeError("BadArguments","Invalid note initialization data (No glyph found): ".concat(JSON.stringify(e)));return a.buildStem(),e.stem_direction?a.setStemDirection(e.stem_direction):a.setStemDirection(B.UP),a.ghost=!1,a.updateWidth(),s(a)}return y(n,[{key:"reset",value:function(){this.stave&&this.setStave(this.stave)}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"setGhost",value:function(e){return this.ghost=e,this.updateWidth(),this}},{key:"hasStem",value:function(){return this.render_options.draw_stem}},{key:"getStemExtension",value:function(){var e=this.getGlyph();return null!=this.stem_extension_override?this.stem_extension_override:e?1===this.getStemDirection()?e.tabnote_stem_up_extension:e.tabnote_stem_down_extension:0}},{key:"addDot",value:function(){var e=new Z;return this.dots+=1,this.addModifier(e,0)}},{key:"updateWidth",value:function(){var e=this;this.glyphs=[],this.width=0;for(var t=0;t<this.positions.length;++t){var n=this.positions[t].fret;this.ghost&&(n="("+n+")");var i=T.tabToGlyph(n,this.render_options.scale);this.glyphs.push(i),this.width=Math.max(i.getWidth(),this.width)}this.glyph.getWidth=function(){return e.width}}},{key:"setStave",value:function(e){var t,i=this;if(o(u(n.prototype),"setStave",this).call(this,e),this.context=e.context,this.context){var r=this.context,a=function(){var e=i.glyphs[t],n=""+e.text;"X"!==n.toUpperCase()&&(r.save(),r.setRawFont(i.render_options.font),e.width=r.measureText(n).width,r.restore(),e.getWidth=function(){return e.width}),i.width=Math.max(e.getWidth(),i.width)};for(this.width=0,t=0;t<this.glyphs.length;++t)a();this.glyph.getWidth=function(){return i.width}}var s=this.positions.map((function(t){var n=t.str;return e.getYForLine(n-1)}));return this.setYs(s),this.stem&&this.stem.setYBounds(this.getStemY(),this.getStemY()),this}},{key:"getPositions",value:function(){return this.positions}},{key:"addToModifierContext",value:function(e){this.setModifierContext(e);for(var t=0;t<this.modifiers.length;++t)this.modifierContext.addModifier(this.modifiers[t]);return this.modifierContext.addModifier(this),this.preFormatted=!1,this}},{key:"getTieRightX",value:function(){var e=this.getAbsoluteX();return e+=this.glyph.getWidth()/2,e+=-this.width/2+this.width+2}},{key:"getTieLeftX",value:function(){var e=this.getAbsoluteX();return e+=this.glyph.getWidth()/2,e-=this.width/2+2}},{key:"getModifierStartXY",value:function(e,t){if(!this.preFormatted)throw new i.RERR("UnformattedNote","Can't call GetModifierStartXY on an unformatted note");if(0===this.ys.length)throw new i.RERR("NoYValues","No Y-Values calculated for this note.");var n=0;return e===q.Position.LEFT?n=-2:e===q.Position.RIGHT?n=this.width+2:e!==q.Position.BELOW&&e!==q.Position.ABOVE||(n=this.glyph.getWidth()/2),{x:this.getAbsoluteX()+n,y:this.ys[t]}}},{key:"getLineForRest",value:function(){return this.positions[0].str}},{key:"preFormat",value:function(){this.preFormatted||(this.modifierContext&&this.modifierContext.preFormat(),this.setPreFormatted(!0))}},{key:"getStemX",value:function(){return this.getCenterGlyphX()}},{key:"getStemY",value:function(){var e=this.stave.getNumLines()-.5,t=B.UP===this.stem_direction?-.5:e;return this.stave.getYForLine(t)}},{key:"getStemExtents",value:function(){return this.stem.getExtents()}},{key:"drawFlag",value:function(){var e=this.beam,t=this.glyph,n=this.context,i=this.stem,r=this.stem_direction,a=this.render_options,s=a.draw_stem,o=a.glyph_font_scale,u=null==e&&s;if(t.flag&&u){var l=this.getStemX()+1,c=this.getStemY()-i.getHeight(),h=r===B.DOWN?t.code_flag_downstem:t.code_flag_upstem;P.renderGlyph(n,l,c,o,h)}}},{key:"drawModifiers",value:function(){var e=this;this.modifiers.forEach((function(t){("dots"!==t.getCategory()||e.render_options.draw_dots)&&(t.setContext(e.context),t.drawWithStyle())}))}},{key:"drawStemThrough",value:function(){var e=this.getStemX(),t=this.getStemY(),n=this.context,i=this.render_options.draw_stem_through_stave;if(this.render_options.draw_stem&&i){var r=function(e,t){for(var n=[],i=[],r=1;r<=e;r++)t.indexOf(r)>-1?(n.push(i),i=[]):i.push(r);return i.length>0&&n.push(i),n}(this.stave.getNumLines(),this.positions.map((function(e){return e.str}))),a=function(e,t,n,i){var r=1!==i,a=-1!==i,s=n.getSpacingBetweenLines(),o=n.getNumLines(),u=[];return t.forEach((function(t){var l=t.indexOf(o)>-1,c=t.indexOf(1)>-1;if(!(r&&c||a&&l)){1===t.length&&t.push(t[0]);var h=[];t.forEach((function(t,r,a){var u=1===t,l=t===o,c=n.getYForLine(t-1);0!==r||u?r!==a.length-1||l||(c+=s/2-1):c-=s/2-1,h.push(c),1===i&&u?h.push(e-2):-1===i&&l&&h.push(e+2)})),u.push(h.sort((function(e,t){return e-t})))}})),u}(t,r,this.getStave(),this.getStemDirection());n.save(),n.setLineWidth(B.WIDTH),a.forEach((function(t){0!==t.length&&(n.beginPath(),n.moveTo(e,t[0]),n.lineTo(e,t[t.length-1]),n.stroke(),n.closePath())})),n.restore()}}},{key:"drawPositions",value:function(){for(var e=this.context,t=this.getAbsoluteX(),n=this.ys,i=0;i<this.positions.length;++i){var r=n[i]+this.render_options.y_shift,a=this.glyphs[i],s=t+this.glyph.getWidth()/2-a.getWidth()/2;if(e.clearRect(s-2,r-3,a.getWidth()+4,6),a.code)P.renderGlyph(e,s,r,this.render_options.glyph_font_scale*this.render_options.scale,a.code);else{e.save(),e.setRawFont(this.render_options.font);var o=a.text.toString();e.fillText(o,s,r+5*this.render_options.scale),e.restore()}}}},{key:"draw",value:function(){if(this.checkContext(),!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");if(0===this.ys.length)throw new i.RERR("NoYValues","Can't draw note without Y values.");this.setRendered();var e=null==this.beam&&this.render_options.draw_stem;this.context.openGroup("tabnote",null,{pointerBBox:!0}),this.drawPositions(),this.drawStemThrough();var t=this.getStemX();this.stem.setNoteHeadXBounds(t,t),e&&(this.context.openGroup("stem",null,{pointerBBox:!0}),this.stem.setContext(this.context).draw(),this.context.closeGroup()),this.drawFlag(),this.drawModifiers(),this.context.closeGroup()}}],[{key:"CATEGORY",get:function(){return"tabnotes"}}]),n}(K),Ue=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","VibratoBracket"),i.start=e.start,i.stop=e.stop,i.toEndOfStopStave=e.toEndOfStopStave,i.line=1,i.render_options={harsh:!1,wave_height:6,wave_width:4,wave_girth:2},i}return y(n,[{key:"setLine",value:function(e){return this.line=e,this}},{key:"setHarsh",value:function(e){return this.render_options.harsh=e,this}},{key:"draw",value:function(){var e=this.context;this.setRendered();var t=this.start?this.start.getStave().getYForTopText(this.line):this.stop.getStave().getYForTopText(this.line),r=0;if(this.start){var a,s=0,o=b(this.start.modifiers);try{for(o.s();!(a=o.n()).done;){var u=a.value;if(u&&"tr"===u.type){s=u.glyph.bbox.w;break}}}catch(c){o.e(c)}finally{o.f()}r=this.start.getNoteHeadBeginX?this.start.getNoteHeadBeginX():this.start.getAbsoluteX(),r+=s}else r=this.stop.getStave().getTieStartX();var l=0;l=this.stop?this.toEndOfStopStave?this.stop.getStave().getTieEndX()-10:this.stop.getAbsoluteX()+this.stop.getWidth():this.start.getStave().getTieEndX()-10,this.render_options.vibrato_width=l-r,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.VibratoBracket",t)}("Rendering VibratoBracket: start_x:",r,"stop_x:",l,"y:",t),_e.renderVibrato(e,r,t,this.render_options)}}]),n}(_);function ze(){if(!Pe){var e=new Y({duration:"w",note_type:"r"});Pe={glyph_font_scale:e.render_options.glyph_font_scale,glyph_code:e.glyph_code,width:e.getWidth()}}return Pe}var He=function(e){h(n,e);var t=d(n);function n(e,r){var a;return g(this,n),(a=t.call(this)).setAttribute("type","MultiMeasureRest"),a.render_options={show_number:!0,number_line:-.5,number_glyph_point:40,padding_left:void 0,padding_right:void 0,line:2,spacing_between_lines_px:10,line_thickness:void 0,serif_thickness:2,use_symbols:!1,symbol_spacing:void 0,semibrave_rest_glyph_scale:T.DEFAULT_NOTATION_FONT_SCALE},i.Merge(a.render_options,r),a.number_of_measures=e,a.xs={left:NaN,right:NaN},a}return y(n,[{key:"getXs",value:function(){return this.xs}},{key:"setStave",value:function(e){return this.stave=e,this}},{key:"getStave",value:function(){return this.stave}},{key:"drawLine",value:function(e,t,n,i){var r=this.stave.getYForLine(this.render_options.line),a=.1*(n-t);t+=a,n-=a;var s=this.render_options.serif_thickness,o=.25*i;isNaN(this.render_options.line_thickness)||(o=.5*this.render_options.line_thickness),e.save(),e.beginPath(),e.moveTo(t,r-i),e.lineTo(t+s,r-i),e.lineTo(t+s,r-o),e.lineTo(n-s,r-o),e.lineTo(n-s,r-i),e.lineTo(n,r-i),e.lineTo(n,r+i),e.lineTo(n-s,r+i),e.lineTo(n-s,r+o),e.lineTo(t+s,r+o),e.lineTo(t+s,r+i),e.lineTo(t,r+i),e.closePath(),e.fill()}},{key:"drawSymbols",value:function(e,t,n,i){var r=Math.floor(this.number_of_measures/4),a=this.number_of_measures%4,s=Math.floor(a/2),o=a%2,u=ze(),l=u.width*(this.render_options.semibrave_rest_glyph_scale/u.glyph_font_scale),c={2:{width:.5*l,height:i},1:{width:l}},h=1.35*l;isNaN(this.render_options.symbol_spacing)||(h=this.render_options.symbol_spacing);var d=t+.5*(n-t)-.5*(r*c[2].width+s*c[2].width+o*c[1].width+(r+s+o-1)*h),f=this.stave.getYForLine(this.render_options.line-1),p=this.stave.getYForLine(this.render_options.line),m=this.stave.getYForLine(this.render_options.line+1);e.save(),e.setStrokeStyle("none"),e.setLineWidth(0);for(var v=0;v<r;++v)e.fillRect(d,p-c[2].height,c[2].width,c[2].height),e.fillRect(d,m-c[2].height,c[2].width,c[2].height),d+=c[2].width+h;for(var g=0;g<s;++g)e.fillRect(d,p-c[2].height,c[2].width,c[2].height),d+=c[2].width+h;for(var y=0;y<o;++y)P.renderGlyph(e,d,f,this.render_options.semibrave_rest_glyph_scale,u.glyph_code),d+=c[1].width+h;e.restore()}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e=this.context,t=this.stave,n=this.render_options.spacing_between_lines_px,i=t.getNoteStartX(),r=t.getNoteEndX(),a=t.getModifiers(Ce.Position.BEGIN);if(1===a.length&&"barlines"===a[0].getCategory()&&(i-=a[0].getWidth()),isNaN(this.render_options.padding_left)||(i=t.getX()+this.render_options.padding_left),isNaN(this.render_options.padding_right)||(r=t.getX()+t.getWidth()-this.render_options.padding_right),this.xs.left=i,this.xs.right=r,this.render_options.use_symbols?this.drawSymbols(e,i,r,n):this.drawLine(e,i,r,n),this.render_options.show_number){var s="/"+this.number_of_measures,o=new Fe(null,void 0,!1);o.point=this.render_options.number_glyph_point,o.setTimeSig(s),o.setStave(t),o.x=i+.5*(r-i)-.5*o.timeSig.glyph.getMetrics().width,o.bottomLine=this.render_options.number_line,o.setContext(e).draw()}}}]),n}(_),Xe=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,{duration:"b"})).setAttribute("type","ClefNote"),a.setType(e,i,r),a.ignore_ticks=!0,a}return y(n,[{key:"setType",value:function(e,t,n){return this.type=e,this.clef_obj=new Be(e,t,n),this.clef=this.clef_obj.clef,this.glyph=new P(this.clef.code,this.clef.point),this.setWidth(this.glyph.getMetrics().width),this}},{key:"getClef",value:function(){return this.clef}},{key:"setContext",value:function(e){return this.context=e,this.glyph.setContext(this.context),this}},{key:"getBoundingBox",value:function(){return o(u(n.prototype),"getBoundingBox",this).call(this)}},{key:"addToModifierContext",value:function(){return this}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"preFormat",value:function(){return this.setPreFormatted(!0),this}},{key:"draw",value:function(){if(!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");this.glyph.getContext()||this.glyph.setContext(this.context),this.setRendered();var e=this.getAbsoluteX();if(this.glyph.setStave(this.stave),this.glyph.setYShift(this.stave.getYForLine(this.clef.line)-this.stave.getYForGlyphs()),this.glyph.renderToStave(e),void 0!==this.clef_obj.annotation){var t=new P(this.clef_obj.annotation.code,this.clef_obj.annotation.point);t.getContext()||t.setContext(this.context),t.setStave(this.stave),t.setYShift(this.stave.getYForLine(this.clef_obj.annotation.line)-this.stave.getYForGlyphs()),t.setXShift(this.clef_obj.annotation.x_shift),t.renderToStave(e)}}}],[{key:"CATEGORY",get:function(){return"clefnote"}}]),n}(X),Ye=function(e){h(n,e);var t=d(n);function n(e,i,r){var a;return g(this,n),(a=t.call(this,{duration:"b"})).setAttribute("type","KeySigNote"),a.keySignature=new De(e,i,r),a.ignore_ticks=!0,a}return y(n,[{key:"getBoundingBox",value:function(){return o(u(n.prototype),"getBoundingBox",this).call(this)}},{key:"addToModifierContext",value:function(){return this}},{key:"preFormat",value:function(){return this.setPreFormatted(!0),this.keySignature.setStave(this.stave),this.keySignature.format(),this.setWidth(this.keySignature.width),this}},{key:"draw",value:function(){this.stave.checkContext(),this.setRendered(),this.keySignature.x=this.getAbsoluteX(),this.keySignature.setContext(this.context),this.keySignature.draw()}}]),n}(X),Ke=function(e){h(n,e);var t=d(n);function n(e,i){var r;g(this,n),(r=t.call(this,{duration:"b"})).setAttribute("type","TimeSigNote");var a=new Fe(e,i);return r.timeSig=a.getTimeSig(),r.setWidth(r.timeSig.glyph.getMetrics().width),r.ignore_ticks=!0,r}return y(n,[{key:"getBoundingBox",value:function(){return o(u(n.prototype),"getBoundingBox",this).call(this)}},{key:"addToModifierContext",value:function(){return this}},{key:"preFormat",value:function(){return this.setPreFormatted(!0),this}},{key:"draw",value:function(){this.stave.checkContext(),this.setRendered(),this.timeSig.glyph.getContext()||this.timeSig.glyph.setContext(this.context),this.timeSig.glyph.setStave(this.stave),this.timeSig.glyph.setYShift(this.stave.getYForLine(this.timeSig.line)-this.stave.getYForGlyphs()),this.timeSig.glyph.renderToStave(this.getAbsoluteX())}}]),n}(X),qe=function(e){h(n,e);var t=d(n);function n(e,i){var r;if(g(this,n),(r=t.call(this,e,"sl.")).setAttribute("type","TabSlide"),!i){var a=e.first_note.getPositions()[0].fret,o=e.last_note.getPositions()[0].fret;i=parseInt(a,10)>parseInt(o,10)?n.SLIDE_DOWN:n.SLIDE_UP}return r.slide_direction=i,r.render_options.cp1=11,r.render_options.cp2=14,r.render_options.y_shift=.5,r.setFont({font:"Times",size:10,style:"bold italic"}),r.setNotes(e),s(r)}return y(n,[{key:"renderTie",value:function(e){if(0===e.first_ys.length||0===e.last_ys.length)throw new i.RERR("BadArguments","No Y-values to render");var t=this.context,r=e.first_x_px,a=e.first_ys,s=e.last_x_px,o=this.slide_direction;if(o!==n.SLIDE_UP&&o!==n.SLIDE_DOWN)throw new i.RERR("BadSlide","Invalid slide direction");for(var u=0;u<this.first_indices.length;++u){var l=a[this.first_indices[u]]+this.render_options.y_shift;if(isNaN(l))throw new i.RERR("BadArguments","Bad indices for slide rendering.");t.beginPath(),t.moveTo(r,l+3*o),t.lineTo(s,l-3*o),t.closePath(),t.stroke()}this.setRendered()}}],[{key:"SLIDE_UP",get:function(){return 1}},{key:"SLIDE_DOWN",get:function(){return-1}},{key:"createSlideUp",value:function(e){return new n(e,n.SLIDE_UP)}},{key:"createSlideDown",value:function(e){return new n(e,n.SLIDE_DOWN)}}]),n}(se),Ze=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this,Object.assign(e,{glyph_font_scale:T.DEFAULT_NOTATION_FONT_SCALE*n.SCALE,stroke_px:n.LEDGER_LINE_OFFSET}))).setAttribute("type","GraceNote"),i.slash=e.slash,i.slur=!0,i.buildNoteHeads(),i.width=3,i}return y(n,[{key:"getStemExtension",value:function(){if(null!=this.stem_extension_override)return this.stem_extension_override;var e=this.getGlyph();if(e){var t=o(u(n.prototype),"getStemExtension",this).call(this);if(e.stem){var i=this.getStaveNoteScale();t=(B.HEIGHT+t)*i-B.HEIGHT}return t}return 0}},{key:"getCategory",value:function(){return n.CATEGORY}},{key:"getStaveNoteScale",value:function(){return this.render_options.glyph_font_scale/T.DEFAULT_NOTATION_FONT_SCALE}},{key:"draw",value:function(){o(u(n.prototype),"draw",this).call(this),this.setRendered();var e=this.stem;if(this.slash&&e){var t,i=this.getStaveNoteScale(),r=i/.66,a=this.beam;if(a)a.postFormatted||a.postFormat(),t=this.calcBeamedNotesSlashBBox(8*r,8*r,{stem:6*r,beam:5*r});else{var s=this.getStemDirection(),l=this.getNoteHeadBounds(),c=e.getHeight(),h=this.getAbsoluteX(),d=s===T.Stem.DOWN?l.y_top-c:l.y_bottom-c,f=s===T.Stem.DOWN?this.glyph.stem_down_extension:this.glyph.stem_up_extension,p=T.STEM_HEIGHT;p-=p/2.8,d+=(p+=f)*i*s;var m=s===T.Stem.UP?{x1:1,y1:0,x2:13,y2:-9}:{x1:-4,y1:1,x2:13,y2:9};t={x1:h+=m.x1*r,y1:d+=m.y1*r,x2:h+m.x2*r,y2:d+m.y2*r}}var v=this.context;v.save(),v.setLineWidth(1*r),v.beginPath(),v.moveTo(t.x1,t.y1),v.lineTo(t.x2,t.y2),v.closePath(),v.stroke(),v.restore()}}},{key:"calcBeamedNotesSlashBBox",value:function(e,t,n){var i=this.beam,r=i.slope,a=i.notes[i.notes.length-1]===this?-1:1,s=Math.atan(r*a),o=Math.cos(s)*t,u=Math.sin(s)*t;e*=this.getStemDirection();var l=Math.atan((u-e)/o),c=Math.cos(l)*n.stem*a,h=Math.sin(l)*n.stem,d=Math.cos(l)*n.beam*a,f=Math.sin(l)*n.beam,p=this.getStemX(),m=i.notes[0].getStemX(),v=this.beam.getBeamYToDraw()+(p-m)*r;return{x1:p-c,y1:v+e-h,x2:p+o*a+d,y2:v+u+f}}}],[{key:"CATEGORY",get:function(){return"gracenotes"}},{key:"LEDGER_LINE_OFFSET",get:function(){return 2}},{key:"SCALE",get:function(){return.66}}]),n}(Q),Je=function(e){h(n,e);var t=d(n);function n(e){var r;return g(this,n),(r=t.call(this,e,!1)).setAttribute("type","GraceTabNote"),i.Merge(r.render_options,{y_shift:.3,scale:.6,font:"7.5pt Arial"}),r.updateWidth(),r}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"draw",value:function(){o(u(n.prototype),"draw",this).call(this),this.setRendered()}}],[{key:"CATEGORY",get:function(){return"gracetabnotes"}}]),n}(We),Qe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"E/5,B/4,G/4,D/4,A/3,E/3,B/2,E/2";g(this,e),this.setTuning(t)}return y(e,[{key:"noteToInteger",value:function(e){return T.keyProperties(e).int_value}},{key:"setTuning",value:function(t){e.names[t]&&(t=e.names[t]),this.tuningString=t,this.tuningValues=[],this.numStrings=0;var n=t.split(/\s*,\s*/);if(0===n.length)throw new i.RERR("BadArguments","Invalid tuning string: "+t);this.numStrings=n.length;for(var r=0;r<this.numStrings;++r)this.tuningValues[r]=this.noteToInteger(n[r])}},{key:"getValueForString",value:function(e){var t=parseInt(e,10);if(t<1||t>this.numStrings)throw new i.RERR("BadArguments","String number must be between 1 and ".concat(this.numStrings,":").concat(e));return this.tuningValues[t-1]}},{key:"getValueForFret",value:function(e,t){var n=this.getValueForString(t),r=parseInt(e,10);if(r<0)throw new i.RERR("BadArguments","Fret number must be 0 or higher: "+e);return n+r}},{key:"getNoteForFret",value:function(e,t){var n=this.getValueForFret(e,t),i=Math.floor(n/12),r=n%12;return T.integerToNote(r)+"/"+i}}],[{key:"names",get:function(){return{standard:"E/5,B/4,G/4,D/4,A/3,E/3",dagdad:"D/5,A/4,G/4,D/4,A/3,D/3",dropd:"E/5,B/4,G/4,D/4,A/3,D/3",eb:"Eb/5,Bb/4,Gb/4,Db/4,Ab/3,Db/3",standardBanjo:"D/5,B/4,G/4,D/4,G/5"}}}]),e}(),$e=function(e){h(n,e);var t=d(n);function n(e,i){var r;return g(this,n),(r=t.call(this)).setAttribute("type","StaveHairpin"),r.notes=e,r.hairpin=i,r.position=q.Position.BELOW,r.render_options={height:10,y_shift:0,left_shift_px:0,right_shift_px:0},r.setNotes(e),r}return y(n,[{key:"setPosition",value:function(e){return e!==q.Position.ABOVE&&e!==q.Position.BELOW||(this.position=e),this}},{key:"setRenderOptions",value:function(e){return null!=e.height&&null!=e.y_shift&&null!=e.left_shift_px&&null!=e.right_shift_px&&(this.render_options=e),this}},{key:"setNotes",value:function(e){if(!e.first_note&&!e.last_note)throw new i.RuntimeError("BadArguments","Hairpin needs to have either first_note or last_note set.");return this.first_note=e.first_note,this.last_note=e.last_note,this}},{key:"renderHairpin",value:function(e){var t=this.checkContext(),i=this.render_options.y_shift+20,r=e.first_y;this.position===q.Position.ABOVE&&(i=30-i,r=e.first_y-e.staff_height);var a=this.render_options.left_shift_px,s=this.render_options.right_shift_px;switch(t.beginPath(),this.hairpin){case n.type.CRESC:t.moveTo(e.last_x+s,r+i),t.lineTo(e.first_x+a,r+this.render_options.height/2+i),t.lineTo(e.last_x+s,r+this.render_options.height+i);break;case n.type.DECRESC:t.moveTo(e.first_x+a,r+i),t.lineTo(e.last_x+s,r+this.render_options.height/2+i),t.lineTo(e.first_x+a,r+this.render_options.height+i)}t.stroke(),t.closePath()}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e=this.first_note,t=this.last_note,n=e.getModifierStartXY(this.position,0),i=t.getModifierStartXY(this.position,0);return this.renderHairpin({first_x:n.x,last_x:i.x,first_y:e.getStave().y+e.getStave().height,last_y:t.getStave().y+t.getStave().height,staff_height:e.getStave().height}),!0}}],[{key:"type",get:function(){return{CRESC:1,DECRESC:2}}},{key:"FormatByTicksAndDraw",value:function(e,t,r,a,s,o){var u=t.pixelsPerTick;if(null==u)throw new i.RuntimeError("BadArguments","A valid Formatter must be provide to draw offsets by ticks.");var l=u*o.left_shift_ticks,c=u*o.right_shift_ticks,h={height:o.height,y_shift:o.y_shift,left_shift_px:l,right_shift_px:c};new n({first_note:r.first_note,last_note:r.last_note},a).setContext(e).setRenderOptions(h).setPosition(s).draw()}}]),n}(_),et=function(e){h(n,e);var t=d(n);function n(e,r,a){var s;return g(this,n),(s=t.call(this)).setAttribute("type","Curve"),s.render_options={spacing:2,thickness:2,x_shift:0,y_shift:10,position:n.Position.NEAR_HEAD,position_end:n.Position.NEAR_HEAD,invert:!1,cps:[{x:0,y:10},{x:0,y:10}]},i.Merge(s.render_options,a),s.setNotes(e,r),s}return y(n,[{key:"setNotes",value:function(e,t){if(!e&&!t)throw new i.RuntimeError("BadArguments","Curve needs to have either first_note or last_note set.");return this.from=e,this.to=t,this}},{key:"isPartial",value:function(){return!this.from||!this.to}},{key:"renderCurve",value:function(e){var t=this.context,n=this.render_options.cps,i=this.render_options.x_shift,r=this.render_options.y_shift*e.direction,a=e.first_x+i,s=e.first_y+r,o=e.last_x-i,u=e.last_y+r,l=this.render_options.thickness,c=(o-a)/(n.length+2);t.beginPath(),t.moveTo(a,s),t.bezierCurveTo(a+c+n[0].x,s+n[0].y*e.direction,o-c+n[1].x,u+n[1].y*e.direction,o,u),t.bezierCurveTo(o-c+n[1].x,u+(n[1].y+l)*e.direction,a+c+n[0].x,s+(n[0].y+l)*e.direction,a,s),t.stroke(),t.closePath(),t.fill()}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e,t,i,r,a,s=this.from,o=this.to,u="baseY",l="baseY";function c(e){return"string"==typeof e?n.PositionString[e]:e}var h=c(this.render_options.position),d=c(this.render_options.position_end);return h===n.Position.NEAR_TOP&&(u="topY",l="topY"),d===n.Position.NEAR_HEAD?l="baseY":d===n.Position.NEAR_TOP&&(l="topY"),s?(e=s.getTieRightX(),a=s.getStemDirection(),i=s.getStemExtents()[u]):(e=o.getStave().getTieStartX(),i=o.getStemExtents()[u]),o?(t=o.getTieLeftX(),a=o.getStemDirection(),r=o.getStemExtents()[l]):(t=s.getStave().getTieEndX(),r=s.getStemExtents()[l]),this.renderCurve({first_x:e,last_x:t,first_y:i,last_y:r,direction:a*(!0===this.render_options.invert?-1:1)}),!0}}],[{key:"Position",get:function(){return{NEAR_HEAD:1,NEAR_TOP:2}}},{key:"PositionString",get:function(){return{nearHead:n.Position.NEAR_HEAD,nearTop:n.Position.NEAR_TOP}}}]),n}(_);function tt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];nt.DEBUG&&i.L("Vex.Flow.TextDynamics",t)}var nt=function(e){h(n,e);var t=d(n);function n(e){var r;return g(this,n),(r=t.call(this,e)).setAttribute("type","TextDynamics"),r.sequence=e.text.toLowerCase(),r.line=e.line||0,r.glyphs=[],i.Merge(r.render_options,{glyph_font_size:40}),tt("New Dynamics Text: ",r.sequence),r}return y(n,[{key:"setLine",value:function(e){return this.line=e,this}},{key:"preFormat",value:function(){var e=this,t=0;return this.sequence.split("").forEach((function(r){var a=n.GLYPHS[r];if(!a)throw new i.RERR("Invalid dynamics character: "+r);var s=e.render_options.glyph_font_size,o=new P(a.code,s);e.glyphs.push(o),t+=a.width})),this.setWidth(t),this.preFormatted=!0,this}},{key:"draw",value:function(){var e=this;this.setRendered();var t=this.getAbsoluteX(),i=this.stave.getYForLine(this.line+-3);tt("Rendering Dynamics: ",this.sequence);var r=t;this.glyphs.forEach((function(t,a){var s=e.sequence[a];t.render(e.context,r,i),r+=n.GLYPHS[s].width}))}}],[{key:"GLYPHS",get:function(){return{f:{code:"vba",width:12},p:{code:"vbf",width:14},m:{code:"v62",width:17},s:{code:"v4a",width:10},z:{code:"v80",width:12},r:{code:"vb1",width:12}}}}]),n}(X);function it(e,t,n,i,r,a,s){e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.lineTo(a,s),e.lineTo(t,n),e.closePath(),e.fill()}var rt=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","StaveLine"),i.notes=e,i.text="",i.font={family:"Arial",size:10,weight:""},i.render_options={padding_left:4,padding_right:3,line_width:1,line_dash:null,rounded_end:!0,color:null,draw_start_arrow:!1,draw_end_arrow:!1,arrowhead_length:10,arrowhead_angle:Math.PI/8,text_position_vertical:n.TextVerticalPosition.TOP,text_justification:n.TextJustification.CENTER},i.setNotes(e),i}return y(n,[{key:"setFont",value:function(e){return this.font=e,this}},{key:"setText",value:function(e){return this.text=e,this}},{key:"setNotes",value:function(e){if(!e.first_note&&!e.last_note)throw new i.RuntimeError("BadArguments","Notes needs to have either first_note or last_note set.");if(e.first_indices||(e.first_indices=[0]),e.last_indices||(e.last_indices=[0]),e.first_indices.length!==e.last_indices.length)throw new i.RuntimeError("BadArguments","Connected notes must have similar index sizes");return this.first_note=e.first_note,this.first_indices=e.first_indices,this.last_note=e.last_note,this.last_indices=e.last_indices,this}},{key:"applyLineStyle",value:function(){var e=this.checkContext(),t=this.render_options;t.line_dash&&e.setLineDash(t.line_dash),t.line_width&&e.setLineWidth(t.line_width),t.rounded_end?e.setLineCap("round"):e.setLineCap("square")}},{key:"applyFontStyle",value:function(){var e=this.checkContext();this.font&&e.setFont(this.font.family,this.font.size,this.font.weight),this.render_options.color&&(e.setStrokeStyle(this.render_options.color),e.setFillStyle(this.render_options.color))}},{key:"draw",value:function(){var e=this,t=this.checkContext();this.setRendered();var i,r,a=this.first_note,s=this.last_note,o=this.render_options;t.save(),this.applyLineStyle(),this.first_indices.forEach((function(n,u){var l=e.last_indices[u];i=a.getModifierStartXY(2,n),r=s.getModifierStartXY(1,l);var c=i.y>r.y;i.x+=a.getMetrics().modRightPx+o.padding_left,r.x-=s.getMetrics().modLeftPx+o.padding_right;var h=a.getGlyph().getWidth();a.getKeyProps()[n].displaced&&1===a.getStemDirection()&&(i.x+=h+o.padding_left),s.getKeyProps()[l].displaced&&-1===s.getStemDirection()&&(r.x-=h+o.padding_right),i.y+=c?-3:1,r.y+=c?2:0,function(e,t,n,i){var r,a,s,o,u=i.draw_start_arrow&&i.draw_end_arrow,l=t.x,c=t.y,h=n.x,d=n.y,f=Math.sqrt((h-l)*(h-l)+(d-c)*(d-c)),p=(f-i.arrowhead_length/3)/f;i.draw_end_arrow||u?(r=Math.round(l+(h-l)*p),a=Math.round(c+(d-c)*p)):(r=h,a=d),i.draw_start_arrow||u?(s=l+(h-l)*(1-p),o=c+(d-c)*(1-p)):(s=l,o=c),i.color&&(e.setStrokeStyle(i.color),e.setFillStyle(i.color)),e.beginPath(),e.moveTo(s,o),e.lineTo(r,a),e.stroke(),e.closePath();var m,v,g,y,b=Math.atan2(d-c,h-l),S=Math.abs(i.arrowhead_length/Math.cos(i.arrowhead_angle));(i.draw_end_arrow||u)&&(m=b+Math.PI+i.arrowhead_angle,g=h+Math.cos(m)*S,y=d+Math.sin(m)*S,v=b+Math.PI-i.arrowhead_angle,it(e,g,y,h,d,h+Math.cos(v)*S,d+Math.sin(v)*S)),(i.draw_start_arrow||u)&&(m=b+i.arrowhead_angle,g=l+Math.cos(m)*S,y=c+Math.sin(m)*S,v=b-i.arrowhead_angle,it(e,g,y,l,c,l+Math.cos(v)*S,c+Math.sin(v)*S))}(t,i,r,e.render_options)})),t.restore();var u,l=t.measureText(this.text).width,c=o.text_justification,h=0;c===n.TextJustification.LEFT?h=i.x:c===n.TextJustification.CENTER?h=(r.x-i.x)/2+i.x-l/2:c===n.TextJustification.RIGHT&&(h=r.x-l);var d=o.text_position_vertical;return d===n.TextVerticalPosition.TOP?u=a.getStave().getYForTopText():d===n.TextVerticalPosition.BOTTOM&&(u=a.getStave().getYForBottomText(T.TEXT_HEIGHT_OFFSET_HACK)),t.save(),this.applyFontStyle(),t.fillText(this.text,h,u),t.restore(),this}}],[{key:"TextVerticalPosition",get:function(){return{TOP:1,BOTTOM:2}}},{key:"TextJustification",get:function(){return{LEFT:1,CENTER:2,RIGHT:3}}}]),n}(_);function at(e,t,n,i,r){var a=st.GLYPHS[e];new P(a.code,r).render(t,n+a.x_shift,i+a.y_shift)}var st=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","PedalMarking"),i.EndsStave=!1,i.ChangeBegin=!1,i.ChangeEnd=!1,i.notes=e,i.style=n.TEXT,i.line=0,i.custom_depress_text="",i.custom_release_text="",i.font={family:"Times New Roman",size:12,weight:"italic bold"},i.render_options={bracket_height:10,text_margin_right:6,bracket_line_width:1,glyph_point_size:40,color:"black"},i}return y(n,[{key:"setEndStave",value:function(e){if(this.endStave=e,this.endStaveAddedWidth=0,this.startMargin=0,this.endMargin=0,Array.isArray(this.endStave.modifiers))for(var t=0;t<this.endStave.modifiers.length;t++){var n=this.endStave.modifiers[t];n&&n.position===Ce.Position.END&&n.width&&(this.endStaveAddedWidth+=n.width)}}},{key:"setCustomText",value:function(e,t){return this.custom_depress_text=e||"",this.custom_release_text=t||"",this}},{key:"setStyle",value:function(e){if(e<1&&e>3)throw new i.RERR("InvalidParameter","The style must be one found in PedalMarking.Styles");return this.style=e,this}},{key:"setLine",value:function(e){return this.line=e,this}},{key:"drawBracketed",value:function(){var e,t,i=this,r=this.context,a=!1,s=this;this.notes.forEach((function(o,u,l){a=!a;var c=0;if(c=o?o.getNoteHeadBeginX():i.endStave.end_x+i.endStaveAddedWidth,i.EndsStave)a?i.ChangeBegin&&(c=o.getAbsoluteX()):(c=o?i.ChangeEnd?o.getAbsoluteX():o.getStave().end_x+i.endStaveAddedWidth-s.render_options.text_margin_right:i.endStave.end_x+i.endStaveAddedWidth-s.render_options.text_margin_right,i.endMargin=-s.render_options.text_margin_right);else if(o)if(a)i.ChangeBegin&&(c=o.getAbsoluteX());else switch(s.style){case n.Styles.BRACKET_OPEN_END:case n.Styles.BRACKET_OPEN_BOTH:case n.Styles.MIXED_OPEN_END:c=o.getNoteHeadEndX();break;default:i.ChangeEnd?c=o.getAbsoluteX():(c=o.getNoteHeadBeginX()-s.render_options.text_margin_right,i.startMargin=-s.render_options.text_margin_right)}var h=i.endStave;o&&(h=o.getStave());var d=h.getYForBottomText(s.line+3);t&&t>d&&(d=t);var f=l[u+1]===o,p=l[u-1]===o,m=0;if(a)if(m=p?5:0,s.style!==n.Styles.MIXED&&s.style!==n.Styles.MIXED_OPEN_END||p)r.beginPath(),s.style===n.Styles.BRACKET_OPEN_BEGIN||s.style===n.Styles.BRACKET_OPEN_BOTH?r.moveTo(c+m,d):(i.ChangeBegin&&(c+=5),r.moveTo(c,d-s.render_options.bracket_height),i.ChangeBegin&&(c+=5),r.lineTo(c+m,d)),r.stroke(),r.closePath();else if(s.custom_depress_text){var v=r.measureText(s.custom_depress_text).width;r.fillText(s.custom_depress_text,c-v/2,d),m=v/2+s.render_options.text_margin_right}else at("pedal_depress",r,c,d,s.render_options.glyph_point_size),m=20+s.render_options.text_margin_right;else m=f&&!i.EndsStave?-5:0,r.beginPath(),r.moveTo(e,t),r.lineTo(c+m,d),s.style!==n.Styles.BRACKET_OPEN_END&&s.style!==n.Styles.MIXED_OPEN_END&&s.style!==n.Styles.BRACKET_OPEN_BOTH&&(i.ChangeEnd&&(c+=5),r.lineTo(c,d-s.render_options.bracket_height)),r.stroke(),r.closePath();e=c+m,t=d}))}},{key:"drawText",value:function(){var e=this.context,t=!1,n=this,i=n.render_options.glyph_point_size;this.notes.forEach((function(r){t=!t;var a=r.getStave(),s=r.getAbsoluteX(),o=a.getYForBottomText(n.line+3),u=0;t?n.custom_depress_text?(u=e.measureText(n.custom_depress_text).width,e.fillText(n.custom_depress_text,s-u/2,o)):at("pedal_depress",e,s,o,i):n.custom_release_text?(u=e.measureText(n.custom_release_text).width,e.fillText(n.custom_release_text,s-u/2,o)):at("pedal_release",e,s,o,i)}))}},{key:"draw",value:function(){var e=this.checkContext();this.setRendered(),e.save(),e.setStrokeStyle(this.render_options.color),e.setFillStyle(this.render_options.color),e.setFont(this.font.family,this.font.size,this.font.weight),n.DEBUG&&i.L("Vex.Flow.PedalMarking",["Rendering Pedal Marking"]),this.style===n.Styles.BRACKET||this.style===n.Styles.MIXED||this.style===n.Styles.MIXED_OPEN_END||this.style===n.Styles.BRACKET_OPEN_BEGIN||this.style===n.Styles.BRACKET_OPEN_END||this.style===n.Styles.BRACKET_OPEN_BOTH?(e.setLineWidth(this.render_options.bracket_line_width),this.drawBracketed()):this.style===n.Styles.TEXT&&this.drawText(),e.restore()}}],[{key:"GLYPHS",get:function(){return{pedal_depress:{code:"v36",x_shift:-10,y_shift:0},pedal_release:{code:"v5d",x_shift:-2,y_shift:3}}}},{key:"Styles",get:function(){return{TEXT:1,BRACKET:2,MIXED:3,MIXED_OPEN_END:4,BRACKET_OPEN_BEGIN:5,BRACKET_OPEN_END:6,BRACKET_OPEN_BOTH:7}}},{key:"StylesString",get:function(){return{text:n.Styles.TEXT,bracket:n.Styles.BRACKET,mixed:n.Styles.MIXED,mixed_open_end:n.Styles.MIXED_OPEN_END,bracket_open_begin:n.Styles.BRACKET_OPEN_BEGIN,bracket_open_end:n.Styles.BRACKET_OPEN_END,bracket_open_both:n.Styles.BRACKET_OPEN_BOTH}}},{key:"createSustain",value:function(e){return new n(e)}},{key:"createSostenuto",value:function(e){var t=new n(e);return t.setStyle(n.Styles.MIXED),t.setCustomText("Sost. Ped."),t}},{key:"createUnaCorda",value:function(e){var t=new n(e);return t.setStyle(n.Styles.TEXT),t.setCustomText("una corda","tre corda"),t}}]),n}(_),ot=function(e){h(n,e);var t=d(n);function n(e){var i,r=e.start,a=e.stop,s=e.text,o=void 0===s?"":s,u=e.superscript,l=void 0===u?"":u,c=e.position,h=void 0===c?n.Positions.TOP:c;return g(this,n),(i=t.call(this)).setAttribute("type","TextBracket"),i.start=r,i.stop=a,i.text=o,i.superscript=l,i.position="string"==typeof h?n.PositionString[h]:h,i.line=1,i.font={family:"Serif",size:15,weight:"italic"},i.render_options={dashed:!0,dash:[5],color:"black",line_width:1,show_bracket:!0,bracket_height:8,underline_superscript:!0},i}return y(n,[{key:"applyStyle",value:function(e){return e.setFont(this.font.family,this.font.size,this.font.weight),e.setStrokeStyle(this.render_options.color),e.setFillStyle(this.render_options.color),e.setLineWidth(this.render_options.line_width),this}},{key:"setDashed",value:function(e,t){return this.render_options.dashed=e,t&&(this.render_options.dash=t),this}},{key:"setFont",value:function(e){return this.font=m(m({},this.font),e),this}},{key:"setLine",value:function(e){return this.line=e,this}},{key:"draw",value:function(){var e=this.context;this.setRendered();var t=0;switch(this.position){case n.Positions.TOP:t=this.start.getStave().getYForTopText(this.line);break;case n.Positions.BOTTOM:t=this.start.getStave().getYForBottomText(this.line+T.TEXT_HEIGHT_OFFSET_HACK);break;default:throw new i.RERR("InvalidPosition","The position ".concat(this.position," is invalid"))}var r={x:this.start.getAbsoluteX(),y:t},a={x:this.stop.getAbsoluteX(),y:t};!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.TextBracket",t)}("Rendering TextBracket: start:",r,"stop:",a,"y:",t);var s=this.render_options.bracket_height*this.position;e.save(),this.applyStyle(e),e.fillText(this.text,r.x,r.y);var o=e.measureText(this.text).width,u=e.measureText("M").width,l=r.y-u/2.5;e.setFont(this.font.family,this.font.size/1.4,this.font.weight),e.fillText(this.superscript,r.x+o+1,l);var c=e.measureText(this.superscript).width,h=e.measureText("M").width,d=r.x,f=l,p=a.x+this.stop.getGlyph().getWidth();this.position===n.Positions.TOP?(d+=o+c+5,f-=h/2.7):this.position===n.Positions.BOTTOM&&(f+=h/2.7,d+=o+2,this.render_options.underline_superscript||(d+=c)),this.render_options.dashed?(N.drawDashedLine(e,d,f,p,f,this.render_options.dash),this.render_options.show_bracket&&N.drawDashedLine(e,p,f+1*this.position,p,f+s,this.render_options.dash)):(e.beginPath(),e.moveTo(d,f),e.lineTo(p,f),this.render_options.show_bracket&&e.lineTo(p,f+s),e.stroke(),e.closePath()),e.restore()}}],[{key:"Positions",get:function(){return{TOP:1,BOTTOM:-1}}},{key:"PositionString",get:function(){return{top:n.Positions.TOP,bottom:n.Positions.BOTTOM}}}]),n}(_),ut=function(e){h(n,e);var t=d(n);function n(){var e,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie.type.SINGLE;g(this,n),(i=t.call(this,{duration:"b"})).setAttribute("type","BarNote"),i.metrics={widths:{}};var a=Ie.type;return i.metrics.widths=(p(e={},a.SINGLE,8),p(e,a.DOUBLE,12),p(e,a.END,15),p(e,a.REPEAT_BEGIN,14),p(e,a.REPEAT_END,14),p(e,a.REPEAT_BOTH,18),p(e,a.NONE,0),e),i.ignore_ticks=!0,i.setType(r),i}return y(n,[{key:"getType",value:function(){return this.type}},{key:"setType",value:function(e){return this.type="string"==typeof e?Ie.typeString[e]:e,this.setWidth(this.metrics.widths[this.type]),this}},{key:"getBoundingBox",value:function(){return o(u(n.prototype),"getBoundingBox",this).call(this)}},{key:"addToModifierContext",value:function(){return this}},{key:"preFormat",value:function(){return this.setPreFormatted(!0),this}},{key:"draw",value:function(){if(this.checkContext(),!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.BarNote",t)}("Rendering bar line at: ",this.getAbsoluteX());var e=new Ie(this.type);e.setX(this.getAbsoluteX()),e.draw(this.stave),this.setRendered()}}]),n}(X),lt=function(e){h(n,e);var t=d(n);function n(e){var r,a;if(g(this,n),!e)throw new i.RuntimeError("BadArguments","Ghost note must have valid initialization data to identify duration.");if("string"==typeof e)a={duration:e};else{if("object"!=typeof e)throw new i.RuntimeError("BadArguments","Ghost note must have valid initialization data to identify duration.");a=e}return(r=t.call(this,a)).setAttribute("type","GhostNote"),r.setWidth(0),r}return y(n,[{key:"isRest",value:function(){return!0}},{key:"setStave",value:function(e){o(u(n.prototype),"setStave",this).call(this,e)}},{key:"addToModifierContext",value:function(){return this}},{key:"preFormat",value:function(){return this.setPreFormatted(!0),this}},{key:"draw",value:function(){if(!this.stave)throw new i.RERR("NoStave","Can't draw without a stave.");this.setRendered();for(var e=0;e<this.modifiers.length;++e){var t=this.modifiers[e];t.setContext(this.context),t.drawWithStyle()}}}]),n}(K),ct=function(e){h(n,e);var t=d(n);function n(e){var i;return g(this,n),(i=t.call(this)).setAttribute("type","Tremolo"),i.num=e,i.note=null,i.index=null,i.position=q.Position.CENTER,i.code="v74",i.y_spacing_scale=1,i.extra_stroke_scale=1,i}return y(n,[{key:"getCategory",value:function(){return n.CATEGORY}},{key:"draw",value:function(){if(this.checkContext(),!this.note||null==this.index)throw new i.RERR("NoAttachedNote","Can't draw Tremolo without a note and index.");this.setRendered();var e=this.note.getStemDirection();this.y_spacing=4*e*this.y_spacing_scale;var t=this.note.getModifierStartXY(this.position,this.index).x,r=this.note.stem.getExtents().topY,a="gracenotes"===this.note.getCategory()?Ze.SCALE:1;a*=this.extra_stroke_scale,r+=e<0?n.YOFFSETSTEMDOWN*a:n.YOFFSETSTEMUP*a,this.font={family:"Arial",size:16*a,weight:""},this.render_options={font_scale:35*a,stroke_px:3,stroke_spacing:10*a},t+=e<0?n.XOFFSETSTEMDOWN:n.XOFFSETSTEMUP;for(var s=0;s<this.num;++s)P.renderGlyph(this.context,t,r,this.render_options.font_scale,this.code),r+=this.y_spacing}}],[{key:"CATEGORY",get:function(){return"tremolo"}},{key:"YOFFSETSTEMUP",get:function(){return-9}},{key:"YOFFSETSTEMDOWN",get:function(){return-21}},{key:"XOFFSETSTEMUP",get:function(){return 6}},{key:"XOFFSETSTEMDOWN",get:function(){return-2}}]),n}(q),ht=function(e){h(n,e);var t=d(n);function n(e){var r;return g(this,n),(r=t.call(this,e)).setAttribute("type","Crescendo"),r.decrescendo=!1,r.line=e.line||0,r.height=15,i.Merge(r.render_options,{extend_left:0,extend_right:0,y_shift:0}),r}return y(n,[{key:"setLine",value:function(e){return this.line=e,this}},{key:"setHeight",value:function(e){return this.height=e,this}},{key:"setDecrescendo",value:function(e){return this.decrescendo=e,this}},{key:"preFormat",value:function(){return this.preFormatted=!0,this}},{key:"draw",value:function(){this.checkContext(),this.setRendered();var e=this.getTickContext(),t=ye.getNextContext(e),r=this.getAbsoluteX(),a=t?t.getX():this.stave.x+this.stave.width,s=this.stave.getYForLine(this.line+-3)+1;!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.DEBUG&&i.L("Vex.Flow.Crescendo",t)}("Drawing ",this.decrescendo?"decrescendo ":"crescendo ",this.height,"x",r-a),function(e,t){var n=t.begin_x,i=t.end_x,r=t.y,a=t.height/2;e.beginPath(),t.reverse?(e.moveTo(n,r-a),e.lineTo(i,r),e.lineTo(n,r+a)):(e.moveTo(i,r-a),e.lineTo(n,r),e.lineTo(i,r+a)),e.stroke(),e.closePath()}(this.context,{begin_x:r-this.render_options.extend_left,end_x:a+this.render_options.extend_right,y:s+this.render_options.y_shift,height:this.height,reverse:this.decrescendo})}}]),n}(X),dt=i.MakeException("ParserError");function ft(e){return void 0!==e.matchedString?e.matchedString:e.results?ft(e.results):1===e.length?ft(e[0]):0===e.length?null:e.map(ft)}var pt=function(){function e(t){g(this,e),this.grammar=t}return y(e,[{key:"parse",value:function(e){this.line=e,this.pos=0,this.errorPos=-1;var t=this.expect(this.grammar.begin());return t.errorPos=this.errorPos,t}},{key:"matchFail",value:function(e){-1===this.errorPos&&(this.errorPos=this.pos),this.pos=e}},{key:"matchSuccess",value:function(){this.errorPos=-1}},{key:"matchToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?new RegExp("^(("+e+"))"):new RegExp("^(("+e+")\\s*)"),n=this.line.slice(this.pos).match(t);return null!==n?{success:!0,matchedString:n[2],incrementPos:n[1].length,pos:this.pos}:{success:!1,pos:this.pos}}},{key:"expectOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],i=this.pos,r=!0,a=!1;t=!0===t||!0===e.maybe;for(var s=0;s<e.expect.length;s++){var o=e.expect[s],u=this.pos,l=this.expect(o);if(l.success){if(n.push(l),a=!0,e.or)break}else if(r=!1,!e.or){this.pos=u;break}}var c=e.or&&a||r,h=c||!0===t;return t&&!c&&(this.pos=i),h?this.matchSuccess():this.matchFail(i),{success:h,results:n,numMatches:c?1:0}}},{key:"expectOneOrMore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],i=this.pos,r=0,a=!0;do{var s=this.expectOne(e);s.success?(r++,n.push(s.results)):a=!1}while(a);var o=r>0||!0===t;return!t||r>0||(this.pos=i),o?this.matchSuccess():this.matchFail(i),{success:o,results:n,numMatches:r}}},{key:"expectZeroOrMore",value:function(e){return this.expectOneOrMore(e,!0)}},{key:"expect",value:function(t){var n;if(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.DEBUG&&i.L("Vex.Flow.Parser",n)}("Evaluating rules:",t),!t)throw new dt("Invalid Rule: "+t,t);var r=t.bind(this.grammar)();if(r.token)(n=this.matchToken(r.token,!0===r.noSpace)).success&&(this.pos+=n.incrementPos);else{if(!r.expect)throw new dt("Bad grammar! No `token` or `expect` property",r);n=r.oneOrMore?this.expectOneOrMore(r):r.zeroOrMore?this.expectZeroOrMore(r):this.expectOne(r)}return n.matches=[],n.results&&n.results.forEach((function(e){return n.matches.push(ft(e))})),r.run&&n.success&&r.run(n),n}}]),e}();function mt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];xt.DEBUG&&i.L("Vex.Flow.EasyScore",t)}var vt=i.MakeException("EasyScoreError"),gt=function(){function e(t){g(this,e),this.builder=t}return y(e,[{key:"begin",value:function(){return this.LINE}},{key:"LINE",value:function(){return{expect:[this.PIECE,this.PIECES,this.EOL]}}},{key:"PIECE",value:function(){var e=this;return{expect:[this.CHORDORNOTE,this.PARAMS],run:function(){return e.builder.commitPiece()}}}},{key:"PIECES",value:function(){return{expect:[this.COMMA,this.PIECE],zeroOrMore:!0}}},{key:"PARAMS",value:function(){return{expect:[this.DURATION,this.TYPE,this.DOTS,this.OPTS]}}},{key:"CHORDORNOTE",value:function(){return{expect:[this.CHORD,this.SINGLENOTE],or:!0}}},{key:"CHORD",value:function(){var e=this;return{expect:[this.LPAREN,this.NOTES,this.RPAREN],run:function(t){return e.builder.addChord(t.matches[1])}}}},{key:"NOTES",value:function(){return{expect:[this.NOTE],oneOrMore:!0}}},{key:"NOTE",value:function(){return{expect:[this.NOTENAME,this.ACCIDENTAL,this.OCTAVE]}}},{key:"SINGLENOTE",value:function(){var e=this;return{expect:[this.NOTENAME,this.ACCIDENTAL,this.OCTAVE],run:function(t){return e.builder.addSingleNote(t.matches[0],t.matches[1],t.matches[2])}}}},{key:"ACCIDENTAL",value:function(){return{expect:[this.ACCIDENTALS],maybe:!0}}},{key:"DOTS",value:function(){var e=this;return{expect:[this.DOT],zeroOrMore:!0,run:function(t){return e.builder.setNoteDots(t.matches[0])}}}},{key:"TYPE",value:function(){var e=this;return{expect:[this.SLASH,this.MAYBESLASH,this.TYPES],maybe:!0,run:function(t){return e.builder.setNoteType(t.matches[2])}}}},{key:"DURATION",value:function(){var e=this;return{expect:[this.SLASH,this.DURATIONS],maybe:!0,run:function(t){return e.builder.setNoteDuration(t.matches[1])}}}},{key:"OPTS",value:function(){return{expect:[this.LBRACKET,this.KEYVAL,this.KEYVALS,this.RBRACKET],maybe:!0}}},{key:"KEYVALS",value:function(){return{expect:[this.COMMA,this.KEYVAL],zeroOrMore:!0}}},{key:"KEYVAL",value:function(){var e=this;return{expect:[this.KEY,this.EQUALS,this.VAL],run:function(t){return e.builder.addNoteOption(t.matches[0],t.matches[2].slice(1,-1))}}}},{key:"VAL",value:function(){return{expect:[this.SVAL,this.DVAL],or:!0}}},{key:"KEY",value:function(){return{token:"[a-zA-Z][a-zA-Z0-9]*"}}},{key:"DVAL",value:function(){return{token:'["][^"]*["]'}}},{key:"SVAL",value:function(){return{token:"['][^']*[']"}}},{key:"NOTENAME",value:function(){return{token:"[a-gA-G]"}}},{key:"OCTAVE",value:function(){return{token:"[0-9]+"}}},{key:"ACCIDENTALS",value:function(){return{token:"bbs|bb|bss|bs|b|db|d|##|#|n|\\+\\+-|\\+-|\\+\\+|\\+|k|o"}}},{key:"DURATIONS",value:function(){return{token:"[0-9whq]+"}}},{key:"TYPES",value:function(){return{token:"[rRsSxX]"}}},{key:"LPAREN",value:function(){return{token:"[(]"}}},{key:"RPAREN",value:function(){return{token:"[)]"}}},{key:"COMMA",value:function(){return{token:"[,]"}}},{key:"DOT",value:function(){return{token:"[.]"}}},{key:"SLASH",value:function(){return{token:"[/]"}}},{key:"MAYBESLASH",value:function(){return{token:"[/]?"}}},{key:"EQUALS",value:function(){return{token:"[=]"}}},{key:"LBRACKET",value:function(){return{token:"\\["}}},{key:"RBRACKET",value:function(){return{token:"\\]"}}},{key:"EOL",value:function(){return{token:"$"}}}]),e}(),yt=function(){function e(t){g(this,e),this.factory=t,this.commitHooks=[],this.reset()}return y(e,[{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={stem:"auto",clef:"treble"},this.elements={notes:[],accidentals:[]},this.rollingDuration="8",this.resetPiece(),Object.assign(this.options,e)}},{key:"getFactory",value:function(){return this.factory}},{key:"getElements",value:function(){return this.elements}},{key:"addCommitHook",value:function(e){this.commitHooks.push(e)}},{key:"resetPiece",value:function(){mt("resetPiece"),this.piece={chord:[],duration:this.rollingDuration,dots:0,type:void 0,options:{}}}},{key:"setNoteDots",value:function(e){mt("setNoteDots:",e),e&&(this.piece.dots=e.length)}},{key:"setNoteDuration",value:function(e){mt("setNoteDuration:",e),this.rollingDuration=this.piece.duration=e||this.rollingDuration}},{key:"setNoteType",value:function(e){mt("setNoteType:",e),e&&(this.piece.type=e)}},{key:"addNoteOption",value:function(e,t){mt("addNoteOption: key:",e,"value:",t),this.piece.options[e]=t}},{key:"addNote",value:function(e,t,n){mt("addNote:",e,t,n),this.piece.chord.push({key:e,accid:t,octave:n})}},{key:"addSingleNote",value:function(e,t,n){mt("addSingleNote:",e,t,n),this.addNote(e,t,n)}},{key:"addChord",value:function(e){var t=this;mt("startChord"),"object"!=typeof e[0]?this.addSingleNote(e[0]):e.forEach((function(e){e&&t.addNote.apply(t,S(e))})),mt("endChord")}},{key:"commitPiece",value:function(){var e=this;mt("commitPiece");var t=this.factory;if(t){var n=m(m({},this.options),this.piece.options),i=n.stem,r=n.clef,a="auto"===i.toLowerCase(),s=a||"up"!==i.toLowerCase()?Q.STEM_DOWN:Q.STEM_UP,o=this.piece,u=o.chord,l=o.duration,c=o.dots,h=o.type,d=u.map((function(e){return e.key+"/"+e.octave})),f=t.StaveNote({keys:d,duration:l,dots:c,type:h,clef:r,auto_stem:a});a||f.setStemDirection(s);var p=u.map((function(e){return e.accid||null}));p.forEach((function(e,n){e&&f.addAccidental(n,t.Accidental({type:e}))}));for(var v=0;v<c;v++)f.addDotToAll();this.commitHooks.forEach((function(t){return t(n,f,e)})),this.elements.notes.push(f),this.elements.accidentals.concat(p),this.resetPiece()}}}]),e}();function bt(e,t){var n=e.id;void 0!==n&&t.setAttribute("id",n)}function St(e,t){e.class&&e.class.split(/\s*,\s*/).forEach((function(e){return t.addClass(e)}))}var xt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(this,e),this.setOptions(t),this.defaults={clef:"treble",time:"4/4",stem:"auto"}}return y(e,[{key:"set",value:function(e){return Object.assign(this.defaults,e),this}},{key:"setOptions",value:function(e){var t=this;return this.options=m({factory:null,builder:null,commitHooks:[bt,St,ge.easyScoreHook],throwOnError:!1},e),this.factory=this.options.factory,this.builder=this.options.builder||new yt(this.factory),this.grammar=new gt(this.builder),this.parser=new pt(this.grammar),this.options.commitHooks.forEach((function(e){return t.addCommitHook(e)})),this}},{key:"setContext",value:function(e){return this.factory&&this.factory.setContext(e),this}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.builder.reset(t);var n=this.parser.parse(e);if(!n.success&&this.options.throwOnError)throw new vt("Error parsing line: "+e,n);return n}},{key:"beam",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.factory.Beam({notes:e,options:t}),e}},{key:"tuplet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.factory.Tuplet({notes:e,options:t}),e}},{key:"notes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=m({clef:this.defaults.clef,stem:this.defaults.stem},t),this.parse(e,t),this.builder.getElements().notes}},{key:"voice",value:function(e,t){return t=m({time:this.defaults.time},t),this.factory.Voice(t).addTickables(e)}},{key:"addCommitHook",value:function(e){return this.builder.addCommitHook(e)}}]),e}(),_t=i.MakeException("FactoryError");function Et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.options;return(e=Object.assign(t,e)).options=Object.assign(n,e.options),e}var kt=function(){function e(t){g(this,e),function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.DEBUG&&i.L("Vex.Flow.Factory",n)}("New factory: ",t);var n={stave:{space:10},renderer:{context:null,elementId:"",backend:N.Backends.SVG,width:500,height:200,background:"#FFF"},font:{face:"Arial",point:10,style:""}};this.options=n,this.setOptions(t)}return y(e,[{key:"reset",value:function(){this.renderQ=[],this.systems=[],this.staves=[],this.voices=[],this.stave=null}},{key:"getOptions",value:function(){return this.options}},{key:"setOptions",value:function(e){for(var t=0,n=["stave","renderer","font"];t<n.length;t++){var i=n[t];Object.assign(this.options[i],e[i])}(null!==this.options.renderer.elementId||this.options.renderer.context)&&this.initRenderer(),this.reset()}},{key:"initRenderer",value:function(){var e=this.options.renderer,t=e.elementId,n=e.backend,i=e.width,r=e.height,a=e.background;if(""===t)throw new _t("HTML DOM element not set in Factory");this.context=N.buildContext(t,n,i,r,a)}},{key:"getContext",value:function(){return this.context}},{key:"setContext",value:function(e){return this.context=e,this}},{key:"getStave",value:function(){return this.stave}},{key:"getVoices",value:function(){return this.voices}},{key:"space",value:function(e){return this.options.stave.space*e}},{key:"Stave",value:function(e){e=Et(e,{x:0,y:0,width:this.options.renderer.width-this.space(1),options:{spacing_between_lines_px:this.options.stave.space}});var t=new Ve(e.x,e.y,e.width,e.options);return this.staves.push(t),t.setContext(this.context),this.stave=t,t}},{key:"TabStave",value:function(e){e=Et(e,{x:0,y:0,width:this.options.renderer.width-this.space(1),options:{spacing_between_lines_px:1.3*this.options.stave.space}});var t=new Ge(e.x,e.y,e.width,e.options);return this.staves.push(t),t.setContext(this.context),this.stave=t,t}},{key:"StaveNote",value:function(e){var t=new Q(e);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"GhostNote",value:function(e){var t=new lt(e);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"TextNote",value:function(e){var t=new Re(e);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"BarNote",value:function(e){e=Et(e,{type:"single",options:{}});var t=new ut(e.type);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"ClefNote",value:function(e){e=Et(e,{type:"treble",options:{size:"default"}});var t=new Xe(e.type,e.options.size,e.options.annotation);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"TimeSigNote",value:function(e){e=Et(e,{time:"4/4",options:{}});var t=new Ke(e.time);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"KeySigNote",value:function(e){var t=new Ye(e.key,e.cancelKey,e.alterKey);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"TabNote",value:function(e){var t=new We(e);return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"GraceNote",value:function(e){var t=new Ze(e);return this.stave&&t.setStave(this.stave),t.setContext(this.context),t}},{key:"GraceNoteGroup",value:function(e){var t=new oe(e.notes,e.slur);return t.setContext(this.context),t}},{key:"Accidental",value:function(e){e=Et(e,{type:null,options:{}});var t=new ie(e.type);return t.setContext(this.context),t}},{key:"Annotation",value:function(e){e=Et(e,{text:"p",vJustify:"below",hJustify:"center",fontFamily:"Times",fontSize:14,fontWeight:"bold italic",options:{}});var t=new Se(e.text);return t.setJustification(e.hJustify),t.setVerticalJustification(e.vJustify),t.setFont(e.fontFamily,e.fontSize,e.fontWeight),t.setContext(this.context),t}},{key:"Articulation",value:function(e){e=Et(e,{type:"a.",position:"above",options:{}});var t=new ge(e.type);return t.setPosition(e.position),t.setContext(this.context),t}},{key:"TextDynamics",value:function(e){e=Et(e,{text:"p",duration:"q",dots:0,line:0,options:{}});var t=new nt({text:e.text,line:e.line,duration:e.duration,dots:e.dots});return this.stave&&t.setStave(this.stave),t.setContext(this.context),this.renderQ.push(t),t}},{key:"Fingering",value:function(e){e=Et(e,{number:"0",position:"left",options:{}});var t=new $(e.number);return t.setPosition(e.position),t.setContext(this.context),t}},{key:"StringNumber",value:function(e){e=Et(e,{number:"0",position:"left",options:{}});var t=new le(e.number);return t.setPosition(e.position),t.setContext(this.context),t}},{key:"TickContext",value:function(){return(new ye).setContext(this.context)}},{key:"ModifierContext",value:function(){return new ke}},{key:"MultiMeasureRest",value:function(e){var t=new He(e.number_of_measures,e);return t.setContext(this.context),this.renderQ.push(t),t}},{key:"Voice",value:function(e){e=Et(e,{time:"4/4",options:{}});var t=new W(e.time);return this.voices.push(t),t}},{key:"StaveConnector",value:function(e){e=Et(e,{top_stave:null,bottom_stave:null,type:"double",options:{}});var t=new z(e.top_stave,e.bottom_stave);return t.setType(e.type).setContext(this.context),this.renderQ.push(t),t}},{key:"Formatter",value:function(){return new Te}},{key:"Tuplet",value:function(e){e=Et(e,{notes:[],options:{}});var t=new D(e.notes,e.options).setContext(this.context);return this.renderQ.push(t),t}},{key:"Beam",value:function(e){e=Et(e,{notes:[],options:{autoStem:!1,secondaryBeamBreaks:[]}});var t=new G(e.notes,e.options.autoStem).setContext(this.context);return t.breakSecondaryAt(e.options.secondaryBeamBreaks),this.renderQ.push(t),t}},{key:"Curve",value:function(e){e=Et(e,{from:null,to:null,options:{}});var t=new et(e.from,e.to,e.options).setContext(this.context);return this.renderQ.push(t),t}},{key:"StaveTie",value:function(e){e=Et(e,{from:null,to:null,first_indices:[0],last_indices:[0],text:null,options:{direction:void 0}});var t=new ae({first_note:e.from,last_note:e.to,first_indices:e.first_indices,last_indices:e.last_indices},e.text);return e.options.direction&&t.setDirection(e.options.direction),t.setContext(this.context),this.renderQ.push(t),t}},{key:"StaveLine",value:function(e){e=Et(e,{from:null,to:null,first_indices:[0],last_indices:[0],options:{}});var t=new rt({first_note:e.from,last_note:e.to,first_indices:e.first_indices,last_indices:e.last_indices});return e.options.text&&t.setText(e.options.text),e.options.font&&t.setFont(e.options.font),t.setContext(this.context),this.renderQ.push(t),t}},{key:"VibratoBracket",value:function(e){e=Et(e,{from:null,to:null,options:{harsh:!1}});var t=new Ue({start:e.from,stop:e.to});return e.options.line&&t.setLine(e.options.line),e.options.harsh&&t.setHarsh(e.options.harsh),t.setContext(this.context),this.renderQ.push(t),t}},{key:"TextBracket",value:function(e){e=Et(e,{from:null,to:null,text:"",options:{superscript:"",position:1}});var t=new ot({start:e.from,stop:e.to,text:e.text,superscript:e.options.superscript,position:e.options.position});return e.options.line&&t.setLine(e.options.line),e.options.font&&t.setFont(e.options.font),t.setContext(this.context),this.renderQ.push(t),t}},{key:"System",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.factory=this;var t=new wt(e).setContext(this.context);return this.systems.push(t),t}},{key:"EasyScore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.factory=this,new xt(e)}},{key:"PedalMarking",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Et(e,{notes:[],options:{style:"mixed"}});var t=new st(e.notes);return t.setStyle(st.StylesString[e.options.style]),t.setContext(this.context),this.renderQ.push(t),t}},{key:"NoteSubGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Et(e,{notes:[],options:{}});var t=new re(e.notes);return t.setContext(this.context),t}},{key:"draw",value:function(){var e=this;this.systems.forEach((function(t){return t.setContext(e.context).format()})),this.staves.forEach((function(t){return t.setContext(e.context).draw()})),this.voices.forEach((function(t){return t.setContext(e.context).draw()})),this.renderQ.forEach((function(t){t.isRendered()||t.setContext(e.context).draw()})),this.systems.forEach((function(t){return t.setContext(e.context).draw()})),this.reset()}}],[{key:"newFromElementId",value:function(t){return new e({renderer:{elementId:t,width:arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,height:arguments.length>2&&void 0!==arguments[2]?arguments[2]:200}})}}]),e}();function Mt(e,t){var n=t.options;return(e=Object.assign(t,e)).options=Object.assign(n,e.options),e}var wt=function(e){h(n,e);var t=d(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g(this,n),(e=t.call(this)).setAttribute("type","System"),e.setOptions(i),e.parts=[],e}return y(n,[{key:"setOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=Mt(e,{x:10,y:10,width:500,connector:null,spaceBetweenStaves:12,factory:null,debugFormatter:!1,formatIterations:0,options:{}}),this.factory=this.options.factory||new kt({renderer:{el:null}})}},{key:"setContext",value:function(e){return o(u(n.prototype),"setContext",this).call(this,e),this.factory.setContext(e),this}},{key:"addConnector",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"double";return this.connector=this.factory.StaveConnector({top_stave:this.parts[0].stave,bottom_stave:this.parts[this.parts.length-1].stave,type:e}),this.connector}},{key:"addStave",value:function(e){var t=this;return(e=Mt(e,{stave:null,voices:[],spaceAbove:0,spaceBelow:0,debugNoteMetrics:!1,options:{left_bar:!1}})).stave||(e.stave=this.factory.Stave({x:this.options.x,y:this.options.y,width:this.options.width,options:e.options})),e.voices.forEach((function(n){return n.setContext(t.context).setStave(e.stave).getTickables().forEach((function(t){return t.setStave(e.stave)}))})),this.parts.push(e),e.stave}},{key:"format",value:function(){var e=this,t=new Te;this.formatter=t;var n=this.options.y,i=0,r=[],a=[];this.parts.forEach((function(s){n+=s.stave.space(s.spaceAbove),s.stave.setY(n),t.joinVoices(s.voices),n+=s.stave.space(s.spaceBelow),n+=s.stave.space(e.options.spaceBetweenStaves),s.debugNoteMetrics&&(a.push({y:n,voice:s.voices[0]}),n+=15),r=r.concat(s.voices),i=Math.max(i,s.stave.getNoteStartX())})),this.parts.forEach((function(e){return e.stave.setNoteStartX(i)}));var s=this.options.width-(i-this.options.x)-X.STAVEPADDING;t.format(r,s);for(var o=0;o<this.options.formatIterations;o++)t.tune();this.startX=i,this.debugNoteMetricsYs=a,this.lastY=n}},{key:"draw",value:function(){var e=this.checkContext();this.setRendered(),this.options.debugFormatter&&Te.plotDebugging(e,this.formatter,this.startX,this.options.y,this.lastY),this.debugNoteMetricsYs.forEach((function(t){t.voice.getTickables().forEach((function(n){return X.plotMetrics(e,n,t.y)}))}))}}]),n}(_);(i.Flow=T).Element=_,i.Flow.Fraction=a,i.Flow.Renderer=N,i.Flow.Formatter=Te,i.Flow.Music=ee,i.Flow.Glyph=P,i.Flow.Stave=Ve,i.Flow.StaveNote=Q,i.Flow.StaveModifier=Ce,i.Flow.StaveTempo=Oe,i.Flow.Voice=W,i.Flow.Accidental=ie,i.Flow.Beam=G,i.Flow.StaveTie=ae,i.Flow.TabStave=Ge,i.Flow.TabNote=We,i.Flow.Bend=xe,i.Flow.Vibrato=_e,i.Flow.VibratoBracket=Ue,i.Flow.Note=X,i.Flow.ModifierContext=ke,i.Flow.MultiMeasureRest=He,i.Flow.TickContext=ye,i.Flow.Articulation=ge,i.Flow.Annotation=Se,i.Flow.Barline=Ie,i.Flow.NoteHead=Y,i.Flow.StaveConnector=z,i.Flow.ClefNote=Xe,i.Flow.KeySignature=De,i.Flow.KeySigNote=Ye,i.Flow.TimeSignature=Fe,i.Flow.TimeSigNote=Ke,i.Flow.Stem=B,i.Flow.TabTie=se,i.Flow.Clef=Be,i.Flow.Dot=Z,i.Flow.Modifier=q,i.Flow.TabSlide=qe,i.Flow.Tuplet=D,i.Flow.GraceNote=Ze,i.Flow.GraceTabNote=Je,i.Flow.Tuning=Qe,i.Flow.KeyManager=function(){function e(t){g(this,e),this.music=new ee,this.setKey(t)}return y(e,[{key:"setKey",value:function(e){return this.key=e,this.reset(),this}},{key:"getKey",value:function(){return this.key}},{key:"reset",value:function(){if(this.keyParts=this.music.getKeyParts(this.key),this.keyString=this.keyParts.root,this.keyParts.accidental&&(this.keyString+=this.keyParts.accidental),!ee.scaleTypes[this.keyParts.type])throw new i.RERR("BadArguments","Unsupported key type: ".concat(this.key));this.scale=this.music.getScaleTones(this.music.getNoteValue(this.keyString),ee.scaleTypes[this.keyParts.type]),this.scaleMap={},this.scaleMapByValue={},this.originalScaleMapByValue={};for(var e=ee.root_indices[this.keyParts.root],t=0;t<ee.roots.length;++t){var n=(e+t)%ee.roots.length,r=ee.roots[n],a=this.music.getRelativeNoteName(r,this.scale[t]);this.scaleMap[r]=a,this.scaleMapByValue[this.scale[t]]=a,this.originalScaleMapByValue[this.scale[t]]=a}return this}},{key:"getAccidental",value:function(e){var t=this.music.getKeyParts(e).root,n=this.music.getNoteParts(this.scaleMap[t]);return{note:this.scaleMap[t],accidental:n.accidental}}},{key:"selectNote",value:function(e){e=e.toLowerCase();var t=this.music.getNoteParts(e),n=this.scaleMap[t.root],i=this.music.getNoteParts(n);if(n===e)return{note:n,accidental:t.accidental,change:!1};var r=this.scaleMapByValue[this.music.getNoteValue(e)];if(null!=r)return{note:r,accidental:this.music.getNoteParts(r).accidental,change:!1};var a=this.originalScaleMapByValue[this.music.getNoteValue(e)];return null!=a?(this.scaleMap[i.root]=a,delete this.scaleMapByValue[this.music.getNoteValue(n)],this.scaleMapByValue[this.music.getNoteValue(e)]=a,{note:a,accidental:this.music.getNoteParts(a).accidental,change:!0}):i.root===e?(delete this.scaleMapByValue[this.music.getNoteValue(this.scaleMap[t.root])],this.scaleMapByValue[this.music.getNoteValue(i.root)]=i.root,this.scaleMap[i.root]=i.root,{note:i.root,accidental:null,change:!0}):(delete this.scaleMapByValue[this.music.getNoteValue(this.scaleMap[t.root])],this.scaleMapByValue[this.music.getNoteValue(e)]=e,delete this.scaleMap[i.root],this.scaleMap[i.root]=e,{note:e,accidental:t.accidental,change:!0})}}]),e}(),i.Flow.StaveHairpin=$e,i.Flow.BoundingBox=k,i.Flow.Stroke=ue,i.Flow.TextNote=Re,i.Flow.Curve=et,i.Flow.TextDynamics=nt,i.Flow.StaveLine=rt,i.Flow.Ornament=be,i.Flow.PedalMarking=st,i.Flow.TextBracket=ot,i.Flow.FretHandFinger=$,i.Flow.Repetition=Ae,i.Flow.BarNote=ut,i.Flow.GhostNote=lt,i.Flow.NoteSubGroup=re,i.Flow.GraceNoteGroup=oe,i.Flow.Tremolo=ct,i.Flow.StringNumber=le,i.Flow.Crescendo=ht,i.Flow.Volta=je,i.Flow.Font=M,i.Flow.System=wt,i.Flow.Factory=kt,i.Flow.Parser=pt,i.Flow.EasyScore=xt,i.Flow.Registry=v;var Pt=i},6150:function(e){"use strict";e.exports="precision mediump float;\nuniform sampler2D u_image;\nvarying vec4 v_position;\n\n#define NUM_ROWS 5\n#define ELEMENT_HEIGHT 300\n\nvoid main() {\n    const float halfPixel = 1.0 / float(ELEMENT_HEIGHT * 2);\n\n    vec2 absolutePosition = (v_position.xy + vec2(1.0)) / vec2(2.0);\n    float absX = absolutePosition.x;\n    float absY = absolutePosition.y;\n\n    int skyLine = 0;\n    for (int i = 0; i < ELEMENT_HEIGHT; ++i) {\n        float ratioY = float(i) / float(ELEMENT_HEIGHT);\n        float relY = (ratioY - 0.5 + halfPixel) / float(NUM_ROWS);\n        float x = absX;\n        float y = absY + relY;\n\n        float currentAlpha = texture2D(u_image, vec2(x, y)).a;\n        if (currentAlpha > 0.0) {\n            skyLine = i;\n            break;\n        }\n    }\n\n    int bottomLine = ELEMENT_HEIGHT;\n    for (int i = ELEMENT_HEIGHT - 1; i >= 0; --i) {\n        float ratioY = float(i) / float(ELEMENT_HEIGHT);\n        float relY = (ratioY - 0.5 + halfPixel) / float(NUM_ROWS);\n        float x = absX;\n        float y = absY + relY;\n\n        float currentAlpha = texture2D(u_image, vec2(x, y)).a;\n        if (currentAlpha > 0.0) {\n            bottomLine = i;\n            break;\n        }\n    }\n\n    int r = skyLine;\n    if (r > 256) {\n        r -= 256;\n    }\n    int g = bottomLine;\n    if (g > 256) {\n        g -= 256;\n    }\n    int b = (skyLine / 256 * 16) + (bottomLine / 256);\n\n    gl_FragColor = vec4(float(r) / 255.0, float(g) / 255.0, float(b) / 255.0, 1.0);\n}\n"},6357:function(e){"use strict";e.exports="attribute vec4 a_position;\nvarying vec4 v_position;\n\nvoid main() {\n    gl_Position = a_position;\n    v_position = a_position;\n}\n"},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e){function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw r}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var i=n(5372),r=n(8872),a=n(6116),s=n(2218);e.exports=function(e,t){return i(e)||r(e,t)||a(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var i=n(3897);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},n={};function w(t){var i=n[t];if(void 0!==i)return i.exports;var r=n[t]={exports:{}};return e[t].call(r.exports,r,r.exports,w),r.exports}return w.d=function(e,t){for(var n in t)w.o(t,n)&&!w.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},w.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),w.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},w.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},w(3607)}()}).call(this,n(33).Buffer,n(267).setImmediate)},505:function(e,t){},768:function(e,t,n){},769:function(e,t,n){"use strict";n.r(t);var i=n(2),r=n.n(i),a=n(44),s=n.n(a),o=(n(484),n(87)),u=(n(488),n(292)),l=n(853),c=n(875),h=n(887),d=n(123),f=n.n(d),p=n(79),m=n(29),v=n(5),g=n(36),y=n(57),b=Object(g.c)({name:"globalSettings",initialState:{themeMode:"dark",globalKeySignature:"C",globalKeySignatureUsesSharps:!1,playbackIsPlaying:!1,playbackSeekSeconds:0,playbackSeekAutoplay:!1,playbackSeekVersion:""},reducers:{updateGlobalSetting:function(e,t){return Object(v.a)(Object(v.a)({},e),t.payload)},setAllGlobalSettings:function(e,t){return Object(v.a)(Object(v.a)({},e),t.payload)}}}),S=b.actions,x=S.updateGlobalSetting,_=S.setAllGlobalSettings,E=Object(y.a)([function(e){return e.globalSettings.themeMode}],(function(e){return e})),k=Object(y.a)([function(e){return e.globalSettings}],(function(e){return e})),M=b.reducer,w=n(62),P=n(226),T=["mxl","midi","audio","img"],C=Object(g.b)({selectId:function(e){return e.key}}),I=C.getInitialState({}),A=Object(g.c)({name:"fileUploads",initialState:I,reducers:{setAllUploadedFiles:C.setAll,removeOneUploadedFile:C.removeOne,addUploadedFile:function(e,t){var n=t.payload.uploadedFile;C.addOne(e,n)}}}),L=A.actions,O=L.addUploadedFile,R=L.setAllUploadedFiles,N=L.removeOneUploadedFile,B=C.getSelectors((function(e){return e.fileUpload})),D=(B.selectAll,B.selectById,Object(y.a)([function(e,t){return e.fileUpload.entities},function(e,t){return t}],(function(e,t){var n=[];return Object.keys(e).forEach((function(i){var r=e[i];(null===r||void 0===r?void 0:r.folder)===t&&n.push(r)})),n.sort((function(e,t){return t.lastModified-e.lastModified}))}))),F=Object(y.a)([function(e){var t=0;return e.fileUpload.ids.forEach((function(n){var i=e.fileUpload.entities[n];(null===i||void 0===i?void 0:i.size)&&(t+=i.size)})),t}],(function(e){return e})),j=function(e){var t=e.split("/");return t.length>0?t[t.length-1]:""},V=A.reducer,G=["default","light","dark"],W=Object(g.b)({selectId:function(e){return e.id}}),U=W.getInitialState({defaultInputId:"",defaultChannelId:"",initialDefaultInputLoaded:!1}),z=Object(g.c)({name:"midiBlocks",initialState:U,reducers:{addMidiBlockAndLayout:function(e,t){W.addOne(e,Object(v.a)(Object(v.a)({},t.payload.midiBlock),{},{inputId:e.defaultInputId,channelId:e.defaultChannelId}))},removeMidiBlockAndLayout:W.removeOne,updateOneMidiBlock:W.updateOne,updateManyMidiBlocks:W.updateMany,upsertManyMidiBlocks:W.upsertMany,setAllMidiBlocks:W.setAll,setDefaultInputChannel:function(e,t){var n=t.payload,i=n.defaultInputId,r=n.defaultChannelId;e.defaultInputId=i,e.defaultChannelId=r,e.initialDefaultInputLoaded=!0,e.ids.forEach((function(t){var n=e.entities[t];n&&(n.inputId=i,n.channelId=r)}))}},extraReducers:function(e){e.addCase(O,(function(e,t){var n=t.payload,i=n.blockId,r=n.uploadedFile,a=e.entities[i];a&&("Sheet Music"===a.widget?a.osmdSettings.selectedFile=r:"Image"===a.widget?a.imageSettings.selectedFile=r:"Midi File Player"===a.widget&&"audio"===r.folder&&(a.midiFilePlayerSettings.selectedAudioFile=r))})).addCase(N,(function(e,t){e.ids.forEach((function(n){var i,r,a,s=e.entities[n];s&&((null===(i=s.osmdSettings.selectedFile)||void 0===i?void 0:i.key)===t.payload?s.osmdSettings.selectedFile=null:(null===(r=s.imageSettings.selectedFile)||void 0===r?void 0:r.key)===t.payload?s.imageSettings.selectedFile=null:(null===(a=s.midiFilePlayerSettings.selectedAudioFile)||void 0===a?void 0:a.key)===t.payload?s.midiFilePlayerSettings.selectedAudioFile=null:s.midiFilePlayerSettings.selectedMidiFiles.map((function(e){return e.key})).includes(t.payload)&&(s.midiFilePlayerSettings.selectedMidiFiles=s.midiFilePlayerSettings.selectedMidiFiles.filter((function(e){return e.key!==t.payload}))))}))}))}}),H=z.actions,X=H.addMidiBlockAndLayout,Y=H.removeMidiBlockAndLayout,K=(H.updateManyMidiBlocks,H.upsertManyMidiBlocks,H.updateOneMidiBlock),q=H.setAllMidiBlocks,Z=H.setDefaultInputChannel,J=W.getSelectors((function(e){return e.midiBlock})),Q=J.selectAll,$=J.selectById,ee=Object(y.a)([function(e){return e.midiBlock.defaultInputId},function(e){return e.midiBlock.defaultChannelId},function(e){return e.midiBlock.initialDefaultInputLoaded}],(function(e,t,n){return{defaultInputId:e,defaultChannelId:t,initialDefaultInputLoaded:n}})),te=z.reducer,ne=Object(g.b)({selectId:function(e){return e.i}}),ie=ne.getInitialState(),re=Object(g.c)({name:"blockLayout",initialState:ie,reducers:{addBlockLayouts:ne.addOne,upsertManyBlockLayouts:ne.upsertMany,updateManyBlockLayouts:ne.updateMany,setAllBlockLayouts:ne.setAll},extraReducers:function(e){e.addCase(X,(function(e,t){ne.addOne(e,t.payload.blockLayout)})).addCase(Y,ne.removeOne)}}),ae=re.actions,se=(ae.addBlockLayouts,ae.upsertManyBlockLayouts,ae.updateManyBlockLayouts),oe=ae.setAllBlockLayouts,ue=ne.getSelectors((function(e){return e.blockLayout})).selectAll,le=re.reducer,ce=350,he=Object(g.c)({name:"drawerContainer",initialState:{open:!1,drawerId:null,drawerData:null,tabValue:0,footerHeight:40},reducers:{openDrawer:function(e,t){var n=t.payload,i=n.drawerId,r=n.drawerData,a=n.tabValue;e.drawerId=i,e.drawerData=r,e.open=!0,void 0!==a&&(e.tabValue=a)},closeDrawer:function(e){e.drawerId=null,e.drawerData=null,e.open=!1},updateDrawerTab:function(e,t){e.tabValue=t.payload}}}),de=he.actions,fe=de.openDrawer,pe=de.closeDrawer,me=de.updateDrawerTab,ve=Object(y.a)([function(e){return e.drawerContainer}],(function(e){return e})),ge=he.reducer,ye=n(77),be=n(106),Se=n.n(be),xe=n(865),_e=navigator.requestMIDIAccess,Ee=Boolean(_e),ke="jon@midisandbox.com",Me=["Piano","Tonnetz","Circle Of Fifths","Chord Estimator","Grand Staff","Sheet Music","Midi File Player","Youtube Player","Image"],we=["All","Treble","Bass"],Pe=["Monochrome","Color Palette"],Te=[0,1,2,3,4,5,6,7,8,9,10,11],Ce=function(e){var t=e.slice(1);return 3===t.length&&(t="".concat(t[0]).concat(t[0]).concat(t[1]).concat(t[1]).concat(t[2]).concat(t[2])),Number("0x".concat(t))},Ie=function(e){return"#".concat(Number(e).toString(16))},Ae=function(e,t){if("Monochrome"===t.style)return t.monoChromeColor;if("Color Palette"===t.style){var n=e%12;return Oe[t.colorPalette][n]}return 14100263},Le=function(e,t){return Ie(Ae(e,t))},Oe=Object.freeze({Gradient:{0:16095389,1:7196662,2:16631433,3:8880573,4:12902299,5:16030657,6:8047816,7:16362881,8:8234969,9:16775066,10:12422335,11:8637085},"Color of Sound":{0:8637085,1:8047816,2:7196662,3:8234969,4:8880573,5:12422335,6:16030657,7:16095389,8:16362881,9:16631433,10:16775066,11:12902299}}),Re=(Object(be.memoize)((function(e){for(var t=[],n=0;n<127;n++)Re[e].includes(n%12)&&t.push(n);return t})),{0:[0,2,4,5,7,9,11],1:[1,3,5,6,8,10,0],2:[2,4,6,7,9,11,1],3:[3,5,7,8,10,0,2],4:[4,6,8,9,11,1,3],5:[5,7,9,10,0,2,4],6:[6,8,10,11,1,3,5],7:[7,9,11,0,2,4,6],8:[8,10,0,1,3,5,7],9:[9,11,1,2,4,6,8],10:[10,0,2,3,5,7,9],11:[11,1,3,4,6,8,10]}),Ne={0:[0,1,3,5,7,8,10],1:[1,2,4,6,8,9,11],2:[2,3,5,7,9,10,0],3:[3,4,6,8,10,11,1],4:[4,5,7,9,11,0,2],5:[5,6,8,10,0,1,3],6:[6,7,9,11,1,2,4],7:[7,8,10,0,2,3,5],8:[8,9,11,1,3,4,6],9:[9,10,0,2,4,5,7],10:[10,11,1,3,5,6,8],11:[11,0,2,4,6,7,9]},Be={Cb:11,C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,"B#":0},De=function(e){return["C","G","D","A","E","B","F#","C#"].includes(e)},Fe=function(){var e={};return Te.forEach((function(t){e[t]={noteCount:0}})),e},je=["C","G","D","A","E","B","F#","Gb","Db","Ab","Eb","Bb","F"],Ve=function(e,t){for(var n=0,i=0;i<t.length;i++){var r=t[i];if(r===e){n=-1;break}e>r&&(n=i+1)}n>-1&&t.splice(n,0,e)},Ge=function(e,t){var n=Object(xe.a)(),i=Object(v.a)({i:n,x:0,y:0,w:12,h:20},t&&t);return{midiBlock:{id:n,inputId:"",channelId:"",widget:"",themeMode:"default",pianoSettings:{startNote:36,keyWidth:.04},staffSettings:{verticalSpacing:1},colorSettings:{style:"Color Palette",monoChromeColor:Ce(e.palette.primary.main),colorPalette:"Gradient"},osmdSettings:{zoom:1,drawTitle:!1,showCursor:!0,iterateCursorOnInput:!0,cursorMatchClefs:"All",drawFromMeasureNumber:0,drawUpToMeasureNumber:0,colorNotes:!1,selectedFile:null,playbackVolume:50,metronomeVolume:0,metronomeCountInBeats:0,rerenderId:Object(xe.a)(),listenGlobalPlayback:!0,midiOutputId:"",midiOutputChannel:""},youtubePlayerSettings:{url:"",verticalScroll:0,videoFit:"contain",listenGlobalPlayback:!0,volume:100,globalPlaybackStartOffset:0},tonnetzSettings:{zoom:1},circleOfFifthsSettings:{keyPrevalenceShading:!1},imageSettings:{url:"",selectedFile:null,objectFit:"cover"},notepadSettings:{currentEditorState:"",templateEditorState:""},midiFilePlayerSettings:{selectedMidiFiles:[],selectedAudioFile:{key:"",filename:"",lastModified:0,folder:"",size:0},volume:1,audioDelay:0,controlGlobalPlayback:!0,loopingEnabled:!1}},blockLayout:i}};function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1e3,i=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,a)).toFixed(i))+" "+r[a]}function Ue(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function ze(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function He(e){return"#"+ze(Math.floor(e.r))+ze(Math.floor(e.g))+ze(Math.floor(e.b))}function Xe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,i={r:0,g:0,b:0};return Object.keys(e).forEach((function(r){var a=r,s=e[a],o=(s-t[a])*n;o>=0&&Math.abs(o),i[a]=s-o})),i}var Ye=function(e,t,n,i){i||(i=Ce(n.palette.divider));var r=Ae(e[0],t);if(e.length>=2&&"Color Palette"===t.style&&(r=Ce(He(Xe(Ue(Le(e[0],t)),Ue(Le(e[1],t))))),e.length>=3)){var a=Xe(Ue(Le(e[0],t)),Ue(Le(e[1],t)),.5);a=Xe(a,Ue(Le(e[2],t)),.333),e.length>=4&&(a=Xe(a,Ue(Le(e[3],t)),.25)),e.length>=5&&(a=Xe(a,Ue(Le(e[4],t)),.2)),r=Ce(He(a))}return{pressedColor:r,sustainedColor:Ce(He(Xe(Ue(Ie(r)),Ue("#ffffff"),.5))),offColor:i}},Ke=function(e){var t=[{x:0,y:0,w:12,h:20},{x:0,y:33,w:12,h:20},{x:6,y:20,w:6,h:13},{x:0,y:20,w:6,h:13},{x:0,y:68,w:12,h:20},{x:4,y:53,w:4,h:15},{x:8,y:53,w:4,h:15},{x:0,y:53,w:4,h:15}].map((function(t){return Ge(e,t)}));return{midiBlocks:t.map((function(e){return e.midiBlock})),blockLayout:t.map((function(e){return e.blockLayout}))}},qe=function(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),i=Math.floor(e-3600*t-60*n);return n.toString()+":"+i.toString().padStart(2,"0")},Ze={time:0,target:null},Je=n(291),Qe=Object(g.b)({selectId:function(e){return e.id}}),$e=Object(g.b)({selectId:function(e){return e.id}}),et=Object(g.b)({selectId:function(e){return e.id}}),tt={inputs:Qe.getInitialState(),channels:$e.getInitialState(),notes:et.getInitialState(),initialInputsLoaded:!1},nt=Object(g.c)({name:"midiListener",initialState:tt,reducers:{addNewMidiInputs:function(e,t){Qe.upsertMany(e.inputs,t.payload.inputs),$e.upsertMany(e.channels,t.payload.channels),et.upsertMany(e.notes,t.payload.notes),e.initialInputsLoaded=!0},deleteMidiInputs:function(e,t){var n=t.payload;Qe.removeMany(e.inputs,n),$e.removeMany(e.channels,e.channels.ids.filter((function(e){var t,i=Object(ye.a)(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(e.includes(r))return!0}}catch(a){i.e(a)}finally{i.f()}return!1}))),et.removeMany(e.notes,e.notes.ids.filter((function(e){var t,i=Object(ye.a)(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(e.includes(r))return!0}}catch(a){i.e(a)}finally{i.f()}return!1})))},updateOneMidiChannel:function(e,t){$e.updateOne(e.channels,t.payload)},resetKeyData:function(e,t){var n=t.payload.channelId,i=e.channels.entities[n];i&&(i.keyData=Fe(),i.totalNoteCount=0)},updateOneMidiInput:function(e,t){Qe.updateOne(e.inputs,t.payload)},handleMidiNoteEvent:function(e,t){var n=[];if("TURN_OFF_ACTIVE_NOTES"===t.payload.eventType){var i=e.channels.entities["".concat(t.payload.inputId,"__").concat(t.payload.channel)];i&&i.notesOn.forEach((function(e){return n.push({eventHandler:"note",inputId:i.inputId,eventType:"noteoff",eventData:[0,e,0],channel:i.number,timestamp:0,velocity:0,attack:0,release:0})}))}else n=[t.payload];for(var r=function(){var t=s[a],n=t.inputId,i=t.eventType,r=t.eventData,o=t.channel,u=t.timestamp,l=t.velocity,c=t.attack,h=t.release,d=e.inputs.entities["".concat(n)],f=e.channels.entities["".concat(n,"__").concat(o)];if(d&&f){var p=r[1]+12*d.manualOctaveOffset,m=p%12;if("noteon"===i)f.totalNoteCount+=1,Ve(p,f.notesOn),Ve(p,f.osmdNotesOn),f.chromaticNoteData[m].noteOn=!0,f.chromaticNoteData[m].notePressed=!0,Ne[m].forEach((function(e){f.keyData[e]&&(f.keyData[e].noteCount+=1)}));else if("noteoff"===i){var v=f.osmdNotesOn.indexOf(p);if(v>-1&&f.osmdNotesOn.splice(v,1),f.chromaticNoteData[m].notePressed=!1,!d.pedalOn){var g=f.notesOn.indexOf(p);g>-1&&f.notesOn.splice(g,1),f.chromaticNoteData[m].noteOn=!1}}var y=e.notes.entities["".concat(n,"__").concat(o,"__").concat(p)];y&&("noteon"===i?(y.noteOn=!0,y.notePressed=!0,y.count++):"noteoff"===i&&(y.notePressed=!1,d.pedalOn||(y.noteOn=!1)),y.timestamp=u,y.velocity=l,y.attack=c,y.release=h)}},a=0,s=n;a<s.length;a++)r()},handlePedalEvent:function(e,t){var n=t.payload,i=n.inputId,r=n.channel,a=n.notesOnState,s=n.pedalOn,o=e.inputs.entities["".concat(i)],u=e.channels.entities["".concat(i,"__").concat(r)],l=a;if(o&&u&&(o.pedalOn=o.reversePedal?s:!s,!o.pedalOn)){var c=[];u.notesOn.forEach((function(t){var n=t%12;0===l.length&&(l=Array(128).fill(!1),u.notesOn.forEach((function(t){var n=e.notes.entities["".concat(u.id,"__").concat(t)];l[t]=!!n&&n.notePressed})));var a=l[t-12*o.manualOctaveOffset];a&&c.push(t);var s=e.notes.entities["".concat(i,"__").concat(r,"__").concat(t)];s&&(s.noteOn=a),u.chromaticNoteData[n].noteOn=a})),u.notesOn=c}}}}),it=nt.actions,rt=it.addNewMidiInputs,at=it.deleteMidiInputs,st=it.resetKeyData,ot=it.updateOneMidiInput,ut=it.updateOneMidiChannel,lt=it.handleMidiNoteEvent,ct=it.handlePedalEvent,ht=Qe.getSelectors((function(e){return e.midiListener.inputs})),dt=ht.selectAll,ft=(ht.selectEntities,ht.selectById),pt=$e.getSelectors((function(e){return e.midiListener.channels})).selectAll,mt=Object(y.a)([function(e,t,n){var i=e.midiListener.channels.entities[t];return i&&n?i.keyData:null},function(e,t,n){var i=e.midiListener.channels.entities[t];return i&&n?i.totalNoteCount:0}],(function(e,t){return Te.map((function(n){return e&&t>0?e[n].noteCount/t:1}))})),vt=Object(y.a)([function(e,t,n){var i=e.midiListener.channels.entities[t];if(i){var r=Je.a.detect(i.notesOn.map((function(e){return Je.b.midiToNoteName(e,{sharps:n})})));return JSON.stringify({chords:r})}return JSON.stringify({chords:[]})}],(function(e){return e})),gt=Object(y.a)([function(e,t,n){var i=e.midiListener.channels.entities[t];return i&&n?JSON.stringify(i.osmdNotesOn):"[]"}],(function(e){return e})),yt=et.getSelectors((function(e){return e.midiListener.notes})),bt=(yt.selectAll,yt.selectById),St=Object(y.a)([function(e,t,n){var i=bt(e,"".concat(t,"__").concat(n));return!!i&&i.noteOn}],(function(e){return e})),xt=Object(y.a)([function(e,t,n){var i=bt(e,"".concat(t,"__").concat(n));return!!i&&i.notePressed}],(function(e){return e})),_t=Object(y.a)([function(e,t,n){var i=e.midiListener.channels.entities[t];if(!i)return!1;var r,a=Object(ye.a)(n);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!1===i.chromaticNoteData[s].noteOn)return!1}}catch(o){a.e(o)}finally{a.f()}return!0}],(function(e){return e})),Et=Object(y.a)([function(e,t,n){var i=e.midiListener.channels.entities[t];if(!i)return!1;var r,a=Object(ye.a)(n);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!1===i.chromaticNoteData[s].notePressed)return!1}}catch(o){a.e(o)}finally{a.f()}return!0}],(function(e){return e})),kt=Object(y.a)([function(e){return e.midiListener.initialInputsLoaded}],(function(e){return e})),Mt=nt.reducer,wt=Object(g.c)({name:"modalContainer",initialState:{open:!1,modalId:null,modalData:null},reducers:{openModal:function(e,t){e.modalId=t.payload.modalId,e.modalData=t.payload.modalData,e.open=!0},closeModal:function(e){e.modalId=null,e.modalData=null,e.open=!1}}}),Pt=wt.actions,Tt=(Pt.openModal,Pt.closeModal),Ct=Object(y.a)([function(e){return e.modalContainer}],(function(e){return e})),It=wt.reducer,At=Object(g.b)({selectId:function(e){return e.id}}),Lt=At.getInitialState(),Ot=Object(g.c)({name:"notification",initialState:Lt,reducers:{addNotification:At.addOne,upsertManyNotification:At.upsertMany,updateManyNotification:At.updateMany,setAllNotification:At.setAll,removeNotification:At.removeOne}}),Rt=Ot.actions,Nt=Rt.addNotification,Bt=(Rt.upsertManyNotification,Rt.updateManyNotification,Rt.setAllNotification,Rt.removeNotification),Dt=At.getSelectors((function(e){return e.notification})).selectAll,Ft=Ot.reducer,jt=Object(g.c)({name:"joyrideTour",initialState:{tour:"",stepIndex:0,tourData:{topBlockId:""}},reducers:{updateJoyrideTour:function(e,t){return Object(v.a)(Object(v.a)({},e),t.payload)}}}),Vt=jt.actions.updateJoyrideTour,Gt=Object(y.a)([function(e){return e.joyrideTour}],(function(e){return e})),Wt=jt.reducer,Ut=Object(g.c)({name:"userActivity",initialState:{tourComplete:!1},reducers:{updateUserActivity:function(e,t){return Object(v.a)(Object(v.a)({},e),t.payload)}}}),zt=Ut.actions.updateUserActivity,Ht=Object(y.a)([function(e){return e.userActivity}],(function(e){return e})),Xt=Ut.reducer,Yt=n(293),Kt=n(21),qt=n.n(Kt),Zt=n(133),Jt=n(111),Qt=n(8),$t=n(124);function en(e,t){var n=[],i=[],r=[];return e.forEach((function(e){var a={id:e._midiInput.id,manufacturer:e._midiInput.manufacturer,name:e._midiInput.name,eventsSuspended:e.eventsSuspended,octaveOffset:e._octaveOffset,manualOctaveOffset:0,connection:e._midiInput.connection,state:e._midiInput.state,type:e._midiInput.type,version:e._midiInput.version,channelIds:[],pedalOn:!1,reversePedal:!1};(null===t||void 0===t?void 0:t.input)&&(a=Object(v.a)(Object(v.a)({},a),t.input)),e.channels.forEach((function(e){var n={id:"".concat(a.id,"__").concat(e._number),inputId:a.id,number:e._number,eventsSuspended:e.eventsSuspended,octaveOffset:e._octaveOffset,noteIds:[],totalNoteCount:0,keyData:Fe(),notesOn:[],osmdNotesOn:[],chromaticNoteData:{0:{noteOn:!1,notePressed:!1},1:{noteOn:!1,notePressed:!1},2:{noteOn:!1,notePressed:!1},3:{noteOn:!1,notePressed:!1},4:{noteOn:!1,notePressed:!1},5:{noteOn:!1,notePressed:!1},6:{noteOn:!1,notePressed:!1},7:{noteOn:!1,notePressed:!1},8:{noteOn:!1,notePressed:!1},9:{noteOn:!1,notePressed:!1},10:{noteOn:!1,notePressed:!1},11:{noteOn:!1,notePressed:!1}}};(null===t||void 0===t?void 0:t.channel)&&(n=Object(v.a)(Object(v.a)({},n),t.channel));for(var s=0;s<=127;s++){var o=$t.a.getNoteDetails(s),u=o.accidental,l=o.identifier,c=o.name,h=o.octave,d={id:"".concat(n.id,"__").concat(s),inputId:a.id,channelId:n.id,name:c,noteNumber:s,accidental:u,identifier:l,octave:h,noteOn:!1,notePressed:!1,count:0,attack:0,release:0,velocity:0,timestamp:0};(null===t||void 0===t?void 0:t.note)&&(d=Object(v.a)(Object(v.a)({},d),t.note)),r.push(d),n.noteIds.push(d.id)}a.channelIds.push(n.id),i.push(n)})),n.push(a)})),{inputs:n,channels:i,notes:r}}var tn=qt.a.mark(rn),nn=qt.a.mark(an);function rn(){return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee){e.next=3;break}return e.next=3,Object(Zt.a)([an()]);case 3:case"end":return e.stop()}}),tn)}function an(){var e,t,n,i,r,a,s;return qt.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Jt.WebMidi.enable().catch((function(e){return alert(e)}));case 2:return e=o.sent,t=en(e.inputs),n=t.inputs,i=t.channels,r=t.notes,o.next=6,Object(Zt.c)(rt({inputs:n,channels:i,notes:r}));case 6:return o.next=8,Object(Zt.b)(sn,e);case 8:a=o.sent;case 9:return o.prev=10,o.next=13,Object(Zt.d)(a);case 13:if("note"!==(s=o.sent).eventHandler){o.next=19;break}return o.next=17,Object(Zt.c)(lt(s));case 17:o.next=22;break;case 19:if("pedalEvent"!==s.eventHandler){o.next=22;break}return o.next=22,Object(Zt.c)(ct(s));case 22:o.next=27;break;case 24:o.prev=24,o.t0=o.catch(10),console.error("socket error:",o.t0);case 27:o.next=9;break;case 29:case"end":return o.stop()}}),nn,null,[[10,24]])}function sn(e){return Object(P.b)((function(t){var n=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16];e.inputs.forEach((function(e,i){e.addListener("noteon",(function(n){t({eventHandler:"note",inputId:e.id,eventType:n.type,eventData:n.data,channel:n.message.channel,timestamp:n.timestamp,velocity:n.velocity,attack:n.note.attack,release:n.note.release})}),{channels:n}),e.addListener("noteoff",(function(n){t({eventHandler:"note",inputId:e.id,eventType:n.type,eventData:n.data,channel:n.message.channel,timestamp:n.timestamp,velocity:n.velocity,attack:n.note.attack,release:n.note.release})}),{channels:n}),e.addListener("controlchange",(function(n){["holdpedal","allnotesoff"].includes(n.subtype)&&t({eventHandler:"pedalEvent",inputId:e.id,channel:n.message.channel,notesOnState:e.channels[n.message.channel].notesState,pedalOn:0===n.value})}),{channels:n})}));return function(){e.inputs.forEach((function(e,t){n.forEach((function(t){e[t].removeListener()}))}))}}))}var on=n(390),un=n.n(on),ln=Object(w.b)({midiBlock:te,blockLayout:le,midiListener:Mt,modalContainer:It,drawerContainer:ge,globalSettings:M,joyrideTour:Wt,userActivity:Xt,fileUpload:V,notification:Ft}),cn={key:"root",storage:un.a,whitelist:["userActivity"]},hn=Object(Yt.a)(cn,ln),dn=Object(P.a)(),fn=Object(g.a)({reducer:hn,middleware:function(e){return e({serializableCheck:{ignoredActions:["persist/PERSIST"]}}).concat(dn)}}),pn=Object(Yt.b)(fn);dn.run(rn);var mn=function(){return Object(o.c)()},vn=o.d,gn="Inter",yn=function(e){return{palette:Object(v.a)(Object(v.a)({mode:e},"light"===e&&bn.palette),"dark"===e&&Sn.palette),custom:Object(v.a)(Object(v.a)({},"light"===e&&{spacingUnit:4,loadingOverlayBackground:"#ffffff8a"}),"dark"===e&&{spacingUnit:4,loadingOverlayBackground:"#4e4e4e94"}),typography:{fontFamily:gn,allVariants:{color:"light"===e?bn.palette.text.primary:Sn.palette.text.primary}},spacing:4,shape:{borderRadius:0},components:{MuiCheckbox:{styleOverrides:{root:{padding:0,marginRight:8}}},MuiTooltip:{styleOverrides:{tooltip:{fontSize:"1em"}}},MuiButton:{styleOverrides:{root:{textTransform:"none"}}},MuiSelect:{styleOverrides:{select:{background:"transparent"}},defaultProps:{variant:"standard"}},MuiTextField:{defaultProps:{variant:"standard"}},MuiInputLabel:{defaultProps:{variant:"standard"}}}}},bn={palette:{primary:{main:"#b6ddba"},secondary:{main:"#ffe7c8"},error:{main:"#ff6a6a"},background:{paper:"#fff",default:"#faf9f8"},text:{primary:"#262626"},divider:"#484848"}},Sn={palette:{primary:{main:"#b6ddba"},secondary:{main:"#ffe7c8"},error:{main:"#ff6a6a"},background:{paper:"#1e1e1e",default:"#181717"},text:{primary:"#fffce7"},divider:"#3b3b3b"}},xn=n(35),_n=n(318),En=n(874),kn=n(857),Mn=n(276);function wn(e,t,n){return Pn.apply(this,arguments)}function Pn(){return(Pn=Object(xn.a)(qt.a.mark((function e(t,n,i){return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,En.a.graphql(Object(v.a)(Object(v.a)({},Object(kn.b)(t,n)),i&&{authMode:i}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Tn=function(){var e=Object(xn.a)(qt.a.mark((function e(){return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mn.a.currentAuthenticatedUser();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),Cn=function(){var e=Object(i.useState)(null),t=Object(Qt.a)(e,2),n=t[0],r=t[1];Object(i.useEffect)((function(){var e=function(){var e=Object(xn.a)(qt.a.mark((function e(){return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,Tn();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return _n.a.listen("auth",e),e(),function(){return _n.a.remove("auth",e)}}),[]);var a=null===n||void 0===n?void 0:n.attributes;return{currentUser:n,signIn:function(){return Mn.a.federatedSignIn()},signOut:function(){return Mn.a.signOut()},gaUserId:a?"".concat(a.email,"//").concat(a.sub):""}},In=n(399),An=n(841),Ln=n(854),On=n(840),Rn=n(49),Nn=n(1);var Bn=function(){var e=Object(Rn.a)(),t=Object(In.a)().tokens,n="#cacaca",i={10:"".concat(e.palette.primary.main,"3b"),20:"".concat(e.palette.primary.main,"4f"),40:"".concat(e.palette.primary.main,"63"),60:"".concat(e.palette.primary.main,"82"),80:"".concat(e.palette.primary.main,"a6"),90:"".concat(e.palette.primary.main,"c9"),100:"".concat(e.palette.primary.main)},r={name:"Midi Sandbox Theme",tokens:{colors:{background:{primary:{value:"transparent"},secondary:{value:"transparent"}},font:{interactive:{value:t.colors.white.value}},brand:{primary:{10:{value:i[90]},80:{value:i[80]},90:{value:i[60]},100:{value:i[60]}}}},components:{heading:{color:{value:e.palette.text.primary}},authenticator:{router:{boxShadow:{value:"none"},borderStyle:{value:"border: none"}}},text:{error:{color:{value:e.palette.error.main}}},button:{color:{value:i[100]},_hover:{color:{value:i[80]},backgroundColor:{value:"transparent"},borderColor:{value:i[80]}},_focus:{color:{value:i[100]},backgroundColor:{value:"transparent"}},_active:{color:{value:i[100]},backgroundColor:{value:"transparent"}},link:{color:{value:i[100]},_hover:{color:{value:i[80]},backgroundColor:{value:"transparent"}},_focus:{color:{value:i[100]},backgroundColor:{value:"transparent"}},_active:{color:{value:i[100]},backgroundColor:{value:"transparent"}}}},fieldcontrol:{color:{value:e.palette.text.primary},borderColor:{value:n}},tabs:{borderStyle:{value:"border: none"},item:{color:{value:n},borderColor:{value:"transparent"},borderStyle:{value:"border: none"},_focus:{color:{value:e.palette.primary.main}},_hover:{color:{value:i[80]}},_active:{color:{value:e.palette.primary.main}}}}}}};return Object(Nn.jsx)(On.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",background:"linear-gradient(45deg, #1B292C 0%, rgba(225, 5, 34, 0) 70%) repeat scroll 0% 0%, linear-gradient(135deg, #222E2D 10%, rgba(49, 5, 209, 0) 80%) repeat scroll 0% 0%, linear-gradient(225deg, #2F2E23 10%, rgba(10, 219, 216, 0) 80%) repeat scroll 0% 0%, rgba(0, 0, 0, 0) linear-gradient(315deg, #332A38 100%, rgba(9, 245, 5, 0) 70%) repeat scroll 0% 0%"},children:Object(Nn.jsx)(An.a,{theme:r,children:Object(Nn.jsx)(Ln.a,{children:function(){return Object(Nn.jsx)(m.a,{to:"/play",replace:!0})}})})})},Dn=function(){var e=Object(m.f)();return Object(i.useEffect)((function(){var t=e.pathname+e.search;f.a.set({page:t}),f.a.send({hitType:"pageview",page:t})}),[e]),null},Fn=n(842),jn=n(236),Vn=n(876);var Gn=function(){return Object(Nn.jsx)(Fn.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",background:"linear-gradient(45deg, #222E2D 0%, rgba(225, 5, 34, 0) 70%) repeat scroll 0% 0%, linear-gradient(135deg, #1B292C 10%, rgba(49, 5, 209, 0) 80%) repeat scroll 0% 0%, linear-gradient(225deg, #332A38 10%, rgba(10, 219, 216, 0) 80%) repeat scroll 0% 0%, rgba(0, 0, 0, 0) linear-gradient(315deg, #2F2E23 100%, rgba(9, 245, 5, 0) 70%) repeat scroll 0% 0%"},children:Object(Nn.jsxs)(Fn.a,{sx:{height:window.innerHeight,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[Object(Nn.jsx)(jn.a,{sx:{fontWeight:800,textAlign:"center",fontSize:"7rem"},variant:"h1",children:"Midi Sandbox"}),Object(Nn.jsxs)(jn.a,{sx:{marginTop:"2rem",marginBottom:"4rem"},variant:"h4",children:["A collection of midi responsive widgets",Object(Nn.jsx)("br",{}),"made for musicians, teachers, and students."]}),Object(Nn.jsx)(jn.a,{variant:"h4",color:"primary",sx:{},children:Object(Nn.jsx)(Vn.a,{sx:{fontSize:"1.5rem",pt:1,pb:1,pr:6,pl:6,borderRadius:1},children:"Play"})})]})})},Wn=n(30),Un=n(855),zn=n(409),Hn=n.n(zn),Xn=n(222),Yn=n(221),Kn=n.n(Yn),qn=n(142),Zn=n.n(qn),Jn=n(428),Qn=n.n(Jn),$n=n(429),ei=n.n($n),ti=n(856),ni=n(449),ii=n(871),ri=n(217),ai=n.n(ri),si=n(218),oi=n.n(si),ui=n(219),li=n.n(ui),ci=n(877),hi=n(863),di=n(410),fi=n(411),pi=function(){var e=Object(o.c)(),t=Object(i.useCallback)((function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;if(t&&n){var a={id:Object(xe.a)(),msg:t,severity:n};e(Nt(a)),setTimeout((function(){e(Bt(a.id))}),r),i&&console.error("".concat(a.msg,"\n"),i)}}),[e]);return t},mi=n(858),vi=n(843),gi=Object(mi.a)((function(e){return Object(vi.a)({select:{marginTop:e.spacing(1.5),marginBottom:e.spacing(1.5)},checkbox:{marginBottom:e.spacing(0)},buttonGroupItem:{pl:.5,pr:.5,pt:.5,pb:.5,border:"0 !important",minWidth:"0 !important"},buttonGroupText:{display:"flex",alignItems:"center",margin:"0 -2px",pl:1,pr:1}})})),yi=Object(mi.a)((function(e){return Object(vi.a)({iconButton:{marginRight:e.spacing(1),marginLeft:e.spacing(1),borderRadius:"50%",width:e.spacing(10),height:e.spacing(10),minWidth:0,padding:0}})})),bi={disableScrollLock:!0,PaperProps:{sx:{ml:1}}};function Si(e){var t=e.playerState,n=e.onPlayerSkip,r=t.songTime-Math.min(t.timeRemaining,t.songTime),a=Object(i.useState)(!1),s=Object(Qt.a)(a,2),o=s[0],u=s[1],l=Object(i.useState)(r),c=Object(Qt.a)(l,2),h=c[0],d=c[1];return Object(i.useEffect)((function(){o||d(r)}),[r,o]),Object(Nn.jsxs)(On.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(Nn.jsx)(On.a,{children:Object(Nn.jsx)(jn.a,{variant:"body2",color:"text.secondary",children:qe(h)})}),Object(Nn.jsx)(On.a,{sx:{width:"100%",display:"flex",ml:3,mr:3},children:Object(Nn.jsx)(hi.a,{value:h,onChange:function(e,t){return d(t)},"aria-labelledby":"time",step:1,min:0,max:t.songTime,size:"small",onMouseDown:function(){return u(!0)},onMouseUp:function(){return setTimeout((function(){return u(!1)}),1e3)},onChangeCommitted:function(e,t){return n(t)}})}),Object(Nn.jsx)(On.a,{children:Object(Nn.jsx)(jn.a,{variant:"body2",color:"text.secondary",children:qe(t.songTime)})})]})}var xi=function(e){e.blockId;var t,n=e.containerHeight,r=e.containerWidth,a=e.midiFilePlayerSettings,s=yi(),o=mn(),u=pi(),l=Object(i.useRef)({}),c=Object(i.useRef)(),h=Object(i.useState)({songTime:0,timeRemaining:0,percentRemaining:100,isPlaying:!1}),d=Object(Qt.a)(h,2),f=d[0],p=d[1],m=Math.max(0,f.songTime-f.timeRemaining),g=Object(i.useCallback)((function(){var e=Object.keys(l.current);return e.length>0?l.current[e[0]]:null}),[]);Object(i.useEffect)((function(){var e=setInterval((function(){var e=g();e&&e.getSongTimeRemaining()!==f.timeRemaining&&p({songTime:Math.round(e.getSongTime()),timeRemaining:e.getSongTimeRemaining(),percentRemaining:e.getSongPercentRemaining(),isPlaying:e.isPlaying()})}),1e3);return function(){clearInterval(e)}}),[g,f.timeRemaining]);var y=Object(i.useCallback)((function(){a.selectedMidiFiles.forEach((function(e){o(ct({eventHandler:"pedalEvent",inputId:e.key,channel:1,notesOnState:[],pedalOn:!1})),o(lt({eventHandler:"note",inputId:e.key,eventType:"TURN_OFF_ACTIVE_NOTES",eventData:[0,0,0],channel:1,timestamp:0,velocity:0,attack:0,release:0}))}))}),[a.selectedMidiFiles,o]),b=Object(i.useCallback)((function(){var e;Object.keys(l.current).forEach((function(e){l.current[e].resetTracks(),l.current[e].skipToPercent(0),y()}));var t=g();t&&p({songTime:Math.round(t.getSongTime()),timeRemaining:t.getSongTimeRemaining(),percentRemaining:t.getSongPercentRemaining(),isPlaying:t.isPlaying()}),null===(e=c.current)||void 0===e||e.stop(),a.controlGlobalPlayback&&o(x({playbackIsPlaying:!1,playbackSeekSeconds:0,playbackSeekAutoplay:!1,playbackSeekVersion:Object(xe.a)()}))}),[o,g,a.controlGlobalPlayback,y]),S=Object(i.useCallback)((function(e){var t,n=a.audioDelay>0?a.audioDelay:0,i=a.audioDelay<0?a.audioDelay:0;null===(t=c.current)||void 0===t||t.pause(),setTimeout((function(){c.current&&(void 0!==e&&c.current.seek(e),c.current.play())}),n),setTimeout((function(){Object.keys(l.current).forEach((function(t){void 0!==e&&l.current[t].skipToSeconds(e),l.current[t].play()})),a.controlGlobalPlayback&&o(x(Object(v.a)({playbackIsPlaying:!0},void 0!==e&&{playbackSeekSeconds:e,playbackSeekAutoplay:!0,playbackSeekVersion:Object(xe.a)()})))}),-i)}),[a.audioDelay,a.controlGlobalPlayback,o]),_=Object(i.useCallback)((function(e,t){if(["Note on","Note off"].includes(e.name)){var n=0===e.velocity||"Note off"===e.name?"noteoff":"noteon",i={eventHandler:"note",inputId:t,eventType:n,eventData:["noteon"===n?144:128,e.noteNumber,0],channel:1,timestamp:0,velocity:e.velocity,attack:0,release:0};o(lt(i))}else"Controller Change"!==e.name||64!==e.number&&64!==e.noteNumber||o(ct({eventHandler:"pedalEvent",inputId:t,channel:1,notesOnState:[],pedalOn:e.value>=70}))}),[o]),E=Object(i.useCallback)((function(e){b(),a.controlGlobalPlayback&&o(x({playbackIsPlaying:!1,playbackSeekSeconds:0,playbackSeekAutoplay:!1,playbackSeekVersion:Object(xe.a)()})),a.loopingEnabled&&S(0)}),[o,a.controlGlobalPlayback,a.loopingEnabled,b,S]);Object(i.useEffect)((function(){var e=[],t={},n=Object.keys(l.current).filter((function(e){return!a.selectedMidiFiles.some((function(t){return t.key===e}))}));o(at(n)),a.selectedMidiFiles.forEach((function(n,i){Un.a.get(n.key,{level:"public",download:!0}).then((function(e){e.Body.arrayBuffer().then((function(e){var r=new fi.a.Player((function(e){return _(e,n.key)}));r.loadArrayBuffer(e),t[n.key]=r,p({songTime:Math.round(r.getSongTime()),timeRemaining:r.getSongTimeRemaining(),percentRemaining:r.getSongPercentRemaining(),isPlaying:r.isPlaying()}),0===i&&r.on("endOfFile",E)}))})).catch((function(e){u("An error occurred while loading your file. Please try refreshing the page or contact support for help.","error","Storage.get failed! key: ".concat(n.key," \nError: ").concat(e),8e3)})),e.push({eventsSuspended:!1,_octaveOffset:0,_midiInput:{id:n.key,manufacturer:"",name:n.filename,connection:"",state:"",type:"midi_file",version:""},channels:[{_octaveOffset:0,eventsSuspended:!1,_number:1}]})})),l.current=t;var i=en(e,{input:{reversePedal:!0}}),r=i.inputs,s=i.channels,c=i.notes;o(rt({inputs:r,channels:s,notes:c}))}),[a.selectedMidiFiles,o,u,_,E]),Object(i.useEffect)((function(){var e;(null===(e=a.selectedAudioFile)||void 0===e?void 0:e.key)?Un.a.get(a.selectedAudioFile.key,{level:"public",download:!0}).then((function(e){var t,n,i=e.Body,r=null===(t=a.selectedAudioFile)||void 0===t?void 0:t.key.split(".").pop();(n=i,new Promise((function(e,t){var i=new FileReader;i.onloadend=function(){return e(i.result)},i.readAsDataURL(n)}))).then((function(e){c.current=new di.Howl({src:e,format:r}),c.current.volume(a.volume)}))})).catch((function(e){var t;u("An error occurred while loading your file. Please try refreshing the page or contact support for help.","error","Storage.get failed! key: ".concat(null===(t=a.selectedAudioFile)||void 0===t?void 0:t.key,"\nError: ").concat(e),8e3)})):c.current=void 0}),[null===(t=a.selectedAudioFile)||void 0===t?void 0:t.key,u]),Object(i.useEffect)((function(){var e;null===(e=c.current)||void 0===e||e.volume(a.volume)}),[a.volume]);var k=Object(i.useCallback)((function(){var e;Object.keys(l.current).forEach((function(e){l.current[e].pause()})),null===(e=c.current)||void 0===e||e.pause(),a.controlGlobalPlayback&&o(x({playbackIsPlaying:!1,playbackSeekAutoplay:!1}))}),[o,a.controlGlobalPlayback]);Object(i.useEffect)((function(){return function(){k(),c.current=void 0,l.current={}}}),[k]);var M=function(){var e=0;for(var t in l.current)if(0===e)e=Math.round(l.current[t].getSongTime());else if(Math.abs(e-Math.round(l.current[t].getSongTime()))>2)return"Warning! selected midi files have different run-times.";return""}();return Object(Nn.jsxs)(On.a,{sx:{width:r,height:n,pl:11,pr:11,pt:2,pb:2,overflow:"auto",display:"flex",flexDirection:"column",justifyContent:"center",fontSize:"1.5rem"},children:[a.selectedMidiFiles.length>0?Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(jn.a,{color:"text.primary",sx:{fontSize:"1.5rem",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},children:"".concat(a.selectedMidiFiles.map((function(e){return e.filename})).join(", "))})}):Object(Nn.jsx)(jn.a,{color:"text.primary",sx:{textAlign:"center"},children:"No file selected."}),Object(Nn.jsxs)(On.a,{sx:{display:"flex",justifyContent:"center",mt:0,mb:0},children:[Object(Nn.jsx)(ti.a,{arrow:!0,title:"Replay",placement:"top",children:Object(Nn.jsx)(ci.a,{color:"primary",className:s.iconButton,onClick:b,"aria-label":"replay",children:Object(Nn.jsx)(ai.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Pause",placement:"top",children:Object(Nn.jsx)(ci.a,{color:"primary",className:s.iconButton,onClick:function(){return k()},"aria-label":"pause",children:Object(Nn.jsx)(oi.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Play",placement:"top",children:Object(Nn.jsx)(ci.a,{color:"primary",className:s.iconButton,onClick:function(){return S(m)},"aria-label":"play",children:Object(Nn.jsx)(li.a,{})})})]}),Object(Nn.jsx)(Si,{playerState:f,onPlayerSkip:function(e){y(),S(e)}}),M&&Object(Nn.jsx)(jn.a,{sx:{textAlign:"center",fontSize:"0.9rem"},variant:"subtitle1",children:M})]})},_i=r.a.memo((function(e){var t=e.channelId,n=e.containerWidth,i=e.containerHeight,r=Object(Rn.a)(),a=vn(k),s=vn((function(e){return vt(e,t,a.globalKeySignatureUsesSharps)})),o=JSON.parse(s).chords,u=1e3;n<=200?u=22:n<=400?u=35:n<=510?u=60:n<=610?u=72:n<=717?u=85:n<=820?u=100:n<=920&&(u=110);var l=Math.min(i/2.5,u),c=.5*l;return Object(Nn.jsxs)(On.a,{sx:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",backgroundColor:r.palette.background.paper,color:r.palette.text.primary},children:[o[0]&&Object(Nn.jsx)(On.a,{sx:{fontSize:l},children:o[0]}),o[1]&&Object(Nn.jsx)(On.a,{sx:{fontSize:c},children:o[1]})]})})),Ei=n(24),ki=n(220),Mi=n.n(ki),wi=n(26),Pi=n.p+"static/media/innerCircleOf5thSlice.66e96661.svg",Ti=n.p+"static/media/outerCircleOf5thSlice.ece7910f.svg",Ci=function(e){var t=e.width,n=e.height,i=e.children,r=e.backgroundColor;return Object(Nn.jsx)(o.b.Consumer,{children:function(e){var a=e.store;return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(On.a,{sx:{position:"absolute",top:0,left:0,bottom:0,right:0}}),Object(Nn.jsx)(Ei.Stage,{width:t,height:n,options:{backgroundColor:r},children:Object(Nn.jsx)(o.a,{store:a,children:i})},"pixi-state-".concat(r))]})}})},Ii=new wi.p({align:"center",fontFamily:gn,strokeThickness:.5,letterSpacing:2}),Ai=new wi.p({align:"center",fontFamily:gn,strokeThickness:.5,letterSpacing:2}),Li=wi.q.from(Pi),Oi=wi.q.from(Ti),Ri=r.a.memo((function(e){var t=e.channelId,n=e.colorSettings,i=e.containerWidth,r=e.containerHeight,a=e.circleOfFifthsSettings,s=Object(Rn.a)(),o=vn((function(e){return mt(e,t,a.keyPrevalenceShading)})),u=Math.min(r-20,i-20),l=.31*u,c=.16*u,h=.19*u,d=.255*u;Ii.fontSize=.28*c,Ai.fontSize=.22*d;var f=function(e,t){var n=$t.a.getNoteDetails(e),i=n.name,r=n.accidental,a=$t.a.getNoteDetails(t),s=a.name,o=a.accidental;return r&&(i+=r),o&&(s+=o),3===e?i="e\u266d":10===e&&(i="b\u266d"),10===t?s="B\u266d":3===t?s="E\u266d":8===t?s="A\u266d":1===t?s="D\u266d":6===t&&(s="G\u266d"),{innerSliceText:i=i.toLowerCase(),outerSliceText:s}};return Object(Nn.jsx)(Ci,{width:i,height:r,backgroundColor:Ce(s.palette.background.paper),children:function(){for(var e=[],t=0;t<12;t++){var a=(5*t+3)%12,s=(5*t+6)%12,u=f(a,s),p=u.innerSliceText,m=u.outerSliceText;e.push(Object(Nn.jsxs)(Ei.Container,{position:[i/2,r/2],angle:-30*t,children:[Object(Nn.jsx)(Ni,{spriteProps:{alpha:Math.max(.2,o[s]),anchor:[.5,0],x:0,y:2,pivot:[0,-5],height:l,width:c,texture:Li,tint:Ae(a,n)},textProps:{anchor:.5,angle:30*t,x:0,y:l/1.25,style:Ii,zIndex:1,text:p}}),Object(Nn.jsx)(Ni,{spriteProps:{alpha:Math.max(.2,o[s]),anchor:[.5,0],x:0,y:l,height:h,width:d,texture:Oi,tint:Ae(s,n)},textProps:{anchor:.5,angle:30*t,x:0,y:l+h/1.8,style:Ai,zIndex:1,text:m}})]},"slice-".concat(t)))}return e}()})}));function Ni(e){var t=e.spriteProps,n=e.textProps,i=Object(v.a)({},t),r=Object(v.a)({},n);return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(Ei.Sprite,Object(v.a)({},i)),Object(Nn.jsx)(Ei.Text,Object(v.a)({},r))]})}var Bi=r.a.memo((function(e){var t=e.styles,n=e.channelId,i=mn();return Object(Nn.jsx)(ti.a,{arrow:!0,title:"Refresh",placement:"left",children:Object(Nn.jsx)(Vn.a,{color:"primary",variant:"contained",sx:t.block_icon,onClick:function(){i(st({channelId:n}))},"aria-label":"refresh",children:Object(Nn.jsx)(Mi.a,{})})})})),Di=Ri,Fi=n(284),ji=n(285),Vi=n.n(ji),Gi=n(878),Wi=n(866),Ui=n(862),zi=n(860),Hi=n(450);var Xi=function(e){var t=e.color,n=e.width,i=e.animate;return Object(Nn.jsx)("svg",{width:n,height:n/4,fill:t,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",children:i?Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsxs)("circle",{cx:"15",cy:"15",r:"15",children:[Object(Nn.jsx)("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(Nn.jsx)("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]}),Object(Nn.jsxs)("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3",children:[Object(Nn.jsx)("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),Object(Nn.jsx)("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]}),Object(Nn.jsxs)("circle",{cx:"105",cy:"15",r:"15",children:[Object(Nn.jsx)("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(Nn.jsx)("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]})]}):Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)("circle",{cx:"15",cy:"15",r:"15"}),Object(Nn.jsx)("circle",{cx:"60",cy:"15",r:"15"}),Object(Nn.jsx)("circle",{cx:"105",cy:"15",r:"15"})]})})},Yi=n(418),Ki=n.n(Yi);var qi=function(e){var t=e.selectLabel,n=e.blockId,a=e.folder,s=e.onSelectChange,o=e.selectValue,u=void 0===o?"":o,l=e.multiSelectValue,c=void 0===l?[]:l,h=e.multi,d=void 0!==h&&h,f=e.showLoginLink,m=void 0===f||f,g=Object(Rn.a)(),y=gi(),b=mn(),S=pi(),x=Cn().currentUser,_=vn((function(e){return D(e,a)})),E=vn(F),k=Object(i.useState)(!1),M=Object(Qt.a)(k,2),w=M[0],P=M[1],T=d&&c.length>0||!d&&u,C=Object(i.useCallback)((function(e){if(x){P(!0);var t,i=e[0],r="".concat(x.getUsername(),"/").concat(a,"/").concat(Object(xe.a)(),"/").concat(i.name),s=5e8,o=3e7;i.size>o?t="Your file's size (".concat(We(i.size),") exceeds the ").concat(We(o)," limit. Please try converting your file to a more compressed format such as an mp3, or email ").concat(ke," for help."):E>s&&(t="You have exceeded your total upload limit of ".concat(We(s)," (currently ").concat(We(E),"). Please delete some of your old files, or email ").concat(ke," for additional storage space.")),t?(S(t,"error","",3e4),P(!1)):Un.a.put(r,i).then((function(e){b(O({blockId:n,uploadedFile:{key:e.key,filename:i.name,folder:a,lastModified:Date.now(),size:i.size}})),P(!1)})).catch((function(e){S("An error occurred while uploading your file. Please try refreshing the page or contact support for help.","error","Storage.put failed! ".concat(JSON.stringify(e)),3e4),P(!1)}))}}),[x,S,n,b,a,E]),I=Object(Hi.a)({onDrop:C}),A=I.getRootProps,L=I.getInputProps,R=r.a.useState(!1),B=Object(Qt.a)(R,2),V=B[0],G=B[1],W=function(){G(!1)},U=function(e){return function(t){t.stopPropagation(),Un.a.remove(e.key).then((function(t){b(N(e.key))})).catch((function(t){return S("An error occurred while deleting ".concat(e.filename,". Please try refreshing the page or contact support for help."),"error","Storage.remove failed! ".concat(JSON.stringify(t)),8e3)}))}},z=function(){var e=Object(xn.a)(qt.a.mark((function e(){return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d||!u){e.next=4;break}Un.a.get(u,{level:"public",cacheControl:"no-cache",download:!0}).then((function(e){var t=e.Body,n=u.split("/").pop();Object(Fi.saveAs)(t,n)})).catch((function(e){S("An error occurred while downloading the file. Please try refreshing the page or contact support for help.","error","Storage.get failed! ".concat(e),8e3)})),e.next=6;break;case 4:if(!(d&&c.length>0)){e.next=6;break}return e.delegateYield(qt.a.mark((function e(){var t,n,i;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Ki.a,n=qt.a.mark((function e(n){var i;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c[n],e.next=3,Un.a.get(i,{level:"public",cacheControl:"no-cache",download:!0}).then((function(e){var n=e.Body,r=i.split("/").pop();r&&t.file(r,n)})).catch((function(e){S("An error occurred while downloading the file. Please try refreshing the page or contact support for help.","error","Storage.get failed! ".concat(e),8e3)}));case 3:case"end":return e.stop()}}),e)})),i=0;case 3:if(!(i<c.length)){e.next=8;break}return e.delegateYield(n(i),"t0",5);case 5:i++,e.next=3;break;case 8:t.generateAsync({type:"blob"}).then((function(e){Object(Fi.saveAs)(e,"MidiSandbox.zip")}));case 9:case"end":return e.stop()}}),e)}))(),"t0",6);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(!x){if(!m)return null;var H="";return H=d?c.map((function(e){return j(e)})).join(", "):j(u),Object(Nn.jsxs)(Fn.a,{children:[Object(Nn.jsxs)(Fn.a,{sx:{display:"flex",mb:2,alignItems:"center"},children:[Object(Nn.jsxs)(Fn.a,{sx:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"325px",whiteSpace:"nowrap"},children:["Loaded File(s): ",Object(Nn.jsx)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:"".concat(H)})]}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Download",placement:"top-start",children:Object(Nn.jsx)(ci.a,{sx:{ml:1},color:"primary","aria-label":"download file",component:"span",size:"small",onClick:z,disabled:!T,children:Object(Nn.jsx)(Vi.a,{})})})]}),Object(Nn.jsxs)(Fn.a,{sx:{color:g.palette.text.primary},children:["Please"," ",Object(Nn.jsx)(p.b,{to:"/login",style:{textDecoration:"none"},children:Object(Nn.jsx)(jn.a,{color:"primary",sx:{display:"inline-block",textDecoration:"underline"},children:"login"})})," ","to upload your own files."]})]})}return Object(Nn.jsx)(Fn.a,{sx:{maxWidth:"320px",margin:"auto"},children:Object(Nn.jsxs)(Fn.a,{sx:{display:"flex",alignItems:"flex-end"},children:[Object(Nn.jsxs)(Gi.a,{sx:{textAlign:"left",margin:0},className:y.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"select-file-label-".concat(n),children:t}),Object(Nn.jsxs)(Ui.a,{displayEmpty:!0,labelId:"select-file-label-".concat(n),id:"select-file-select-".concat(n),multiple:d,value:d?c:u,label:"".concat(t),onChange:function(e){var t=e.target.value;if(""!==t){var n=null;if(Array.isArray(t))n=_.filter((function(e){return t.includes(e.key)}));else{var i=_.find((function(e){return e.key===t}));i&&(n=i)}s(n),d||W()}},open:V,renderValue:function(e){if(w)return Object(Nn.jsx)(Fn.a,{sx:{width:"100%",textAlign:"center"},children:Object(Nn.jsx)(Xi,{animate:!0,color:g.palette.secondary.main,width:50})});if("string"===typeof e){var t=_.find((function(t){return t.key===e}));return null===t||void 0===t?void 0:t.filename}if(Array.isArray(e)){var n=[];return _.forEach((function(t){e.includes(t.key)&&n.push(t.filename)})),n.join(", ")}return""},onBlur:W,onClose:function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.className;n&&n.includes&&n.includes("MuiBackdrop")&&W()},onOpen:function(){G(!0)},MenuProps:bi,children:[Object(Nn.jsx)(ii.a,{id:"upload-file-menu-item",value:"",sx:{padding:0},children:Object(Nn.jsxs)(Fn.a,Object(v.a)(Object(v.a)({sx:{width:"100%",pt:1.5,pb:1.5,pl:4,pr:4}},A()),{},{children:[Object(Nn.jsx)("input",Object(v.a)({},L())),"Upload New File"]}))}),_.map((function(e){return Object(Nn.jsxs)(ii.a,{value:e.key,sx:{whiteSpace:"normal",marginRight:"".concat(45,"px"),position:"relative"},children:[d&&Object(Nn.jsx)(zi.a,{checked:c.includes(e.key)}),Object(Nn.jsx)(Fn.a,{children:e.filename}),Object(Nn.jsx)(ci.a,{color:"error","aria-label":"delete file",component:"span",onClick:U(e),sx:{position:"absolute",right:"-".concat(45,"px"),borderRadius:0,height:"100%",width:"".concat(45,"px")},children:Object(Nn.jsx)(Zn.a,{})})]},e.key)}))]})]}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Download",placement:"top-start",children:Object(Nn.jsx)(ci.a,{sx:{ml:1},size:"small",color:"primary","aria-label":"download file",component:"span",onClick:z,disabled:!T,children:Object(Nn.jsx)(Vi.a,{})})})]})})};var Zi,Ji=function(e){var t=e.blockId,n=e.imageSettings,i=mn();return Object(Nn.jsx)(qi,{selectLabel:"Select Image File",folder:"img",blockId:t,onSelectChange:function(e){Array.isArray(e)||i(K({id:t,changes:{imageSettings:Object(v.a)(Object(v.a)({},n),{},{selectedFile:e})}}))},selectValue:n.selectedFile?n.selectedFile.key:""})},Qi=(Zi=function(e){var t=e.containerHeight,n=e.containerWidth,i=e.imageSettings,r=e.imageFile;return Object(Nn.jsx)(Fn.a,{children:r?Object(Nn.jsx)(Fn.a,{component:"img",sx:{height:t,width:n,objectFit:i.objectFit},src:r}):Object(Nn.jsx)(Fn.a,{sx:{},children:"Missing image!"})})},function(e){var t=e.blockId,n=e.imageSettings,r=Object(i.useState)(null),a=Object(Qt.a)(r,2),s=a[0],o=a[1],u=pi();return Object(i.useEffect)((function(){n.selectedFile&&Un.a.get(n.selectedFile.key,{level:"public",cacheControl:"no-cache"}).then((function(e){o(e)})).catch((function(e){u("An error occurred while loading your file. Please try refreshing the page or contact support for help.","error","Storage.get failed! ".concat(e),8e3)}))}),[n.selectedFile,u]),null===s?Object(Nn.jsx)(Fn.a,{sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:Object(Nn.jsx)(Fn.a,{sx:{width:"100%",textAlign:"center"},children:Object(Nn.jsx)(Ji,{imageSettings:n,blockId:t})})}):Object(Nn.jsx)(Zi,Object(v.a)(Object(v.a)({},e),{},{imageFile:s}))}),$i=n(147),er=n(286),tr=n.n(er),nr=function(){var e=Object(xn.a)(qt.a.mark((function e(t,n,i,r,a,s,o){var u,l,c,h,d,f,p;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((u=new $i.LinearTimingSource).reset(),u.pause(),u.Settings=t.Sheet.SheetPlaybackSetting,l={playFirstBeatSample:function(e){},playBeatSample:function(e){}},c=new AudioContext,h=null,!(Ee&&s&&o)){e.next=10;break}return e.next=10,Jt.WebMidi.enable().then((function(){h=Jt.WebMidi.getOutputById(s).channels[parseInt(o)]}));case 10:return e.next=12,tr.a.instrument(c,"woodblock").then((function(e){return a.metronomeSF=e}));case 12:return l.playFirstBeatSample=function(e){var t;null===(t=a.metronomeSF)||void 0===t||t.play("E4",c.currentTime,{gain:r/100*5})},l.playBeatSample=function(e){var t;null===(t=a.metronomeSF)||void 0===t||t.play("C4",c.currentTime,{gain:r/100*5})},d=new $i.BasicAudioPlayer,f=new AudioContext,e.next=18,tr.a.instrument(f,"acoustic_grand_piano").then((function(e){return a.pianoSF=e}));case 18:d.playSound=function(e,t,n,r){var s;9!==e&&(h&&h.playNote(t,{duration:r}),null===(s=a.pianoSF)||void 0===s||s.play(t,f.currentTime,{gain:i/100*5,duration:r/1e3}))},(p=new $i.PlaybackManager(u,l,d,{MessageOccurred:void 0})).DoPreCount=!1,p.DoPlayback=!0,p.Metronome.Audible=!0,p.Metronome.Highlight=!1,p.Metronome.Volume=1,p.initialize(t.Sheet.MusicPartManager),p.addListener(t.cursor),p.reset(),p.bpmChanged(t.Sheet.DefaultStartTempoInBpm,!1),p.addListener({pauseOccurred:function(e){p.CursorIterator.EndReached&&(p.setPlaybackStart(t.Sheet.SourceMeasures[Math.max(0,n-1)].AbsoluteTimestamp),p.play())},cursorPositionChanged:function(e,t){},selectionEndReached:function(e){},resetOccurred:function(e){},notesPlaybackEventOccurred:function(e){}}),t.PlaybackManager=p;case 31:case"end":return e.stop()}}),e)})));return function(t,n,i,r,a,s,o){return e.apply(this,arguments)}}();function ir(e,t){console.warn("Error ".concat(t," sheet: ").concat(e," \nStackTrace: \n").concat(e.stack))}var rr=Object(mi.a)((function(e){return Object(vi.a)({container:{height:"100%",overflow:"scroll",padding:e.spacing(2),paddingRight:e.spacing(5)},osmdButtonCont:{position:"absolute",textAlign:"center",display:"flex",bottom:e.spacing(1),left:0,right:0,justifyContent:"center"},buttonGroup:{marginRight:e.spacing(1),marginLeft:e.spacing(1)},buttonGroupItem:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1),border:"0 !important"},buttonGroupText:{display:"flex",alignItems:"center",backgroundColor:e.palette.primary.main,color:e.palette.secondary.contrastText,margin:"0 -2px",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})})),ar=r.a.memo((function(e){var t=e.styles,n=e.block,i=mn();return Object(Nn.jsx)(ti.a,{arrow:!0,title:"Refresh",placement:"left",children:Object(Nn.jsx)(Vn.a,{color:"primary",variant:"contained",sx:t.block_icon,onClick:function(){i(K({id:n.id,changes:{osmdSettings:Object(v.a)(Object(v.a)({},n.osmdSettings),{},{rerenderId:Object(xe.a)()})}}))},"aria-label":"refresh",children:Object(Nn.jsx)(Mi.a,{})})})})),sr=function(e){var t=e.blockId,n=e.osmdSettings,i=mn();return Object(Nn.jsx)(qi,{selectLabel:"Select MusicXML File",folder:"mxl",blockId:t,onSelectChange:function(e){Array.isArray(e)||i(K({id:t,changes:{osmdSettings:Object(v.a)(Object(v.a)({},n),{},{selectedFile:e})}}))},selectValue:n.selectedFile?n.selectedFile.key:""})},or=n(421),ur=n.n(or),lr=n(422),cr=n.n(lr),hr=n(883);var dr=function(e){var t=e.animate,n=Object(Rn.a)();return Object(Nn.jsx)(On.a,{sx:{position:"absolute",top:0,right:0,bottom:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",zIndex:1,backgroundColor:n.custom.loadingOverlayBackground},children:Object(Nn.jsx)(Xi,{animate:void 0===t||t,color:n.palette.primary.main,width:75})})},fr=r.a.memo((function(e){var t=e.blockId,n=e.osmdFile,r=e.channelId,a=e.osmdSettings,s=e.hover,o=e.colorSettings,u=e.themeMode,l="osmd-container-".concat(t),c=mn(),h=Object(i.useRef)(),d=Object(i.useRef)({metronomeSF:{},pianoSF:{}}),f=vn(k),p=vn((function(e){return gt(e,r,a.iterateCursorOnInput)})),m=Object(i.useState)("uninitiated"),v=Object(Qt.a)(m,2),g=v[0],y=v[1],b=Object(i.useState)("[]"),S=Object(Qt.a)(b,2),x=S[0],_=S[1],E=Object(i.useState)(120),M=Object(Qt.a)(E,2),w=M[0],P=M[1],T=Object(i.useState)(""),C=Object(Qt.a)(T,2),I=C[0],A=C[1],L=Object(Rn.a)(),O=rr(),R=yi(),N=L.palette.background.paper,B=L.palette.text.primary,D=Object(i.useCallback)((function(){var e;if(null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.cursor){var t=[];h.current.cursor.NotesUnderCursor().forEach((function(e){var n=e.halfTone+12,i=(null===e||void 0===e?void 0:e.NoteTie)&&e.NoteTie.Notes[0]!==e,r="Treble"===a.cursorMatchClefs?1===e.ParentStaffEntry.ParentStaff.Id:"Bass"!==a.cursorMatchClefs||2===e.ParentStaffEntry.ParentStaff.Id;e.isRest()||i||t.includes(n)||!e.PrintObject||!r||t.push(n)}));var n=JSON.stringify(t.sort((function(e,t){return e-t})));return _(n),n}return"[]"}),[a.cursorMatchClefs]);Object(i.useEffect)((function(){return Object(xn.a)(qt.a.mark((function e(){var t,i;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y("loading"),e.next=3,new Promise((function(e){return setTimeout(e,50)}));case 3:return A(""),i={autoResize:!1,backend:"dark"===u?"svg":"canvas",followCursor:!0,defaultColorMusic:B,defaultColorRest:B,colorStemsLikeNoteheads:!0,drawTitle:a.drawTitle,drawFromMeasureNumber:a.drawFromMeasureNumber,drawUpToMeasureNumber:a.drawUpToMeasureNumber,cursorsOptions:[{type:0,alpha:.6,color:L.palette.primary.main,follow:!0}]},a.colorNotes&&(i.coloringMode=3,i.coloringSetCustom=[Le(0,o),Le(1,o),Le(2,o),Le(3,o),Le(4,o),Le(5,o),Le(6,o),Le(7,o),Le(8,o),Le(9,o),Le(10,o),Le(11,o),"#000000"]),h.current=new $i.OpenSheetMusicDisplay(l,i),e.next=9,null===h||void 0===h||null===(t=h.current)||void 0===t?void 0:t.load(n).then((function(){var e;if(null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.IsReadyToRender())return h.current.zoom=a.zoom,h.current.DrawingParameters.setForCompactTightMode(),h.current.DrawingParameters.Rules.MinimumDistanceBetweenSystems=15,h.current.EngravingRules.PageBackgroundColor=N,h.current.RenderingManager.addListener({userDisplayInteraction:function(e,t,n){D()}}),h.current.render();console.error("OSMD tried to render but was not ready!")}),(function(e){ir(e,"rendering")})).then((function(){if(null===h||void 0===h?void 0:h.current){var e;if(a.showCursor)h.current.cursor.show(),P(h.current.Sheet.DefaultStartTempoInBpm),nr(h.current,a.drawFromMeasureNumber,a.playbackVolume,a.metronomeVolume,d.current,a.midiOutputId,a.midiOutputChannel).then(D);else null===(e=h.current.cursor)||void 0===e||e.hide();y("complete")}}),(function(e){ir(e,"loading")})).catch((function(e){A("Unable to load selected file.\nPlease make sure the file you selected is valid MusicXML.")}));case 9:case"end":return e.stop()}}),e)})))(),function(){if(null===h||void 0===h?void 0:h.current){var e;null===(e=h.current.PlaybackManager)||void 0===e||e.pause(),h.current=void 0;var t=document.getElementById(l);(null===t||void 0===t?void 0:t.hasChildNodes())&&(t.innerHTML="")}}}),[a.drawTitle,a.drawFromMeasureNumber,a.drawUpToMeasureNumber,a.zoom,a.showCursor,a.colorNotes,N,B,.6,L.palette.mode,L.palette.primary.main,o,n,u,l,a.playbackVolume,a.metronomeVolume,D,a.midiOutputId,a.midiOutputChannel]),Object(i.useEffect)((function(){var e;null===h||void 0===h||null===(e=h.current)||void 0===e||e.render()}),[a.rerenderId]);var F=Object(i.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===h||void 0===h?void 0:h.current){e&&h.current.cursor.next();var t,n=D();if(h.current.cursor.Iterator.EndReached)null===(t=h.current.PlaybackManager)||void 0===t||t.setPlaybackStart(h.current.Sheet.SourceMeasures[Math.max(0,a.drawFromMeasureNumber-1)].AbsoluteTimestamp),D();else"[]"===n&&F()}}),[a.drawFromMeasureNumber,D]);Object(i.useEffect)((function(){var e,t;a.iterateCursorOnInput&&a.showCursor&&(null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.cursor)&&!h.current.cursor.Iterator.EndReached&&0===(null===(t=h.current.PlaybackManager)||void 0===t?void 0:t.RunningState)&&["[]",p].includes(x)&&(c(ut({id:r,changes:{osmdNotesOn:[]}})),F())}),[a.iterateCursorOnInput,a.showCursor,x,p,r,c,F]);var j=function(e){return function(){var t,n=w+e;(P(n),null===h||void 0===h?void 0:h.current)&&(null===(t=h.current.PlaybackManager)||void 0===t||t.bpmChanged(n,!0))}},V=Object(i.useCallback)((function(){if(null===h||void 0===h?void 0:h.current){var e;for(null===(e=h.current.PlaybackManager)||void 0===e||e.pause();h.current.cursor.Iterator.currentTimeStamp.RealValue<(null===(t=h.current.PlaybackManager)||void 0===t?void 0:t.CursorIterator.currentTimeStamp.RealValue);){var t;h.current.cursor.next()}F(!1)}}),[F]),G=Object(i.useCallback)((function(e){var t=function(){var t,n,i,r;void 0!==e?null===(t=h.current)||void 0===t||null===(n=t.PlaybackManager)||void 0===n||n.playFromMs(e):null===(i=h.current)||void 0===i||null===(r=i.PlaybackManager)||void 0===r||r.play()};if(a.metronomeCountInBeats&&a.metronomeVolume){for(var n=1;n<a.metronomeCountInBeats+1;n++)setTimeout((function(){var e;null===d||void 0===d||null===(e=d.current)||void 0===e||e.metronomeSF.play("C4",void 0,{gain:a.metronomeVolume/100*5})}),6e4/w*n);setTimeout((function(){return t()}),(a.metronomeCountInBeats+1)*(6e4/w))}else t()}),[a.metronomeCountInBeats,a.metronomeVolume,w]);Object(i.useEffect)((function(){a.listenGlobalPlayback&&(f.playbackIsPlaying?G(1e3*f.playbackSeekSeconds):V())}),[f.playbackIsPlaying,G,V,f.playbackSeekSeconds,a.listenGlobalPlayback]),Object(i.useEffect)((function(){var e,t;a.listenGlobalPlayback&&(null===(e=h.current)||void 0===e||null===(t=e.PlaybackManager)||void 0===t||t.playFromMs(1e3*f.playbackSeekSeconds).then((function(){!1===f.playbackSeekAutoplay&&V()})))}),[f.playbackSeekSeconds,f.playbackSeekAutoplay,V,f.playbackSeekVersion,a.listenGlobalPlayback]);return Object(Nn.jsxs)(On.a,{className:O.container,sx:{backgroundColor:N},children:[Object(Nn.jsx)("div",{id:l}),I?Object(Nn.jsxs)(On.a,{sx:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[Object(Nn.jsx)(jn.a,{children:I}),Object(Nn.jsx)(On.a,{sx:{width:"100%",margin:"auto"},children:Object(Nn.jsx)(sr,{osmdSettings:a,blockId:t})})]}):Object(Nn.jsxs)(Nn.Fragment,{children:["complete"!==g&&Object(Nn.jsx)(dr,{animate:!1}),a.showCursor&&Object(Nn.jsxs)(On.a,{className:O.osmdButtonCont,sx:{visibility:s?"inherit":"hidden"},children:[Object(Nn.jsx)(ti.a,{arrow:!0,title:"Reset Cursor",placement:"top",children:Object(Nn.jsx)(Vn.a,{variant:"contained",color:"primary",className:R.iconButton,onClick:function(){var e;(null===h||void 0===h?void 0:h.current)&&(null===(e=h.current.PlaybackManager)||void 0===e||e.setPlaybackStart(h.current.Sheet.SourceMeasures[Math.max(0,a.drawFromMeasureNumber-1)].AbsoluteTimestamp),h.current.cursor.update(),D())},"aria-label":"reset",children:Object(Nn.jsx)(ai.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Cursor Next",placement:"top",children:Object(Nn.jsx)(Vn.a,{variant:"contained",color:"primary",className:R.iconButton,onClick:function(){return F()},"aria-label":"next",children:Object(Nn.jsx)(ur.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"BPM",placement:"top",children:Object(Nn.jsxs)(hr.a,{className:O.buttonGroup,disableElevation:!0,variant:"contained",children:[Object(Nn.jsx)(Vn.a,{color:"primary",className:O.buttonGroupItem,sx:{borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%"},onClick:j(-5),children:Object(Nn.jsx)(cr.a,{})}),Object(Nn.jsx)(On.a,{color:"primary",className:O.buttonGroupText,children:w}),Object(Nn.jsx)(Vn.a,{color:"primary",className:O.buttonGroupItem,sx:{borderTopRightRadius:"50%",borderBottomRightRadius:"50%"},onClick:j(5),children:Object(Nn.jsx)(Kn.a,{})})]})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Pause",placement:"top",children:Object(Nn.jsx)(Vn.a,{variant:"contained",color:"primary",className:R.iconButton,onClick:V,"aria-label":"pause",children:Object(Nn.jsx)(oi.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Play",placement:"top",children:Object(Nn.jsx)(Vn.a,{variant:"contained",color:"primary",className:R.iconButton,onClick:function(){return G()},"aria-label":"play",children:Object(Nn.jsx)(li.a,{})})})]})]})]})})),pr=function(e){return function(t){var n=t.blockId,r=t.osmdSettings,a=Object(i.useState)(null),s=Object(Qt.a)(a,2),o=s[0],u=s[1],l=pi();return Object(i.useEffect)((function(){r.selectedFile&&Un.a.get(r.selectedFile.key,{level:"public",cacheControl:"no-cache",download:!0}).then((function(e){var t=new FileReader;t.onload=function(e){var t;u(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.result)},t.readAsBinaryString(e.Body)})).catch((function(e){l("An error occurred while loading your file. Please try refreshing the page or contact support for help.","error","Storage.get failed! ".concat(e),8e3)}))}),[r.selectedFile,l]),null===o?Object(Nn.jsx)(Fn.a,{sx:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:Object(Nn.jsx)(Fn.a,{sx:{width:"100%",textAlign:"center"},children:Object(Nn.jsx)(sr,{osmdSettings:r,blockId:n})})}):Object(Nn.jsx)(e,Object(v.a)(Object(v.a)({},t),{},{osmdFile:o}))}}(fr),mr=n(448),vr=n.p+"static/media/blackPianoKey.784ae3e8.svg",gr=n.p+"static/media/whitePianoKey.94acee39.svg",yr=n.p+"static/media/whitePianoKeyBordered.acee5d83.svg",br=wi.q.from(gr),Sr=wi.q.from(yr),xr=wi.q.from(vr);function _r(e){var t=e.channelId,n=e.noteNum,i=e.noteOnColors,r=e.isBlackKey,a=e.spriteProps,s=i.pressedColor,o=i.sustainedColor,u=vn((function(e){return St(e,t,n)})),l=vn((function(e){return xt(e,t,n)})),c=Object(v.a)({},a);return u?(c.tint=l?s:o,r&&(c.texture=Sr)):(c.tint=16777215,c.texture=a.texture),Object(Nn.jsx)(Ei.Sprite,Object(v.a)({},c))}var Er=r.a.memo((function(e){var t=e.channelId,n=e.pianoSettings,a=e.colorSettings,s=e.containerWidth,o=e.containerHeight,u=Object(Rn.a)(),l=r.a.useRef(null),c=Object(mr.a)(l),h=Object(Qt.a)(c,2),d=h[0],f=(h[1],Object(i.useMemo)((function(){var e=7.5+100*n.keyWidth;return new wi.p({align:"center",fontFamily:gn,fontSize:"".concat(e,"px"),strokeThickness:.5,letterSpacing:2})}),[n.keyWidth]));return Object(Nn.jsx)(On.a,{ref:l,children:Object(Nn.jsx)(Ci,{width:s,height:o,backgroundColor:0,children:Object(Nn.jsx)(Ei.Container,{sortableChildren:!0,children:function(){for(var e=[],i=0,r=n.keyWidth*d,l=.74*r,c=n.startNote;i<=s;){var h=c%12,p=void 0,m=void 0,v=void 0,g=0,y=0,b=!1;if([1,3,6,8,10].includes(h)?(b=!0,v=xr,p=l,m=.65*o,y=1,[1,6].includes(h)?g=i-.45*r:[3,10].includes(h)?g=i-.259*r:[8].includes(h)&&(g=i-.333*r)):(v=br,m=o,g=i,i+=(p=r)+2),0===h){var S=(c-12)/12;e.push(Object(Nn.jsx)(Ei.Text,{text:"C".concat(S),anchor:.5,x:g+.5*p,y:o-16,style:f,zIndex:1},"note-text-".concat(c)))}e.push(Object(Nn.jsx)(_r,{channelId:t,noteNum:c,isBlackKey:b,noteOnColors:Ye([c],a,u),spriteProps:{texture:v,width:p,height:m,zIndex:y,x:g,y:0}},"note-".concat(c))),c+=1}return e}()})})})})),kr=n.p+"static/media/accidentalFlatWhite.19f098bd.svg",Mr=n.p+"static/media/accidentalSharpWhite.676eae59.svg",wr=n.p+"static/media/grandStaffWhite.9cb4f725.svg",Pr=n.p+"static/media/naturalWhite.e2237405.svg",Tr=n.p+"static/media/staffLineWhite.b5432174.svg",Cr=n.p+"static/media/wholeNoteWhite.23c78a07.svg";var Ir=function(e){e.channelId;var t=e.flatSpriteProps,n=e.sharpSpriteProps,i=e.staffWidth,r=e.yAxisNoteStep,a=e.flatWidth,s=e.sharpWidth,o=e.selectedKey,u=[],l=.1978*-i;return["F","Bb","Eb","Ab","Db","Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l,-6*r]}),"b-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l,8*r]}),"b-flat-bass")])),["Bb","Eb","Ab","Db","Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+a,-9*r]}),"e-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+a,5*r]}),"e-flat-bass")])),["Eb","Ab","Db","Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+2*a,-5*r]}),"a-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+2*a,9*r]}),"a-flat-bass")])),["Ab","Db","Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+3*a,-8*r]}),"d-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+3*a,6*r]}),"d-flat-bass")])),["Db","Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+4*a,-4*r]}),"g-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+4*a,10*r]}),"g-flat-bass")])),["Gb"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+5*a,-7*r]}),"c-flat-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{position:[l+5*a,7*r]}),"c-flat-bass")])),["G","D","A","E","B","F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l,-9*r]}),"f-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l,5*r]}),"f-sharp-bass")])),["D","A","E","B","F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+s,-6*r]}),"c-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+s,8*r]}),"c-sharp-bass")])),["A","E","B","F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+2*s,-10*r]}),"g-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+2*s,4*r]}),"g-sharp-bass")])),["E","B","F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+3*s,-7*r]}),"d-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+3*s,7*r]}),"d-sharp-bass")])),["B","F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+4*s,-4*r]}),"a-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+4*s,10*r]}),"a-sharp-bass")])),["F#"].includes(o)&&(u=u.concat([Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+5*s,-8*r]}),"e-sharp-treble"),Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[l+5*s,6*r]}),"e-sharp-bass")])),Object(Nn.jsx)(Nn.Fragment,{children:[u]})},Ar=r.a.memo((function(e){var t=e.noteSpriteProps,n=e.staffLineSpriteProps,i=e.sharpSpriteProps,r=e.flatSpriteProps,a=e.naturalSpriteProps,s=e.noteNum,o=e.channelId,u=e.yValue,l=e.yAxisNoteStep,c=vn((function(e){return St(e,o,s)})),h=vn((function(e){return xt(e,o,s)}))?1:c?.6:0,d=[];if(1===u)d.push(Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:t.position,alpha:h}),"middle-staff-line"));else if(u<=-11)for(var f=-11;f>=u;f-=2)d.push(Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[t.position[0],f*l],alpha:h}),"".concat(f,"-staff-line")));else if(u>=13)for(var p=13;p<=u;p+=2)d.push(Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},n),{},{position:[t.position[0],p*l],alpha:h}),"".concat(p,"-staff-line")));return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{alpha:h})),d,i&&Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},i),{},{alpha:h})),r&&Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},r),{},{alpha:h})),a&&Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},a),{},{alpha:h}))]})})),Lr=wi.q.from(kr),Or=wi.q.from(Mr),Rr=wi.q.from(Pr),Nr=wi.q.from(Cr),Br=wi.q.from(Tr),Dr=wi.q.from(wr),Fr=r.a.memo((function(e){var t=e.channelId,n=e.containerWidth,i=e.containerHeight,r=e.staffSettings,a=Object(Rn.a)(),s=Ce(a.palette.text.primary),o=.6*i/r.verticalSpacing,u=1.3226*o,l=.95*n;u>l&&(o=.7561*(u=l));var c=.0935*u,h=.594*c,d=.0393*u,f=3*d,p=.042*u,m=2.355*p,v=.0298*u,g=3.727*v,y=.1314*u,b=.0516*y,S=.089606*o/2,x={width:d,height:f,texture:Lr,anchor:[.5,.45],tint:s},_={width:p,height:m,texture:Or,anchor:[.5,.5],tint:s},E=vn(k).globalKeySignature;return Object(Nn.jsx)(Ci,{width:n,height:i,backgroundColor:Ce(a.palette.background.paper),children:Object(Nn.jsxs)(Ei.Container,{position:[n/2,i/2],children:[Object(Nn.jsx)(Ei.Sprite,{width:u,height:o,anchor:[.5,.5],texture:Dr,tint:s}),Object(Nn.jsx)(Ir,{channelId:t,selectedKey:E,flatSpriteProps:x,sharpSpriteProps:_,staffWidth:u,yAxisNoteStep:S,flatWidth:d,sharpWidth:p}),function(){for(var e=[],n=12;n<108;n++){var i=n%12,r=["C","G","D","A","E","B","F#"].includes(E),a=Re[Be[E]].includes(i),o=!1,u=!1,l=!1,x=0;[0,2,4,5,7,9,11].includes(i)?(a||(l=!0),0===i?x=0:2===i?x=1:4===i?x=2:5===i?x=3:7===i?x=4:9===i?x=5:11===i&&(x=6)):r?(a||(u=!0),1===i?x=0:3===i?x=1:6===i?x=3:8===i?x=4:10===i&&(x=5)):(a||(o=!0),1===i?x=1:3===i?x=2:6===i?x=4:8===i?x=5:10===i&&(x=6));var _=-x-7*(Math.floor((n-12)/12)-Math.floor(4))+1,k=[4*p,_*S];e.push(Object(Nn.jsx)(Ar,{noteNum:n,channelId:t,yValue:_,yAxisNoteStep:S,noteSpriteProps:{width:c,height:h,texture:Nr,position:k,anchor:[.5,.5],tint:s},staffLineSpriteProps:{width:y,height:b,texture:Br,anchor:[.5,.5],tint:s},sharpSpriteProps:u?{width:p,height:m,texture:Or,position:[k[0]-p/1.5-c/2,k[1]],anchor:[.5,.5],tint:s}:null,flatSpriteProps:o?{width:d,height:f,texture:Lr,position:[k[0]-d/1.5-c/2,k[1]],anchor:[.5,.5],tint:s}:null,naturalSpriteProps:l?{width:v,height:g,texture:Rr,position:[k[0]-v/1.5-c/2,k[1]],anchor:[.5,.5],tint:s}:null},"staff-note-".concat(n)))}return e}()]})})})),jr=n.p+"static/media/circle.a3140b30.svg",Vr=n.p+"static/media/equilateralTriangleWhite.5afa31d4.svg",Gr=wi.q.from(jr),Wr=wi.q.from(Tr),Ur=wi.q.from(Vr),zr=r.a.memo((function(e){var t=e.channelId,n=e.tonnetzSettings,i=e.colorSettings,r=e.containerWidth,a=e.containerHeight,s=function(e){var t=De(e);return{0:["C#"].includes(e)?"B#":"C",1:t?"C#":"Db",2:"D",3:t?"D#":"Eb",4:["Cb"].includes(e)?"Fb":"E",5:["F#","C#"].includes(e)?"E#":"F",6:t?"F#":"Gb",7:"G",8:t?"G#":"Ab",9:"A",10:t?"A#":"Bb",11:"B"}}(vn(k).globalKeySignature),o=Object(Rn.a)(),u=45*n.zoom,l=2.5*u,c=l/2;return Object(Nn.jsx)(Ci,{width:r,height:a,backgroundColor:Ce(o.palette.background.paper),children:function(){for(var e=[],n=[],h=[],d=0,f=-c,p=0,m=0;f<r;){for(;m<a;){var g=p%2===0?0:c,y=[f+g,m],b=Hr(d,p),S=[b,(b+4)%12,(b+9)%12],x={alpha:1,anchor:[0,0],angle:0,x:f+g-.79*u,y:y[1]+u/2,width:l,height:.9*l,texture:Ur};h.push(Object(Nn.jsx)(Kr,{chromaticNums:S,channelId:t,triangleColors:Ye(S,i,o,Ce(o.palette.background.paper)),spriteProps:x},"bot-triangle-".concat(d,"-").concat(p))),S=[b,(b+4)%12,(b+7)%12],x=Object(v.a)(Object(v.a)({},x),{},{angle:180,x:1.5*l+f+g-.79*u,y:l+y[1]+u/3-5}),h.push(Object(Nn.jsx)(Kr,{chromaticNums:S,channelId:t,triangleColors:Ye(S,i,o,Ce(o.palette.background.paper)),spriteProps:x},"bot-right-triangle-".concat(d,"-").concat(p)));var _={alpha:1,anchor:[0,0],angle:0,x:y[0]+u/2,y:y[1]+u/2,width:l,texture:Wr},E=[b,(b+7)%12];n.push(Object(Nn.jsx)(Yr,{chromaticNums:E,channelId:t,lineColors:Ye(E,i,o),spriteProps:_},"line-right-".concat(d,"-").concat(p))),E=[b,(b+4)%12],n.push(Object(Nn.jsx)(Yr,{chromaticNums:E,channelId:t,lineColors:Ye(E,i,o),spriteProps:Object(v.a)(Object(v.a)({},_),{},{angle:60})},"line-bot-right-".concat(d,"-").concat(p))),E=[b,(b+9)%12],n.push(Object(Nn.jsx)(Yr,{chromaticNums:E,channelId:t,lineColors:Ye(E,i,o),spriteProps:Object(v.a)(Object(v.a)({},_),{},{angle:120})},"line-bot-left-".concat(d,"-").concat(p))),e.push(Object(Nn.jsx)(Xr,{position:y,circleSize:u,nodeColors:Ye([b],i,o),nodeText:s[b],chromaticNum:b,channelId:t},"node-".concat(d,"-").concat(p))),m+=l/2+u,p++}p=0,m=0,f+=l,d++}return h.concat(n,e)}()},"tonnetz-".concat(r,"-").concat(a))})),Hr=function(e,t){return(4*Math.floor(.5+t/2)+9*Math.floor(t/2)+7*e)%12},Xr=r.a.memo((function(e){var t=e.position,n=e.circleSize,r=e.nodeColors,a=e.nodeText,s=e.channelId,o=e.chromaticNum,u=r.pressedColor,l=r.sustainedColor,c=r.offColor,h=vn((function(e){return _t(e,s,[o])})),d=vn((function(e){return Et(e,s,[o])})),f=Object(i.useMemo)((function(){return new wi.p({align:"center",fontFamily:gn,strokeThickness:.5,letterSpacing:2,fontSize:2.5*n/5})}),[n]);return f.fill=d||h?"#000000":"#ffffff",Object(Nn.jsxs)(Ei.Container,{position:t,children:[Object(Nn.jsx)(Ei.Sprite,{alpha:1,anchor:[0,0],x:0,y:0,zIndex:1,height:n,width:n,texture:Gr,tint:d?u:h?l:c}),Object(Nn.jsx)(Ei.Text,{anchor:.5,angle:0,x:n/2,y:n/2,style:f,zIndex:2,text:a})]})})),Yr=r.a.memo((function(e){var t=e.spriteProps,n=e.channelId,i=e.chromaticNums,r=e.lineColors,a=r.pressedColor,s=r.sustainedColor,o=r.offColor,u=vn((function(e){return _t(e,n,i)})),l=vn((function(e){return Et(e,n,i)}));return Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{tint:l?a:u?s:o,height:u?10:5}))})),Kr=r.a.memo((function(e){var t=e.spriteProps,n=e.channelId,i=e.chromaticNums,r=e.triangleColors,a=r.pressedColor,s=r.sustainedColor,o=r.offColor,u=vn((function(e){return _t(e,n,i)})),l=vn((function(e){return Et(e,n,i)}));return Object(Nn.jsx)(Ei.Sprite,Object(v.a)(Object(v.a)({},t),{},{alpha:.5,tint:l?a:u?s:o}))})),qr=zr,Zr=n(423);var Jr=r.a.memo((function(e){e.blockId;var t=e.youtubePlayerSettings,n=e.containerWidth,r=e.containerHeight,a=function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,n=e.match(t);return!(!n||11!==n[7].length)&&n[7]}(t.url),s=Object(i.useRef)(),o=vn(k);if(Object(i.useEffect)((function(){var e;null===(e=s.current)||void 0===e||e.setVolume(t.volume)}),[t.volume]),Object(i.useEffect)((function(){var e,n,i;t.listenGlobalPlayback&&(o.playbackIsPlaying?(null===(e=s.current)||void 0===e||e.seekTo(t.globalPlaybackStartOffset+o.playbackSeekSeconds),null===(n=s.current)||void 0===n||n.playVideo()):null===(i=s.current)||void 0===i||i.pauseVideo())}),[t.globalPlaybackStartOffset,t.listenGlobalPlayback,o.playbackIsPlaying,o.playbackSeekSeconds]),Object(i.useEffect)((function(){var e,n,i;t.listenGlobalPlayback&&(null===(e=s.current)||void 0===e||e.seekTo(t.globalPlaybackStartOffset+o.playbackSeekSeconds),null===(n=s.current)||void 0===n||n.playVideo(),!1===o.playbackSeekAutoplay&&(null===(i=s.current)||void 0===i||i.pauseVideo()))}),[t.globalPlaybackStartOffset,t.listenGlobalPlayback,o.playbackSeekSeconds,o.playbackSeekAutoplay,o.playbackSeekVersion]),!a)return Object(Nn.jsx)(On.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:"Please provide a valid youtube url in the widget settings."});var u={};if("cover"===t.videoFit){var l=Math.abs(9/16-r/n),c=t.verticalScroll/100*(l*n)/(r/100);u={position:"relative",paddingBottom:"56.25%",overflow:"scroll",bottom:"".concat(c,"%")}}var h={height:"".concat(r,"px"),width:"".concat(n,"px"),playerVars:{rel:0}};return Object(Nn.jsx)(Zr.a,{videoId:a,iframeClassName:"youtube-player-iframe",opts:h,style:u,onReady:function(e){s.current=e.target,s.current.setVolume(t.volume),s.current.seekTo(t.globalPlaybackStartOffset+o.playbackSeekSeconds),s.current.playVideo(),s.current.pauseVideo()}})})),Qr={midiBlockUtilColumn:{display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:0,right:0,pt:1,pb:1},block_icon:{mr:1,mb:2,p:1,minWidth:0,borderRadius:"50%"}},$r=function(e){var t=e.blockLayout,n=e.deleteDisabled,a=e.blockIndex,s=t.i,o=Object(Xn.a)({refreshMode:"debounce",refreshRate:500}),l=o.width,d=o.height,f=o.ref,p=mn(),m=Object(i.useState)(!1),g=Object(Qt.a)(m,2),y=g[0],b=g[1],S=vn((function(e){return $(e,s)})),x=vn(Gt),_=Object(i.useState)(null),k=Object(Qt.a)(_,2),M=k[0],w=k[1],P=Boolean(M),T=vn(E),C=(null===S||void 0===S?void 0:S.themeMode)&&"default"!==S.themeMode?S.themeMode:T;"Sheet Music"===(null===S||void 0===S?void 0:S.widget)&&"default"===S.themeMode&&(C="light");var I=r.a.useMemo((function(){return Object(c.a)(Object(u.a)(yn(C)))}),[C]),A=function(e){return function(){b(e)}};if(!S)return null;var L=function(){var e=null,t=null;return d&&l&&("Piano"===S.widget?e=Object(Nn.jsx)(Er,{pianoSettings:S.pianoSettings,colorSettings:S.colorSettings,channelId:S.channelId,containerHeight:d,containerWidth:l}):"Grand Staff"===S.widget?e=Object(Nn.jsx)(Fr,{channelId:S.channelId,containerHeight:d,containerWidth:l,staffSettings:S.staffSettings}):"Circle Of Fifths"===S.widget?(e=Object(Nn.jsx)(Di,{channelId:S.channelId,colorSettings:S.colorSettings,containerHeight:d,containerWidth:l,circleOfFifthsSettings:S.circleOfFifthsSettings}),t=Object(Nn.jsx)(Bi,{channelId:S.channelId,styles:Qr})):"Chord Estimator"===S.widget?e=Object(Nn.jsx)(_i,{channelId:S.channelId,containerHeight:d,containerWidth:l}):"Sheet Music"===S.widget?(e=Object(Nn.jsx)(pr,{blockId:S.id,osmdFile:null,channelId:S.channelId,hover:y,osmdSettings:S.osmdSettings,colorSettings:S.colorSettings,themeMode:C}),t=Object(Nn.jsx)(ar,{block:S,styles:Qr})):"Youtube Player"===S.widget?e=Object(Nn.jsx)(Jr,{blockId:S.id,youtubePlayerSettings:S.youtubePlayerSettings,containerHeight:d,containerWidth:l}):"Tonnetz"===S.widget?e=Object(Nn.jsx)(qr,{channelId:S.channelId,colorSettings:S.colorSettings,tonnetzSettings:S.tonnetzSettings,containerHeight:d,containerWidth:l}):"Image"===S.widget?e=Object(Nn.jsx)(Qi,{imageFile:null,blockId:S.id,imageSettings:S.imageSettings,containerHeight:d,containerWidth:l}):"Midi File Player"===S.widget&&(e=Object(Nn.jsx)(xi,{blockId:S.id,containerHeight:d,containerWidth:l,midiFilePlayerSettings:S.midiFilePlayerSettings}))),{widget:e,widgetButtons:t}},O=function(){w(null)},R=y||"GET_STARTED"===x.tour&&0===a&&1===x.stepIndex;return Object(Nn.jsx)(h.a,{theme:I,children:Object(Nn.jsxs)(On.a,{className:"midi-block-".concat(a),ref:f,onMouseEnter:A(!0),onMouseLeave:A(!1),sx:{bgcolor:"background.paper",height:"100%",overflow:"hidden"},children:[Object(Nn.jsx)(On.a,{onTouchEnd:function(e){(function(e){var t={time:(new Date).getTime(),target:e.currentTarget},n=t.target===Ze.target&&t.time-Ze.time<300;return Ze=t,n})(e)&&setTimeout((function(){A(!y)()}),100)},sx:{height:"100%",width:"100%"},children:L().widget}),Object(Nn.jsxs)(On.a,{sx:Object(v.a)(Object(v.a)({},Qr.midiBlockUtilColumn),{},{visibility:R?"inherit":"hidden"}),children:[Object(Nn.jsx)(ti.a,{arrow:!0,title:"Drag Handle",placement:"left",children:Object(Nn.jsx)(Vn.a,{color:"primary",variant:"contained",sx:Object(v.a)(Object(v.a)({},Qr.block_icon),{},{cursor:"grab"}),"aria-label":"drag-handle",className:"blockDragHandle",children:Object(Nn.jsx)(Qn.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Block Settings",placement:"left",children:Object(Nn.jsx)(Vn.a,{className:"block-settings-btn-".concat(a),color:"primary",variant:"contained",sx:Qr.block_icon,onClick:function(){p(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:s},tabValue:0})),"GET_STARTED"===x.tour&&p(Vt({stepIndex:x.stepIndex+1}))},"aria-label":"settings",children:Object(Nn.jsx)(ei.a,{})})}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Add Block Below",placement:"left",children:Object(Nn.jsx)(Vn.a,{color:"primary",variant:"contained",sx:Qr.block_icon,onClick:function(){var e=Ge(I,{y:t.y+t.h-1,x:t.x,w:t.w,h:t.h});p(X(e)),p(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:e.midiBlock.id},tabValue:0}))},"aria-label":"add block below",children:Object(Nn.jsx)(Kn.a,{})})}),!n&&Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ti.a,{arrow:!0,title:"Delete Block",placement:"left",children:Object(Nn.jsx)(Vn.a,{variant:"contained",sx:Qr.block_icon,onClick:function(e){w(e.currentTarget)},id:"delete-block","aria-controls":P?"basic-menu":void 0,"aria-expanded":P?"true":void 0,"aria-label":"delete block","aria-haspopup":"true",children:Object(Nn.jsx)(Zn.a,{})})}),Object(Nn.jsxs)(ni.a,{id:"delete-block-menu",anchorEl:M,open:P,onClose:O,MenuListProps:{"aria-labelledby":"delete-block"},children:[Object(Nn.jsx)(ii.a,{onClick:function(){p(Y(s))},children:"Confirm Delete"}),Object(Nn.jsx)(ii.a,{onClick:O,children:"Cancel"})]})]}),L().widgetButtons]})]},S.id)})},ea={minH:7},ta=function(){var e=Object(Xn.a)(),t=e.width,n=e.ref,i=Object(Rn.a)(),r=vn(ue),a=mn();return Object(Nn.jsx)(On.a,{ref:n,children:Object(Nn.jsx)(Hn.a,{width:t||0,className:"layout",draggableHandle:".blockDragHandle",margin:[2*i.custom.spacingUnit,2*i.custom.spacingUnit],cols:12,rowHeight:2*i.custom.spacingUnit,onLayoutChange:function(e){var t=[];e.forEach((function(e){t.push({id:e.i,changes:e})})),a(se(t))},resizeHandle:Object(Nn.jsx)(On.a,{sx:{position:"absolute",bottom:2,right:2,width:i.spacing(5),height:i.spacing(5),display:"flex",alignItems:"center",justifyContent:"center",cursor:"grab"},children:Object(Nn.jsx)(On.a,{sx:{width:i.spacing(3),height:i.spacing(3),borderRight:"3px solid ".concat(i.palette.primary.main),borderBottom:"3px solid ".concat(i.palette.primary.main),boxShadow:"1px 1px 0px #adadadf2"}})}),children:r.map((function(e,t){return Object(Nn.jsx)(On.a,{"data-grid":Object(v.a)(Object(v.a)({},e),ea),children:Object(Nn.jsx)($r,{blockIndex:t,deleteDisabled:1===r.length,blockLayout:e})},e.i)}))})})},na=n(52),ia=n(441),ra=n.n(ia),aa=n(442),sa=n.n(aa),oa=n(859),ua=n(885),la=n(873),ca=n(11),ha=n(872),da=n(7),fa=n(447);var pa={colorPopover:{position:"absolute",zIndex:"2"},colorPickerCover:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},colorPickerCont:{cursor:"pointer",display:"flex",alignItems:"center"},colorExampleBlock:{display:"inline-block",width:"20px",height:"20px",mr:2}},ma=function(e){var t=e.block,n=gi(),r=mn(),a=Object(i.useState)(!1),s=Object(Qt.a)(a,2),o=s[0],u=s[1],l=Object(i.useState)(Ie(t.colorSettings.monoChromeColor)),c=Object(Qt.a)(l,2),h=c[0],d=c[1],f=function(e,n){r(K({id:t.id,changes:{colorSettings:Object(v.a)(Object(v.a)({},t.colorSettings),{},Object(da.a)({},e,n))}}))},p=function(e){return function(t){var n=t.target.value;f(e,n)}},m=function(e){return function(){u(e)}};return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{sx:{padding:0,textAlign:"left"},id:"color-style-label",children:"Color Style"}),Object(Nn.jsx)(Ui.a,{labelId:"color-style-label",value:t.colorSettings.style,label:"Color Style",onChange:p("style"),MenuProps:bi,children:Pe.map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})}),"Monochrome"===t.colorSettings.style&&pa&&Object(Nn.jsxs)(ha.a,{item:!0,xs:12,children:[Object(Nn.jsxs)(On.a,{sx:Object(v.a)(Object(v.a)({},pa.colorPickerCont),{},{":hover":{color:Ie(t.colorSettings.monoChromeColor)}}),onClick:m(!0),children:[Object(Nn.jsx)(On.a,{sx:Object(v.a)(Object(v.a)({},pa.colorExampleBlock),{},{backgroundColor:h})}),"Change Color"]}),o?Object(Nn.jsxs)(On.a,{sx:pa.colorPopover,children:[Object(Nn.jsx)(On.a,{sx:pa.colorPickerCover,onClick:function(){m(!1)(),f("monoChromeColor",Ce(h))}}),Object(Nn.jsx)(fa.a,{disableAlpha:!0,color:h,onChangeComplete:function(e){d(e.hex)}})]}):null]}),"Color Palette"===t.colorSettings.style&&Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"color-palette-label",children:"Color Palette"}),Object(Nn.jsx)(Ui.a,{labelId:"color-palette-label",value:t.colorSettings.colorPalette,label:"Color Palette",onChange:p("colorPalette"),MenuProps:bi,children:Object.keys(Oe).map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})})]})};function va(e){var t=e.inputId,n=gi(),i=vn((function(e){return ft(e,t)})),r=mn();if(!i)return null;var a;return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:(a="reversePedal",function(){var e;e=Object(da.a)({},a,!i[a]),r(ot({id:t,changes:e}))}),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:n.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:i.reversePedal}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Reverse Sustain Pedal"})]})})})}var ga=n(73),ya=n.n(ga),ba=n(867),Sa=n(435),xa=n.n(Sa),_a=n(434),Ea=n.n(_a);var ka=function(e){var t=e.width,n=e.height;return Object(Nn.jsx)(ci.a,{onClick:function(e){var t;document.fullscreenElement?function(){var e=document;e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()}():(t=document.documentElement).requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},sx:Object(v.a)(Object(v.a)(Object(v.a)({p:.5},t&&{width:t}),n&&{height:n}),{},{borderRadius:0}),color:"primary",children:document.fullscreenElement?Object(Nn.jsx)(Ea.a,{}):Object(Nn.jsx)(xa.a,{})})},Ma=function(e){var t=Object(Rn.a)(),n=vn((function(e){return ve(e)})).footerHeight,i=e.zIndex;return Object(Nn.jsx)(Fn.a,{sx:Object(v.a)({position:"fixed",bottom:0,right:0,width:ce,display:"flex",alignItems:"center",height:n,overflow:"hidden",borderTop:"1px solid ".concat(t.palette.divider),borderLeft:"1px solid ".concat(t.palette.divider),background:t.palette.background.paper},void 0!==i&&{zIndex:i}),children:e.children})},wa=function(){var e=mn(),t=vn((function(e){return ve(e)})).footerHeight,n=Cn(),i=n.currentUser,r=n.signOut;return Object(Nn.jsxs)(Ma,{zIndex:-1,children:[Object(Nn.jsxs)(Fn.a,{sx:{flexGrow:1},children:[Object(Nn.jsx)("a",{target:"_blank",rel:"noreferrer",style:{textDecoration:"none"},href:"https://midisandbox.com/",children:Object(Nn.jsx)(Vn.a,{color:"primary",children:"Home"})}),Object(Nn.jsx)("a",{target:"_blank",rel:"noreferrer",style:{textDecoration:"none"},href:"https://midisandbox.com/faq",children:Object(Nn.jsx)(Vn.a,{color:"primary",children:"FAQ"})}),Object(Nn.jsx)(Vn.a,{onClick:function(){e(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:""},tabValue:1})),e(Vt({tour:"GET_STARTED",stepIndex:0}))},color:"primary",children:"Tour"}),i?Object(Nn.jsx)(Vn.a,{onClick:r,color:"primary",children:"Logout"}):Object(Nn.jsx)(p.b,{style:{textDecoration:"none"},to:"/login",children:Object(Nn.jsx)(Vn.a,{color:"primary",children:"Login"})})]}),Object(Nn.jsx)(ka,{width:t,height:t})]})};function Pa(e){var t=e.outputId,n=e.channel,r=e.handleOutputChannelChange,a=e.source,s=gi(),o=function(){var e=Object(i.useState)({inputs:[],outputs:[]}),t=Object(Qt.a)(e,2),n=t[0],r=t[1];return Object(i.useEffect)((function(){Ee&&Jt.WebMidi.enable().then((function(){var e=Jt.WebMidi,t=en(e.inputs).inputs,n={outputs:e.outputs.map((function(e){return{id:e._midiOutput.id,name:e._midiOutput.name,octaveOffset:e._octaveOffset,eventsSuspended:e.eventsSuspended}}))};r({instance:e,inputs:t,outputs:n.outputs})})).catch((function(e){return alert(e)}))}),[]),n}(),u=o.instance?o.instance.outputs:[],l=function(e,t,n){"outputId"===e&&((""===t||u.find((function(e){return e.id===t})))&&(n="1"));return r(t,n)};return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{sx:{display:"flex",alignItems:"end"},children:[Object(Nn.jsxs)(Gi.a,{id:"".concat(a,"-output-select"),className:s.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-output-label",sx:{display:"flex"},children:"MIDI Output"}),Object(Nn.jsxs)(Ui.a,{labelId:"block-output-label",value:t,label:"MIDI Output",onChange:function(e){return l("outputId",e.target.value,n)},MenuProps:bi,children:[0===u.length?Object(Nn.jsxs)(ii.a,{value:"output-options-empty",disabled:!0,children:["No devices found. Try connecting a",Object(Nn.jsx)("br",{}),"midi device and refresh the page."]},"output-options-empty"):Object(Nn.jsx)(ii.a,{value:"",children:"None"}),u.map((function(e){return Object(Nn.jsx)(ii.a,{value:e.id,children:"".concat(e.name)},e.id)}))]})]}),Object(Nn.jsxs)(Gi.a,{sx:{width:"130px",ml:2},className:s.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-channel-label",children:"Channel"}),Object(Nn.jsx)(Ui.a,{labelId:"block-channel-label",value:n,label:"Channel",onChange:function(e){return l("channelId",t,e.target.value)},MenuProps:bi,children:t?["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"].map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)})):Object(Nn.jsx)(ii.a,{value:"channel-options-empty",disabled:!0,children:"Select an Output before setting the channel."},"channel-options-empty")})]}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"Sends the notes from the sheet music to a midi output during playback.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2,mb:2}})})]})},"output-setting")})}var Ta=function(e){var t=e.block,n=gi(),r=mn(),a=Object(i.useState)(t.osmdSettings),s=Object(Qt.a)(a,2),o=s[0],u=s[1],l=Object(i.useState)(!1),c=Object(Qt.a)(l,2),h=c[0],d=c[1];Object(i.useEffect)((function(){u(t.osmdSettings)}),[t.osmdSettings]);var f,p=function(e){d(!0),u(e)},m=function(e){return function(t,n){p(Object(v.a)(Object(v.a)({},o),{},Object(da.a)({},e,n)))}},g=function(e){return function(){p(Object(v.a)(Object(v.a)({},o),{},Object(da.a)({},e,!o[e])))}},y=function(e){return function(t){p(Object(v.a)(Object(v.a)({},o),{},Object(da.a)({},e,parseInt(t.target.value))))}},b=function(e){return e.target.select()};return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Pa,{source:"osmd-settings",outputId:o.midiOutputId,channel:o.midiOutputChannel,handleOutputChannelChange:function(e,t){return p(Object(v.a)(Object(v.a)({},o),{},{midiOutputId:e,midiOutputChannel:t}))}})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(sr,{osmdSettings:o,blockId:t.id})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:Object(Nn.jsx)(ba.a,{size:"small",label:"Start Measure",type:"number",value:o.drawFromMeasureNumber,onChange:y("drawFromMeasureNumber"),onFocus:b})})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:Object(Nn.jsx)(ba.a,{size:"small",label:"End Measure",helperText:"0 will display all measures until the end",type:"number",value:o.drawUpToMeasureNumber,onChange:y("drawUpToMeasureNumber"),onFocus:b})})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"zoom",gutterBottom:!0,children:["Zoom:",Object(Nn.jsxs)(jn.a,{component:"span",fontWeight:500,children:[" ","".concat(o.zoom,"x")]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:o.zoom,onChange:m("zoom"),"aria-labelledby":"zoom",step:.05,min:.25,max:3})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:g("showCursor"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:n.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:o.showCursor}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Show Audio Player"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If enabled, cursor also moves when correct notes are hit on selected midi input.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:g("iterateCursorOnInput"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:n.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:o.iterateCursorOnInput}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Iterate Cursor On Input Match"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If the notes pressed on your midi input match the notes under the cursor, then iterate to the next note(s).",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),o.iterateCursorOnInput&&Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{sx:{padding:0,textAlign:"left"},id:"cursor-match-clefs-label",children:Object(Nn.jsxs)(On.a,{sx:{display:"flex"},children:[Object(Nn.jsx)("div",{children:"Cursor Match Clef(s)"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"The cursor will iterate when your midi input matches the notes in the selected clefs. Change this setting if you only want to practice the notes on a single clef.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),Object(Nn.jsx)(Ui.a,{labelId:"cursor-match-clefs-label",value:o.cursorMatchClefs,label:"Cursor Match Clef(s)",onChange:(f="cursorMatchClefs",function(e){p(Object(v.a)(Object(v.a)({},o),{},Object(da.a)({},f,e.target.value)))}),MenuProps:bi,children:we.map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"playbackVolume",gutterBottom:!0,children:["Playback Volume:",Object(Nn.jsxs)(jn.a,{component:"span",fontWeight:500,children:[" ","".concat(o.playbackVolume)]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:o.playbackVolume,onChange:m("playbackVolume"),"aria-labelledby":"playbackVolume",step:1,min:0,max:100})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"metronomeVolume",gutterBottom:!0,children:["Metronome Volume:",Object(Nn.jsxs)(jn.a,{component:"span",fontWeight:500,children:[" ","".concat(o.metronomeVolume)]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:o.metronomeVolume,onChange:m("metronomeVolume"),"aria-labelledby":"metronomeVolume",step:1,min:0,max:100})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Gi.a,{className:n.select,size:"small",fullWidth:!0,children:Object(Nn.jsx)(ba.a,{size:"small",label:"Metronome count in beats",type:"number",value:o.metronomeCountInBeats,onChange:y("metronomeCountInBeats"),onFocus:b})})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:g("listenGlobalPlayback"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:n.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:o.listenGlobalPlayback}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Listen to Global Playback"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If enabled, then the score will automatically play/pause in sync with a Midi File Player widget that is controlling global playback.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),h&&Object(Nn.jsx)(Ma,{children:Object(Nn.jsx)(On.a,{sx:{flexGrow:1,bgcolor:"background.paper",zIndex:1},children:Object(Nn.jsx)(Vn.a,{sx:{width:"100%"},onClick:function(){d(!1),r(K({id:t.id,changes:{osmdSettings:o}}))},variant:"contained",children:"Save Changes"})})})]})};var Ca=function(e){var t=e.block,n=mn(),r=Object(i.useState)(t.pianoSettings),a=Object(Qt.a)(r,2),s=a[0],o=a[1],u=$t.a.getNoteDetails(s.startNote),l=u.accidental,c=u.name,h=u.octave,d=Object(i.useMemo)((function(){return Object(be.debounce)((function(e){n(K({id:t.id,changes:{pianoSettings:e}}))}),500)}),[n,t.id]),f=function(e){return function(t,n){var i=Object(v.a)(Object(v.a)({},s),{},Object(da.a)({},e,n));o(i),d(i)}};return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"startNote",gutterBottom:!0,children:["Start Note:",Object(Nn.jsxs)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:[" ","".concat(c).concat(l||"").concat(h)]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:s.startNote,onChange:f("startNote"),"aria-labelledby":"startNote",min:0,max:127})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsx)(jn.a,{variant:"body1",id:"keyWidth",gutterBottom:!0,children:"Key Width:"}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:s.keyWidth,onChange:f("keyWidth"),"aria-labelledby":"keyWidth",step:.001,min:.015,max:.1})})]})})]})};function Ia(e){var t=e.inputId,n=e.channelId,i=e.handleInputChannelChange,r=e.source,a=gi(),s=vn(dt),o=vn(pt).filter((function(e){return e.inputId===t})),u=s.find((function(e){return e.id===t}))?t:"",l=o.find((function(e){return e.id===n}))?n:"",c=function(e,t,n){if("inputId"===e)if(""===t)n="";else{var r=s.find((function(e){return e.id===t}));r&&(n=r.channelIds[0])}return i(t,n)};return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{sx:{display:"flex"},children:[Object(Nn.jsxs)(Gi.a,{id:"".concat(r,"-input-select"),className:a.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-input-label",children:"MIDI Input"}),Object(Nn.jsxs)(Ui.a,{labelId:"block-input-label",value:u,label:"MIDI Input",onChange:function(e){return c("inputId",e.target.value,l)},MenuProps:bi,children:[0===s.length?Object(Nn.jsxs)(ii.a,{value:"input-options-empty",disabled:!0,children:["No devices found. Try connecting a",Object(Nn.jsx)("br",{}),"midi device and refresh the page."]},"input-options-empty"):Object(Nn.jsx)(ii.a,{value:"",children:"None"}),s.map((function(e){return Object(Nn.jsx)(ii.a,{value:e.id,children:"".concat(e.name)},e.id)}))]})]}),Object(Nn.jsxs)(Gi.a,{sx:{width:"150px",ml:2},className:a.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-channel-label",children:"Channel"}),Object(Nn.jsxs)(Ui.a,{labelId:"block-channel-label",value:l,label:"Channel",onChange:function(e){return c("channelId",u,e.target.value)},MenuProps:bi,children:[t?Object(Nn.jsx)(ii.a,{value:"",children:"None"}):Object(Nn.jsx)(ii.a,{value:"channel-options-empty",disabled:!0,children:"Select an Input before setting the channel."},"channel-options-empty"),o.map((function(e){return Object(Nn.jsx)(ii.a,{value:e.id,children:"".concat(e.number)},e.id)}))]})]})]})},"input-setting")})}var Aa=function(e){var t=e.value,n=e.min,r=e.max,a=e.label,s=e.onCommitChange,o=e.valuePrefix,u=void 0===o?"":o,l=e.valueSuffix,c=void 0===l?"":l,h=Object(i.useState)(t),d=Object(Qt.a)(h,2),f=d[0],p=d[1];return Object(Nn.jsxs)(Fn.a,{sx:{mr:3},children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:a,gutterBottom:!0,children:[a,":",Object(Nn.jsxs)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:[" ","".concat(u).concat(f).concat(c)]})]}),Object(Nn.jsx)(hi.a,{value:f,onChange:function(e,t){return p(t)},onChangeCommitted:function(e,t){return s(t)},"aria-labelledby":a,min:n,max:r})]})};var La=function(e){var t,n=e.block,r=gi(),a=mn(),s=Object(i.useCallback)((function(e,t){a(K({id:n.id,changes:{youtubePlayerSettings:Object(v.a)(Object(v.a)({},n.youtubePlayerSettings),{},Object(da.a)({},e,t))}}))}),[n.id,n.youtubePlayerSettings,a]),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){var i=n.target.value;s(e,t?parseFloat(i):i)}};return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Gi.a,{className:r.select,size:"small",fullWidth:!0,children:Object(Nn.jsx)(ba.a,{size:"small",label:"Youtube URL",value:n.youtubePlayerSettings.url,onChange:o("url"),onFocus:function(e){return e.target.select()}})})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Aa,{value:n.youtubePlayerSettings.volume,min:0,max:100,label:"Volume",valueSuffix:"%",onCommitChange:function(e){return s("volume",e)}})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:r.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{sx:{padding:0,textAlign:"left"},id:"video-fit-label",children:"Video Fit"}),Object(Nn.jsx)(Ui.a,{labelId:"video-fit-label",value:n.youtubePlayerSettings.videoFit,label:"Video Fit",onChange:(t="videoFit",function(e){s(t,e.target.value)}),MenuProps:bi,children:["contain","cover"].map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})}),"cover"===n.youtubePlayerSettings.videoFit&&Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Aa,{value:n.youtubePlayerSettings.verticalScroll,min:0,max:100,label:"Vertical Scroll",valueSuffix:"%",onCommitChange:function(e){return s("verticalScroll",e)}})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Fn.a,{onClick:function(e){return function(){s(e,!n.youtubePlayerSettings[e])}}("listenGlobalPlayback"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:r.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:n.youtubePlayerSettings.listenGlobalPlayback}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Listen to Global Playback"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If enabled, then the video will automatically play/pause in sync with a Midi File Player widget that is controlling global playback.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),n.youtubePlayerSettings.listenGlobalPlayback&&Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Gi.a,{className:r.select,size:"small",fullWidth:!0,children:Object(Nn.jsx)(ba.a,{size:"small",inputProps:{step:"0.1",lang:"en-US"},label:"Global Playback Offset (seconds)",type:"number",value:n.youtubePlayerSettings.globalPlaybackStartOffset,onChange:o("globalPlaybackStartOffset",!0),onFocus:function(e){return e.target.select()}})})})]})};var Oa=function(e){var t,n=e.block,i=n.tonnetzSettings,r=mn();return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Fn.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"zoom",gutterBottom:!0,children:["Zoom:",Object(Nn.jsxs)(jn.a,{component:"span",fontWeight:500,children:[" ","".concat(i.zoom,"x")]})]}),Object(Nn.jsx)(Fn.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:i.zoom,onChange:(t="zoom",function(e,a){r(K({id:n.id,changes:{tonnetzSettings:Object(v.a)(Object(v.a)({},i),{},Object(da.a)({},t,a))}}))}),"aria-labelledby":"zoom",step:.05,min:.5,max:3})})]})})})};var Ra=function(e){var t,n=e.block,r=mn(),a=Object(i.useState)(n.staffSettings),s=Object(Qt.a)(a,2),o=s[0],u=s[1],l=Object(i.useMemo)((function(){return Object(be.debounce)((function(e){r(K({id:n.id,changes:{staffSettings:e}}))}),500)}),[n.id,r]);return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"verticalSpacing",gutterBottom:!0,children:["Vertical spacing:",Object(Nn.jsxs)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:[" ","".concat(o.verticalSpacing,"x")]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:o.verticalSpacing,onChange:(t="verticalSpacing",function(e,n){var i=Object(v.a)(Object(v.a)({},o),{},Object(da.a)({},t,n));u(i),l(i)}),"aria-labelledby":"verticalSpacing",step:.1,min:0,max:2})})]})})})};var Na=function(e){var t,n=e.block,i=gi(),r=mn();return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:(t="keyPrevalenceShading",function(){!function(e,t){r(K({id:n.id,changes:{circleOfFifthsSettings:Object(v.a)(Object(v.a)({},n.circleOfFifthsSettings),{},Object(da.a)({},e,t))}}))}(t,!n.circleOfFifthsSettings[t])}),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:i.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:n.circleOfFifthsSettings.keyPrevalenceShading}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Key prevalence shading"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If enabled, the notes in the circle will be shaded based on how many input notes are within each key. Eg. if you play a song in the key of C major then the the Gb major slice of the Circle of 5ths will be dim, since it shares very few notes with C major. You can reset this by hovering the Circle widget and clicking the refresh button.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})})})};var Ba=function(){var e=mn(),t=gi(),n=vn(k);return Object(Nn.jsx)(Nn.Fragment,{children:Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:t.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"channel-key-label",children:"Key"}),Object(Nn.jsx)(Ui.a,{labelId:"channel-key-label",value:n.globalKeySignature,label:"Key",onChange:function(t){var n=t.target.value;e(x({globalKeySignature:n,globalKeySignatureUsesSharps:De(n)}))},MenuProps:bi,children:je.map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})})})};var Da=function(e){var t,n=e.block,i=gi(),r=mn();return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Ji,{imageSettings:n.imageSettings,blockId:n.id})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:i.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{sx:{padding:0,textAlign:"left"},id:"image-objectFit-label",children:"Object Fit"}),Object(Nn.jsx)(Ui.a,{labelId:"image-objectFit-label",value:n.imageSettings.objectFit,label:"Object Fit",onChange:(t="objectFit",function(e){var i=e.target.value;!function(e){r(K({id:n.id,changes:{imageSettings:e}}))}(Object(v.a)(Object(v.a)({},n.imageSettings),{},Object(da.a)({},t,i)))}),MenuProps:bi,children:["fill","contain","cover"].map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e},e)}))})]})})]})};var Fa=function(e){var t,n=e.block,r=gi(),a=mn(),s=Object(i.useState)(n.midiFilePlayerSettings),o=Object(Qt.a)(s,2),u=o[0],l=o[1];Object(i.useEffect)((function(){l(n.midiFilePlayerSettings)}),[n.midiFilePlayerSettings]);var c=function(e){return function(t,n){var i=Object(v.a)(Object(v.a)({},u),{},Object(da.a)({},e,n));l(i)}},h=function(e){return function(t,n){p(Object(da.a)({},e,n))}},d=function(e){return function(){p(Object(da.a)({},e,!n.midiFilePlayerSettings[e]))}},f=function(e){if(null!==e){var t=Array.isArray(e)?{selectedMidiFiles:e}:{selectedAudioFile:e};p(t)}},p=function(e){a(K({id:n.id,changes:{midiFilePlayerSettings:Object(v.a)(Object(v.a)({},n.midiFilePlayerSettings),e)}}))};return Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(ti.a,{arrow:!0,title:"Upload and select one or more midi files to use as an input. Each file that's selected will appear as an option in the Midi Input setting. Optionally, add an audio file to sync with the midi player.",placement:"left",children:Object(Nn.jsxs)(On.a,{sx:{display:"flex"},children:[Object(Nn.jsx)(ya.a,{color:"secondary",sx:{mr:2}}),Object(Nn.jsx)(jn.a,{color:"secondary",variant:"body1",children:"Learn More"})]})})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(qi,{selectLabel:"Select Midi File(s)",folder:"midi",blockId:n.id,multi:!0,multiSelectValue:u.selectedMidiFiles.map((function(e){return e.key})),onSelectChange:f})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(qi,{showLoginLink:!1,selectLabel:"Select Audio File (mp3)",folder:"audio",blockId:n.id,selectValue:null===(t=u.selectedAudioFile)||void 0===t?void 0:t.key,onSelectChange:f})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"volume",gutterBottom:!0,children:["Volume:",Object(Nn.jsxs)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:[" ","".concat(Math.round(100*u.volume),"%")]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:u.volume,onChange:c("volume"),onChangeCommitted:h("volume"),"aria-labelledby":"volume",step:.01,min:0,max:1})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{children:[Object(Nn.jsxs)(jn.a,{variant:"body1",id:"audioDelay",gutterBottom:!0,children:["Audio Delay:",Object(Nn.jsxs)(jn.a,{color:"secondary",component:"span",fontWeight:500,children:[" ","".concat(Math.round(u.audioDelay),"ms")]})]}),Object(Nn.jsx)(On.a,{sx:{mr:3},children:Object(Nn.jsx)(hi.a,{value:u.audioDelay,onChange:c("audioDelay"),onChangeCommitted:h("audioDelay"),"aria-labelledby":"audioDelay",step:1,min:-3e3,max:3e3})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:d("controlGlobalPlayback"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:r.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:u.controlGlobalPlayback}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Control Global Playback"}),Object(Nn.jsx)(ti.a,{arrow:!0,title:"If enabled, then the playback buttons will automatically trigger playback events for any other widgets listening to global playback, such as a Sheet Music widget.",placement:"top",children:Object(Nn.jsx)(ya.a,{color:"secondary",sx:{ml:2}})})]})}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(On.a,{onClick:d("loopingEnabled"),sx:{cursor:"pointer",display:"flex",alignItems:"center"},className:r.checkbox,children:[Object(Nn.jsx)(zi.a,{checked:u.loopingEnabled}),Object(Nn.jsx)(jn.a,{variant:"body1",children:"Enable Looping"})]})})]})};function ja(e){var t=e.drawerData,n=Object(Rn.a)(),i=gi(),r=t.blockId,a=vn((function(e){return $(e,r)})),s=mn();if(!a)return Object(Nn.jsx)(Fn.a,{sx:{mt:4,textAlign:"center"},children:Object(Nn.jsx)(jn.a,{sx:{color:n.palette.text.secondary},variant:"body1",children:"No block selected."})});var o=function(e){s(K({id:r,changes:e}))};return Object(Nn.jsxs)(ha.a,{sx:{pl:3,pr:3,mb:2},container:!0,rowSpacing:4,children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:"".concat(i.select," widget-selector"),size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-widget-label",children:"Widget"}),Object(Nn.jsx)(Ui.a,{labelId:"block-widget-label",value:a.widget,label:"Widget",onChange:function(e){var t=e.target.value;f.a.event({category:"interaction",action:"widget selection",label:t}),o({widget:t})},MenuProps:bi,children:Me.map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:"".concat(e)},e)}))})]})}),function(){var e=[];return["Circle Of Fifths","Chord Estimator","Grand Staff","Tonnetz","Sheet Music","Midi File Player"].includes(a.widget)&&e.push(Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Gi.a,{className:i.select,size:"small",fullWidth:!0,children:[Object(Nn.jsx)(Wi.a,{id:"block-themeMode-label",children:"Block Theme"}),Object(Nn.jsx)(Ui.a,{labelId:"block-themeMode-label",value:a.themeMode,label:"Block Theme",onChange:function(e){return o({themeMode:e.target.value})},MenuProps:bi,children:G.map((function(e){return Object(Nn.jsx)(ii.a,{value:e,children:e[0].toUpperCase()+e.substring(1)},"".concat(e,"-").concat(a.id))}))})]})},"block-themeMode-setting-".concat(a.id))),["Piano","Circle Of Fifths","Grand Staff","Chord Estimator","Sheet Music","Tonnetz"].includes(a.widget)&&(e=e.concat([Object(Nn.jsx)(Ia,{source:a.id,handleInputChannelChange:function(e,t){return o({inputId:e,channelId:t})},inputId:a.inputId,channelId:a.channelId},"block-input-channel-".concat(a.id)),Object(Nn.jsx)(va,{inputId:a.inputId},"input-settings-".concat(a.id))])),"Piano"===a.widget&&(e=e.concat([Object(Nn.jsx)(Ca,{block:a},"piano-setting-".concat(a.id))])),"Grand Staff"===a.widget&&(e=e.concat([Object(Nn.jsx)(Ra,{block:a},"staff-setting-".concat(a.id))])),"Sheet Music"===a.widget&&(e=e.concat([Object(Nn.jsx)(Ta,{block:a},"osmd-setting-".concat(a.id))])),["Tonnetz"].includes(a.widget)&&e.push(Object(Nn.jsx)(Oa,{block:a},"tonnetz-setting-".concat(a.id))),["Circle Of Fifths"].includes(a.widget)&&e.push(Object(Nn.jsx)(Na,{block:a},"circle-of-fifths-setting-".concat(a.id))),["Grand Staff","Tonnetz","Chord Estimator"].includes(a.widget)&&e.push(Object(Nn.jsx)(Ba,{},"key-setting-".concat(a.id))),["Piano","Circle Of Fifths","Tonnetz"].includes(a.widget)&&e.push(Object(Nn.jsx)(ma,{block:a},"color-setting-".concat(a.id))),["Youtube Player"].includes(a.widget)&&e.push(Object(Nn.jsx)(La,{block:a},"youtube-player-setting-".concat(a.id))),"Image"===a.widget&&(e=e.concat([Object(Nn.jsx)(Da,{block:a},"image-setting-".concat(a.id))])),"Midi File Player"===a.widget&&(e=e.concat([Object(Nn.jsx)(Fa,{block:a},"midi-player-setting-".concat(a.id))])),e}()]})}function Va(){var e=mn(),t=vn(ee),n=t.defaultInputId,i=t.defaultChannelId;return Object(Nn.jsxs)(ha.a,{sx:{pl:3,pr:3,mb:2},container:!0,rowSpacing:4,children:[Object(Nn.jsx)(Ia,{source:"global",handleInputChannelChange:function(t,n){return e(Z({defaultInputId:t,defaultChannelId:n}))},inputId:n,channelId:i}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(Ba,{})})]})}var Ga=n(27),Wa=n(439),Ua=n.n(Wa),za=n(440),Ha=n.n(za),Xa=n(880),Ya=n(884),Ka="\n  query ListTemplates(\n    $filter: ModelTemplateFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listTemplates(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        template\n        createdAt\n        updatedAt\n        owner\n      }\n      nextToken\n    }\n  }\n",qa=function(e){return Object(v.a)(Object(v.a)({},JSON.parse(e.template)),{},{id:e.id,createdAt:e.createdAt,updatedAt:e.updatedAt,owner:e.owner})};function Za(e){var t,n,i;return(null===(t=e.data)||void 0===t||null===(n=t.listTemplates)||void 0===n||null===(i=n.items)||void 0===i?void 0:i.map((function(e){return e?qa(e):null})).filter((function(e){return null!==e})))||[]}function Ja(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.getTemplate;return n?qa(n):null}function Qa(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.createTemplate;return n?qa(n):null}function $a(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.updateTemplate;return n?qa(n):null}var es=n(437),ts=n.n(es),ns=n(436),is=n.n(ns),rs=n(438),as=n.n(rs),ss=n(868),os=n(849),us=n(850),ls=n(851);var cs=function(e){var t=e.template,n=e.selected,r=e.handleTemplateDelete,a=e.handleTemplateOverwrite,s=Object(Rn.a)(),o=Object(i.useState)(null),u=Object(Qt.a)(o,2),l=u[0],c=u[1],h=Boolean(l),d=function(){c(null)};return Object(Nn.jsx)(ss.a,{secondaryAction:Object(Nn.jsxs)(Nn.Fragment,{children:[Object(Nn.jsx)(ci.a,{onClick:function(e){c(e.currentTarget)},id:"template-menu",edge:"end","aria-controls":h?"basic-menu":void 0,"aria-expanded":h?"true":void 0,"aria-label":"template menu","aria-haspopup":"true",children:Object(Nn.jsx)(is.a,{})}),Object(Nn.jsxs)(ni.a,{id:"template-menu-dropdown",anchorEl:l,open:h,onClose:d,MenuListProps:{"aria-labelledby":"template-menu"},children:[Object(Nn.jsxs)(ii.a,{onClick:function(){navigator.clipboard.writeText("".concat(window.location.host,"/play/").concat(t.id)),d()},children:[Object(Nn.jsx)(os.a,{children:Object(Nn.jsx)(ts.a,{fontSize:"small"})}),Object(Nn.jsx)(us.a,{children:"Copy Link"})]}),Object(Nn.jsxs)(ii.a,{onClick:function(){a(t.id),d()},children:[Object(Nn.jsx)(os.a,{children:Object(Nn.jsx)(as.a,{fontSize:"small"})}),Object(Nn.jsx)(us.a,{children:"Overwrite"})]}),Object(Nn.jsxs)(ii.a,{onClick:function(){return r(t.id)},sx:{color:s.palette.error.main},children:[Object(Nn.jsx)(os.a,{sx:{color:s.palette.error.main},children:Object(Nn.jsx)(Zn.a,{fontSize:"small"})}),Object(Nn.jsx)(us.a,{children:"Delete"})]})]})]}),disablePadding:!0,children:Object(Nn.jsx)(ls.a,{selected:n,onClick:function(){return window.location.href="".concat(window.location.origin,"/play/").concat(t.id)},children:Object(Nn.jsx)(us.a,{primary:t.name})})},t.id)};function hs(){var e=Object(m.g)(),t=Object(Rn.a)(),n=mn(),r=pi(),a=Object(m.h)().templateId,s=vn(Q),o=vn(ue),u=vn(k),l=vn(ee),c=l.defaultInputId,h=l.defaultChannelId,d=Object(i.useState)([]),f=Object(Qt.a)(d,2),p=f[0],g=f[1],y=Object(i.useState)(""),b=Object(Qt.a)(y,2),S=b[0],x=b[1],_=Object(i.useState)(!1),E=Object(Qt.a)(_,2),M=E[0],w=E[1],P=Object(i.useState)(!1),T=Object(Qt.a)(P,2),C=T[0],I=T[1];Object(i.useEffect)((function(){function e(){return(e=Object(xn.a)(qt.a.mark((function e(){var t;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),e.prev=1,e.next=4,wn(Ka);case 4:t=e.sent,g(Za(t).sort((function(e,t){return Date.parse(t.createdAt)-Date.parse(e.createdAt)}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r("An error occurred while fetching your templates","error",e.t0);case 11:I(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n,r]);var A=function(e,t){var n=s.map((function(e){return Object(xe.a)()}));return{id:e,name:t,defaultInputId:c,defaultChannelId:h,midiBlocks:s.map((function(e,t){return Object(v.a)(Object(v.a)({},e),{},{id:n[t]})})),blockLayout:o.map((function(e,t){return Object(v.a)(Object(v.a)({},e),{},{i:n[t]})})),globalSettings:u}},L=function(){var t=Object(xn.a)(qt.a.mark((function t(){var n,i;return qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(S.length>0)){t.next=18;break}return t.prev=1,t.next=4,wn("\n  mutation CreateTemplate(\n    $input: CreateTemplateInput!\n    $condition: ModelTemplateConditionInput\n  ) {\n    createTemplate(input: $input, condition: $condition) {\n      id\n      template\n      createdAt\n      updatedAt\n      owner\n    }\n  }\n",{input:{template:JSON.stringify(A("",S))}});case 4:if(n=t.sent,!(i=Qa(n))){t.next=11;break}g([i].concat(Object(Ga.a)(p))),e("/play/".concat(i.id)),t.next=12;break;case 11:throw new Error("unexpected response: ".concat(JSON.stringify(n)));case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),r("An error occurred while creating a template","error",t.t0);case 17:N();case 18:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(){return t.apply(this,arguments)}}(),O=function(){var e=Object(xn.a)(qt.a.mark((function e(t){var n,i,a,s;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===(n=p.findIndex((function(e){return e.id===t})))){e.next=9;break}return e.next=4,wn("\n  mutation UpdateTemplate(\n    $input: UpdateTemplateInput!\n    $condition: ModelTemplateConditionInput\n  ) {\n    updateTemplate(input: $input, condition: $condition) {\n      id\n      template\n      createdAt\n      updatedAt\n      owner\n    }\n  }\n",{input:{id:p[n].id,template:JSON.stringify(A(p[n].id,p[n].name))}});case 4:i=e.sent,(a=$a(i))?((s=Object(Ga.a)(p))[n]=a,g(s)):r("An error occurred while updating your template. Please try refreshing the page or contact support for help.","error","Update template mutation failed! ".concat(JSON.stringify(i)),8e3),e.next=10;break;case 9:r("An error occurred while updating your template. Please try refreshing the page or contact support for help.","error","Unable to update template ".concat(t,": template not found in list."),8e3);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(xn.a)(qt.a.mark((function e(t){var n,i,a;return qt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wn("\n  mutation DeleteTemplate(\n    $input: DeleteTemplateInput!\n    $condition: ModelTemplateConditionInput\n  ) {\n    deleteTemplate(input: $input, condition: $condition) {\n      id\n      template\n      createdAt\n      updatedAt\n      owner\n    }\n  }\n",{input:{id:t}});case 2:a=e.sent,(null===(n=a.data)||void 0===n||null===(i=n.deleteTemplate)||void 0===i?void 0:i.id)?g(p.filter((function(e){var t,n;return e.id!==(null===(t=a.data)||void 0===t||null===(n=t.deleteTemplate)||void 0===n?void 0:n.id)}))):r("An error occurred while deleting your template. Please try refreshing the page or contact support for help.","error","Delete template mutation failed! ".concat(JSON.stringify(a)),8e3);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){x(""),w(!1)};return Object(Nn.jsxs)(ha.a,{sx:{mb:2},container:!0,rowSpacing:1,children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsx)(On.a,{sx:{pl:1,pr:1,height:"40px"},children:M?Object(Nn.jsx)(ds,{name:S,handleSave:L,handleClose:N,handleChange:x}):Object(Nn.jsxs)(On.a,{sx:{display:"flex"},children:[Object(Nn.jsx)(Vn.a,{onClick:function(){return w(!0)},sx:{width:"100%",height:"100%",ml:1,mr:2},variant:"contained",children:"Save Template"}),Object(Nn.jsx)(Vn.a,{onClick:function(){var i=Ke(t),r=i.midiBlocks,a=i.blockLayout;n(q(r)),n(oe(a)),e("/play")},sx:{width:"100%",height:"100%",mr:1},variant:"contained",children:"Start Fresh"})]})})}),C?Object(Nn.jsx)(On.a,{sx:{width:"100%",textAlign:"center",mt:15},children:Object(Nn.jsx)(Xi,{animate:!0,color:t.palette.primary.main,width:75})}):Object(Nn.jsx)(Xa.a,{sx:{width:"100%"},component:"nav","aria-label":"template list",children:p.map((function(e){return Object(Nn.jsx)(cs,{selected:a===e.id,template:e,handleTemplateDelete:R,handleTemplateOverwrite:O},e.id)}))})]})}function ds(e){var t=e.name,n=e.handleSave,i=e.handleClose,r=e.handleChange;return Object(Nn.jsx)(ba.a,{autoFocus:!0,size:"small",placeholder:"Enter template name",value:t,onChange:function(e){return r(e.target.value)},onKeyDown:function(e){"Enter"===e.key?n():"Escape"===e.key&&i()},sx:{width:"100%",height:"100%",pl:1,pr:1},InputProps:{sx:{pb:1.5,pl:2,pr:2},endAdornment:Object(Nn.jsxs)(Ya.a,{position:"end",children:[Object(Nn.jsx)(ci.a,{sx:{p:1,mr:1},"aria-label":"save template",onClick:function(){return n()},edge:"end",color:"primary",children:Object(Nn.jsx)(Ua.a,{})}),Object(Nn.jsx)(ci.a,{sx:{p:1},"aria-label":"cancel",onClick:function(){return i()},edge:"end",children:Object(Nn.jsx)(Ha.a,{})})]})}})}function fs(){var e=Cn().currentUser;return Object(Nn.jsx)("div",{children:e?Object(Nn.jsx)(hs,{}):Object(Nn.jsxs)(On.a,{sx:{textAlign:"center",mt:4},children:["Please"," ",Object(Nn.jsx)(p.b,{to:"/login",style:{textDecoration:"none"},children:Object(Nn.jsx)(jn.a,{color:"primary",sx:{display:"inline-block",textDecoration:"underline"},children:"login"})})," ","to save your own templates."]})})}var ps=["children","value","index"],ms=12;function vs(e){var t=e.children,n=Object(Rn.a)(),i=mn(),r=Ss(),a=vn((function(e){return ve(e)})),s=a.open,o=a.drawerId,u=a.drawerData,l=a.tabValue,c=a.footerHeight;return Object(Nn.jsxs)(Fn.a,{sx:{display:"flex",height:"100%"},children:[Object(Nn.jsx)(ys,{open:s,shrinkMainOnDrawerOpen:!(window.innerWidth<=555),children:t}),Object(Nn.jsxs)(la.a,{sx:{width:ce,flexShrink:0,"& .MuiDrawer-paper":{width:ce}},transitionDuration:0,variant:"persistent",anchor:"right",open:s,children:[Object(Nn.jsxs)(bs,{sx:{height:n.spacing(ms)},children:[Object(Nn.jsx)(ci.a,{color:"primary",sx:{height:"100%",borderRadius:0},onClick:function(){i(pe())},children:"rtl"===n.direction?Object(Nn.jsx)(ra.a,{}):Object(Nn.jsx)(sa.a,{})}),Object(Nn.jsx)(oa.a,{value:l,onChange:function(e,t){i(me(t))},classes:{root:r.tabsRoot},sx:{height:n.spacing(ms)},"aria-label":"setting tabs",children:["Widget","Global","Templates"].map((function(e,t){return Object(Nn.jsx)(ua.a,Object(v.a)(Object(v.a)({className:"tab-".concat(e),classes:{root:r.tabRoot},label:e},{id:"tab-".concat(n=0),"aria-controls":"tabpanel-".concat(n)}),{},{sx:{fontSize:"0.7rem"}}),"tab-".concat(t));var n}))})]}),Object(Nn.jsxs)(Fn.a,{sx:{position:"absolute",top:n.spacing(ms),pt:3,bottom:c,width:"100%",borderTop:"1px solid ".concat(n.palette.divider),overflow:"auto !important",overflowX:"hidden"},children:[Object(Nn.jsx)(gs,{value:l,index:0,children:"BLOCK_SETTINGS"===o&&Object(Nn.jsx)(ja,{drawerData:u})}),Object(Nn.jsx)(gs,{value:l,index:1,children:Object(Nn.jsx)(Va,{})}),Object(Nn.jsx)(gs,{value:l,index:2,children:Object(Nn.jsx)(fs,{})})]}),Object(Nn.jsx)(wa,{})]})]})}function gs(e){var t=e.children,n=e.value,i=e.index,r=Object(na.a)(e,ps);return Object(Nn.jsx)("div",Object(v.a)(Object(v.a)({role:"tabpanel",hidden:n!==i,id:"tabpanel-".concat(i),"aria-labelledby":"tab-".concat(i)},r),{},{children:n===i&&Object(Nn.jsx)(Fn.a,{children:t})}))}var ys=Object(ca.a)("main",{shouldForwardProp:function(e){return!["open","shrinkMainOnDrawerOpen"].includes(e)}})((function(e){e.theme;var t=e.open,n=e.shrinkMainOnDrawerOpen;return Object(v.a)({flexGrow:1,marginRight:-350},t&&n&&{marginRight:0})})),bs=Object(ca.a)("div")((function(e){return{display:"flex",alignItems:"center",padding:e.theme.spacing(0),justifyContent:"flex-start"}})),Ss=Object(mi.a)((function(e){return{tabsRoot:{minHeight:e.spacing(ms),height:e.spacing(ms),flexGrow:1},tabRoot:{minHeight:e.spacing(ms),height:e.spacing(ms),padding:e.spacing(1),flexGrow:1}}})),xs=n(864),_s=n(869),Es=n(847);function ks(e){e.modalData;var t=e.handleClose;return Object(Nn.jsxs)(Fn.a,{children:[Object(Nn.jsx)(jn.a,{sx:Ms.modalHeader,id:"transition-modal-title",variant:"h6",component:"h2",children:"Example Modal"}),Object(Nn.jsxs)(ha.a,{container:!0,spacing:2,children:[Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:"CONTENT GOES HERE"}),Object(Nn.jsx)(ha.a,{item:!0,xs:12,children:Object(Nn.jsxs)(Fn.a,{sx:{float:"right",mt:2},children:[Object(Nn.jsx)(Vn.a,{color:"inherit",onClick:function(){return t()},children:"Cancel"}),Object(Nn.jsx)(Vn.a,{color:"primary",onClick:function(){t()},children:"Save"})]})})]})]})}var Ms={modalHeader:{mb:5}};var ws={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},Ps=function(){var e=mn(),t=vn((function(e){return Ct(e)})),n=t.open,i=t.modalId,r=t.modalData,a=function(){e(Tt())};return null===i?null:Object(Nn.jsx)("div",{children:Object(Nn.jsx)(xs.a,{open:n,onClose:a,closeAfterTransition:!0,BackdropComponent:_s.a,BackdropProps:{timeout:500},children:Object(Nn.jsx)(Es.a,{in:n,children:Object(Nn.jsx)(Fn.a,{sx:ws,children:"EXAMPLE_MODAL"===i&&r&&Object(Nn.jsx)(ks,{handleClose:a,modalData:r})})})})})},Ts=n(443),Cs=n.n(Ts),Is=n(861),As=n(886);function Ls(){var e=mn(),t=vn(Dt);return Object(Nn.jsx)(Fn.a,{sx:{position:"fixed",zIndex:2,top:8,left:0,right:0,display:"flex",justifyContent:"center"},children:Object(Nn.jsx)(Fn.a,{sx:{maxWidth:550},children:t.map((function(t){return Object(Nn.jsx)(As.a,{in:!0,children:Object(Nn.jsx)(Is.a,{severity:t.severity,action:Object(Nn.jsx)(ci.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){return e(Bt(t.id))},children:Object(Nn.jsx)(Cs.a,{fontSize:"inherit"})}),sx:{mb:2},children:t.msg})},t.id)}))})})}var Os=n(132);var Rs=function(e){var t=e.continuous,n=(e.index,e.step),i=(e.backProps,e.closeProps,e.skipProps),r=e.primaryProps,a=e.tooltipProps,s=e.isLastStep,o=Object(Rn.a)();return Object(Nn.jsxs)(Fn.a,Object(v.a)(Object(v.a)({},a),{},{sx:{background:o.palette.background.paper,pt:5,pl:5,pr:5},children:[n.title&&Object(Nn.jsx)(Fn.a,{children:n.title}),Object(Nn.jsx)(Fn.a,{children:n.content}),Object(Nn.jsxs)(Fn.a,{sx:{display:"flex",pt:4,pb:2},children:[Object(Nn.jsx)(Vn.a,Object(v.a)(Object(v.a)({disableFocusRipple:!0},i),{},{children:s?"Done":"Skip"})),t&&!s&&Object(Nn.jsx)(Vn.a,Object(v.a)(Object(v.a)({disableFocusRipple:!0},r),{},{sx:{marginLeft:"auto"},children:"Next"}))]})]}))},Ns={"":[],GET_STARTED:[{target:"#global-input-select",content:Object(Nn.jsxs)("div",{children:[Object(Nn.jsx)(Fn.a,{sx:{textAlign:"center",pb:2},children:"Welcome!"}),"Get started by selecting your midi",Object(Nn.jsx)("br",{}),"device in the global settings."]}),disableBeacon:!0,placement:"left"},{target:".block-settings-btn-0",content:Object(Nn.jsxs)("div",{children:["Hover over a widget and click the gear",Object(Nn.jsx)("br",{}),"icon to configure its settings."]}),disableBeacon:!0,placement:"left",hideNext:!0},{target:".widget-selector",content:Object(Nn.jsx)("div",{children:"Select a widget and configure its settings."}),disableBeacon:!0,placement:"left",hideNext:!0},{target:".tab-Templates",content:Object(Nn.jsxs)("div",{children:["Create templates to save your",Object(Nn.jsx)("br",{}),"layout and midi settings."]}),disableBeacon:!0,hideNext:!0}]},Bs=function(){var e=vn(Gt),t=vn(Q),n=mn(),i=Object(Rn.a)();return e.tour?Object(Nn.jsx)(Os.d,{callback:function(i){var r=i.action,a=i.index,s=i.status,o=i.type;if([Os.b.STEP_AFTER,Os.b.TARGET_NOT_FOUND].includes(o)){var u=a+(r===Os.a.PREV?-1:1);"GET_STARTED"===e.tour&&2===u&&n(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:t[0].id},tabValue:0})),n(Vt({stepIndex:u}))}else[Os.c.FINISHED,Os.c.SKIPPED].includes(s)&&(n(Vt({tour:"",stepIndex:0})),"GET_STARTED"===e.tour&&n(zt({tourComplete:!0})))},run:!!e.tour,stepIndex:e.stepIndex,steps:Ns[e.tour],showSkipButton:!0,disableOverlayClose:!0,hideBackButton:!0,continuous:!0,disableScrolling:!0,spotlightClicks:!0,tooltipComponent:Rs,spotlightPadding:4,styles:{options:{arrowColor:i.palette.background.paper,backgroundColor:i.palette.background.paper,overlayColor:"rgba(150, 150, 150, 1)",primaryColor:i.palette.primary.main,textColor:i.palette.text.primary,zIndex:1200}}}):null},Ds=function(){var e=Object(Rn.a)(),t=Object(m.g)(),n=mn(),r=pi(),a=vn(Ht),s=vn(dt),o=vn(ee),u=o.defaultInputId,l=o.initialDefaultInputLoaded,c=s.find((function(e){return e.id===u})),h=vn(kt),d=Cn().currentUser,f=Object(m.h)().templateId,p=Object(i.useState)(""),v=Object(Qt.a)(p,2),g=v[0],y=v[1],b=Object(i.useCallback)(function(){var i=Object(xn.a)(qt.a.mark((function i(r){var a,s,o,u,l;return qt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r!==g){i.next=2;break}return i.abrupt("return");case 2:if(a=Ke(e),s=a.midiBlocks,o=a.blockLayout,!r){i.next=24;break}return i.prev=4,i.next=7,wn("\n  query GetTemplate($id: ID!) {\n    getTemplate(id: $id) {\n      id\n      template\n      createdAt\n      updatedAt\n      owner\n    }\n  }\n",{id:r},Wn.c.API_KEY);case 7:if(u=i.sent,!(l=Ja(u))){i.next=17;break}s=l.midiBlocks.map((function(t){var n=Se.a.merge(Ge(e).midiBlock,t);return n.notepadSettings.templateEditorState=n.notepadSettings.currentEditorState,n})),o=l.blockLayout,n(_(l.globalSettings)),n(Z({defaultInputId:l.defaultInputId,defaultChannelId:l.defaultChannelId})),y(r),i.next=19;break;case 17:throw t("/play"),new Error("Template not found!");case 19:i.next=24;break;case 21:i.prev=21,i.t0=i.catch(4),console.error("err: ",i.t0);case 24:n(q(s)),n(oe(o)),r||(n(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:s[0].id},tabValue:0})),n(Z({defaultInputId:"",defaultChannelId:""})));case 27:case"end":return i.stop()}}),i,null,[[4,21]])})));return function(e){return i.apply(this,arguments)}}(),[e,n,t,g]);return Object(i.useEffect)((function(){b(f)}),[f,b]),Object(i.useEffect)((function(){l&&h&&!c&&!u.includes("/midi/")&&(n(fe({drawerId:"BLOCK_SETTINGS",drawerData:{blockId:""},tabValue:1})),a.tourComplete||n(Vt({tour:"GET_STARTED",stepIndex:0})))}),[u,l,c,h,n,a.tourComplete]),Object(i.useEffect)((function(){d&&Un.a.list(d.getUsername()).then((function(e){var t=[];e.forEach((function(e){if(e.key){var n=function(e,t,n){var i=e.indexOf(t);if(!(i>=0))return"";if(e=e.substring(i+t.length),n){if(!((i=e.indexOf(n))>=0))return"";e=e.substring(0,i)}return e}(e.key,"".concat(d.getUsername(),"/"),"/"),i=e.key.split("/");T.includes(n)&&t.push({key:e.key,lastModified:e.lastModified?e.lastModified.valueOf():0,folder:n,filename:i[i.length-1],size:e.size?e.size:0})}})),n(R(t))})).catch((function(e){r("An error occurred while loading your files. Please try refreshing the page or contact support for help.","error","Storage.list failed! ".concat(e),8e3)}))}),[d,n,r]),Object(Nn.jsxs)(Fn.a,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(Nn.jsx)(Ls,{}),Object(Nn.jsx)(Ps,{}),Object(Nn.jsx)(Bs,{}),Object(Nn.jsx)(vs,{children:Object(Nn.jsx)(ta,{})})]})},Fs=n(852);var js=function(){return Object(Nn.jsx)(Fn.a,{sx:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(45deg, #222E2D 0%, rgba(225, 5, 34, 0) 70%) repeat scroll 0% 0%, linear-gradient(135deg, #1B292C 10%, rgba(49, 5, 209, 0) 80%) repeat scroll 0% 0%, linear-gradient(225deg, #332A38 10%, rgba(10, 219, 216, 0) 80%) repeat scroll 0% 0%, rgba(0, 0, 0, 0) linear-gradient(315deg, #2F2E23 100%, rgba(9, 245, 5, 0) 70%) repeat scroll 0% 0%"},children:Object(Nn.jsx)(ba.a,{sx:{width:"500px",margin:"auto",border:"none","& .MuiOutlinedInput-root.Mui-focused":{"& > fieldset":{borderColor:"#fffce7"}},"& .MuiInputLabel-root":{color:"#fffce7"},"& .MuiOutlinedInput-root":{"& > fieldset":{borderColor:"#fffce7"}}},size:"small",label:"",variant:"outlined",placeholder:"Search",InputProps:{startAdornment:Object(Nn.jsx)(Ya.a,{position:"start",children:Object(Nn.jsx)(Fs.a,{})}),endAdornment:Object(Nn.jsx)(ci.a,{sx:{color:"#fffce7",m:1,p:1},"aria-label":"",component:"label",children:Object(Nn.jsx)(Fs.a,{})})}})})},Vs=function(){var e=Cn().gaUserId,t=vn(E),n=r.a.useMemo((function(){return Object(c.a)(Object(u.a)(yn(t)))}),[t]);return Object(i.useEffect)((function(){f.a.initialize([{trackingId:"G-MWHCMGX96T",gaOptions:{userId:e}}])}),[e]),Object(Nn.jsxs)(h.a,{theme:n,children:[Object(Nn.jsx)(l.a,{}),Object(Nn.jsxs)(p.a,{children:[Object(Nn.jsx)(Dn,{}),Object(Nn.jsxs)(m.d,{children:[Object(Nn.jsx)(m.b,{path:"/",element:Object(Nn.jsx)(m.a,{to:"/play",replace:!0})}),Object(Nn.jsx)(m.b,{path:"login",element:Object(Nn.jsx)(Bn,{})}),Object(Nn.jsx)(m.b,{path:"play",element:Object(Nn.jsx)(Ds,{}),children:Object(Nn.jsx)(m.b,{path:":templateId",element:Object(Nn.jsx)(Ds,{})})}),Object(Nn.jsx)(m.b,{path:"search-demo",element:Object(Nn.jsx)(js,{})}),Object(Nn.jsx)(m.b,{path:"home-demo",element:Object(Nn.jsx)(Gn,{})})]})]})]})},Gs=n(91),Ws={aws_project_region:"us-west-1",aws_appsync_graphqlEndpoint:"https://dy4uerxxtjffxoqk3o3owbvecu.appsync-api.us-west-1.amazonaws.com/graphql",aws_appsync_region:"us-west-1",aws_appsync_authenticationType:"AMAZON_COGNITO_USER_POOLS",aws_appsync_apiKey:"da2-lhbmhornpbdwhlpj2gmxjqocqa",aws_cognito_identity_pool_id:"us-west-1:d9536a3f-7332-45ea-9584-6bd996749585",aws_cognito_region:"us-west-1",aws_user_pools_id:"us-west-1_lUl5dgSMH",aws_user_pools_web_client_id:"537e4a2ja6b5ni3g2tlstu9nm3",oauth:{domain:"midisandbox7970c8ae-7970c8ae-dev.auth.us-west-1.amazoncognito.com",scope:["phone","email","openid","profile","aws.cognito.signin.user.admin"],redirectSignIn:"https://www.midisandbox.com/login/",redirectSignOut:"https://www.midisandbox.com/",responseType:"code"},federationTarget:"COGNITO_USER_POOLS",aws_cognito_username_attributes:["EMAIL"],aws_cognito_social_providers:[],aws_cognito_signup_attributes:["EMAIL"],aws_cognito_mfa_configuration:"OFF",aws_cognito_mfa_types:["SMS"],aws_cognito_password_protection_settings:{passwordPolicyMinLength:8,passwordPolicyCharacters:[]},aws_cognito_verification_mechanisms:["EMAIL"],aws_user_files_s3_bucket:"sandboxstorage113445-dev",aws_user_files_s3_bucket_region:"us-west-1"},Us=n(446);n(767),n(768);function zs(){return Object(Nn.jsx)(r.a.StrictMode,{children:Object(Nn.jsx)(o.a,{store:fn,children:Object(Nn.jsx)(Us.a,{loading:null,persistor:pn,children:Object(Nn.jsx)(Vs,{})})})})}Gs.a.configure(Ws),console.log=function(){},console.error=function(){},console.debug=function(){},s.a.render(Object(Nn.jsx)(zs,{}),document.getElementById("root"))}},[[769,1,2]]]);
//# sourceMappingURL=main.a91896a7.chunk.js.map